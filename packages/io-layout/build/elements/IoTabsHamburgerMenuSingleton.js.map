{"version":3,"file":"IoTabsHamburgerMenuSingleton.js","sourceRoot":"","sources":["../../src/elements/IoTabsHamburgerMenuSingleton.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoOverlaySingleton, NudgeDirection, NodeArray, VDOMElement, IoElement, IoElementProps, Register, ReactiveProperty, nudge, ListenerDefinition } from 'io-core';\nimport { Tab } from '../nodes/Tab.js';\nimport { ioTab, IoTab } from './IoTab.js';\n\nexport interface IoTabsHamburgerMenuExpandProps {\n  source: HTMLElement,\n  direction: NudgeDirection,\n  tabs: NodeArray<Tab>,\n  onEditTab: (event: CustomEvent) => void,\n}\n\n@Register\nclass IoTabsHamburgerMenu extends IoElement {\n  static vConstructor: (arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string) => VDOMElement;\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        border: var(--io_border);\n        border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n        border-color: var(--io_borderColorOutset);\n        background-color: var(--io_bgColorLight);\n        padding: calc(var(--io_spacing) + var(--io_borderWidth));\n        position: absolute;\n        overflow-y: auto;\n        box-shadow: 1px 1px 16px var(--io_shadowColor),\n                    1px 1px 8px var(--io_shadowColor), \n                    1px 1px 4px var(--io_shadowColor);\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host > io-tab {\n        border-color: transparent !important;\n        background-color: var(--io_bgColorLight) !important;\n        border-radius: var(--io_borderRadius) !important;\n      }\n      :host > io-tab[selected] {\n        background-color: var(--io_bgColor) !important;\n      }\n      :host > io-tab > .marker {\n        border-radius: 0;\n      }\n    `;\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>;\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare private expanded: boolean;\n\n  declare private onEditTab: (event: CustomEvent) => void;\n\n  static get Listeners() {\n    return {\n      'touchstart': ['stopPropagation', {passive: false}] as ListenerDefinition, // TODO: why?\n      'io-focus-to': 'onIoFocusTo',\n      'io-edit-tab': 'onEditTabCapture',\n    };\n  }\n\n  constructor(args: IoElementProps = {}) { super(args); }\n\n  stopPropagation(event: TouchEvent) {\n    event.stopPropagation();\n  }\n\n  onIoFocusTo(event: CustomEvent) {\n    const source = event.detail.source;\n    const cmd = event.detail.command;\n    const siblings = Array.from(this.querySelectorAll('io-tab')) as IoTab[];\n    const index = siblings.indexOf(source);\n\n    let cmdOverride = '';\n\n    if (cmd === 'ArrowDown') cmdOverride = 'Next';\n    if (cmd === 'ArrowUp') cmdOverride = 'Prev';\n    if (cmd === 'ArrowLeft') cmdOverride = 'First';\n    if (cmd === 'ArrowRight') cmdOverride = 'Last';\n\n    if (cmdOverride) {\n      if (cmdOverride === 'Next') {\n        siblings[(index + 1) % siblings.length].focus();\n      } else if (cmdOverride === 'Prev') {\n        siblings[(index - 1 + siblings.length) % siblings.length].focus();\n      } else if (cmdOverride === 'First') {\n        siblings[0].focus();\n      } else if (cmdOverride === 'Last') {\n        siblings[siblings.length - 1].focus();\n      }\n      event.stopPropagation();\n    }\n  }\n\n  onEditTabCapture(event: CustomEvent) {\n    event.stopPropagation();\n    this.onEditTab(event);\n    this.expanded = false;\n  }\n\n  expand(props: IoTabsHamburgerMenuExpandProps) {\n    this.setProperties({\n      tabs: props.tabs,\n      expanded: true,\n    });\n    this.onEditTab = props.onEditTab;\n    nudge(this, props.source, props.direction);\n    this.debounce(this.onExpand);\n  }\n  onExpand() {\n    (this.querySelector('[selected]') as HTMLElement)?.focus();\n  }\n  changed() {\n    this.render([\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n    ]);\n  }\n}\n\nexport const IoTabsHamburgerMenuSingleton = new IoTabsHamburgerMenu();\nsetTimeout(() => {\n  IoOverlaySingleton.appendChild(IoTabsHamburgerMenuSingleton as HTMLElement);\n}, 100);"]}