import{ReactiveProperty as t,Property as e,Register as i,IoElement as n,span as o,ThemeSingleton as s}from"io-gui";import{MenuItem as r,MenuOptions as a,ioMenuItem as l}from"io-menus";import{ioSelector as h}from"io-navigation";import{IoField as d}from"io-inputs";import{ioIcon as c}from"io-icons";var __decorate$5=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let p=class IoDivider extends n{static vConstructor;static get Style(){return"\n      :host {\n        position: relative;\n        flex: 0 0 var(--io_spacing3);\n        background-color: var(--io_colorLight);\n        border-style: solid;\n        border-width: 0 var(--io_borderWidth);\n        border-color: var(--io_color);\n        cursor: col-resize;\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorBlue);\n        background-color: var(--io_bgColorBlue);\n      }\n      :host[pressed]:before,\n      :host[pressed]:after {\n        background-color: var(--io_colorWhite);\n      }\n      :host:before,\n      :host:after {\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        z-index: 1;\n        opacity: 0;\n      }\n      :host:before {\n        width: var(--io_fieldHeight);\n        height: var(--io_spacing);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(90deg);\n        border-radius: var(--io_spacing);\n        opacity: 0.5;\n      }\n      :host[direction='column']:before {\n        transform: translate(-50%, -50%);\n      }\n      :host:after {\n        width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(45deg);\n        border-radius: 25%;\n      }\n      :host[direction='column'] {\n        cursor: row-resize;\n        border-width: var(--io_borderWidth) 0;\n      }\n      :host:hover {\n        border-style: dashed;\n      }\n      :host:hover:before {\n        opacity: 1;\n      }\n    "}static get Listeners(){return{pointerdown:"onPointerdown"}}constructor(t={}){super(t)}onPointerdown(t){this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerleave",this.onPointerleave),this.addEventListener("pointerup",this.onPointerup),this.setPointerCapture(t.pointerId),this.pressed=!0}onPointermove(t){this.dispatchEvent("io-divider-move",{index:this.index,clientX:t.clientX,clientY:t.clientY},!0)}onPointerleave(t){this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.pressed=!1}onPointerup(t){this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.releasePointerCapture(t.pointerId),this.pressed=!1,this.dispatchEvent("io-divider-move-end",{index:this.index,clientX:t.clientX,clientY:t.clientY},!0)}};__decorate$5([t({value:!1,type:Boolean,reflect:!0})],p.prototype,"pressed",void 0),__decorate$5([t({value:"row",type:String,reflect:!0})],p.prototype,"direction",void 0),__decorate$5([e(Number)],p.prototype,"index",void 0),p=__decorate$5([i],p);const m=p.vConstructor;var __decorate$4=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let f=class IoTab extends d{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        position: relative;\n        padding: 0;\n        /* padding-right: var(--io_lineHeight); */\n        height: inherit;\n        min-height: inherit;\n        margin: var(--io_spacing);\n        margin-bottom: calc(-1 * var(--io_borderWidth));\n        border-bottom-left-radius: 0;\n        border-bottom-right-radius: 0;\n        border-color: var(--io_borderColorLight);\n        border-bottom-color: transparent;\n        user-select: none;\n        margin-right: var(--io_spacing);\n      }\n      :host[selected] {\n        color: var(--io_colorStrong);\n        background-color: var(--io_bgColorLight);\n        border-color: var(--io_borderColorStrong);\n        border-bottom-color: var(--io_bgColorLight);\n      }\n      :host[selected]:focus {\n        color: var(--io_colorWhite);\n      }\n      :host:not([selected]) {\n        margin-bottom: var(--io_borderWidth) !important;\n      }\n      :host > * {\n        pointer-events: none;\n        display: inline-block;\n        white-space: nowrap;\n        padding: 0 var(--io_spacing);\n      }\n      :host > .label {}\n      :host > .hint {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        color: var(--io_colorLight);\n        padding-right: var(--io_spacing3);\n      }\n      :host > .hint:empty {\n        padding-right: var(--io_lineHeight);\n      }\n      :host:not(:hover) > .io-close-icon {\n        visibility: hidden;\n      }\n      :host > .io-close-icon {\n        position: absolute;\n        right: var(--io_spacing);\n        top: 0;\n        pointer-events: inherit;\n      }\n      :host > .io-close-icon:hover {\n        fill: var(--io_colorStrong);\n        stroke: var(--io_colorStrong);\n      }\n    "}constructor(t={}){super(t)}preventDefault(t){t.stopPropagation(),t.preventDefault()}onPointerdown(t){super.onPointerdown(t),t.stopPropagation(),this.setPointerCapture(t.pointerId)}onPointermove(t){}onPointerup(t){super.onPointerup(t),t.stopPropagation(),this.releasePointerCapture(t.pointerId),this.onPointerupAction(t)}onPointerupAction(t){this.onClick()}onClick(){this.item.selected=!0}onCloseClick(){this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"delete"},!0)}onKeydown(t){let e=null;if("Backspace"===t.key&&t.shiftKey?e="delete":"ArrowLeft"===t.key&&t.shiftKey?e="shiftLeft":"ArrowRight"===t.key&&t.shiftKey?e="shiftRight":"ArrowUp"===t.key&&t.shiftKey?e="shiftUp":"ArrowDown"===t.key&&t.shiftKey?e="shiftDown":"Home"===t.key&&t.shiftKey?e="shiftStart":"End"===t.key&&t.shiftKey&&(e="shiftEnd"),e)switch(t.preventDefault(),e){case"delete":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"delete"},!0);break;case"shiftLeft":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftLeft"},!0);break;case"shiftRight":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftRight"},!0);break;case"shiftUp":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftUp"},!0);break;case"shiftDown":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftDown"},!0);break;case"shiftStart":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftStart"},!0);break;case"shiftEnd":this.dispatchEvent("io-edit-tab-item",{item:this.item,command:"shiftEnd"},!0)}else super.onKeydown(t)}itemChanged(){this.setProperties({selected:this.item.bind("selected"),disabled:this.item.bind("disabled")})}itemMutated(){this.changed()}changed(){this.hidden=this.item.hidden,this.render([c({value:this.item.icon||" "}),o({class:"label"},this.item.label),o({class:"hint"},this.item.hint||""),c({value:"io:close_small",size:"small",class:"io-close-icon","@click":this.onCloseClick,"@pointerdown":this.preventDefault})])}};__decorate$4([t({type:r})],f.prototype,"item",void 0),__decorate$4([e(void 0)],f.prototype,"$parent",void 0),f=__decorate$4([i],f);const v=f.vConstructor;var __decorate$3=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let b=class IoTabs extends n{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        background-color: var(--io_bgColorStrong);\n        border-bottom: var(--io_border);\n        border-bottom-color: var(--io_borderColorStrong);\n      }\n      :host > io-tab:first-of-type {\n        margin-left: var(--io_spacing2);\n      }\n      :host > io-menu-item {\n        min-width: fit-content;\n        margin-left: auto;\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n        opacity: 0.125;\n      }\n      :host > io-menu-item:focus,\n      :host > io-menu-item:hover {\n        opacity: 1;\n      }\n      :host > io-menu-item > .label,\n      :host > io-menu-item > .icon,\n      :host > io-menu-item > .hasmore {\n        display: none;\n      }\n    "}init(){this.addTab=this.addTab.bind(this),this.selectTabByIndex=this.selectTabByIndex.bind(this)}static get Listeners(){return{"io-edit-tab-item":"onEditTabItem"}}onEditTabItem(t){t.stopPropagation();const e=t.detail.item,i=t.detail.command,n=this.tabs.items.indexOf(e);if(-1!==n){switch(i){case"delete":{if(1===this.tabs.items.length)return;this.tabs.items.splice(n,1);const t=Math.min(n,this.tabs.items.length-1);this.selectTabByIndex(t);break}case"shiftLeft":n>0&&(this.tabs.items.splice(n-1,0,this.tabs.items.splice(n,1)[0]),this.selectTabByIndex(n-1));break;case"shiftRight":n<this.tabs.items.length-1&&(this.tabs.items.splice(n+1,0,this.tabs.items.splice(n,1)[0]),this.selectTabByIndex(n+1))}i&&(this.changed(),this.dispatchEvent("object-mutated",{object:this.tabs},!1,window))}}selectTabByIndex(t){this.tabs.items[t].selected=!0;const e=this.querySelectorAll("io-tab");e[t]&&e[t].focus()}addTab(t){t.stopPropagation();const e=t.detail.item;if(!e.id)return;const i=this.tabs.findItemById(e.id);if(i){const t=this.tabs.items.indexOf(i);this.selectTabByIndex(t)}else this.tabs.addItem({id:e.id,label:e.label,icon:e.icon,hint:e.hint,mode:"select"}),this.debounce(this.selectTabByIndex,this.tabs.items.length-1);this.changed()}changed(){this.render([...this.tabs.items.map((t=>v({item:t}))),l({icon:"io:box_fill_plus",direction:"down",item:this.addMenuItem,"@io-menu-item-clicked":this.addTab})])}};__decorate$3([t({type:a,init:null})],b.prototype,"tabs",void 0),__decorate$3([e(r)],b.prototype,"addMenuItem",void 0),b=__decorate$3([i],b);const u=b.vConstructor;var __decorate$2=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let g=class IoPanel extends n{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: column;\n        flex: 1 1 auto;\n        background-color: var(--io_bgColorLight);\n      }\n    "}tabsMutated(){this.panel.selected=this.tabs.selected,this.panel.tabs.length=0;for(let t=0;t<this.tabs.items.length;t++){const e=this.tabs.items[t],i={};e.id&&(i.id=e.id),e.label&&(i.label=e.label),e.icon&&(i.icon=e.icon),e.hint&&(i.hint=e.hint),this.panel.tabs.push(i)}this.dispatchEvent("io-panel-data-changed",{panel:this.panel},!0)}panelChanged(){this.tabs&&this.tabs.dispose(),this.style.flex=this.panel.flex,this.tabs=new a({items:this.panel.tabs,selected:this.panel.selected})}changed(){this.render([u({tabs:this.tabs,addMenuItem:this.addMenuItem}),h({options:this.tabs,elements:this.elements})])}};__decorate$2([t({type:Object,init:null})],g.prototype,"panel",void 0),__decorate$2([t(Array)],g.prototype,"elements",void 0),__decorate$2([t({type:a,init:null})],g.prototype,"tabs",void 0),__decorate$2([e(r)],g.prototype,"addMenuItem",void 0),g=__decorate$2([i],g);const y=g.vConstructor;var __decorate$1=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let x=class IoSplit extends n{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        overflow: hidden;\n      }\n      :host[direction='column'] {\n        flex-direction: column;\n      }\n    "}static get Listeners(){return{"io-divider-move":"onDividerMove","io-divider-move-end":"onDividerMoveEnd"}}constructor(t={}){super(t)}onDividerMove(t){t.stopPropagation();const e=t.detail.index,i=this.getBoundingClientRect(),n=this.split.direction,o=s.spacing3,r=("row"===n?i.width:i.height)-o*(this.children.length-1)/2,a="row"===n?4*s.fieldHeight:s.fieldHeight,l=[],h=[],d=[];for(let e=0;e<this.children.length;e+=2){const s=this.children[e],r=s.getBoundingClientRect(),a="row"===n?r.width:r.height;let c=t.detail.clientX-r.left-o/2,p=t.detail.clientY-r.top-o/2;e===this.children.length-1&&(c=i.width-(t.detail.clientX-i.left)-o/2,p=i.height-(t.detail.clientY-i.top)-o/2);let m="row"===n?c:p;l.push(s),h.push(a),d.push(m)}let c=0,p=0,m=0,f=0,v=0;for(let t=0;t<l.length;t++){let i=e;i===l.length-2&&(i=l.length-1),l[t].style.flex.endsWith("%")?(m+=h[t],t<i?f++:t>i&&v++):t<i?c+=h[t]:t>i&&(p+=h[t])}if(0===e){const t=r-a*v-p,i=Math.max(a,Math.min(t,d[0]));l[e].style.flex=`0 0 ${i}px`;for(let t=0;t<l.length;t++)l[t].style.flex.endsWith("%")&&t!==e&&(l[t].style.flex=`1 1 ${Math.max(a,h[t])/m*100}%`)}else if(e===l.length-2){const t=r-a*f-c,i=Math.max(a,Math.min(t,d[e+1]));l[e+1].style.flex=`0 0 ${i}px`;for(let t=0;t<l.length;t++)l[t].style.flex.endsWith("%")&&t!==e+1&&(l[t].style.flex=`1 1 ${Math.max(a,h[t])/m*100}%`)}else{const t=h[e]+h[e+1]-a,i=Math.max(a,Math.min(t,d[e])),n=h[e+1]-(i-h[e]);for(let t=0;t<l.length;t++)l[t].style.flex.endsWith("%")&&(l[t].style.flex=t===e?`1 1 ${i/m*100}%`:t===e+1?`1 1 ${n/m*100}%`:`1 1 ${Math.max(a,h[t])/m*100}%`)}}onDividerMoveEnd(t){t.stopPropagation();let e=0;for(let t=0;t<this.children.length;t+=2){const i=this.children[t];this.split.children[e].flex=i.style.flex,e++}this.dispatchEvent("io-split-data-changed",{split:this.split},!0)}changed(){this.setAttribute("direction",this.split.direction),this.style.flex=this.split.flex;const t=[];for(let e=0;e<this.split.children.length;e++){const i=this.split.children[e];"split"===i.type?t.push(w({split:i,elements:this.elements,addMenuItem:this.addMenuItem})):"panel"===i.type&&t.push(y({panel:i,elements:this.elements,addMenuItem:this.addMenuItem})),e<this.split.children.length-1&&t.push(m({direction:this.split.direction,index:e}))}this.render(t)}};__decorate$1([t({type:Object,init:null})],x.prototype,"split",void 0),__decorate$1([t(Array)],x.prototype,"elements",void 0),__decorate$1([e(r)],x.prototype,"addMenuItem",void 0),x=__decorate$1([i],x);const w=x.vConstructor;var __decorate=function(t,e,i,n){var o,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r};let P=class IoLayout extends n{static vConstructor;static get Style(){return"\n      :host {\n        position: relative;\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n      }\n      :host > io-split {\n        max-width: 100%;\n        max-height: 100%;\n      }\n    "}static get Listeners(){return{"io-split-data-changed":"onSplitDataChanged","io-panel-data-changed":"onPanelDataChanged"}}onSplitDataChanged(t){this.dispatchEvent("object-mutated",{object:this.split},!1,window)}onPanelDataChanged(t){this.dispatchEvent("object-mutated",{object:this.split},!1,window)}elementsChanged(){this.addMenuItem&&(this.addMenuItem.options?.dispose(),this.addMenuItem.dispose());const t=[];for(let e=0;e<this.elements.length;e++){const i=this.elements[e].props?.id;i&&t.push(new r({mode:"none",id:i,label:this.elements[e].props?.label||i,icon:this.elements[e].props?.icon||"",hint:this.elements[e].props?.hint||""}))}this.addMenuItem=new r({mode:"none",options:new a({items:t})})}changed(){this.render([w({split:this.split,elements:this.elements,addMenuItem:this.addMenuItem})])}};__decorate([t({type:Object,init:null})],P.prototype,"split",void 0),__decorate([t(Array)],P.prototype,"elements",void 0),__decorate([e(r)],P.prototype,"addMenuItem",void 0),P=__decorate([i],P);const _=P.vConstructor;export{p as IoDivider,P as IoLayout,g as IoPanel,x as IoSplit,f as IoTab,b as IoTabs,m as ioDivider,_ as ioLayout,y as ioPanel,w as ioSplit,v as ioTab,u as ioTabs};
