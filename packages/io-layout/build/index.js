import{ReactiveProperty as t,Property as e,Register as o,IoElement as n,Node as i,ThemeSingleton as r,span as s,NodeArray as l,IoOverlaySingleton as a,nudge as c}from"io-gui";import{ioOptionSelect as p,MenuOption as d,ioMenuItem as h}from"io-menus";import{ioSelector as u}from"io-navigation";import{IoField as b,ioField as f,ioString as g}from"io-inputs";import{IoContextEditorSingleton as v}from"io-editors";import{ioIcon as y,IconsetDB as m}from"io-icons";var __decorate$c=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let x=class IoDivider extends n{static get Style(){return"\n      :host {\n        position: relative;\n        flex: 0 0 var(--io_spacing3);\n        background-color: var(--io_colorLight);\n        border-style: solid;\n        border-width: 0 var(--io_borderWidth);\n        border-color: var(--io_color);\n        cursor: col-resize;\n        @apply --unselectable;\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorBlue);\n        background-color: var(--io_bgColorBlue);\n      }\n      :host[pressed]:before,\n      :host[pressed]:after {\n        background-color: var(--io_colorWhite);\n      }\n      :host:before,\n      :host:after {\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        z-index: 1;\n        opacity: 0;\n      }\n      :host:before {\n        width: var(--io_fieldHeight);\n        height: var(--io_spacing);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(90deg);\n        border-radius: var(--io_spacing);\n        opacity: 0.5;\n      }\n      :host[orientation='vertical']:before {\n        transform: translate(-50%, -50%);\n      }\n      :host:after {\n        width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(45deg);\n        border-radius: 25%;\n      }\n      :host[orientation='vertical'] {\n        cursor: row-resize;\n        border-width: var(--io_borderWidth) 0;\n      }\n      :host:hover {\n        border-style: dashed;\n      }\n      :host:hover:before {\n        opacity: 1;\n      }\n    "}static get Listeners(){return{pointerdown:"onPointerdown",touchstart:["onTouchstart",{passive:!1}]}}constructor(t){super(t)}onPointerdown(t){t.preventDefault(),t.stopPropagation(),this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerleave",this.onPointerleave),this.addEventListener("pointerup",this.onPointerup),this.setPointerCapture(t.pointerId),this.pressed=!0}onPointermove(t){t.preventDefault(),this.dispatch("io-divider-move",{index:this.index,clientX:t.clientX,clientY:t.clientY},!0)}onPointerleave(t){t.preventDefault(),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.pressed=!1}onPointerup(t){t.preventDefault(),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.releasePointerCapture(t.pointerId),this.pressed=!1,this.dispatch("io-divider-move-end",{index:this.index,clientX:t.clientX,clientY:t.clientY},!0)}onTouchstart(t){this.addEventListener("touchmove",this.onTouchmove,{passive:!1}),this.addEventListener("touchend",this.onTouchend)}onTouchmove(t){t.preventDefault()}onTouchend(){this.removeEventListener("touchmove",this.onTouchmove),this.removeEventListener("touchend",this.onTouchend)}};__decorate$c([t({value:!1,type:Boolean,reflect:!0})],x.prototype,"pressed",void 0),__decorate$c([t({value:"horizontal",type:String,reflect:!0})],x.prototype,"orientation",void 0),__decorate$c([e(Number)],x.prototype,"index",void 0),x=__decorate$c([o],x);const ioDivider=function(t){return x.vConstructor(t)};var __decorate$b=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let w=class Tab extends i{constructor(t){t.label=t.label??t.id,super(t)}toJSON(){return{id:this.id,label:this.label,icon:this.icon,selected:this.selected}}fromJSON(t){return this.setProperties({id:t.id,label:t.label??t.id,icon:t.icon??"",selected:t.selected??!1}),this}};__decorate$b([t({type:String,value:""})],w.prototype,"id",void 0),__decorate$b([t({type:String,value:""})],w.prototype,"label",void 0),__decorate$b([t({type:String,value:""})],w.prototype,"icon",void 0),__decorate$b([t({type:Boolean,value:!1})],w.prototype,"selected",void 0),w=__decorate$b([o],w);var __decorate$a=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let P=class IoTabDropMarker extends n{static get Style(){return'\n      :host {\n        position: fixed;\n        height: calc(var(--io_fieldHeight) - var(--io_borderWidth) - var(--io_borderRadius));\n        width: var(--io_spacing);\n        background-color: var(--io_bgColorBlue);\n        margin-bottom: var(--io_borderWidth);\n        z-index: 100000;\n        display: none;\n      }\n      :host:not([dropindex="-1"]) {\n        display: block;\n      }\n      :host:not([splitdirection="none"]) {\n        display: block;\n        opacity: 0.25;\n      }\n    '}constructor(t={}){super(t)}changed(){if(this.dropTarget&&-1!==this.dropIndex){const t=this.dropTarget.querySelectorAll("io-tab");if(this.style.width="",this.style.height="",0===t.length){const t=this.dropTarget.getBoundingClientRect();this.style.top=`${t.top+r.borderRadius}px`,this.style.left=`${t.left}px`}else if(this.dropIndex>t.length-1){const e=t[t.length-1].getBoundingClientRect();this.style.top=`${e.top+r.borderRadius}px`,this.style.left=`${e.left+e.width}px`}else{const e=t[this.dropIndex].getBoundingClientRect();this.style.top=`${e.top+r.borderRadius}px`,this.style.left=e.left-r.spacing+"px"}}else if(this.dropTarget&&"none"!==this.splitDirection){const t=this.dropTarget.getBoundingClientRect();"top"===this.splitDirection?(this.style.top=`${t.top}px`,this.style.left=`${t.left}px`,this.style.width=`${t.width}px`,this.style.height=t.height/2+"px"):"bottom"===this.splitDirection?(this.style.top=`${t.top+t.height/2}px`,this.style.left=`${t.left}px`,this.style.width=`${t.width}px`,this.style.height=t.height/2+"px"):"left"===this.splitDirection?(this.style.top=`${t.top}px`,this.style.left=`${t.left}px`,this.style.width=t.width/2+"px",this.style.height=`${t.height}px`):"right"===this.splitDirection?(this.style.top=`${t.top}px`,this.style.left=`${t.left+t.width/2}px`,this.style.width=t.width/2+"px",this.style.height=`${t.height}px`):"center"===this.splitDirection&&(this.style.top=`${t.top}px`,this.style.left=`${t.left}px`,this.style.width=`${t.width}px`,this.style.height=`${t.height}px`)}}};__decorate$a([t(null)],P.prototype,"dropTarget",void 0),__decorate$a([t({type:String,value:"none",reflect:!0})],P.prototype,"splitDirection",void 0),__decorate$a([t({type:Number,value:-1,reflect:!0})],P.prototype,"dropIndex",void 0),P=__decorate$a([o],P);const T=new P;setTimeout((()=>{document.body.appendChild(T)}),100);var __decorate$9=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let O=class IoTabDragIcon extends b{static get Style(){return"\n      :host {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        transform: translate(-50%, -50%);\n        z-index: 100000;\n        pointer-events: none;\n        border-color: var(--io_borderColorLight);\n        background-color: var(--io_bgColorLight) !important;\n        opacity: 0.75;\n      }\n      :host[dragging] {\n        display: flex;\n      }\n      :host > * {\n        display: inline-block;\n        white-space: nowrap;\n        padding: 0 var(--io_spacing);\n      }\n      :host > .label {}\n    "}constructor(t={}){super(t)}changed(){T.setProperties({dropTarget:this.dropTarget,splitDirection:this.splitDirection,dropIndex:this.dropIndex}),this.render([y({value:this.tab?.icon||" "}),s({class:"label"},this.tab?.label||"")])}};__decorate$9([t({type:Boolean,reflect:!0})],O.prototype,"dragging",void 0),__decorate$9([t(null)],O.prototype,"tab",void 0),__decorate$9([t(null)],O.prototype,"dropSource",void 0),__decorate$9([t(null)],O.prototype,"dropTarget",void 0),__decorate$9([t({type:String,value:"none",reflect:!0})],O.prototype,"splitDirection",void 0),__decorate$9([t({type:Number,value:-1})],O.prototype,"dropIndex",void 0),__decorate$9([e(-1)],O.prototype,"tabIndex",void 0),O=__decorate$9([o],O);const D=new O;document.body.appendChild(D);var __decorate$8=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};const S=[];for(const t of Object.keys(m))for(const e of Object.keys(m[t])){const o=`${t}:${e}`;S.push({value:o,label:e,icon:o})}const _=p({label:"Select",option:new d({id:"iconselect",options:S})});let R=0,M=0,C=class IoTab extends b{static get Style(){return"\n      :host {\n        display: flex;\n        position: relative;\n        height: inherit;\n        min-height: inherit;\n        /* TODO: use vars for this */\n        min-width: calc(var(--io_fieldHeight) * 1.25);\n        margin: 0;\n        margin-right: var(--io_spacing);\n        background-color: var(--io_bgColor) !important;\n        border-bottom-left-radius: 0;\n        border-bottom-right-radius: 0;\n        border-color: var(--io_borderColorLight);\n        padding-right: var(--io_lineHeight);\n      }\n      :host[pressed] {\n        border-color: unset !important;\n        box-shadow: unset !important;\n      }\n      :host[selected] {\n        color: var(--io_colorStrong);\n        background-color: var(--io_bgColorLight) !important;\n        border-color: var(--io_borderColorStrong);\n        border-bottom-color: var(--io_bgColorLight);\n        z-index: 1;\n      }\n      :host[overflow]:not([selected]) > .io-close-icon {\n        display: none;\n      }\n      :host[selected]:focus {\n        color: var(--io_colorWhite);\n        z-index: 2;\n      }\n      :host > .io-icon:not([value=' ']) {\n        margin: 0 var(--io_spacing2) 0 0;\n      }\n      :host > .marker {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 100%;\n        background-color: var(--io_bgColorBlue);\n        border-bottom-right-radius: var(--io_borderRadius);\n      }\n      :host > span {\n        padding: 0 var(--io_spacing);\n        overflow: hidden; \n        text-overflow: ellipsis !important;\n      }\n      :host > * {\n        pointer-events: none;\n        display: inline-block;\n        white-space: nowrap;\n      }\n      :host:not(:hover) > .io-close-icon {\n        opacity: 0;\n        transform: scale(0.2);\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host:hover > .io-close-icon {\n        opacity: 1;\n        transform: scale(0.4);\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host > .io-close-icon {\n        position: absolute;\n        right: var(--io_spacing);\n        top: var(--io_spacing);\n        pointer-events: inherit;\n        background: linear-gradient(to right, transparent 0%, var(--io_bgColor) 25%);\n      }\n      :host[selected] > .io-close-icon {\n        background: linear-gradient(to right, transparent 0%, var(--io_bgColorLight) 25%);\n      }\n      :host > .io-close-icon:hover {\n        transform: scale(0.5);\n        fill: var(--io_colorStrong);\n        stroke: var(--io_colorStrong);\n      }\n    "}static get Listeners(){return{click:"preventDefault",contextmenu:"preventDefault"}}constructor(t){super(t)}onResized(){const t=this.querySelector("span");this.overflow=t.scrollWidth>t.clientWidth}onTouchmove(t){t.preventDefault()}preventDefault(t){t.stopPropagation(),t.preventDefault()}onPointerdown(t){t.preventDefault(),t.stopPropagation(),this.setPointerCapture(t.pointerId),R=t.clientX,M=t.clientY,super.onPointerdown(t),2===t.buttons?this.expandContextEditor():this.focus()}onPointermove(t){if(t.preventDefault(),1!==t.buttons)return;const e=this.parentElement.parentElement;if(!D.dragging){const o=Math.abs(R-t.clientX),n=Math.abs(M-t.clientY);return void((o>10||n>10)&&(D.setProperties({tab:this.tab,dragging:!0,dropSource:e,dropTarget:null,dropIndex:-1}),D.style.top=t.clientY+"px",D.style.left=t.clientX+"px"))}D.style.top=t.clientY+"px",D.style.left=t.clientX+"px";const o=t.clientX,n=t.clientY,i=r.spacing,s=document.querySelectorAll("io-tabs");for(let t=0;t<s.length;t++){const e=s[t],r=e.parentElement,l=e.getBoundingClientRect();if(n>=l.top&&n<=l.bottom&&o>=l.left&&o<=l.right){const t=e.querySelectorAll("io-tab");if(0===t.length)return void D.setProperties({dropTarget:r,splitDirection:"none",dropIndex:0});for(let e=0;e<t.length;e++){const s=t[e].getBoundingClientRect(),a=e===t.length-1;if(n>=s.top-i&&n<=s.bottom+i&&o>=s.left-i&&(o<=s.right+i||a&&o<=l.right)){const t="left"===(o<s.left+s.width/2?"left":"right")?e:e+1;return void D.setProperties({dropTarget:r,splitDirection:"none",dropIndex:t})}}}}const l=document.querySelectorAll("io-panel");for(let t=0;t<l.length;t++){const e=l[t],i=e.getBoundingClientRect();if(n>=i.top&&n<=i.bottom&&o>=i.left&&o<=i.right){const t=(o-i.left-i.width/2)/i.width*2,r=(n-i.top-i.height/2)/i.height*2;let s="none";return Math.abs(t)<.5&&Math.abs(r)<.5?s="center":r>0&&Math.abs(r)>Math.abs(t)?s="bottom":r<0&&Math.abs(r)>Math.abs(t)?s="top":t>0&&Math.abs(t)>Math.abs(r)?s="right":t<0&&Math.abs(t)>Math.abs(r)&&(s="left"),void D.setProperties({dropTarget:e,splitDirection:s,dropIndex:-1})}}}onPointerup(t){if(t.preventDefault(),super.onPointerup(t),this.releasePointerCapture(t.pointerId),D.dragging){const t=D.dropSource,e=D.dropTarget,o=D.dropIndex,n=D.splitDirection;e&&-1!==o?(t&&t!==e&&t.removeTab(this.tab),e.addTab(this.tab,o)):t&&e&&"none"!==n&&e.moveTabToSplit(t,this.tab,n),D.setProperties({dragging:!1,dropSource:null,dropTarget:null,splitDirection:"none",dropIndex:-1})}else this.onClick()}onPointercancel(t){t.preventDefault(),t.stopPropagation(),super.onPointercancel(t),D.setProperties({dragging:!1,dropSource:null,dropTarget:null,splitDirection:"none",dropIndex:-1})}onPointerleave(t){t.preventDefault(),t.stopPropagation()}onClick(){this.dispatch("io-edit-tab",{tab:this.tab,key:"Select"},!0)}onDeleteClick(){this.dispatch("io-edit-tab",{tab:this.tab,key:"Backspace"},!0)}expandContextEditor(){v.expand({source:this,direction:"down",value:this.tab,properties:["id","label","icon"],orientation:"horizontal",config:new Map([[Object,[["id",f({inert:!0})],["label",g({live:!0})],["icon",_]]]])})}onKeydown(t){t.shiftKey&&["Backspace","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(t.key)?(t.preventDefault(),this.dispatch("io-edit-tab",{tab:this.tab,key:t.key},!0)):t.shiftKey&&"Enter"===t.key?this.expandContextEditor():super.onKeydown(t)}tabMutated(){this.changed()}changed(){this.setAttribute("selected",this.tab.selected),this.render([this.tab.selected?s({class:"marker"}):null,y({class:"io-icon",value:this.tab.icon||" "}),s({class:"label"},this.tab.label),y({value:"io:close",size:"small",class:"io-close-icon","@click":this.onDeleteClick,"@pointerdown":this.preventDefault})])}};__decorate$8([t({type:w})],C.prototype,"tab",void 0),__decorate$8([t({type:Boolean,reflect:!0})],C.prototype,"overflow",void 0),C=__decorate$8([o],C);const ioTab=function(t){return C.vConstructor(t)};var __decorate$7=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let k=class IoTabsHamburgerMenu extends n{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        flex-direction: column;\n        border: var(--io_border);\n        border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n        border-color: var(--io_borderColorOutset);\n        background-color: var(--io_bgColorLight);\n        padding: calc(var(--io_spacing) + var(--io_borderWidth));\n        position: absolute;\n        overflow-y: auto;\n        box-shadow: 1px 1px 16px var(--io_shadowColor),\n                    1px 1px 8px var(--io_shadowColor), \n                    1px 1px 4px var(--io_shadowColor);\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host > io-tab {\n        border-color: transparent !important;\n        background-color: var(--io_bgColorLight) !important;\n        border-radius: var(--io_borderRadius) !important;\n      }\n      :host > io-tab[selected] {\n        background-color: var(--io_bgColor) !important;\n      }\n      :host > io-tab > .marker {\n        border-radius: 0;\n      }\n    "}static get Listeners(){return{touchstart:["stopPropagation",{passive:!1}],"io-focus-to":"onIoFocusTo","io-edit-tab":"onEditTabCapture"}}constructor(t={}){super(t)}stopPropagation(t){t.stopPropagation()}onIoFocusTo(t){const e=t.detail.source,o=t.detail.command,n=Array.from(this.querySelectorAll("io-tab")),i=n.indexOf(e);let r="";"ArrowDown"===o&&(r="Next"),"ArrowUp"===o&&(r="Prev"),"ArrowLeft"===o&&(r="First"),"ArrowRight"===o&&(r="Last"),r&&("Next"===r?n[(i+1)%n.length].focus():"Prev"===r?n[(i-1+n.length)%n.length].focus():"First"===r?n[0].focus():"Last"===r&&n[n.length-1].focus(),t.stopPropagation())}onEditTabCapture(t){t.stopPropagation(),this.onEditTab(t),this.expanded=!1}expand(t){this.setProperties({tabs:t.tabs,expanded:!0}),this.onEditTab=t.onEditTab,c(this,t.source,t.direction),this.debounce(this.onExpand)}onExpand(){this.querySelector("[selected]")?.focus()}changed(){this.render([...this.tabs.map((t=>ioTab({tab:t})))])}};__decorate$7([t({type:l,init:"this"})],k.prototype,"tabs",void 0),__decorate$7([t({type:Boolean,reflect:!0})],k.prototype,"expanded",void 0),k=__decorate$7([o],k);const j=new k;setTimeout((()=>{a.appendChild(j)}),100);var __decorate$6=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let E=class IoTabsHamburger extends b{static get Style(){return"\n      :host {\n        display: flex;\n        flex-shrink: 0;\n      }\n    "}constructor(t){super(t)}onClick(){j.expand({source:this,direction:"over",tabs:this.tabs,onEditTab:this.onEditTab})}onEditTab(t){this.dispatch("io-edit-tab",{tab:t.detail.tab,key:t.detail.key},!0)}changed(){this.render([y({value:"io:hamburger"})])}};__decorate$6([t({type:l,init:"this"})],E.prototype,"tabs",void 0),E=__decorate$6([o],E);const ioTabsHamburger=function(t){return E.vConstructor(t)};var __decorate$5=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let I=class IoTabs extends n{static get Style(){return'\n      :host {\n        display: flex;\n        background-color: var(--io_bgColorStrong);\n        padding-top: var(--io_spacing);\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n      }\n      :host io-tab {\n        transition: opacity 2s cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      :host:not([overflow="-1"]) io-tab {\n        /* TODO: make niceer animations */\n        pointer-events: none;\n        opacity: 0;\n      }\n      :host[overflow="-1"] io-tabs-hamburger {\n        /* TODO: make niceer animations */\n        display: none;\n      }\n      :host > io-tabs-hamburger {\n        margin-bottom: var(--io_spacing);\n        /* transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1); */\n      }\n      :host > io-menu-item {\n        margin-left: auto;\n        flex-shrink: 0;\n        opacity: 0.125;\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host > io-menu-item:focus,\n      :host > io-menu-item:hover {\n        opacity: 1;\n      }\n      :host > io-menu-item > .label,\n      :host > io-menu-item > .icon,\n      :host > io-menu-item > .hasmore {\n        display: none;\n      }\n    '}constructor(t){super(t)}tabsMutated(){this.changed(),this.overflow=-1,this.onResized()}onResized(){const t=this.getBoundingClientRect(),e=this.querySelector(".add-tab").getBoundingClientRect();-1===this.overflow?e.right>t.right&&(this.overflow=t.width):t.width>this.overflow+32&&(this.overflow=-1)}changed(){this.render([ioTabsHamburger({tabs:this.tabs}),...this.tabs.map((t=>ioTab({tab:t}))),h({class:"add-tab",icon:"io:box_fill_plus",direction:"down",option:this.addMenuOption})])}};__decorate$5([t({type:l,init:"this"})],I.prototype,"tabs",void 0),__decorate$5([t({type:Number,value:-1,reflect:!0})],I.prototype,"overflow",void 0),__decorate$5([e({type:d})],I.prototype,"addMenuOption",void 0),I=__decorate$5([o],I);const ioTabs=function(t){return I.vConstructor(t)};var __decorate$4=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let L=class IoPanel extends n{static get Style(){return"\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: column;\n        flex: 1 1 auto;\n        background-color: var(--io_bgColorLight);\n      }\n      :host > io-selector {\n        margin-top: calc(-1 * var(--io_borderWidth));\n        border-top: var(--io_border);\n        border-top-color: var(--io_borderColorStrong);\n      }\n    "}static get Listeners(){return{"io-edit-tab":"onEditTab"}}onEditTab(t){t.stopPropagation();const e=t.detail.tab,o=t.detail.key,n=this.panel.tabs.indexOf(e);if(-1!==n)switch(o){case"Select":this.selectTab(e);break;case"Backspace":this.removeTab(e);break;case"ArrowLeft":this.moveTab(e,n-1);break;case"ArrowRight":this.moveTab(e,n+1)}}init(){this.focusTabDebounced=this.focusTabDebounced.bind(this)}onNewTabClicked(t){t.stopPropagation();const e=t.detail.option;if(e.id&&0===e.options.length){const t=new w({id:e.id,label:e.label,icon:e.icon});this.addTab(t);const o=this.querySelector(".add-tab");o&&(o.expanded=!1)}}selectIndex(t){t=Math.min(t,this.panel.tabs.length-1),this.panel.setSelected(this.panel.tabs[t].id),this.debounce(this.focusTabDebounced,t)}selectTab(t){const e=this.panel.tabs.indexOf(t);this.panel.setSelected(t.id),this.debounce(this.focusTabDebounced,e)}moveTabToSplit(t,e,o){const n=this.parentElement;"center"===o?(t.removeTab(e),this.addTab(e)):n.moveTabToSplit(t,this.panel,e,o)}addTab(t,e){const o=this.panel.tabs.findIndex((e=>e.id===t.id));-1!==o&&this.panel.tabs.splice(o,1),e=e??this.panel.tabs.length,e=Math.min(e,this.panel.tabs.length),this.panel.tabs.splice(e,0,t),this.selectIndex(e)}removeTab(t){const e=this.parentElement;if((e.parentElement instanceof N?e.parentElement:null)&&1===e.split.children.length&&1===this.panel.tabs.length)return;const o=this.panel.tabs.indexOf(t);if(this.panel.tabs.splice(o,1),this.panel.tabs.length>0){const t=Math.min(o,this.panel.tabs.length-1);this.selectIndex(t)}else this.dispatch("io-panel-remove",{panel:this.panel},!0)}moveTab(t,e){e=Math.max(Math.min(e,this.panel.tabs.length-1),0);const o=this.panel.tabs.findIndex((e=>e.id===t.id));this.panel.tabs.splice(o,1),e=Math.min(e,this.panel.tabs.length),this.panel.tabs.splice(e,0,t),this.selectIndex(e)}focusTabDebounced(t){const e=Array.from(this.querySelectorAll("io-tab"));e[t=Math.min(t,e.length-1)]&&e[t].focus()}panelMutated(){this.changed()}changed(){this.render([ioTabs({tabs:this.panel.tabs,addMenuOption:this.addMenuOption,"@io-menu-option-clicked":this.onNewTabClicked}),u({selected:this.panel.getSelected(),elements:this.elements,anchor:""})])}};__decorate$4([t({type:Object})],L.prototype,"panel",void 0),__decorate$4([t(Array)],L.prototype,"elements",void 0),__decorate$4([e(d)],L.prototype,"addMenuOption",void 0),L=__decorate$4([o],L);const ioPanel=function(t){return L.vConstructor(t)};var __decorate$3=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let $=class Panel extends i{constructor(t){(t={...t}).tabs.length>0&&!t.tabs.find((t=>t.selected))&&(t.tabs[0].selected=!0),t.tabs=t.tabs.map((t=>new w({...t}))),super(t)}tabsMutated(){this.debounce(this.onTabsMutatedDebounced)}onTabsMutatedDebounced(){this.dispatchMutation()}getSelected(){let t="";for(let e=0;e<this.tabs.length;e++){const o=this.tabs[e];if(o.selected&&o.id){t=o.id;break}}return t}setSelected(t){this.tabs.withInternalOperation((()=>{for(let e=0;e<this.tabs.length;e++){const o=this.tabs[e];o.id===t?o.selected=!0:o.selected=!1}})),this.tabs.dispatchMutation()}toJSON(){return{tabs:this.tabs.map((t=>t.toJSON())),flex:this.flex}}fromJSON(t){return this.setProperties({tabs:t.tabs.map((t=>new w(t))),flex:t.flex??"1 1 100%"}),this}dispose(){this.tabs.length=0,super.dispose()}};__decorate$3([t({type:l,init:"this"})],$.prototype,"tabs",void 0),__decorate$3([t({type:String,value:"1 1 100%"})],$.prototype,"flex",void 0),$=__decorate$3([o],$);var z,__decorate$2=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let A=z=class Split extends i{constructor(t){t={...t};for(let e=0;e<t.children.length;e++){const o=t.children[e],n=t.children[e];o.tabs?t.children[e]=new $(o):n.children&&(t.children[e]=new z(n))}super(t)}childrenMutated(){this.debounce(this.onChildrenMutatedDebounced)}onChildrenMutatedDebounced(){this.dispatchMutation()}toJSON(){return{children:this.children.map((t=>t.toJSON())),orientation:this.orientation,flex:this.flex}}fromJSON(t){return this.setProperties({children:t.children.map((t=>{const e=t,o=t;return e.tabs?new $(e):o.children?new z(o):void 0})),orientation:t.orientation??"horizontal",flex:t.flex??"1 1 100%"}),this}dispose(){this.children.length=0,super.dispose()}};__decorate$2([t({type:l,init:"this"})],A.prototype,"children",void 0),__decorate$2([t({type:String,value:"horizontal"})],A.prototype,"orientation",void 0),__decorate$2([t({type:String,value:"1 1 100%"})],A.prototype,"flex",void 0),A=z=__decorate$2([o],A);var __decorate$1=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let B=class IoSplit extends n{static get Style(){return"\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: row;\n      }\n      :host[orientation='vertical'] {\n        flex-direction: column;\n      }\n    "}static get Listeners(){return{"io-divider-move":"onDividerMove","io-divider-move-end":"onDividerMoveEnd","io-panel-remove":"onPanelRemove","io-split-remove":"onSplitRemove","io-split-convert-to-panel":"onSplitConvertToPanel"}}constructor(t){super(t),this.splitMutatedDebounced=this.splitMutatedDebounced.bind(this)}onDividerMove(t){t.stopPropagation();const e=t.detail.index,o=this.getBoundingClientRect(),n=this.split.orientation,i=r.spacing3,s=("horizontal"===n?o.width:o.height)-i*(this.children.length-1)/2,l="horizontal"===n?4*r.fieldHeight:r.fieldHeight,a=[],c=[],p=[];for(let e=0;e<this.children.length;e+=2){const r=this.children[e],s=r.getBoundingClientRect(),l="horizontal"===n?s.width:s.height;let d=t.detail.clientX-s.left-i/2,h=t.detail.clientY-s.top-i/2;e===this.children.length-1&&(d=o.width-(t.detail.clientX-o.left)-i/2,h=o.height-(t.detail.clientY-o.top)-i/2);let u="horizontal"===n?d:h;a.push(r),c.push(l),p.push(u)}let d=0,h=0,u=0,b=0,f=0;for(let t=0;t<a.length;t++){let o=e;o===a.length-2&&(o=a.length-1),a[t].style.flex.endsWith("%")?(u+=c[t],t<o?b++:t>o&&f++):t<o?d+=c[t]:t>o&&(h+=c[t])}if(0===e){const t=s-l*f-h,o=Math.max(l,Math.min(t,p[0]));a[e].style.flex=`0 0 ${o}px`;for(let t=0;t<a.length;t++)a[t].style.flex.endsWith("%")&&t!==e&&(a[t].style.flex=`1 1 ${Math.max(l,c[t])/u*100}%`)}else if(e===a.length-2){const t=s-l*b-d,o=Math.max(l,Math.min(t,p[e+1]));a[e+1].style.flex=`0 0 ${o}px`;for(let t=0;t<a.length;t++)a[t].style.flex.endsWith("%")&&t!==e+1&&(a[t].style.flex=`1 1 ${Math.max(l,c[t])/u*100}%`)}else{const t=c[e]+c[e+1]-l,o=Math.max(l,Math.min(t,p[e])),n=c[e+1]-(o-c[e]);for(let t=0;t<a.length;t++)a[t].style.flex.endsWith("%")&&(a[t].style.flex=t===e?`1 1 ${o/u*100}%`:t===e+1?`1 1 ${n/u*100}%`:`1 1 ${Math.max(l,c[t])/u*100}%`)}}onDividerMoveEnd(t){t.stopPropagation();let e=0;for(let t=0;t<this.children.length;t+=2){const o=this.children[t];this.split.children[e].flex=o.style.flex,e++}}onPanelRemove(t){if(t.detail.panel!==this.split){t.stopPropagation();for(let t=this.split.children.length;t--;){const e=this.split.children[t];e instanceof $&&0===e.tabs.length&&this.split.children.splice(t,1)}0===this.split.children.length?this.dispatch("io-split-remove",{split:this.split},!0):1===this.split.children.length&&this.dispatch("io-split-convert-to-panel",{split:this.split},!0)}}onSplitRemove(t){if(t.detail.split===this.split)return;t.stopPropagation();const e=this.split.children.indexOf(t.detail.split);this.split.children.splice(e,1),2===this.split.children.length&&(this.split.children[1].flex="1 1 100%")}onSplitConvertToPanel(t){t.detail.split!==this.split&&(t.stopPropagation(),this.convertToPanel(t.detail.split))}convertToSplit(t,e,o,n){const i=this.split.children.indexOf(t);this.split.children.splice(i,1,new A({orientation:n,children:[e,o]}))}convertToPanel(t){const e=t.children[0],o=this.split.children.indexOf(t);e.flex="1 1 100%",this.split.children.splice(o,1,e)}moveTabToSplit(t,e,o,n){const i=this.split.children.indexOf(e);let r="horizontal";"top"!==n&&"bottom"!==n||(r="vertical");let s=["left","top"].includes(n)?i-1:i+1;this.split.orientation===r?(s=Math.max(0,s),this.split.children.splice(s,0,new $({tabs:[o]})),t.removeTab(o)):(e.tabs.length>1||e!==t.panel)&&(t.removeTab(o),-1===s?this.convertToSplit(e,new $({tabs:[o]}),e,r):this.convertToSplit(e,e,new $({tabs:[o]}),r))}splitMutated(){this.debounce(this.splitMutatedDebounced)}splitMutatedDebounced(){this.changed()}changed(){this.setAttribute("orientation",this.split.orientation),this.style.flex=this.split.flex;const t=[];for(let e=0;e<this.split.children.length;e++){const o=this.split.children[e];o instanceof A?t.push(ioSplit({split:o,style:{flex:o.flex},elements:this.elements,addMenuOption:this.addMenuOption})):o instanceof $&&t.push(ioPanel({panel:o,style:{flex:o.flex},elements:this.elements,addMenuOption:this.addMenuOption})),e<this.split.children.length-1&&t.push(ioDivider({orientation:this.split.orientation,index:e}))}this.render(t)}};__decorate$1([t({type:Object})],B.prototype,"split",void 0),__decorate$1([t(Array)],B.prototype,"elements",void 0),__decorate$1([e({type:d})],B.prototype,"addMenuOption",void 0),B=__decorate$1([o],B);const ioSplit=function(t){return B.vConstructor(t)};var __decorate=function(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let N=class IoLayout extends n{static get Style(){return"\n      :host {\n        position: relative;\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n      }\n      :host > io-split {\n        max-width: 100%;\n        max-height: 100%;\n      }\n    "}changed(){this.render([ioSplit({split:this.split,elements:this.elements,addMenuOption:this.addMenuOption})])}};__decorate([t({type:Object})],N.prototype,"split",void 0),__decorate([t(Array)],N.prototype,"elements",void 0),__decorate([e({type:d})],N.prototype,"addMenuOption",void 0),N=__decorate([o],N);const ioLayout=function(t){return N.vConstructor(t)};export{x as IoDivider,N as IoLayout,L as IoPanel,B as IoSplit,C as IoTab,I as IoTabs,E as IoTabsHamburger,j as IoTabsHamburgerMenuSingleton,$ as Panel,A as Split,w as Tab,ioDivider,ioLayout,ioPanel,ioSplit,ioTab,ioTabs,ioTabsHamburger,D as tabDragIconSingleton,T as tabDropMarkerSingleton};
