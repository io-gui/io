{"version":3,"file":"IoNavigator.js","sourceRoot":"","sources":["../../src/elements/IoNavigator.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoElement, VDOMElement, ReactiveProperty, IoElementProps, WithBinding, Register, div } from '@io-gui/core'\nimport { MenuOption, ioMenuOptions, ioMenuTree } from '@io-gui/menus'\nimport { CachingType, ioSelector } from './IoSelector.js'\nimport { ioNavigatorDrawer, IoNavigatorDrawer } from './IoNavigatorDrawer.js'\n\nexport type SelectType = 'shallow' | 'deep' | 'all' | 'none'\n\nexport type MenuPosition = 'top' | 'left'\n\nexport type IoNavigatorProps = IoElementProps & {\n  option?: MenuOption\n  elements?: VDOMElement[]\n  widget?: VDOMElement\n  menu?: MenuPosition\n  depth?: number\n  select?: SelectType\n  caching?: CachingType\n  anchor?: WithBinding<string>\n  minWidth?: number\n}\n\n@Register\nexport class IoNavigator extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n        position: relative;\n        overflow: hidden;\n        flex-direction: row-reverse;\n      }\n      :host[menu='top'] {\n        flex-direction: column-reverse;\n      }\n      :host > io-menu-tree {\n        align-self: stretch;\n        flex: 0 0 auto;\n        min-width: 10em;\n        border: var(--io_border);\n        overflow-y: auto;\n        border-radius: 0;\n      }\n      :host > io-menu-tree {\n        border-width: 0 var(--io_borderWidth) 0 0;\n      }\n      :host > io-menu-options {\n        border: none;\n        border-bottom: var(--io_border);\n        border-radius: 0;\n      }\n      :host > .io-veil {\n        position: absolute;\n        opacity: 0;\n        transition: opacity 0.125s ease-out;\n        background-color: rgba(0, 0, 0, 1);\n        pointer-events: none;\n        inset: 0;\n      }\n      :host[showveil] > .io-veil {\n        display: block;\n        opacity: 0.5;\n        pointer-events: auto;\n        cursor: pointer;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Array, init: null})\n  declare elements: VDOMElement[]\n\n  @ReactiveProperty({type: MenuOption})\n  declare option: MenuOption\n\n  @ReactiveProperty(null)\n  declare widget: VDOMElement | null\n\n  @ReactiveProperty({value: 'left', type: String, reflect: true})\n  declare menu: MenuPosition\n\n  @ReactiveProperty({value: Infinity, type: Number})\n  declare depth: number\n\n  @ReactiveProperty({value: 'shallow', type: String})\n  declare select: SelectType\n\n  @ReactiveProperty({value: 'none', type: String})\n  declare caching: CachingType\n\n  @ReactiveProperty({value: 570, type: Number})\n  declare minWidth: number\n\n  @ReactiveProperty({value: '', type: String})\n  declare anchor: string\n\n  @ReactiveProperty({value: false, type: Boolean, reflect: true})\n  declare collapsed: boolean\n\n  @ReactiveProperty({value: false, type: Boolean, reflect: true})\n  declare showVeil: boolean\n\n  static get Listeners() {\n    return {\n      'io-drawer-expanded-changed': 'onDrawerExpandedChanged',\n    }\n  }\n\n  onResized() {\n    this.debounce(this.calculateCollapsedDebounced)\n  }\n\n  calculateCollapsedDebounced() {\n    this.calculateCollapsed()\n  }\n\n  calculateCollapsed() {\n    if (this.menu === 'top') {\n      this.collapsed = false\n      return\n    }\n\n    const rect = this.getBoundingClientRect()\n    if (rect.width === 0 && rect.height === 0) return\n\n    this.collapsed = rect.width < this.minWidth\n  }\n\n  onDrawerExpandedChanged(event: CustomEvent) {\n    event.stopPropagation()\n    const srcDrawer = event.detail.element as IoNavigatorDrawer\n    this.showVeil = srcDrawer.expanded\n  }\n\n  collapseDrawer() {\n    const drawer = this.querySelector('io-navigator-drawer') as IoNavigatorDrawer\n    if (drawer) drawer.expanded = false\n  }\n\n  onVeilClick(event: MouseEvent) {\n    event.stopPropagation()\n    this.collapseDrawer()\n  }\n\n  collapsedChanged() {\n    this.collapseDrawer()\n  }\n\n  menuChanged() {\n    this.calculateCollapsed()\n  }\n\n  optionMutated() {\n    this.changed()\n  }\n\n  changed() {\n    const sharedMenuConfig = {\n      option: this.option,\n      widget: this.widget,\n      depth: this.depth\n    }\n\n    let selected = ''\n    if (this.select === 'shallow') selected = this.option.selectedIDImmediate\n    if (this.select === 'deep') selected = this.option.selectedID\n    if (this.select === 'all') selected = '*'\n    if (this.select === 'none') selected = ''\n\n    const selectorElement = ioSelector({selected: selected, anchor: this.bind('anchor'), caching: this.caching, elements: this.elements})\n    const veil = div({class: 'io-veil', '@click': this.onVeilClick})\n\n    if (this.menu === 'top') {\n      this.render([\n        selectorElement,\n        ioMenuOptions({horizontal: true, ...sharedMenuConfig}),\n      ])\n    } else if (this.menu === 'left') {\n      if (this.collapsed) {\n        this.render([\n          selectorElement,\n          veil,\n          ioNavigatorDrawer({\n            direction: 'left',\n            menuContent: ioMenuTree({...sharedMenuConfig}),\n          }),\n        ])\n      } else {\n        this.render([\n          selectorElement,\n          ioMenuTree({...sharedMenuConfig}),\n        ])\n      }\n    }\n  }\n}\n\nexport const ioNavigator = function(arg0?: IoNavigatorProps) {\n  return IoNavigator.vConstructor(arg0)\n}"]}