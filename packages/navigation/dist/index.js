import{ReactiveProperty,Property,IoElement,clearFocusBacktrack,div,Register,span,disposeChildren,ThemeSingleton}from"@io-gui/core";import{ioBoolean}from"@io-gui/inputs";import{ioIcon}from"@io-gui/icons";import{MenuOption,ioMenuOptions,ioMenuTree}from"@io-gui/menus";var __defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$3(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$3(target,key,result),result};let IoCollapsible=class extends IoElement{static get Style(){return'\n    :host {\n      display: flex;\n      flex-direction: column;\n      flex-shrink: 0;\n      align-self: stretch;\n      box-sizing: content-box;\n      align-items: stretch;\n      align-self: stretch;\n      border: var(--io_border);\n      border-radius: calc(var(--io_borderRadius) - var(--io_spacing));\n      border-color: var(--io_borderColorOutset);\n      min-height: var(--io_fieldHeight);\n      background-color: var(--io_bgColorLight);\n    }\n    :host > io-boolean {\n      flex: 0 0 auto;\n      padding-left: 0;\n      margin: var(--io_spacing) var(--io_spacing2);\n      border-radius: 0;\n      background-color: transparent;\n    }\n    :host > io-boolean:before {\n      text-align: center;\n      width: var(--io_lineHeight);\n      margin-right: var(--io_spacing2);\n      content: "▸"\n    }\n    :host > io-boolean[value]:before {\n      content: "▾"\n    }\n    :host > div.io-collapsible-content {\n      position: relative;\n      display: flex;\n      align-items: flex-start;\n      flex-direction: column;\n      overflow: auto;\n      background-color: var(--io_bgColorStrong);\n    }\n    :host[direction=row] > div.io-collapsible-content {\n      flex-direction: row;\n    }\n    :host > div.io-collapsible-content:not(:empty) {\n      margin: var(--io_spacing);\n      margin-top: 0;\n      padding: var(--io_spacing);\n      border-radius: var(--io_borderRadius);\n    }\n    '}expandedChanged(){clearFocusBacktrack()}changed(){this.render([ioBoolean({icon:this.icon,true:this.label,false:this.label,value:this.bind("expanded")}),div({class:"io-collapsible-content"},this.expanded?this.elements:[])])}};__decorateClass$3([ReactiveProperty({type:Array,init:null})],IoCollapsible.prototype,"elements",2),__decorateClass$3([ReactiveProperty({value:"",type:String})],IoCollapsible.prototype,"label",2),__decorateClass$3([ReactiveProperty({value:"column",reflect:!0})],IoCollapsible.prototype,"direction",2),__decorateClass$3([ReactiveProperty({value:"",type:String})],IoCollapsible.prototype,"icon",2),__decorateClass$3([ReactiveProperty({value:!1,reflect:!0})],IoCollapsible.prototype,"expanded",2),__decorateClass$3([Property("region")],IoCollapsible.prototype,"role",2),IoCollapsible=__decorateClass$3([Register],IoCollapsible);const ioCollapsible=function(arg0){return IoCollapsible.vConstructor(arg0)};var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$2(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$2(target,key,result),result};const dummyElement=document.createElement("div"),IMPORTED_PATHS={};function importModule(path){const importPath=new URL(path,String(window.location)).pathname;return new Promise(resolve=>{!path||IMPORTED_PATHS[importPath]?resolve(importPath):import(importPath).then(()=>{IMPORTED_PATHS[importPath]=!0,resolve(importPath)})})}let IoSelector=class extends IoElement{static get Style(){return"\n      :host {\n        display: flex;\n        flex-direction: column;\n        position: relative;\n        overflow-y: auto !important;\n        flex: 1 1 auto;\n        justify-content: stretch;\n      }\n      @keyframes io-loading-spinner {\n        to {\n          transform: rotate(360deg);\n        }\n      }\n      :host[loading]:after {\n        content: '';\n        box-sizing: border-box;\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        width: 4em;\n        height: 4em;\n        margin-top: calc(-1 * var(--io_fieldHeight));\n        margin-left: calc(-1 * var(--io_fieldHeight));\n        border-radius: 50%;\n        border: var(--io_border);\n        border-color: var(--io_borderColorStrong);\n        border-top-color: var(--io_colorBlue);\n        animation: io-loading-spinner .6s linear infinite;\n      }\n    "}static get Listeners(){return{scroll:"onScrollChanged"}}constructor(args={}){super(args)}init(){this.preacheNext=this.preacheNext.bind(this),this.startPreache=this.startPreache.bind(this),this.scrollToUnsuspend=this.scrollToUnsuspend.bind(this),this.onScrollUnsuspend=this.onScrollUnsuspend.bind(this)}anchorChanged(){this.scrollToSuspended||(this.onScrollSuspended=!0,this.debounce(this.onScrollUnsuspend,void 0,120)),this.debounce(this.anchorChangedDebounced,void 0,3)}anchorChangedDebounced(){const anchor=this.anchor.split("#")[1]||this.anchor;if(!anchor||this.scrollToSuspended)return;const heading=this.querySelector(`[data-heading="${anchor}"]`);if(heading){const style=window.getComputedStyle(heading),top=heading.offsetTop-parseInt(style.marginTop);this.scrollTo({top:top,behavior:"smooth"})}else this.scrollTo(0,0)}scrollToUnsuspend(){this.scrollToSuspended=!1}onScrollUnsuspend(){this.onScrollSuspended=!1}onScrollChanged(){if(this.onScrollSuspended)return;const anchor=this.anchor.split("#")[1]||this.anchor,headings=this.querySelectorAll("[data-heading]"),closestHeading=Array.from(headings).reduce((prev,curr)=>Math.abs(curr.offsetTop-this.scrollTop)<Math.abs(prev.offsetTop-this.scrollTop)?curr:prev,headings[0]);if(closestHeading){const current=closestHeading.getAttribute("data-heading");current&&current!==anchor&&(this.scrollToSuspended=!0,2===this.anchor.split("#").length?this.anchor=this.anchor.split("#")[0]+"#"+current:this.anchor=current,this.debounce(this.scrollToUnsuspend,void 0,120))}}elementsChanged(){this.selectedChanged(),this.startPreache()}selectedChanged(){this.selected?"*"===this.selected?this.render(this.elements):this.renderSelectedId(this.selected):this.render([],this,!0),this.debounce(this.anchorChangedDebounced,void 0,2)}renderSelectedId(id){const cache="proactive"===this.caching||"reactive"===this.caching;if(!id)return this.render([],this,cache),void this.scrollTo(0,0);id=id.split("#")[0],this.render([],this,cache),this.scrollTo(0,0);const vElement=this.elements.find(element=>element.props?.id===id);if(!vElement)return console.warn(`IoSelector: Could not find elements with id: "${id}"!`),void this.render([span(`Could not find elements with id: "${id}"!`)],this,cache);const importPath=vElement.props?.import;importPath?(this.loading=!0,this._preaching=!1,importModule(importPath).then(()=>{this.loading=!1,this.debounce(this.renderDebounced,vElement),this.debounce(this.startPreache)})):this.debounce(this.renderDebounced,vElement)}renderDebounced(vElement){const cache="proactive"===this.caching||"reactive"===this.caching,id=vElement.props?.id,cachedElement=this._caches[id];cache&&cachedElement?cachedElement.parentElement!==this&&(this.firstChild&&this.removeChild(this.firstChild),this.appendChild(cachedElement)):(this.render([vElement],this,cache),cache&&(this._caches[id]=this.childNodes[0]))}startPreache(){"proactive"!==this.caching||this._preaching||(this._preaching=!0,this.debounce(this.preacheNext))}preacheNext(){if(this._preaching){for(let i=0;i<this.elements.length;i++){const vElement=this.elements[i],props=vElement.props,id=props.id;if(id&&void 0===this._caches[id])return props.import?void importModule(props.import).then(()=>{this._preaching&&(this.render([vElement],dummyElement,!0),this._caches[id]=dummyElement.childNodes[0],dummyElement.removeChild(dummyElement.childNodes[0]),this.debounce(this.preacheNext),delete props.import)}):(this.render([vElement],dummyElement,!0),this._caches[id]=dummyElement.childNodes[0],dummyElement.removeChild(dummyElement.childNodes[0]),void this.debounce(this.preacheNext))}this._preaching=!1}}dispose(){for(const key in this._caches)this._caches[key].parentElement||disposeChildren(this._caches[key]),delete this._caches[key];super.dispose()}};__decorateClass$2([ReactiveProperty({type:Array,init:null})],IoSelector.prototype,"elements",2),__decorateClass$2([ReactiveProperty({value:"",type:String})],IoSelector.prototype,"selected",2),__decorateClass$2([ReactiveProperty({value:"",type:String})],IoSelector.prototype,"anchor",2),__decorateClass$2([ReactiveProperty({value:"reactive",type:String})],IoSelector.prototype,"caching",2),__decorateClass$2([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoSelector.prototype,"loading",2),__decorateClass$2([Property(Object)],IoSelector.prototype,"_caches",2),__decorateClass$2([Property(!1)],IoSelector.prototype,"_preaching",2),__decorateClass$2([Property(!1)],IoSelector.prototype,"scrollToSuspended",2),__decorateClass$2([Property(!1)],IoSelector.prototype,"onScrollSuspended",2),IoSelector=__decorateClass$2([Register],IoSelector);const ioSelector=function(arg0){return IoSelector.vConstructor(arg0)};var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$1(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$1(target,key,result),result};let IoNavigatorDrawer=class extends IoElement{static get Style(){return'\n      :host {\n        pointer-events: auto;\n        position: relative;\n        top: 0;\n        bottom: 0;\n        width: var(--io_fieldHeight) !important;\n      }\n\n      :host > .io-drawer-content {\n        position: relative;\n        display: flex;\n        overflow: hidden;\n        transition: transform 0.125s ease-out;\n        height: 100%;\n        width: var(--io-drawer-size);\n        border: var(--io_border);\n        border-color: var(--io_borderColorStrong);\n        border-top: 0 !important;\n        border-bottom: 0 !important;\n        justify-content: flex-end;\n        background-color: var(--io_bgColorStrong);\n      }\n\n      :host[direction="left"] > .io-drawer-content {\n        transform: translateX(calc(var(--io-drawer-size) * -1 + var(--io_fieldHeight)));\n        flex-direction: row;\n      }\n      :host[direction="left"][expanded] > .io-drawer-content {\n        transform: translateX(0);\n      }\n      \n      :host[direction="right"] > .io-drawer-content {\n        transform: translateX(0);\n        flex-direction: row-reverse;\n      }\n      :host[direction="right"][expanded] > .io-drawer-content {\n        transform: translateX(calc(var(--io-drawer-size) * -1 + var(--io_fieldHeight)));\n      }\n\n      :host > .io-drawer-content > .io-drawer-handle {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        background-color: var(--io_bgColorLight);\n        cursor: pointer;\n        flex: 0 0 auto;\n        width: var(--io_fieldHeight);\n        @apply --unselectable;\n      }\n      :host[direction="left"][expanded] > .io-drawer-content > .io-drawer-handle {\n        border-left: var(--io_border);\n        border-color: var(--io_borderColorStrong);\n      }\n      :host[direction="right"][expanded] > .io-drawer-content > .io-drawer-handle {\n        border-right: var(--io_border );\n        border-color: var(--io_borderColorStrong);\n      }\n\n      :host[expanded] > .io-drawer-content > .io-drawer-handle > io-icon:first-of-type {\n        opacity: 0;\n      }\n      :host > .io-drawer-content > .io-drawer-handle > io-icon:first-of-type {\n        margin: var(--io_spacing2) auto;\n      }\n      :host > .io-drawer-content > .io-drawer-handle > io-icon:last-of-type {\n        margin: auto;\n      }\n\n      :host > .io-drawer-content > .io-navigator-drawer-menu {\n        display: flex;\n        flex: 0 0 auto;\n        overflow-y: auto;\n        flex-direction: column;\n      }\n      :host > .io-drawer-content > .io-navigator-drawer-menu > io-menu-tree {\n        flex: 1 1 auto;\n        border: none;\n        border-radius: 0;\n      }\n    '}constructor(args){super(args)}static get Listeners(){return{"io-menu-option-clicked":"onMenuOptionClicked","io-menu-tree-resized":"onMenuTreeResized"}}onMenuOptionClicked(){this.expanded=!1}onMenuTreeResized(){this.throttle(this.updateDrawerSizeThrottled)}onClick(event){event.preventDefault(),event.stopPropagation(),this.expanded=!this.expanded}expandedChanged(){this.dispatch("io-drawer-expanded-changed",{element:this},!0)}changed(){const icon={left:this.expanded?"io:triangle_left":"io:triangle_right",right:this.expanded?"io:triangle_right":"io:triangle_left"}[this.direction];this.render([div({class:"io-drawer-content"},[div({class:"io-navigator-drawer-menu"},[this.menuContent]),div({class:"io-drawer-handle","@click":this.onClick},[ioIcon({value:"io:hamburger",size:"small"}),ioIcon({value:icon,size:"small"})])])]),this.throttle(this.updateDrawerSizeThrottled)}updateDrawerSizeThrottled(){const menuEl=this.querySelector(".io-navigator-drawer-menu");if(menuEl){const contentSize=menuEl.scrollWidth+ThemeSingleton.lineHeight,contentEl=this.querySelector(".io-drawer-content");contentEl&&contentEl.style.setProperty("--io-drawer-size",`${contentSize}px`)}}};__decorateClass$1([ReactiveProperty({type:String,value:"left",reflect:!0})],IoNavigatorDrawer.prototype,"direction",2),__decorateClass$1([ReactiveProperty({type:Boolean,value:!1,reflect:!0})],IoNavigatorDrawer.prototype,"expanded",2),__decorateClass$1([ReactiveProperty({type:Object})],IoNavigatorDrawer.prototype,"menuContent",2),IoNavigatorDrawer=__decorateClass$1([Register],IoNavigatorDrawer);const ioNavigatorDrawer=function(args){return IoNavigatorDrawer.vConstructor(args)};var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp(target,key,result),result};let IoNavigator=class extends IoElement{static get Style(){return"\n      :host {\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n        position: relative;\n        overflow: hidden;\n        flex-direction: row-reverse;\n      }\n      :host[menu='top'] {\n        flex-direction: column-reverse;\n      }\n      :host > io-menu-tree {\n        align-self: stretch;\n        flex: 0 0 auto;\n        min-width: 10em;\n        border: var(--io_border);\n        overflow-y: auto;\n        border-radius: 0;\n      }\n      :host > io-menu-tree {\n        border-width: 0 var(--io_borderWidth) 0 0;\n      }\n      :host > io-menu-options {\n        border: none;\n        border-bottom: var(--io_border);\n        border-radius: 0;\n      }\n      :host > .io-veil {\n        position: absolute;\n        opacity: 0;\n        transition: opacity 0.125s ease-out;\n        background-color: rgba(0, 0, 0, 1);\n        pointer-events: none;\n        inset: 0;\n      }\n      :host[showveil] > .io-veil {\n        display: block;\n        opacity: 0.5;\n        pointer-events: auto;\n        cursor: pointer;\n      }\n    "}static get Listeners(){return{"io-drawer-expanded-changed":"onDrawerExpandedChanged"}}onResized(){this.debounce(this.calculateCollapsedDebounced)}calculateCollapsedDebounced(){this.calculateCollapsed()}calculateCollapsed(){if("top"===this.menu)return void(this.collapsed=!1);const rect=this.getBoundingClientRect();0===rect.width&&0===rect.height||(this.collapsed=rect.width<this.minWidth)}onDrawerExpandedChanged(event){event.stopPropagation();const srcDrawer=event.detail.element;this.showVeil=srcDrawer.expanded}collapseDrawer(){const drawer=this.querySelector("io-navigator-drawer");drawer&&(drawer.expanded=!1)}onVeilClick(event){event.stopPropagation(),this.collapseDrawer()}collapsedChanged(){this.collapseDrawer()}menuChanged(){this.calculateCollapsed()}optionMutated(){this.changed()}changed(){const sharedMenuConfig={option:this.option,widget:this.widget,depth:this.depth};let selected="";"shallow"===this.select&&(selected=this.option.selectedIDImmediate),"deep"===this.select&&(selected=this.option.selectedID),"all"===this.select&&(selected="*"),"none"===this.select&&(selected="");const selectorElement=ioSelector({selected:selected,anchor:this.bind("anchor"),caching:this.caching,elements:this.elements}),veil=div({class:"io-veil","@click":this.onVeilClick});"top"===this.menu?this.render([selectorElement,ioMenuOptions({horizontal:!0,...sharedMenuConfig})]):"left"===this.menu&&(this.collapsed?this.render([selectorElement,veil,ioNavigatorDrawer({direction:"left",menuContent:ioMenuTree({...sharedMenuConfig})})]):this.render([selectorElement,ioMenuTree({...sharedMenuConfig})]))}};__decorateClass([ReactiveProperty({type:Array,init:null})],IoNavigator.prototype,"elements",2),__decorateClass([ReactiveProperty({type:MenuOption})],IoNavigator.prototype,"option",2),__decorateClass([ReactiveProperty(null)],IoNavigator.prototype,"widget",2),__decorateClass([ReactiveProperty({value:"left",type:String,reflect:!0})],IoNavigator.prototype,"menu",2),__decorateClass([ReactiveProperty({value:Infinity,type:Number})],IoNavigator.prototype,"depth",2),__decorateClass([ReactiveProperty({value:"shallow",type:String})],IoNavigator.prototype,"select",2),__decorateClass([ReactiveProperty({value:"none",type:String})],IoNavigator.prototype,"caching",2),__decorateClass([ReactiveProperty({value:570,type:Number})],IoNavigator.prototype,"minWidth",2),__decorateClass([ReactiveProperty({value:"",type:String})],IoNavigator.prototype,"anchor",2),__decorateClass([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoNavigator.prototype,"collapsed",2),__decorateClass([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoNavigator.prototype,"showVeil",2),IoNavigator=__decorateClass([Register],IoNavigator);const ioNavigator=function(arg0){return IoNavigator.vConstructor(arg0)};export{IoCollapsible,IoNavigator,IoNavigatorDrawer,IoSelector,ioCollapsible,ioNavigator,ioNavigatorDrawer,ioSelector};
//# sourceMappingURL=index.js.map
