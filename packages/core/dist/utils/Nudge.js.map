{"version":3,"file":"Nudge.js","sourceRoot":"","sources":["../../src/utils/Nudge.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoElement } from '../elements/IoElement.js'\n\n/**\n * Nudge direction.\n *\n * @description Nudge direction.\n * @example\n *\n */\nexport type NudgeDirection = 'none' | 'up' | 'left' | 'down' | 'right' | 'over'\n\nconst viewport = {\n  get width(): number {\n    return window.visualViewport\n      ? window.visualViewport.width * window.visualViewport.scale\n      : document.documentElement.clientWidth\n  },\n  get height(): number {\n    return window.visualViewport\n      ? window.visualViewport.height * window.visualViewport.scale\n      : document.documentElement.clientHeight\n  },\n  get offsetLeft(): number {\n    return window.visualViewport ? window.visualViewport.offsetLeft : 0\n  },\n  get offsetTop(): number {\n    return window.visualViewport ? window.visualViewport.offsetTop : 0\n  },\n}\n\nfunction nudgeUp(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  x = Math.max(0, Math.min(x, viewport.width - elemRect.width))\n  let clipWidth = -1\n  let clipHeight = -1\n  const fitsHeight = y - elemRect.height >= 0\n  const fitsWidth = x + elemRect.width <= viewport.width\n  if (fitsHeight || force) {\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = y\n        y = 0\n      } else {\n        y = elemRect.height - y\n      }\n    } else {\n      y = y - elemRect.height\n    }\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width\n      } else {\n        x = viewport.width - elemRect.width\n      }\n    }\n    element.style.top = y + 'px'\n    element.style.left = x + 'px'\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : ''\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : ''\n    return true\n  }\n  return false\n}\n\nfunction nudgeDown(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = y + viewport.offsetTop\n  x = x + viewport.offsetLeft\n  x = Math.max(0, Math.min(x, viewport.width - elemRect.width))\n  let clipWidth = -1\n  let clipHeight = -1\n  const fitsHeight = y + elemRect.height <= viewport.height\n  const fitsWidth = x + elemRect.width <= viewport.width\n  if (fitsHeight || force) {\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height - y\n      } else {\n        y = viewport.height - elemRect.height\n      }\n    }\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width\n      } else {\n        x = viewport.width - elemRect.width\n      }\n    }\n    element.style.top = y + 'px'\n    element.style.left = x + 'px'\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : ''\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : ''\n    return true\n  }\n  return false\n}\n\nfunction nudgeLeft(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = Math.max(0, Math.min(y, viewport.height - elemRect.height))\n  let clipWidth = -1\n  let clipHeight = -1\n  const fitsWidth = x - elemRect.width >= 0\n  const fitsHeight = y + elemRect.height <= viewport.height\n  if (fitsWidth || force) {\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = x\n        x = 0\n      } else {\n        x = 0\n      }\n    } else {\n      x = x - elemRect.width\n    }\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height\n      } else {\n        y = viewport.height - elemRect.height\n      }\n    }\n    element.style.top = y + 'px'\n    element.style.left = x + 'px'\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : ''\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : ''\n    return true\n  }\n  return false\n}\n\nfunction nudgeRight(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = Math.max(0, Math.min(y, viewport.height - elemRect.height))\n  let clipWidth = -1\n  let clipHeight = -1\n  const fitsWidth = x + elemRect.width <= viewport.width\n  const fitsHeight = y + elemRect.height <= viewport.height\n  if (fitsWidth || force) {\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width - x\n      } else {\n        x = viewport.width - elemRect.width\n      }\n    }\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height\n      } else {\n        y = viewport.height - elemRect.height\n      }\n    }\n    element.style.top = y + 'px'\n    element.style.left = x + 'px'\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : ''\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : ''\n    return true\n  }\n  return false\n}\n\nexport function nudge(element: HTMLElement | IoElement, srcElement: HTMLElement | IoElement, direction: NudgeDirection, doClip?: boolean) {\n  const elemRect = element.getBoundingClientRect()\n  const srcRect = srcElement.getBoundingClientRect()\n  const left = srcRect.left\n  const top = srcRect.top\n  const right = srcRect.right\n  const bottom = srcRect.bottom\n  const bottomToHeight = viewport.height - bottom\n  const rightToWidth = viewport.width - right\n  const x = elemRect.left\n  const y = elemRect.top\n  switch (direction) {\n    case 'none':\n      nudgeRight(element, x, y, elemRect, false, doClip) ||\n      nudgeLeft(element, x, y, elemRect, false, doClip) ||\n      nudgeRight(element, x, y, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, left, top, elemRect, rightToWidth <= left, doClip)\n      break\n    case 'up':\n      nudgeUp(element, left, top, elemRect, false, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, false, doClip) ||\n      nudgeUp(element, left, top, elemRect, top > bottomToHeight, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, top <= bottomToHeight, doClip)\n      break\n    case 'left':\n      nudgeLeft(element, left, top, elemRect, false, doClip) ||\n      nudgeRight(element, right, top, elemRect, false, doClip) ||\n      nudgeLeft(element, left, top, elemRect, left > rightToWidth, doClip) ||\n      nudgeRight(element, right, top, elemRect, left <= rightToWidth, doClip)\n      break\n    case 'down':\n      nudgeDown(element, left, bottom, elemRect, false, doClip) ||\n      nudgeUp(element, left, top, elemRect, false, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, bottomToHeight > top, doClip) ||\n      nudgeUp(element, left, top, elemRect, bottomToHeight <= top, doClip)\n      break\n    case 'right':\n      nudgeRight(element, right, top, elemRect, false, doClip) ||\n      nudgeLeft(element, left, top, elemRect, false, doClip) ||\n      nudgeRight(element, right, top, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, left, top, elemRect, rightToWidth <= left, doClip)\n      break\n    case 'over':\n    default:\n      nudgeRight(element, left, top, elemRect, false, doClip) ||\n      nudgeLeft(element, right, top, elemRect, false, doClip) ||\n      nudgeRight(element, left, top, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, right, top, elemRect, rightToWidth <= left, doClip)\n      break\n  }\n}"]}