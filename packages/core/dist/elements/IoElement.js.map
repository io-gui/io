{"version":3,"file":"IoElement.js","sourceRoot":"","sources":["../../src/elements/IoElement.ts"],"names":[],"mappings":"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","sourcesContent":["import { Property, ReactiveProperty } from '../decorators/Property.js'\nimport { Register } from '../decorators/Register.js'\nimport { ProtoChain } from '../core/ProtoChain.js'\nimport { applyNativeElementProps, constructElement, disposeChildren, VDOMElement, toVDOM, NativeElementProps } from '../vdom/VDOM.js'\nimport { Node, ReactivityType, dispose, bind, unbind, onPropertyMutated, setProperty, dispatchQueue, setProperties, initReactiveProperties, initProperties, ReactivePropertyDefinitions, ListenerDefinitions } from '../nodes/Node.js'\nimport { Binding } from '../core/Binding.js'\nimport { applyElementStyleToDocument } from '../core/Style.js'\nimport { EventDispatcher, AnyEventListener } from '../core/EventDispatcher.js'\nimport { ChangeQueue } from '../core/ChangeQueue.js'\nimport { ReactivePropertyInstance } from '../core/ReactiveProperty.js'\nimport { throttle, debounce, CallbackFunction } from '../core/Queue.js'\n\nconst resizeObserver = new ResizeObserver(entries => {\n  for (const entry of entries) (entry.target as any).onResized()\n})\n\ntype prefix<TKey, TPrefix extends string> = TKey extends string ? `${TPrefix}${TKey}` : never\ntype AnyEventHandler = ((event: CustomEvent<any>) => void) | ((event: PointerEvent) => void) | ((event: KeyboardEvent) => void) | ((event: MouseEvent) => void) | ((event: TouchEvent) => void) | ((event: WheelEvent) => void) | ((event: InputEvent) => void) | ((event: ClipboardEvent) => void) | ((event: DragEvent) => void) | ((event: FocusEvent) => void) | ((event: TransitionEvent) => void) | ((event: AnimationEvent) => void) | ((event: ErrorEvent) => void) | ((event: Event) => void)\n\nexport type IoElementProps = NativeElementProps & {\n  reactivity?: ReactivityType\n  [key: prefix<string, '@'>]: string | AnyEventHandler\n}\n\n@Register\nexport class IoElement extends HTMLElement {\n  declare static vConstructor: (arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string) => VDOMElement\n  static get Style() {\n    return /* css */`\n      :host {\n        display: block;\n        box-sizing: border-box;\n        -webkit-touch-callout: none;\n      }\n      :host[hidden] {\n        display: none;\n      }\n      --unselectable: {\n        user-select: none;\n        -webkit-user-select: none;\n        -webkit-touch-callout: none;\n        -webkit-tap-highlight-color: transparent;\n      }\n      --io_focus: {\n        border-color: var(--io_colorWhite) !important;\n        outline: var(--io_borderWidth) solid var(--io_borderColorBlue) !important;\n        z-index: 1;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: String, value: 'immediate'})\n  declare reactivity: ReactivityType\n\n  @Property(Object)\n  declare $: Record<string, HTMLElement | IoElement>\n\n  static get ReactiveProperties(): ReactivePropertyDefinitions {\n    return {}\n  }\n\n  static get Properties(): Record<string, any> {\n    return {}\n  }\n\n  static get Listeners(): ListenerDefinitions {\n    return {}\n  }\n\n  declare readonly _protochain: ProtoChain\n  declare readonly _reactiveProperties: Map<string, ReactivePropertyInstance>\n  declare readonly _bindings: Map<string, Binding>\n  declare readonly _changeQueue: ChangeQueue\n  declare readonly _eventDispatcher: EventDispatcher\n  declare readonly _observedObjectProperties: string[]\n  declare readonly _observedNodeProperties: string[]\n  declare readonly _isIoElement: boolean\n  declare _disposed: boolean\n  declare _textNode: Text\n\n  constructor(args: IoElementProps = {}) {\n    super()\n    this._protochain.init(this)\n\n    Object.defineProperty(this, '_changeQueue', {enumerable: false, configurable: true, value: new ChangeQueue(this)})\n    Object.defineProperty(this, '_reactiveProperties', {enumerable: false, configurable: true, value: new Map()})\n    Object.defineProperty(this, '_bindings', {enumerable: false, configurable: true, value: new Map()})\n    Object.defineProperty(this, '_eventDispatcher', {enumerable: false, configurable: true, value: new EventDispatcher(this)})\n    Object.defineProperty(this, '_observedObjectProperties', {enumerable: false, configurable: true, value: []})\n    Object.defineProperty(this, '_observedNodeProperties', {enumerable: false, configurable: true, value: []})\n    // Object.defineProperty(this, '_parents', {enumerable: false, configurable: true, value: []});\n\n    this.init()\n\n    initReactiveProperties(this)\n    initProperties(this)\n\n    this.applyProperties(args, true)\n\n    this.ready()\n    this.dispatchQueue()\n  }\n  // TODO: add types\n  applyProperties(props: any, skipDispatch = false) {\n    for (const name in props) {\n      if (this._reactiveProperties.has(name)) {\n        this.setProperty(name, props[name], true)\n      } else {\n        if (name === 'class') {\n          this.className = props[name]\n        } else if (name === 'style') {\n          for (const s in props[name]) {\n            this.style[s as any] = props[name][s]\n          }\n        } else if (name.startsWith('data-')) {\n          // TODO: Test this!\n          if (props[name] === undefined) {\n            this.removeAttribute(name)\n          } else {\n            this.setAttribute(name, props[name])\n          }\n        } else if (!name.startsWith('@')) {\n          debug: if (props[name] as any instanceof Binding) {\n            console.warn(`IoElement: Not a ReactiveProperty! Cannot set binding to \"${name}\" property on element \"${this.localName}\"`)\n          }\n          this[name as keyof this] = props[name]\n          // TODO: test and check if type can be attribute.\n          if (props[name] === undefined && this.hasAttribute(name)) {\n            this.removeAttribute(name)\n          }\n        }\n      }\n    }\n    this._eventDispatcher.applyPropListeners(props)\n    if (!skipDispatch) this.dispatchQueue()\n  }\n  // TODO: add types\n  setProperties(props: any) {\n    setProperties(this, props)\n  }\n  setProperty(name: string, value: any, debounce = false) {\n    if (this._disposed) return\n    setProperty(this, name, value, debounce)\n    const prop = this._reactiveProperties.get(name)!\n    if (prop.reflect) this.setAttribute(name.toLowerCase(), value)\n  }\n  init() {}\n  ready() {}\n  changed() {}\n  queue(name: string, value: any, oldValue: any) {\n    this._changeQueue.queue(name, value, oldValue)\n  }\n  dispatchQueue(debounce = false) {\n    dispatchQueue(this, debounce)\n  }\n  throttle(func: CallbackFunction, arg?: any, timeout = 1) {\n    throttle(func, arg, this, timeout)\n  }\n  debounce(func: CallbackFunction, arg?: any, timeout = 1) {\n    debounce(func, arg, this, timeout)\n  }\n  onPropertyMutated(event: CustomEvent) {\n    return onPropertyMutated(this, event)\n  };\n  dispatchMutation(object: object | Node = this, properties: string[] = []) {\n    if ((object as Node)._isNode || (object as IoElement)._isIoElement) {\n      this.dispatch('io-object-mutation', {object, properties})\n    } else {\n      this.dispatch('io-object-mutation', {object, properties}, false, window)\n    }\n  }\n  bind(name: string): Binding {\n    return bind(this, name)\n  }\n  unbind(name: string): void {\n    unbind(this, name)\n  }\n  addEventListener(type: string, listener: AnyEventListener, options?: AddEventListenerOptions) {\n    if (this._disposed) return\n    this._eventDispatcher.addEventListener(type, listener as EventListener, options)\n  }\n  removeEventListener(type: string, listener?: AnyEventListener, options?: AddEventListenerOptions) {\n    if (this._disposed) return\n    this._eventDispatcher.removeEventListener(type, listener as EventListener, options)\n  }\n  dispatch(type: string, detail: any = undefined, bubbles = false, src?: Node | HTMLElement | Document | Window) {\n    if (this._disposed) return\n    this._eventDispatcher.dispatchEvent(type, detail, bubbles, src)\n  }\n  dispose() {\n    dispose(this)\n  }\n\n  connectedCallback() {\n    if (typeof (this as any).onResized === 'function') {\n      resizeObserver.observe(this)\n    }\n  }\n  disconnectedCallback() {\n    if (typeof (this as any).onResized === 'function') {\n      resizeObserver.unobserve(this)\n    }\n  }\n\n  /**\n   * Renders DOM from virtual DOM arrays.\n   * @param {Array} vDOMElements - Array of VDOMElement[] children.\n   * @param {HTMLElement} [host] - Optional template target.\n   * @param {boolean} [noDispose] - Skip disposal of existing elements.\n   */\n  render(vDOMElements: Array<VDOMElement | null>, host?: HTMLElement | IoElement, noDispose?: boolean) {\n    host = (host || this) as any\n    const vDOMElementsOnly = vDOMElements.filter(item => item !== null)\n    this.$ = {}\n    this.traverse(vDOMElementsOnly, host as HTMLElement, noDispose)\n  }\n  /**\n   * Recurively traverses virtual DOM elements.\n   * TODO: test element.traverse() function!\n   * @param {Array} vDOMElements - Array of VDOMElements elements.\n   * @param {HTMLElement} [host] - Optional template target.\n   * @param {boolean} [noDispose] - Skip disposal of existing elements.\n   */\n  traverse(vChildren: VDOMElement[], host: HTMLElement | IoElement, noDispose?: boolean) {\n    const children = host.children\n    // remove trailing elements\n    while (children.length > vChildren.length) {\n      const child = children[children.length - 1]\n      host.removeChild(child)\n      if (!noDispose) disposeChildren(child as IoElement)\n    }\n    // replace elements\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i] as HTMLElement | IoElement\n      // replace existing elements\n      if (child.localName !== vChildren[i].tag || noDispose) {\n        const oldElement = child as HTMLElement\n        const element = constructElement(vChildren[i])\n        host.insertBefore(element, oldElement)\n        host.removeChild(oldElement)\n        if (!noDispose) disposeChildren(oldElement as IoElement)\n      // update existing elements\n      } else {\n        // TODO: improve setting/removal/cleanup of native element properties/attributes.\n        child.removeAttribute('className')\n        child.removeAttribute('style')\n        if (vChildren[i].props) {\n          if ((child as IoElement)._isIoElement) {\n            // Set IoElement element properties\n            (child as IoElement).applyProperties(vChildren[i].props as Record<keyof this, any>)\n          } else {\n            // Set native HTML element properties\n            applyNativeElementProps(child as HTMLElement, vChildren[i].props!)\n          }\n        }\n      }\n    }\n    // TODO: doing this before \"replace elements\" cached (noDispose) elements to be created twice.\n    // TODO: rename nodispose to dispose.\n    // TODO: test\n    // create new elements after existing\n    if (children.length < vChildren.length) {\n      const frag = document.createDocumentFragment()\n      for (let i = children.length; i < vChildren.length; i++) {\n        const element = constructElement(vChildren[i])\n        frag.appendChild(element)\n      }\n      host.appendChild(frag)\n    }\n    for (let i = 0; i < vChildren.length; i++) {\n      const vChild = vChildren[i]\n      const child = children[i] as HTMLElement | IoElement\n      if (vChild.props?.id) {\n        // Update this.$ map of ids.\n        debug: {\n          if (this.$[vChild.props!.id] !== undefined) {\n            console.warn(`IoElement: Duplicate id in template. \"${vChild.props!.id}\"`)\n          }\n        }\n        this.$[vChild.props!.id] = child\n      }\n      if (vChild.children !== undefined) { // TODO: test this! Look for more cases of truthy check bugs!\n        if (typeof vChild.children === 'string') {\n          // Set textNode value.\n          this._flattenTextNode(child as HTMLElement);\n          (child as IoElement)._textNode.nodeValue = String(vChild.children)\n        } else if (vChild.children instanceof Array) {\n          // Traverse deeper.\n          const vDOMElementsOnly = (vChild.children as Array<VDOMElement | null>).filter(item => item !== null)\n          this.traverse(vDOMElementsOnly, child as HTMLElement, noDispose)\n        }\n      }\n    }\n  }\n\n  /**\n  * Helper function to flatten textContent into a single TextNode.\n  * Update textContent via TextNode is better for layout performance.\n  * TODO: Consider using normalize()? Is it the same function?\n  * @param {HTMLElement} element - Element to flatten.\n  */\n  _flattenTextNode(element: HTMLElement | IoElement) {\n    if (element.childNodes.length === 0) {\n      element.appendChild(document.createTextNode(''))\n    }\n    if (element.childNodes[0].nodeName !== '#text') {\n      element.innerHTML = ''\n      element.appendChild(document.createTextNode(''))\n    }\n    (element as IoElement)._textNode = element.childNodes[0] as Text\n    if (element.childNodes.length > 1) {\n      const textContent = element.textContent\n      for (let i = element.childNodes.length; i--;) {\n        if (i !== 0) element.removeChild(element.childNodes[i])\n      }\n      (element as IoElement)._textNode.nodeValue = textContent\n    }\n  }\n  /**\n  * Alias for HTMLElement setAttribute where falsey values remove the attribute.\n  * @param {string} attr - Attribute name.\n  * @param {*} value - Attribute value.\n  */\n  setAttribute(attr: string, value: boolean | number | string) {\n    if (value === true) {\n      HTMLElement.prototype.setAttribute.call(this, attr, '')\n    } else if (value === false || value === '') {\n      this.removeAttribute(attr)\n    } else if (typeof value === 'string' || typeof value === 'number') {\n      if (this.getAttribute(attr) !== String(value)) HTMLElement.prototype.setAttribute.call(this, attr, String(value))\n    }\n  }\n  /**\n   * Returns a vDOM-like representation of the element with children and attributes. This feature is used in testing.\n   */\n  toVDOM() {\n    return toVDOM(this)\n  }\n  Register(ioNodeConstructor: typeof IoElement) {\n    Object.defineProperty(ioNodeConstructor.prototype, '_protochain', {value: new ProtoChain(ioNodeConstructor)})\n\n    const localName = ioNodeConstructor.name.replace(/([a-z])([A-Z,0-9])/g, '$1-$2').toLowerCase()\n\n    Object.defineProperty(ioNodeConstructor, 'localName', {value: localName})\n    Object.defineProperty(ioNodeConstructor.prototype, 'localName', {value: localName})\n\n    Object.defineProperty(ioNodeConstructor, '_isIoElement', {enumerable: false, value: true, writable: false})\n    Object.defineProperty(ioNodeConstructor.prototype, '_isIoElement', {enumerable: false, value: true, writable: false})\n    Object.defineProperty(window, ioNodeConstructor.name, {value: ioNodeConstructor})\n\n    window.customElements.define(localName, ioNodeConstructor as unknown as CustomElementConstructor)\n\n    applyElementStyleToDocument(localName, ioNodeConstructor.prototype._protochain.style)\n\n    // TODO: Define all overloads with type guards.\n    // TODO: Add runtime debug type checks.\n    // TODO: Test thoroughly.\n    Object.defineProperty(ioNodeConstructor, 'vConstructor', {value: function(arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string): VDOMElement {\n      const vDOMElement: VDOMElement = {tag: localName}\n      if (arg0 !== undefined) {\n        if (typeof arg0 === 'string') {\n          vDOMElement.children = arg0\n        } else if (arg0 instanceof Array) {\n          vDOMElement.children = arg0\n        } else if (typeof arg0 === 'object') {\n          vDOMElement.props = arg0\n        }\n        if (arg1 !== undefined) {\n          if (typeof arg1 === 'string') {\n            vDOMElement.children = arg1\n          } else if (arg1 instanceof Array) {\n            vDOMElement.children = arg1\n          }\n        }\n      }\n      return vDOMElement\n    }})\n  }\n}\n\nexport const ioElement = IoElement.vConstructor"]}