{"version":3,"file":"Binding.test.js","sourceRoot":"","sources":["../../src/core/Binding.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { describe, it, expect } from 'vitest'\nimport { Binding, Node, Register, ReactiveProperty } from '@io-gui/core'\n\n@Register\nclass TestNode extends Node {\n  @ReactiveProperty({type: Number, value: 0})\n  declare prop1: number\n  @ReactiveProperty({type: Number, value: 0})\n  declare prop2: number\n}\n\n@Register\nclass TestNodeString extends Node {\n  @ReactiveProperty({type: String, value: ''})\n  declare strProp: string\n}\n\ndescribe('Binding', () => {\n  it('Should initialize with correct default values', () => {\n    const node = new TestNode()\n    const binding = new Binding(node, 'prop1')\n    expect(binding.node).toBe(node)\n    expect(binding.property).toBe('prop1')\n    expect(binding.targets instanceof Set).toBe(true)\n    expect(binding.targets.size).toBe(0)\n    expect(binding.targetProperties instanceof WeakMap).toBe(true)\n  })\n  it('Should set source and target properties', () => {\n    const node = new TestNode()\n    const binding = new Binding(node, 'prop1')\n    node.prop1 = 1\n    expect(binding.value).toBe(1)\n    node.prop1 = 2\n    expect(binding.value).toBe(2)\n    binding.value = 3\n    expect(node.prop1).toBe(3)\n    const targetNode = new TestNode()\n    binding.addTarget(targetNode, 'prop1')\n    expect(targetNode.prop1).toBe(3)\n    targetNode.prop1 = 4\n    expect(binding.value).toBe(4)\n    node.prop1 = 5\n    expect(targetNode.prop1).toBe(5)\n    expect(binding.value).toBe(5)\n    binding.value = 6\n    expect(node.prop1).toBe(6)\n    expect(targetNode.prop1).toBe(6)\n  })\n  it('Should add/remove target nodes+properties with `addTarget()` and `removeTarget()`', () => {\n    const srcNode = new TestNode()\n    const binding0 = new Binding(srcNode, 'prop1')\n    const binding1 = new Binding(srcNode, 'prop2')\n\n    const dstNode0 = new TestNode()\n    const dstNode1 = new TestNode()\n\n    binding0.addTarget(dstNode0, 'prop1')\n    binding1.addTarget(dstNode0, 'prop2')\n    binding1.addTarget(dstNode1, 'prop1')\n    binding1.addTarget(dstNode1, 'prop2')\n\n    expect(srcNode._eventDispatcher.addedListeners).toEqual({\n      'prop1-changed': [[binding0.onSourceChanged]],\n      'prop2-changed': [[binding1.onSourceChanged]]\n    })\n\n    expect(dstNode0._eventDispatcher.addedListeners).toEqual({\n      'prop1-changed': [[binding0.onTargetChanged]],\n      'prop2-changed': [[binding1.onTargetChanged]]\n    })\n\n    expect(dstNode1._eventDispatcher.addedListeners).toEqual({\n      'prop1-changed': [[binding1.onTargetChanged]],\n      'prop2-changed': [[binding1.onTargetChanged]]\n    })\n\n    expect(binding0.targets.has(dstNode0)).toBe(true)\n    expect(binding0.targets.size).toBe(1)\n    expect(binding1.targets.has(dstNode0)).toBe(true)\n    expect(binding1.targets.has(dstNode1)).toBe(true)\n    expect(binding1.targets.size).toBe(2)\n\n    expect(dstNode0._reactiveProperties.get('prop1')!.binding).toBe(binding0)\n    expect(dstNode0._reactiveProperties.get('prop2')!.binding).toBe(binding1)\n    expect(dstNode1._reactiveProperties.get('prop1')!.binding).toBe(binding1)\n    expect(dstNode1._reactiveProperties.get('prop2')!.binding).toBe(binding1)\n\n    const binding0target0Props = binding0.getTargetProperties(dstNode0)\n    const binding0target1Props = binding0.getTargetProperties(dstNode1)\n    expect(binding0target0Props[0]).toBe('prop1')\n    expect(binding0target0Props.length).toBe(1)\n    expect(binding0target1Props.length).toBe(0)\n\n    const binding1target0Props = binding1.getTargetProperties(dstNode0)\n    const binding1target1Props = binding1.getTargetProperties(dstNode1)\n    expect(binding1target0Props[0]).toBe('prop2')\n    expect(binding1target0Props.length).toBe(1)\n    expect(binding1target1Props[0]).toBe('prop1')\n    expect(binding1target1Props[1]).toBe('prop2')\n    expect(binding1target1Props.length).toBe(2)\n\n    binding1.removeTarget(dstNode1, 'prop1')\n    expect(binding1target1Props[0]).toBe('prop2')\n    expect(binding1target1Props.length).toBe(1)\n    expect(dstNode1._reactiveProperties.get('prop1')!.binding).toBe(undefined)\n\n    expect(dstNode1._eventDispatcher.addedListeners).toEqual({\n      'prop2-changed': [[binding1.onTargetChanged]]\n    })\n\n    binding1.addTarget(dstNode1, 'prop1')\n    expect(binding1target1Props.length).toBe(2)\n    expect(dstNode1._reactiveProperties.get('prop1')!.binding).toBe(binding1)\n    binding1.removeTarget(dstNode1)\n    expect(binding1target1Props.length).toBe(0)\n    expect(dstNode1._reactiveProperties.get('prop1')!.binding).toBe(undefined)\n    expect(dstNode1._reactiveProperties.get('prop2')!.binding).toBe(undefined)\n\n    expect(dstNode1._eventDispatcher.addedListeners).toEqual({})\n  })\n  it('Should remove existing binding from target if `addTarget()` causes a binding collision', () => {\n    const srcNode1 = new TestNode()\n    const binding1 = new Binding(srcNode1, 'prop1')\n    const dstNode1 = new TestNode()\n    binding1.addTarget(dstNode1, 'prop1')\n\n    const srcNode2 = new TestNode()\n    const binding2 = new Binding(srcNode2, 'prop1')\n\n    expect(binding1.targets.has(dstNode1)).toBe(true)\n    let binding1targetProps = binding1.getTargetProperties(dstNode1)\n    expect(binding1targetProps.length).toBe(1)\n    expect(binding1targetProps[0]).toBe('prop1')\n\n    binding2.addTarget(dstNode1, 'prop1')\n\n    expect(binding1.targets.size).toBe(0)\n    binding1targetProps = binding1.getTargetProperties(dstNode1)\n    expect(binding1targetProps.length).toBe(0)\n  })\n  it('Should dispose correctly', () => {\n    const node = new TestNode()\n    const dstNode = new TestNode()\n    const binding = new Binding(node, 'prop1')\n    binding.addTarget(dstNode, 'prop1')\n\n    expect(node._eventDispatcher.addedListeners).toEqual({\n      'prop1-changed': [[binding.onSourceChanged]]\n    })\n\n    expect(dstNode._eventDispatcher.addedListeners).toEqual({\n      'prop1-changed': [[binding.onTargetChanged]],\n    })\n\n    binding.dispose()\n    expect(binding.node).toBe(undefined)\n    expect(binding.property).toBe(undefined)\n    expect(binding.targets).toBe(undefined)\n    expect(binding.targetProperties).toBe(undefined)\n    expect(dstNode._reactiveProperties.get('prop1')!.binding).toBe(undefined)\n\n    expect(node._eventDispatcher.addedListeners).toEqual({})\n\n    expect(dstNode._eventDispatcher.addedListeners).toEqual({})\n  })\n  it('Should return correct JSON representation', () => {\n    const node1 = new TestNode()\n    const node2 = new TestNode()\n    const node3 = new TestNode()\n    const node4 = new TestNodeString()\n    const binding = new Binding(node1, 'prop1')\n    binding.addTarget(node2, 'prop1')\n    binding.addTarget(node2, 'prop2')\n    binding.addTarget(node3, 'prop1')\n    binding.addTarget(node4, 'strProp')\n    const json = binding.toJSON()\n    expect(json).toEqual({\n      node: 'TestNode',\n      property: 'prop1',\n      targets: ['TestNode', 'TestNode', 'TestNodeString'],\n      targetProperties: [\n        ['prop1', 'prop2'],\n        ['prop1'],\n        ['strProp']\n      ]\n    })\n  })\n})\n"]}