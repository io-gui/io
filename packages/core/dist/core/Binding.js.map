{"version":3,"file":"Binding.js","sourceRoot":"","sources":["../../src/core/Binding.ts"],"names":[],"mappings":"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","sourcesContent":["import { ChangeEvent } from './ChangeQueue.js'\nimport { ReactiveNode } from '../nodes/ReactiveNode.js'\nimport { IoElement } from '../elements/IoElement.js'\n\n// TODO: Improve types!\ntype Properties = string[]\ntype TargetProperties = WeakMap<ReactiveNode | IoElement, Properties>\n\n// This helper checks if both values are NaN because NaN === NaN is false.\nconst bothAreNaNs = function(value: any, oldValue: any) {\n  return typeof value === 'number' && isNaN(value) && typeof oldValue === 'number' && isNaN(oldValue)\n}\n\nconst isTypeCompatible = (type1: any, type2: any) => {\n  // Handle primitive types\n  if (type1 === type2) return true\n  // Handle class inheritance\n  if (typeof type1 === 'function' && typeof type2 === 'function') {\n    return type1.prototype instanceof type2 || type2.prototype instanceof type1\n  }\n  return false\n}\n/**\n * This class is used internally by the framework to enable two-way data synchronization between reactive properties.\n * It manages bindings between a source node's reactive property and one or more target nodes and reactive properties.\n * It uses hub-and-spoke pub/sub event system and maintains data consistency by automatically propagating changes to all bound nodes and properties.\n *\n * Key features:\n * - Listens for `[propName]-changed` events to detect changes\n * - Supports one-to-many property bindings\n * - Prevents circular update loops\n * - Automatically cleans up listeners when disposed\n *\n * @example\n * const binding = new Binding(nodeA, 'value');\n * binding.addTarget(nodeB, 'value');\n */\nexport class Binding {\n  readonly node: ReactiveNode | IoElement\n  readonly property: string\n  readonly targets: Set<ReactiveNode | IoElement> = new Set()\n  readonly targetProperties: TargetProperties = new WeakMap()\n  /**\n   * Creates a binding object for specified source `node` and `property`.\n   * It attaches a `[propName]-changed` listener to the source node.\n   * @param {ReactiveNode | IoElement} node - Source node\n   * @param {string} property - Name of the sourceproperty\n   */\n  constructor(node: ReactiveNode | IoElement, property: string) {\n    debug: {\n      if (!(node as ReactiveNode)._isNode && !(node as IoElement)._isIoElement) console.warn('Source node is not a ReactiveNode or IoElement instance!')\n      if (!node._reactiveProperties.has(property)) console.warn(`Source node does not have a reactive property \"${property}\"!`)\n    }\n    this.node = node\n    this.property = property\n    this.onSourceChanged = this.onSourceChanged.bind(this)\n    this.onTargetChanged = this.onTargetChanged.bind(this)\n    this.node.addEventListener(`${this.property}-changed`, this.onSourceChanged)\n  }\n  set value(value: any) {\n    (this.node as any)[this.property] = value\n  }\n  get value(): any {\n    return (this.node as any)[this.property]\n  }\n  /**\n   * Adds a target node and property.\n   * Sets itself as the binding reference on the target `ReactivePropertyInstance`.\n   * Adds a `[propName]-changed` listener to the target node.\n   * @param {ReactiveNode | IoElement} target - Target node\n   * @param {string} property - Target property\n   */\n  addTarget(target: ReactiveNode | IoElement, property: string) {\n    const targetProps = this.getTargetProperties(target)\n\n    debug: {\n      if (!(target as ReactiveNode)._isNode && !(target as IoElement)._isIoElement) console.warn('Target node is not a ReactiveNode or IoElement instance!')\n      if (!target._reactiveProperties.has(property)) console.warn(`Target node does not have a reactive property \"${property}\"!`)\n      if (targetProps.indexOf(property) !== -1) console.error(`Target property \"${property}\" already added!`)\n    }\n\n    if (!this.targets.has(target)) this.targets.add(target)\n    if (targetProps.indexOf(property) === -1) {\n      targetProps.push(property)\n\n      const targetP = target._reactiveProperties.get(property)!\n      if (targetP.binding && targetP.binding !== this) {\n        debug: {\n          console.warn('Improper usage detected!')\n          console.info('Target property is already a target of another binding. Undinding previous binding!')\n        }\n        targetP.binding.removeTarget(target, property)\n      }\n      targetP.binding = this\n\n      debug: {\n        const srcP = this.node._reactiveProperties.get(this.property)!\n        const valueMismatch = srcP.value !== undefined && targetP.value !== undefined && typeof srcP.value !== typeof targetP.value\n        const typeMismatch = srcP.type !== undefined && targetP.type !== undefined && !isTypeCompatible(srcP.type, targetP.type)\n        if (valueMismatch || typeMismatch) {\n          console.warn(`Source property \"${this.property}\" does not match type of target property \"${property}\"!`)\n          console.info(`Source \"${this.property}\" value: ${srcP.value} type: ${srcP.type} typeof: ${typeof srcP.value}`)\n          console.info(`Target \"${property}\" value: ${targetP.value} type: ${targetP.type} typeof: ${typeof targetP.value}`)\n        }\n      }\n\n      target.addEventListener(`${property}-changed`, this.onTargetChanged)\n      target.setProperty(property, this.value, true)\n    }\n  }\n  /**\n   * Removes target node and property.\n   * If `property` is not specified, it removes all target properties.\n   * Removes binding reference from the target `ReactivePropertyInstance`.\n   * Removes `[propName]-changed` listener from the target node.\n   * @param {ReactiveNode | IoElement} target - Target node\n   * @param {string} property - Target property\n   */\n  removeTarget(target: ReactiveNode | IoElement, property?: string) {\n    const targetProperties = this.getTargetProperties(target)\n\n    if (property) {\n\n      const i = targetProperties.indexOf(property)\n      debug: if (i === -1) {\n        console.error('Target property not found!')\n      }\n      targetProperties.splice(i, 1)\n\n      const propertyInstance = target._reactiveProperties.get(property)!\n      debug: if (propertyInstance.binding !== this) {\n        console.error('Target property has a different binding!')\n      }\n      propertyInstance.binding = undefined\n      target.removeEventListener(`${property}-changed`, this.onTargetChanged)\n\n    } else {\n\n      for (let i = targetProperties.length; i--;) {\n        const prop = targetProperties[i]\n        const propertyInstance = target._reactiveProperties.get(prop)!\n        debug: if (propertyInstance.binding !== this) {\n          console.error('Target property has a different binding!')\n        }\n        propertyInstance.binding = undefined\n        target.removeEventListener(`${prop}-changed`, this.onTargetChanged)\n      }\n      targetProperties.length = 0\n\n    }\n\n    if (targetProperties.length === 0) this.targets.delete(target)\n  }\n  /**\n   * Event handler that updates source property when one of the targets emits `[propName]-changed` event.\n   * @param {ChangeEvent} event - Property change event.\n   */\n  onTargetChanged(event: ChangeEvent){\n    debug: if (!this.targets.has(event.target as ReactiveNode | IoElement)) {\n      console.error('onTargetChanged() should never fire if target is not accounted for!')\n    }\n    const oldValue = this.value\n    const value = event.detail.value\n    if (oldValue !== value) {\n      if (bothAreNaNs(value, oldValue)) return;\n      (this.node as any)[this.property] = value\n    }\n  }\n  /**\n   * Event handler that updates bound properties on target nodes when source node emits `[propName]-changed` event.\n   * @param {ChangeEvent} event - Property change event.\n   */\n  onSourceChanged(event: ChangeEvent) {\n    debug: if (event.target !== this.node) {\n      console.error('onSourceChanged() should always originate form source node!')\n    }\n    const value = event.detail.value\n    for (const target of this.targets) {\n      const targetProperties = this.getTargetProperties(target)\n      for (let j = targetProperties.length; j--;) {\n        const propName = targetProperties[j]\n        const oldValue = (target as any)[propName]\n        if (oldValue !== value) {\n          if (bothAreNaNs(value, oldValue)) continue;\n          (target as any)[propName] = value\n        }\n      }\n    }\n  }\n  /**\n   * Returns a list of target properties for specified target node.\n   * @param {ReactiveNode | IoElement} target - Target node.\n   * @return {Properties} list of target property names.\n   */\n  getTargetProperties(target: ReactiveNode | IoElement): Properties {\n    if (!this.targetProperties.has(target)) this.targetProperties.set(target, [])\n    return this.targetProperties.get(target)!\n  }\n  /**\n   * Returns a JSON representation of the binding.\n   * This is required for `JSON.stringify(protoProperties)` in `ProtoChain`.\n   * @return {string} JSON representation of the binding.\n   */\n  toJSON() {\n    const targetProperties: Properties[] = []\n    const targetNames: string[] = []\n    for (const target of this.targets) {\n      targetNames.push(target.constructor.name)\n      targetProperties.push(this.getTargetProperties(target))\n    }\n    return {\n      node: this.node.constructor.name,\n      property: this.property,\n      targets: targetNames,\n      targetProperties: targetProperties,\n    }\n  }\n  /**\n   * Disposes the binding and removes all targets and listeners.\n   */\n  dispose() {\n    this.node.removeEventListener(`${this.property}-changed`, this.onSourceChanged)\n    for (const target of this.targets) {\n      this.removeTarget(target)\n    }\n    this.targets.clear()\n    delete (this as any).node\n    delete (this as any).property\n    delete (this as any).targets\n    delete (this as any).targetProperties\n  }\n}\n"]}