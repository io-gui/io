{"version":3,"file":"IoNumber.js","sourceRoot":"","sources":["../../src/elements/IoNumber.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, ReactiveProperty, WithBinding, Property } from '@io-gui/core'\nimport { IoNumberLadderSingleton } from './IoNumberLadderSingleton.js'\nimport { IoField, IoFieldProps } from './IoField.js'\n\nexport type IoNumberProps = IoFieldProps & {\n  value?: WithBinding<number>\n  live?: boolean\n  conversion?: number\n  step?: number\n  min?: number\n  max?: number\n  ladder?: boolean\n}\n\n/**\n * Input element for `Number` data type.\n * It clamps the `value` to `min` / `max` and rounds it to the nearest `step` increment.\n * If `ladder` property is enabled, it displays an interactive float ladder element when clicked/taped.\n * Alternatively, ladder can be expanded by middle click or ctrl key regardless of ladder property.\n **/\n@Register\nexport class IoNumber extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        font-family: monospace;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorInput);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: 0, type: Number})\n  declare value: number\n\n  @ReactiveProperty({value: false, type: Boolean})\n  declare live: boolean\n\n  @ReactiveProperty({value: 1, type: Number})\n  declare conversion: number\n\n  @ReactiveProperty({value: 0.0001, type: Number})\n  declare step: number\n\n  @ReactiveProperty({value: -Infinity, type: Number})\n  declare min: number\n\n  @ReactiveProperty({value: Infinity, type: Number})\n  declare max: number\n\n  @ReactiveProperty({value: false, type: Boolean})\n  declare ladder: boolean\n\n  @ReactiveProperty({value: 'inset', type: String, reflect: true})\n  declare appearance: 'neutral' | 'inset' | 'outset'\n\n  @Property('true')\n  declare contentEditable: string\n\n  @ReactiveProperty({value: 'pattern=\"-?[0-9]*?[0-9]*\"', type: String, reflect: true})\n  declare pattern: string\n\n  // TODO: 'decimal' mode on iOS does not display minus and decimal point\n  @Property('text')\n  declare inputMode: string\n\n  @Property('textbox')\n  declare role: string\n\n  constructor(args: IoNumberProps = {}) { super(args) }\n\n  get textNode() {\n    this._flattenTextNode(this)\n    return this._textNode.nodeValue\n  }\n  set textNode(value) {\n    this._flattenTextNode(this)\n    this._textNode.nodeValue = String(value)\n  }\n\n  onBlur(event: FocusEvent) {\n    super.onBlur(event)\n    this._setFromTextNode()\n    this.scrollTop = 0\n    this.scrollLeft = 0\n    // TODO: unhack race condition\n    setTimeout(() => {\n      if ((document.activeElement as Element).parentElement !== IoNumberLadderSingleton as unknown as Element) {\n        IoNumberLadderSingleton.expanded = false\n      }\n    })\n  }\n  onPointerdown(event: PointerEvent) {\n    if (event.pointerType === 'touch') event.preventDefault()\n    this.addEventListener('pointermove', this.onPointermove)\n    this.addEventListener('pointerup', this.onPointerup)\n    if (document.activeElement === this as unknown as Element && event.button === 0) return\n  }\n  onPointerup(event: PointerEvent) {\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n    if (this.ladder || event.button === 1) {\n      if (event.pointerType === 'touch') {\n        event.preventDefault();\n        (document.activeElement as HTMLElement).blur()\n      } else {\n        if (document.activeElement !== this as unknown as Element) {\n          this.focus()\n          this.setCaretPosition(this.textNode!.length)\n        }\n      }\n      this.expandLadder()\n    } else {\n      if (document.activeElement !== this as unknown as Element) {\n        this.focus()\n        this.setCaretPosition(this.textNode!.length)\n      }\n    }\n  }\n  expandLadder() {\n    IoNumberLadderSingleton.src = this\n    IoNumberLadderSingleton.expanded = true\n  }\n  collapseLadder() {\n    IoNumberLadderSingleton.expanded = false\n  }\n  onKeydown(event: KeyboardEvent) {\n    const range = (window.getSelection() as Selection).getRangeAt(0)\n    const rangeStart = range.startOffset\n    const rangeEnd = range.endOffset\n    const length = this.childNodes[0] ? (this.childNodes[0] as Text).length : 0\n    const rangeInside = range.startContainer === range.endContainer && (range.startContainer === this.childNodes[0] || range.startContainer === this as unknown as Node)\n\n    switch (event.key) {\n      case 'Escape':\n      case 'Enter':\n      case ' ':\n        event.preventDefault()\n        this._setFromTextNode()\n        // Only blur if on mobile\n        if (isMobileDevice()) {\n          (this as unknown as HTMLElement).blur()\n        }\n        break\n      case 'Home':\n        event.preventDefault()\n        this.textNode = String(this.min)\n        this._setFromTextNode()\n        break\n      case 'End':\n        event.preventDefault()\n        this.textNode = String(this.max)\n        this._setFromTextNode()\n        break\n      case 'ArrowLeft':\n        if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === 0)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n        // TODO: shift step\n        break\n      case 'ArrowUp':\n        if (IoNumberLadderSingleton.expanded) {\n          event.preventDefault()\n          const upStep = IoNumberLadderSingleton.querySelector('.io-up1') as HTMLElement\n          if (upStep) upStep.focus()\n        } else if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === 0)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n        break\n      case 'ArrowRight':\n        if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === length)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n        // TODO: shift step\n        break\n      case 'ArrowDown':\n        if (IoNumberLadderSingleton.expanded) {\n          event.preventDefault()\n          const downStep = IoNumberLadderSingleton.querySelector('.io-down1') as HTMLElement\n          if (downStep) downStep.focus()\n        } else if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === length)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n        break\n    }\n  }\n  onKeyup(event: KeyboardEvent) {\n    // TODO: move to onkeydown?\n    if (event.key === 'Control' || event.key === 'Shift') {\n      IoNumberLadderSingleton.expanded ? this.collapseLadder() : this.expandLadder()\n    } else if (event.key === 'Escape' || event.key === 'Enter' || event.key === ' ') {\n      this.collapseLadder()\n    }\n\n    if (this.live) {\n      const carretPosition = this.getCaretPosition()\n      this._setFromTextNode()\n      this.setCaretPosition(carretPosition)\n    }\n  }\n  _setFromTextNode() {\n    // Normalize comma to period for decimal separator\n    let valueText = this.textNode!.trim().replace(',', '.')\n    let valueNumber = Number(valueText) / this.conversion\n    valueNumber = Math.min(this.max, Math.max(this.min, valueNumber))\n    valueNumber = Math.round(valueNumber / this.step) * this.step\n    const d = Math.max(0, Math.min(100, -Math.floor(Math.log(this.step) / Math.LN10)))\n    valueNumber = Number(valueNumber.toFixed(d))\n    if (!isNaN(valueNumber)) {\n      this._reactiveProperties.get('invalid')!.value = false\n      this.removeAttribute('invalid')\n      this.removeAttribute('aria-invalid')\n      this.inputValue(valueNumber)\n    } else {\n      this._reactiveProperties.get('invalid')!.value = true\n      this.setAttribute('invalid', 'true')\n      this.setAttribute('aria-invalid', 'true')\n    }\n  }\n  ready() {\n    this.disabledChanged()\n    this.changed()\n  }\n  changed() {\n    this.setAttribute('aria-valuenow', this.value)\n    this.setAttribute('aria-valuemin', this.min)\n    this.setAttribute('aria-valuemax', this.max)\n    this.setAttribute('aria-valuestep', this.step)\n    if (typeof this.value !== 'number' || isNaN(this.value)) {\n      this.setAttribute('invalid', 'true')\n      this.setAttribute('aria-invalid', 'true')\n    } else {\n      this.removeAttribute('invalid')\n      this.removeAttribute('aria-invalid')\n    }\n    let value = this.value\n    let valueText\n    if (typeof value === 'number' && !isNaN(value)) {\n      value *= this.conversion\n      let d = -Math.floor(Math.log(this.step * this.conversion) / Math.LN10)\n      d = Math.max(0, Math.min(100, d))\n      value = Number(value.toFixed(d))\n      valueText = String(value)\n    } else {\n      valueText = 'NaN'\n    }\n    this.setAttribute('value', valueText)\n    this.setAttribute('positive', this.value >= 0)\n    this.textNode = valueText\n  }\n}\n\nfunction isMobileDevice(): boolean {\n  return /Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)\n    || ('ontouchstart' in window && !window.matchMedia('(pointer: fine)').matches)\n}\n\nexport const ioNumber = function(arg0?: IoNumberProps) {\n  return IoNumber.vConstructor(arg0)\n}"]}