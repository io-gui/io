import{ReactiveProperty,Property,IoElement,span,Register,IoOverlaySingleton,ThemeSingleton}from"@io-gui/core";import{ioIcon}from"@io-gui/icons";var __defProp$6=Object.defineProperty,__getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$7(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$6(target,key,result),result};let IoField=class extends IoElement{static get Style(){return"\n      :host {\n        cursor: pointer;\n        height: var(--io_fieldHeight);\n        min-height: var(--io_fieldHeight);\n        line-height: var(--io_lineHeight);\n        border: var(--io_border);\n        border-color: transparent;\n        border-radius: var(--io_borderRadius);\n        padding: var(--io_spacing) var(--io_spacing2);\n        color: var(--io_color);\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        font-size: var(--io_fontSize);\n        text-size-adjust: 100%;\n        overflow: hidden;\n        @apply --unselectable;\n      }\n      :host:focus {\n        text-overflow: inherit;\n        @apply --io_focus;\n      }\n      :host[hidden] {\n        display: none;\n      }\n      :host[disabled] {\n        opacity: 0.5;\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorInset) !important;\n        box-shadow: var(--io_shadowInset) !important;\n      }\n      :host span {\n        height: var(--io_lineHeight);\n        vertical-align: top;\n      }\n      :host[appearance=neutral] {\n        color: var(--io_color);\n        background-color: transparent;\n      }\n      :host[appearance=inset] {\n        color: var(--io_colorInput);\n        background-color: var(--io_bgColorInput);\n        border-color: var(--io_borderColorInset);\n        padding-top: calc(var(--io_spacing) + 0.05em);\n        padding-bottom: calc(var(--io_spacing) - 0.05em);\n        box-shadow: var(--io_shadowInset);\n      }\n      :host[appearance=outset] {\n        border-color: var(--io_borderColorOutset);\n        background-image: var(--io_gradientOutset);\n        box-shadow: var(--io_shadowOutset);\n      }\n      :host.red,\n      :host[invalid] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorRed);\n        border-color: var(--io_borderColorRed);\n      }\n      :host.green {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorGreen);\n        border-color: var(--io_borderColorGreen);\n      }\n      :host.blue,\n      :host[selected] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorBlue);\n        border-color: var(--io_borderColorBlue);\n      }\n    "}static get Listeners(){return{focus:"onFocus",pointerdown:"onPointerdown",touchstart:["onTouchstart",{passive:!1}],click:"onClick"}}constructor(args={}){super(args)}onFocus(event){this.addEventListener("blur",this.onBlur),this.addEventListener("keydown",this.onKeydown),this.addEventListener("keyup",this.onKeyup)}onBlur(event){this.removeEventListener("blur",this.onBlur),this.removeEventListener("keydown",this.onKeydown),this.removeEventListener("keyup",this.onKeyup)}onPointerdown(event){event.stopPropagation(),this.setPointerCapture(event.pointerId),this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerleave",this.onPointerleave),this.addEventListener("pointerup",this.onPointerup),this.addEventListener("pointercancel",this.onPointercancel),this.pressed=!0}onPointermove(event){event.stopPropagation()}onPointercancel(event){event.stopPropagation(),this.releasePointerCapture(event.pointerId),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.removeEventListener("pointercancel",this.onPointercancel),this.pressed=!1}onPointerleave(event){event.stopPropagation(),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.removeEventListener("pointercancel",this.onPointercancel),this.pressed=!1}onPointerup(event){event.stopPropagation(),this.releasePointerCapture(event.pointerId),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerleave",this.onPointerleave),this.removeEventListener("pointerup",this.onPointerup),this.removeEventListener("pointercancel",this.onPointercancel),this.pressed=!1}onTouchstart(event){event.stopPropagation(),this.addEventListener("touchmove",this.onTouchmove,{passive:!1}),this.addEventListener("touchend",this.onTouchend),this.focus()}onTouchmove(event){event.stopPropagation()}onTouchend(event){event.stopPropagation(),this.removeEventListener("touchmove",this.onTouchmove),this.removeEventListener("touchend",this.onTouchend)}inputValue(value){if(this.value!==value||"object"==typeof this.value){const oldValue=this.value;this.setProperty("value",value),this.dispatch("value-input",{value:value,oldValue:oldValue},!1)}}onClick(event){}onKeydown(event){switch(event.key){case"Enter":case" ":event.preventDefault(),this.onClick();break;default:["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Home","End","PageUp","PageDown"].includes(event.key)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0))}}onKeyup(event){}getCaretPosition(){let position=0;const selection=window.getSelection();if(selection&&selection.rangeCount){const range=selection.getRangeAt(0),selected=range.toString().length,preCaretRange=range.cloneRange();preCaretRange.selectNodeContents(this),preCaretRange.setEnd(range.endContainer,range.endOffset),position=preCaretRange.toString().length-selected}return position}setCaretPosition(position=0){const selection=window.getSelection();this._flattenTextNode(this);const textNode=this._textNode;if(selection){const range=document.createRange();range.setStart(textNode,Math.max(0,Math.min(position,textNode.length))),range.collapse(!0),selection.removeAllRanges(),selection.addRange(range)}}selectAll(){const selection=window.getSelection();this._flattenTextNode(this);const textNode=this._textNode;if(selection&&textNode){const range=document.createRange();range.selectNodeContents(textNode),selection.removeAllRanges(),selection.addRange(range)}}labelChanged(){this.label?this.setAttribute("aria-label",this.label):this.removeAttribute("aria-label")}selectedChanged(){this.selected?this.setAttribute("aria-selected","true"):this.removeAttribute("aria-selected")}invalidChanged(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")}disabledChanged(){this.inert=this.disabled,this.disabled?this.setAttribute("aria-disabled","true"):this.removeAttribute("aria-disabled")}changed(){this.render([this.icon?ioIcon({value:this.icon}):null,void 0!==this.value?span(String(this.value)):null])}};__decorateClass$7([ReactiveProperty({value:""})],IoField.prototype,"value",2),__decorateClass$7([ReactiveProperty({type:String,value:""})],IoField.prototype,"icon",2),__decorateClass$7([ReactiveProperty({type:String,value:"",reflect:!0})],IoField.prototype,"label",2),__decorateClass$7([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoField.prototype,"selected",2),__decorateClass$7([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoField.prototype,"invalid",2),__decorateClass$7([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoField.prototype,"disabled",2),__decorateClass$7([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoField.prototype,"pressed",2),__decorateClass$7([ReactiveProperty({value:"neutral",reflect:!0})],IoField.prototype,"appearance",2),__decorateClass$7([ReactiveProperty({value:"",type:String,reflect:!0})],IoField.prototype,"pattern",2),__decorateClass$7([Property(!1)],IoField.prototype,"spellcheck",2),__decorateClass$7([Property(0)],IoField.prototype,"tabIndex",2),IoField=__decorateClass$7([Register],IoField);const ioField=function(arg0){return IoField.vConstructor(arg0)};var __defProp$5=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$6(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$5(target,key,result),result};let IoBoolean=class extends IoField{static get Style(){return"\n      :host {\n        padding: var(--io_spacing);\n      }\n    "}constructor(args={}){super(args)}onClick(){this.toggle(),this.dispatch("io-boolean-clicked",{value:this.value},!0)}toggle(){this.inputValue(!this.value)}ready(){this.valueChanged(),this.changed()}valueChanged(){this.invalid="boolean"!=typeof this.value,this.setAttribute("aria-checked",String(!!this.value))}changed(){const value=this.value?this.true:this.false;this.render([this.icon?ioIcon({value:this.icon}):null,value?value.startsWith("io:")?ioIcon({value:value}):span(value):null])}};__decorateClass$6([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoBoolean.prototype,"value",2),__decorateClass$6([ReactiveProperty({value:"true",type:String})],IoBoolean.prototype,"true",2),__decorateClass$6([ReactiveProperty({value:"false",type:String})],IoBoolean.prototype,"false",2),__decorateClass$6([Property("checkbox")],IoBoolean.prototype,"role",2),IoBoolean=__decorateClass$6([Register],IoBoolean);const ioBoolean=function(arg0){return IoBoolean.vConstructor(arg0)};var __defProp$4=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$5(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$4(target,key,result),result};let IoButton=class extends IoField{static get Style(){return"\n      :host {\n        text-align: center;\n        color: var(--io_colorStrong);\n      }\n      :host > io-icon {\n        margin-right: var(--io_spacing);\n      }\n      :host > span {\n        vertical-align: top;\n      }\n    "}constructor(args={}){super(args)}onPointerdown(event){event.preventDefault(),super.onPointerdown(event)}onKeydown(event){super.onKeydown(event),"Enter"!==event.key&&" "!==event.key||(this.pressed=!0)}onKeyup(event){super.onKeyup(event),this.pressed=!1}onClick(event){"function"==typeof this.action&&this.action(this.value),this.dispatch("io-button-clicked",{value:this.value},!0)}ready(){this.changed()}changed(){this.setAttribute("aria-pressed",String(this.pressed)),this.render([this.icon?ioIcon({value:this.icon}):null,this.label?span(this.label):null])}};__decorateClass$5([ReactiveProperty({value:void 0})],IoButton.prototype,"value",2),__decorateClass$5([ReactiveProperty()],IoButton.prototype,"action",2),__decorateClass$5([ReactiveProperty({value:"outset",type:String,reflect:!0})],IoButton.prototype,"appearance",2),__decorateClass$5([Property("button")],IoButton.prototype,"role",2),IoButton=__decorateClass$5([Register],IoButton);const ioButton=function(arg0){return IoButton.vConstructor(arg0)};var __defProp$3=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$4(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$3(target,key,result),result};let IoNumberLadderStep=class extends IoField{static get Style(){return"\n      :host {\n        pointer-events: all;\n        display: inline-block;\n        cursor: ew-resize;\n        text-align: center;\n        background-color: var(--io_bgColorStrong) !important;\n        color: var(--io_color);\n        align-self: stretch;\n        touch-action: none;\n        width: 6em;\n      }\n      :host:focus {\n        background-color: var(--io_bgColor) !important;\n      }\n      /* TODO: use icons */\n      :host:before {\n        float: left;\n        content: '<';\n        opacity: 0.25;\n      }\n      :host:after {\n        float: right;\n        content: '>';\n        opacity: 0.25;\n      }\n    "}constructor(args){super(args)}onKeydown(event){let stepMove=0;switch(event.key){case"Enter":case"Escape":case" ":this.dispatch("ladder-step-collapse",{},!0);break;case"ArrowLeft":case"Backspace":event.preventDefault(),stepMove=-1*this.value;break;case"ArrowUp":case"ArrowDown":event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0);break;case"ArrowRight":event.preventDefault(),stepMove=1*this.value}0!==stepMove&&this.dispatch("ladder-step-change",{step:Number(stepMove.toFixed(5)),round:event.shiftKey},!0)}onPointerdown(event){this.setPointerCapture(event.pointerId),this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerup",this.onPointerup),this.startX=event.clientX}onPointermove(event){const deltaX=event.clientX-this.startX;if(Math.abs(deltaX)>5){const expMove=Math.pow(deltaX/5,2)*deltaX<0?-1:1,roundMove=deltaX>0?Math.floor(expMove):Math.ceil(expMove),stepMove=this.value*roundMove;this.startX=event.clientX,this.dispatch("ladder-step-change",{step:Number(stepMove.toFixed(5)),round:event.shiftKey},!0)}}onPointerup(event){this.releasePointerCapture(event.pointerId),this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerup",this.onPointerup),this.dispatch("ladder-step-collapse",{},!0)}ready(){this.changed()}changed(){this.render([span(this.label)]),this.setAttribute("aria-label",this.label),this.setAttribute("aria-valuestep",this.label)}};__decorateClass$4([ReactiveProperty({value:1,type:Number})],IoNumberLadderStep.prototype,"value",2),__decorateClass$4([ReactiveProperty({value:"",type:String})],IoNumberLadderStep.prototype,"label",2),__decorateClass$4([Property("spinbutton")],IoNumberLadderStep.prototype,"role",2),IoNumberLadderStep=__decorateClass$4([Register],IoNumberLadderStep);const ioNumberLadderStep=function(arg0){return IoNumberLadderStep.vConstructor(arg0)};var __defProp$2=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$3(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$2(target,key,result),result};let IoNumberLadder=class extends IoElement{static get Style(){return"\n      :host {\n        display: flex;\n        flex-direction: column;\n        position: absolute;\n        pointer-events: none;\n        box-shadow: unset;\n        @apply --unselectable;\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n      }\n      :host > io-number-ladder-step {\n        box-shadow: var(--io_shadow);\n      }\n      :host > .io-up1,\n      :host > .io-up2,\n      :host > .io-up3,\n      :host > .io-up4 {\n        margin-bottom: var(--io_borderWidth);\n        box-shadow: 0px -2px 6px var(--io_shadowColor), 0 -1px 3px var(--io_shadowColor);\n      }\n      :host > .io-down1,\n      :host > .io-down2,\n      :host > .io-down3,\n      :host > .io-down4 {\n        margin-top: var(--io_borderWidth);\n        box-shadow: 0px 2px 6px var(--io_shadowColor), 0 1px 3px var(--io_shadowColor);\n      }\n      :host > .io-up1,\n      :host > .io-down1{\n        z-index: 4;\n      }\n      :host > .io-up2,\n      :host > .io-down2 {\n        z-index: 3;\n      }\n      :host > .io-up3,\n      :host > .io-down3 {\n        z-index: 2;\n      }\n      :host > .io-up4,\n      :host > .io-down4 {\n        z-index: 1;\n      }\n      :host > io-number-ladder-step:focus {\n        background-color: var(--io_bgColorStrong);\n        border-color: var(--io_colorBlue);\n      }\n      :host > .io-number-ladder-empty {\n        height: var(--io_fieldHeight);\n      }\n      :host > .io-number-ladder-center {\n        height: calc(1.5 * var(--io_fieldHeight));\n      }\n    "}static get Listeners(){return{"ladder-step-change":"_onLadderStepChange","ladder-step-collapse":"onLadderStepCollapse","io-focus-to":"onIoFocusTo"}}get value(){return this.src?this.src.value:0}get min(){return this.src?this.src.min:-Infinity}get max(){return this.src?this.src.max:Infinity}get step(){return this.src?this.src.step:1e-4}get conversion(){return this.src?this.src.conversion:1}constructor(args={}){super(args)}onIoFocusTo(event){const source=event.detail.source,command=event.detail.command;this.src&&("ArrowDown"===command&&source===this.querySelector(".io-up1")||"ArrowUp"===command&&source===this.querySelector(".io-down1"))&&(event.stopPropagation(),this.src.focus(),this.src.setCaretPosition(this.src.textNode.length))}_onLadderStepChange(event){const src=this.src;if(src){const step=event.detail.step,value=event.detail.round?Math.round(this.value/step)*step:this.value;let newValue=Math.min(this.max,Math.max(this.min,value+step));newValue=Number(newValue.toFixed(5)),src.inputValue(newValue)}}onLadderStepCollapse(){this.setProperty("expanded",!1)}expandedChanged(){if(this.expanded){if(this.src){const rect=this.src.getBoundingClientRect(),selfRect=this.getBoundingClientRect(),layerRect=IoOverlaySingleton.getBoundingClientRect();this.style.top=rect.bottom-layerRect.top+"px",this.style.left=rect.left-layerRect.left+"px",this.style.marginTop=-(selfRect.height/2+ThemeSingleton.lineHeight/2+ThemeSingleton.spacing)+"px"}}else setTimeout(()=>{this.src?.setCaretPosition(this.src.textNode.length)}),this.removeAttribute("style");this.dispatch("expanded",{value:this.expanded},!0)}changed(){const range=this.max-this.min,hiddenItem=span({class:"io-number-ladder-empty"});let step=this.step/1e4;for(;step<.1;)step*=10;const upStep4=1e4*step,upStep3=1e3*step,upStep2=100*step,upStep1=10*step,downStep1=1*step,downStep2=.1*step,downStep3=.01*step,downStep4=.001*step,upLabel4=Number((upStep4*this.conversion).toFixed(6)),upLabel3=Number((upStep3*this.conversion).toFixed(6)),upLabel2=Number((upStep2*this.conversion).toFixed(6)),upLabel1=Number((upStep1*this.conversion).toFixed(6)),downLabel1=Number((downStep1*this.conversion).toFixed(6)),downLabel2=Number((downStep2*this.conversion).toFixed(6)),downLabel3=Number((downStep3*this.conversion).toFixed(6)),downLabel4=Number((downStep4*this.conversion).toFixed(6));this.render([range>=upStep4?ioNumberLadderStep({class:"io-up4",value:upStep4,label:String(upLabel4)}):hiddenItem,range>=upStep3?ioNumberLadderStep({class:"io-up3",value:upStep3,label:String(upLabel3)}):hiddenItem,range>=upStep2?ioNumberLadderStep({class:"io-up2",value:upStep2,label:String(upLabel2)}):hiddenItem,range>=upStep1?ioNumberLadderStep({class:"io-up1",value:upStep1,label:String(upLabel1)}):hiddenItem,span({class:"io-number-ladder-center"}),this.step<=downStep1?ioNumberLadderStep({class:"io-down1",value:downStep1,label:String(downLabel1)}):hiddenItem,this.step<=downStep2?ioNumberLadderStep({class:"io-down2",value:downStep2,label:String(downLabel2)}):hiddenItem,this.step<=downStep3?ioNumberLadderStep({class:"io-down3",value:downStep3,label:String(downLabel3)}):hiddenItem,this.step<=downStep4?ioNumberLadderStep({class:"io-down4",value:downStep4,label:String(downLabel4)}):hiddenItem]),this.setAttribute("aria-valuemin",this.min),this.setAttribute("aria-valuemax",this.max),this.setAttribute("aria-valuenow",this.value),this.setAttribute("aria-valuestep",this.step),this.setAttribute("aria-invalid",!("number"==typeof this.value&&!isNaN(this.value))&&"true");const steps=this.querySelectorAll("io-number-ladder-step");for(let i=steps.length;i--;)steps[i].setAttribute("aria-valuemin",String(this.min)),steps[i].setAttribute("aria-valuemax",String(this.max)),steps[i].setAttribute("aria-valuenow",String(this.value)),steps[i].changed()}};__decorateClass$3([ReactiveProperty({value:void 0,type:IoElement,init:null})],IoNumberLadder.prototype,"src",2),__decorateClass$3([ReactiveProperty({value:!1,type:Boolean,reflect:!0})],IoNumberLadder.prototype,"expanded",2),__decorateClass$3([Property("listbox")],IoNumberLadder.prototype,"role",2),IoNumberLadder=__decorateClass$3([Register],IoNumberLadder);const IoNumberLadderSingleton=new IoNumberLadder;setTimeout(()=>{IoOverlaySingleton.appendChild(IoNumberLadderSingleton)},100);var __defProp$1=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$2(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp$1(target,key,result),result};let IoNumber=class extends IoField{static get Style(){return"\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        font-family: monospace;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorInput);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n    "}constructor(args={}){super(args)}get textNode(){return this._flattenTextNode(this),this._textNode.nodeValue}set textNode(value){this._flattenTextNode(this),this._textNode.nodeValue=String(value)}onBlur(event){super.onBlur(event),this._setFromTextNode(),this.scrollTop=0,this.scrollLeft=0,setTimeout(()=>{document.activeElement.parentElement!==IoNumberLadderSingleton&&(IoNumberLadderSingleton.expanded=!1)})}onPointerdown(event){this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerup",this.onPointerup),document.activeElement!==this||event.button}onPointerup(event){this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerup",this.onPointerup),this.ladder||1===event.button?("touch"===event.pointerType?(event.preventDefault(),document.activeElement.blur()):document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length)),this.expandLadder()):document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length))}expandLadder(){IoNumberLadderSingleton.src=this,IoNumberLadderSingleton.expanded=!0}collapseLadder(){IoNumberLadderSingleton.expanded=!1}onKeydown(event){const range=window.getSelection().getRangeAt(0),rangeStart=range.startOffset,rangeEnd=range.endOffset,length=this.childNodes[0]?this.childNodes[0].length:0,rangeInside=range.startContainer===range.endContainer&&(range.startContainer===this.childNodes[0]||range.startContainer===this);switch(event.key){case"Escape":case"Enter":case" ":event.preventDefault(),this._setFromTextNode(),function isMobileDevice(){return/Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)||"ontouchstart"in window&&!window.matchMedia("(pointer: fine)").matches}()&&this.blur();break;case"Home":event.preventDefault(),this.textNode=String(this.min),this._setFromTextNode();break;case"End":event.preventDefault(),this.textNode=String(this.max),this._setFromTextNode();break;case"ArrowLeft":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&0===rangeStart)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0));break;case"ArrowUp":if(IoNumberLadderSingleton.expanded){event.preventDefault();const upStep=IoNumberLadderSingleton.querySelector(".io-up1");upStep&&upStep.focus()}else(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&0===rangeStart)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0));break;case"ArrowRight":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&rangeStart===length)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0));break;case"ArrowDown":if(IoNumberLadderSingleton.expanded){event.preventDefault();const downStep=IoNumberLadderSingleton.querySelector(".io-down1");downStep&&downStep.focus()}else(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&rangeStart===length)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0))}}onKeyup(event){if("Control"===event.key||"Shift"===event.key?IoNumberLadderSingleton.expanded?this.collapseLadder():this.expandLadder():"Escape"!==event.key&&"Enter"!==event.key&&" "!==event.key||this.collapseLadder(),this.live){const carretPosition=this.getCaretPosition();this._setFromTextNode(),this.setCaretPosition(carretPosition)}}_setFromTextNode(){const valueText=this.textNode.trim().replace(",",".");let valueNumber=Number(valueText)/this.conversion;valueNumber=Math.min(this.max,Math.max(this.min,valueNumber)),valueNumber=Math.round(valueNumber/this.step)*this.step;const d=Math.max(0,Math.min(100,-Math.floor(Math.log(this.step)/Math.LN10)));valueNumber=Number(valueNumber.toFixed(d)),isNaN(valueNumber)?(this._reactiveProperties.get("invalid").value=!0,this.setAttribute("invalid","true"),this.setAttribute("aria-invalid","true")):(this._reactiveProperties.get("invalid").value=!1,this.removeAttribute("invalid"),this.removeAttribute("aria-invalid"),this.inputValue(valueNumber))}ready(){this.disabledChanged(),this.changed()}changed(){this.setAttribute("aria-valuenow",this.value),this.setAttribute("aria-valuemin",this.min),this.setAttribute("aria-valuemax",this.max),this.setAttribute("aria-valuestep",this.step),"number"!=typeof this.value||isNaN(this.value)?(this.setAttribute("invalid","true"),this.setAttribute("aria-invalid","true")):(this.removeAttribute("invalid"),this.removeAttribute("aria-invalid"));let valueText,value=this.value;if("number"!=typeof value||isNaN(value))valueText="NaN";else{value*=this.conversion;let d=-Math.floor(Math.log(this.step*this.conversion)/Math.LN10);d=Math.max(0,Math.min(100,d)),value=Number(value.toFixed(d)),valueText=String(value)}this.setAttribute("value",valueText),this.setAttribute("positive",this.value>=0),this.textNode=valueText}};__decorateClass$2([ReactiveProperty({value:0,type:Number})],IoNumber.prototype,"value",2),__decorateClass$2([ReactiveProperty({value:!1,type:Boolean})],IoNumber.prototype,"live",2),__decorateClass$2([ReactiveProperty({value:1,type:Number})],IoNumber.prototype,"conversion",2),__decorateClass$2([ReactiveProperty({value:1e-4,type:Number})],IoNumber.prototype,"step",2),__decorateClass$2([ReactiveProperty({value:-Infinity,type:Number})],IoNumber.prototype,"min",2),__decorateClass$2([ReactiveProperty({value:Infinity,type:Number})],IoNumber.prototype,"max",2),__decorateClass$2([ReactiveProperty({value:!1,type:Boolean})],IoNumber.prototype,"ladder",2),__decorateClass$2([ReactiveProperty({value:"inset",type:String,reflect:!0})],IoNumber.prototype,"appearance",2),__decorateClass$2([Property("true")],IoNumber.prototype,"contentEditable",2),__decorateClass$2([ReactiveProperty({value:'pattern="-?[0-9]*?[0-9]*"',type:String,reflect:!0})],IoNumber.prototype,"pattern",2),__decorateClass$2([Property("text")],IoNumber.prototype,"inputMode",2),__decorateClass$2([Property("textbox")],IoNumber.prototype,"role",2),IoNumber=__decorateClass$2([Register],IoNumber);const ioNumber=function(arg0){return IoNumber.vConstructor(arg0)};var __defProp=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc$1(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp(target,key,result),result};let IoString=class extends IoField{static get Style(){return"\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorInput);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n    "}constructor(args={}){super(args)}onPointerdown(event){this.addEventListener("pointermove",this.onPointermove),this.addEventListener("pointerup",this.onPointerup),document.activeElement!==this||event.button}onPointerup(event){this.removeEventListener("pointermove",this.onPointermove),this.removeEventListener("pointerup",this.onPointerup),document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length))}get textNode(){return this._flattenTextNode(this),this._textNode.nodeValue}set textNode(value){this._flattenTextNode(this),this._textNode.nodeValue=String(value)}_setFromTextNode(){const textNode=this.textNode;"string"==typeof this.value&&textNode!==String(this.value)&&this.inputValue(textNode)}_setObjectFromTextNodeJSON(){const textNode=this.textNode;try{const value=JSON.parse(textNode.replace(/[\t\n\r ]+/g," "));this.inputValue(value)}catch(error){console.warn("IoString: Cannot parse value",textNode),console.error(error),this._setFromTextNode()}}onBlur(event){super.onBlur(event),this._setFromTextNode(),this.scrollTop=0,this.scrollLeft=0}onKeydown(event){const range=window.getSelection().getRangeAt(0),rangeStart=range.startOffset,rangeEnd=range.endOffset,length=this.childNodes[0]?this.childNodes[0].length:0,rangeInside=range.startContainer===range.endContainer&&(range.startContainer===this.childNodes[0]||range.startContainer===this);switch(event.key){case"Enter":event.preventDefault(),event.shiftKey?this._setObjectFromTextNodeJSON():this._setFromTextNode();break;case"ArrowLeft":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&0===rangeStart)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:"ArrowLeft"},!0));break;case"ArrowUp":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&0===rangeStart)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:"ArrowUp"},!0));break;case"ArrowRight":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&rangeStart===length)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:"ArrowRight"},!0));break;case"ArrowDown":(event.ctrlKey||rangeInside&&rangeStart===rangeEnd&&rangeStart===length)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:"ArrowDown"},!0));break;default:["Tab","Home","End","PageUp","PageDown"].includes(event.key)&&(event.preventDefault(),this.dispatch("io-focus-to",{source:this,command:event.key},!0))}}onKeyup(event){if(super.onKeyup(event),this.live){const carretPosition=this.getCaretPosition();this._setFromTextNode(),this.setCaretPosition(carretPosition)}}ready(){this.disabledChanged()}valueChanged(){this.invalid="string"!=typeof this.value&&null!==this.value&&void 0!==this.value}changed(){this.textNode=String(this.value||"")}};__decorateClass$1([ReactiveProperty({value:"",type:String})],IoString.prototype,"value",2),__decorateClass$1([ReactiveProperty({value:!1,type:Boolean})],IoString.prototype,"live",2),__decorateClass$1([ReactiveProperty({value:"",type:String,reflect:!0})],IoString.prototype,"placeholder",2),__decorateClass$1([ReactiveProperty({value:"inset",reflect:!0})],IoString.prototype,"appearance",2),__decorateClass$1([Property("true")],IoString.prototype,"contentEditable",2),__decorateClass$1([Property("textbox")],IoString.prototype,"role",2),IoString=__decorateClass$1([Register],IoString);const ioString=function(arg0){return IoString.vConstructor(arg0)};var __getOwnPropDesc=Object.getOwnPropertyDescriptor;let IoSwitch=class extends IoBoolean{static get Style(){return"\n      :host {\n        display: flex;\n        position: relative;\n        overflow: visible;\n        padding: var(--io_spacing) var(--io_spacing);\n      }\n      :host:focus {\n        outline: 0 !important;\n        border-color: transparent !important;\n      }\n      :host:focus > span:before {\n        @apply --io_focus;\n      }\n      :host[pressed] {\n        border-color: transparent !important;\n        box-shadow: none !important;\n      }\n      :host > span {\n        position: relative;\n        width: calc(1.5 * var(--io_fieldHeight));\n      }\n      :host > span:before {\n        content: '';\n        box-sizing: border-box;\n        position: absolute;\n        visibility: visible;\n        left: 0;\n        width: 100%;\n        height: var(--io_lineHeight);\n        border-radius: var(--io_lineHeight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorInset);\n        background-color: var(--io_bgColorInput);\n        box-shadow: var(--io_shadowInset);\n        transition: background-color 0.4s;\n      }\n      :host > span:after {\n        content: '';\n        box-sizing: border-box;\n        position: absolute;\n        visibility: visible;\n        top: var(--io_borderWidth);\n        left: var(--io_borderWidth);\n        height: calc(var(--io_lineHeight) - calc(2 * var(--io_borderWidth)));\n        width: calc(var(--io_lineHeight) - calc(2 * var(--io_borderWidth)));\n        background-color: var(--io_bgColorLight);\n        box-shadow: var(--io_shadowOutset);\n        border: var(--io_border);\n        border-color: var(--io_borderColorOutset);\n        border-radius: var(--io_lineHeight);\n        transition-timing-function: ease-in-out;\n        transition: left 0.25s;\n        z-index: 1;\n      }\n      :host[value] > span:after {\n        background-color: var(--io_bgColorBlue);\n        left: calc(100% - calc(var(--io_lineHeight) - var(--io_borderWidth)));\n      }\n    "}changed(){this.render([this.icon?ioIcon({value:this.icon}):null,span()])}};IoSwitch=((decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(result)||result);return result})([Register],IoSwitch);const ioSwitch=function(arg0){return IoSwitch.vConstructor(arg0)};export{IoBoolean,IoButton,IoField,IoNumber,IoNumberLadderSingleton,IoNumberLadderStep,IoString,IoSwitch,ioBoolean,ioButton,ioField,ioNumber,ioNumberLadderStep,ioString,ioSwitch};
//# sourceMappingURL=index.js.map
