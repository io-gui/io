import{ReactiveProperty as t,NodeArray as e,Node as o,Register as n,IoOverlaySingleton as i,Property as s,IoElement as r,nudge as l,span as a,Storage as p}from"@io-gui/core";import{ioIcon as h}from"@io-gui/icons";import{ioString as d,ioField as c,IoField as u,ioBoolean as v}from"@io-gui/inputs";var m=Object.defineProperty,g=Object.getOwnPropertyDescriptor,f=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?g(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&m(e,o,s),s};let y=class extends o{static get Listeners(){return{"option-selected-changed":"onOptionSelectedChanged"}}constructor(t){"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t&&null!=t||(t={id:String(t),value:t}),(t={...t}).id=t.id??"null",t.label=t.label??t.id,t.value=t.value??t.id,t.options=t.options??[],t.options=t.options.map(t=>t instanceof y?t:new y(t));const e=t.options.filter(t=>"select"===t.mode&&t.selected);for(let o=1;o<e.length;o++)console.warn('Duplicate selected options with mode "select" found!',e),e[o].selected=!1;super(t)}getAllOptions(){const t=[this];for(let e=0;e<this.options.length;e++)t.push(...this.options[e].getAllOptions());{const e=/* @__PURE__ */new Set;for(let o=0;o<t.length;o++)e.has(t[o].id)&&console.warn(`Duplicate id "${t[o].id}"`,this),e.add(t[o].id)}return t}findItemByValue(t){const e=this.getAllOptions();for(let o=0;o<e.length;o++)if(e[o].value===t)return e[o]}findItemById(t){const e=this.getAllOptions();for(let o=0;o<e.length;o++)if(e[o].id===t)return e[o]}selectDefault(){let t="select"===this.mode?this:void 0;for(;t;){const e=t.options.find(t=>"select"===t.mode);if("select"!==t.mode||!e)break;t=e}t&&(t.selected=!0)}selectedChanged(){!1===this.selected&&this.unselectSuboptions(),this.dispatch("option-selected-changed",{option:this},!0)}selectedIDChanged(){const t=this.findItemById(this.selectedID);t&&(t.selected=!0,this.dispatch("option-selected",{option:t},!1))}selectedIDImmediateChanged(){if(this.selectedIDImmediate){this.selected=!0;const t=this.options.find(t=>t.id===this.selectedIDImmediate);t&&(t.selected=!0)}this.updatePaths()}getSelectedIDImmediate(){let t="";for(let e=0;e<this.options.length;e++){const o=this.options[e];if(o.selected&&o.id&&"select"===o.mode){t=o.id;break}}return t}setSelectedIDImmediate(t){this.options.withInternalOperation(()=>{for(let e=0;e<this.options.length;e++){const o=this.options[e];o.id===t?o.selected=!0:o.selected=!1}}),this.options.dispatchMutation()}onOptionSelectedChanged(t){if(-1===this.options.indexOf(t.detail.option))return;if(t.detail.option===this)return;const e=t.detail.option;if(e.selected)for(let o=0;o<this.options.length;o++){const t=this.options[o];t!==e&&"select"===t.mode&&"select"===e.mode&&(t.selected=!1)}this.options.some(t=>t.selected&&"select"===t.mode)||this.setProperties({selectedID:"",selectedIDImmediate:"",path:""})}unselectSuboptions(){for(let t=0;t<this.options.length;t++){const e=this.options[t];"select"===e.mode&&(e.selected=!1,e.unselectSuboptions())}}updatePaths(){const t=[];if("select"!==this.mode||!this.selected)return void(this.path="");let e=this.getSelectedIDImmediate(),o=e?this.options.find(t=>"select"===t.mode&&t.selected&&t.id===e):void 0;if(o){for(;o;)t.push(o.id),e=o.getSelectedIDImmediate(),o=e?o.options.find(t=>"select"===t.mode&&t.selected&&t.id===e):void 0;this.path=t.join(",")}}pathChanged(){const t=this.path?[...this.path.split(",")]:[];t.length&&(this.selectedID=t[t.length-1])}optionsMutated(t){const e=this.getSelectedIDImmediate();"select"===this.mode&&e&&this.options.length&&this.setProperties({selectedIDImmediate:e}),this.updatePaths(),this.dispatchMutation()}toJSON(){return{id:this.id,value:this.value,label:this.label,icon:this.icon,hint:this.hint,disabled:this.disabled,mode:this.mode,options:this.options.map(t=>t.toJSON())}}fromJSON(t){return this.setProperties({id:t.id,value:t.value??void 0,label:t.label??t.id,icon:t.icon??"",hint:t.hint??"",disabled:t.disabled??!1,mode:t.mode??"select",selected:t.selected??!1,options:t.options?.map(t=>new y(t))??[]}),this}changed(){-1===["select","toggle","none"].indexOf(this.mode)&&console.warn(`Unknown "mode" property "${this.mode}"!`,this),this.selected&&-1===["select","toggle"].indexOf(this.mode)&&console.warn('"selected" property is only valid when mode is "select" or "toggle"!',this),this.id||console.warn('"id" property is required!',this),this.action&&"function"!=typeof this.action&&console.warn(`Invalid type "${typeof this.action}" of "action" property!`,this)}dispose(){this.options.length=0,super.dispose()}};f([t({value:"",type:String})],y.prototype,"id",2),f([t({value:void 0})],y.prototype,"value",2),f([t({value:"",type:String})],y.prototype,"label",2),f([t({value:"",type:String})],y.prototype,"icon",2),f([t({value:"",type:String})],y.prototype,"hint",2),f([t({value:!1,type:Boolean})],y.prototype,"disabled",2),f([t()],y.prototype,"action",2),f([t({value:"select",type:String})],y.prototype,"mode",2),f([t({value:!1,type:Boolean})],y.prototype,"selected",2),f([t({value:"",type:String})],y.prototype,"selectedIDImmediate",2),f([t({value:"",type:String})],y.prototype,"selectedID",2),f([t({value:"",type:String})],y.prototype,"path",2),f([t({type:e,init:"this"})],y.prototype,"options",2),y=f([n],y);const b=["io-menu-item","io-menu-options","io-menu-hamburger","io-option-select","io-string","io-menu-tree"],x=b.join(", ");function w(t){const e=[];if(t.$options){e.push(t.$options);const o=t.$options.querySelectorAll(x);for(let t=o.length;t--;)e.push(o[t]),e.push(...w(o[t]))}else{const o=Array.from(t.querySelectorAll(x));for(let t=o.length;t--;)e.push(o[t]),e.push(...w(o[t]))}return e}function C(t){const e=[];let o=t;for(;o&&o.$parent;)o=o.$parent,o&&e.push(o);return e}function O(t){const e=[],o=t.parentElement;return o&&e.push(...Array.from(o.querySelectorAll(x))),e}function P(t){let e=t;for(;e&&e.$parent;)e=e.$parent;return e}function E(t,e){if(-1!==b.indexOf(e.localName)&&!e.disabled&&e.parentElement!==i&&e.parentElement.expanded){const o=e.getBoundingClientRect(),n=t.clientX,i=t.clientY;return o.top<=i&&o.bottom>=i&&o.left<=n&&o.right>=n}return!1}function $(t,e){return!t.options.length&&(void 0!==t.value&&-1!==String(t.value).toLowerCase().indexOf(e)||(!(!t.label||-1===t.label.toLowerCase().indexOf(e))||!(!t.hint||-1===t.hint.toLowerCase().indexOf(e))))}function I(t,e,o=5,n=0){e=e.toLowerCase();const i=[];if(n<=o)for(let s=0;s<t.options.length;s++)$(t.options[s],e)&&i.push(t.options[s]),t.options[s].options.length&&i.push(...I(t.options[s],e,o,n+1));return i}var _=Object.defineProperty,S=Object.getOwnPropertyDescriptor,k=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?S(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&_(e,o,s),s};let D=class extends r{static get Style(){return"\n    :host {\n      display: flex;\n      flex-direction: column;\n      align-self: flex-start;\n      border: var(--io_border);\n      border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n      border-color: var(--io_borderColorOutset);\n      background-color: var(--io_bgColorLight);\n      padding: calc(var(--io_spacing) + var(--io_borderWidth));\n      transition: opacity 0.3s ease-in-out;\n      @apply --unselectable;\n    }\n    :host[horizontal] {\n      padding: var(--io_spacing) 0;\n      flex-direction: row;\n      align-self: stretch;\n    }\n    :host[inoverlay] {\n      overflow-y: auto;\n      box-shadow: 1px 1px 16px var(--io_shadowColor),\n                  1px 1px 8px var(--io_shadowColor), \n                  1px 1px 4px var(--io_shadowColor);\n    }\n    :host[inoverlay]:not([expanded]) {\n      visibility: hidden;\n      opacity: 0;\n    }\n    :host > io-menu-item[hidden] ~ span.divider {\n      display: none;\n    }\n    :host > span.divider {\n      flex: 0 0 0;\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      margin: var(--io_spacing) 0;\n      opacity: 0.1;\n    }\n    :host[horizontal] > span.divider {\n      margin: 0 var(--io_spacing);\n    }\n    :host[horizontal] > io-menu-item > .hint {\n      display: none;\n    }\n    :host:not([horizontal]) > #search {\n      margin: var(--io_spacing);\n      margin-top: 0;\n    }\n    :host[horizontal] > #search {\n      margin: 0 var(--io_spacing);\n      flex: 0 0 10em;\n    }\n    "}static get Listeners(){return{touchstart:["stopPropagation"],"io-focus-to":"onIoFocusTo"}}get inoverlay(){return i.contains(this.parentElement)}constructor(t={}){super(t)}stopPropagation(t){this.inoverlay&&t.stopPropagation()}connectedCallback(){super.connectedCallback(),this.inoverlay&&this.setAttribute("inoverlay","true")}onIoFocusTo(t){const e=t.detail.source,o=t.detail.command,n=O(e),i=n.indexOf(e),s=this.inoverlay;let r=!1,l=!1,a=!1,p=!1;if(this.$parent){const t=this.getBoundingClientRect(),e=this.$parent.getBoundingClientRect();r=t.top>e.top,l=t.bottom<e.bottom,a=t.left>e.left,p=t.right<e.right}let h="";this.horizontal?("ArrowRight"===o&&s&&(h="Next"),"ArrowLeft"===o&&s&&(h="Prev"),"ArrowUp"===o&&r&&(h="Out"),"ArrowDown"===o&&l&&(h="Out")):("ArrowDown"===o&&s&&(h="Next"),"ArrowUp"===o&&s&&(h="Prev"),"ArrowLeft"===o&&a&&(h="Out"),"ArrowRight"===o&&p&&(h="Out")),"Tab"===o&&s&&(h="Next"),h&&("Next"===h?n[(i+1)%n.length].focus():"Prev"===h?n[(i-1+n.length)%n.length].focus():"Out"===h&&this.$parent&&this.$parent.focus(),t.stopPropagation())}collapse(){const t=this.contains(document.activeElement),e=this.searchable&&!!this.search;w(this).forEach(t=>{t.expanded=!1}),this.expanded=!1,e&&t&&!this.inoverlay&&(this.search="",this.$.search.focus())}expandedChanged(){this.expanded?this.inoverlay&&this.debounce(this.onExpandInOverlay):(this.style.top="",this.style.height="",this.scrollTop=0,this.search="")}searchChanged(){this.inoverlay&&this.$parent&&this.debounce(this.onExpandInOverlay)}onExpandInOverlay(){this.$parent&&l(this,this.$parent,this.direction,!0)}changed(){const t=this.widget?[this.widget]:[];if(this.searchable&&t.push(d({id:"search",role:"search",value:this.bind("search"),placeholder:"Search",live:!0})),this.search){const e=I(this.option,this.search,this.depth);if(0===e.length)t.push(c({label:"No matches"}));else for(let o=0;o<e.length;o++)t.push(F({option:e[o],depth:0})),o<e.length-1&&t.push({tag:"span",props:{class:"divider"}})}else{let e=this.horizontal?"down":"right";this.horizontal&&"up"===this.direction&&(e="up");for(let o=0;o<this.option.options.length;o++)t.push(F({option:this.option.options[o],direction:e,$parent:this,depth:this.depth})),o<this.option.options.length-1&&t.push(a({class:"divider"}))}this.render(t)}};k([t({type:y})],D.prototype,"option",2),k([t({value:!1,reflect:!0})],D.prototype,"expanded",2),k([t({value:!1,reflect:!0})],D.prototype,"horizontal",2),k([t(!1)],D.prototype,"searchable",2),k([t("")],D.prototype,"search",2),k([t({value:"none",reflect:!0})],D.prototype,"direction",2),k([t(100)],D.prototype,"depth",2),k([t({value:"",reflect:!0})],D.prototype,"overflow",2),k([t(null)],D.prototype,"widget",2),k([s()],D.prototype,"$parent",2),k([s("listbox")],D.prototype,"role",2),D=k([n],D);const L=function(t){return D.vConstructor(t)};var B=Object.defineProperty,A=Object.getOwnPropertyDescriptor,j=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?A(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&B(e,o,s),s};let R,N,T;function z(t){N=void 0,T=void 0}function M(t){if(clearTimeout(R),N=function(t){const e=Array.from(i.querySelectorAll("io-menu-item, io-menu-options")),o=[];if(i.expanded)for(let n=e.length;n--;)E(t,e[n])&&o.push(e[n]);if(o.length){o.sort((t,e)=>t.depth>e.depth?1:t.depth<e.depth?-1:"io-menu-item"===t.localName?1:"io-menu-item"===e.localName?-1:0);const t=o[0],e=o[1];if("io-menu-item"===t.localName)return t;if("io-menu-options"===t.localName&&e&&"io-menu-item"===e.localName&&e.depth===t.depth)return e}}(t),N&&N!==T){const e=Math.abs(t.movementY)-Math.abs(t.movementX),o=N.parentElement?.horizontal;T?.parentElement!==N.parentElement||(o?e<-.25:e>.25)?(T=N,N.focus()):R=setTimeout(()=>{T=N,N&&N.focus()},250)}}function V(t){N&&N.onClick()}i.addEventListener("pointermove",M);let q=class extends u{static get Style(){return"\n      :host > * {\n        pointer-events: none;\n        text-overflow: ellipsis;\n      }\n      :host > .label {\n        flex: 1 1 auto;\n        padding: 0 var(--io_spacing2);\n      }\n      :host > .hint {\n        flex: 0 1 auto;\n        opacity: 0.25;\n        padding: 0 var(--io_spacing2);\n      }\n      :host > .hasmore {\n        opacity: 0.5;\n      }\n    "}static get Listeners(){return{click:"preventDefault",focus:"onFocus",blur:"onBlur"}}constructor(t={}){super(t)}preventDefault(t){t.stopPropagation(),t.preventDefault()}get hasmore(){return this.option.options.length&&this.depth>0}get inoverlay(){return i.contains(this.parentElement?.parentElement)}connectedCallback(){super.connectedCallback(),this.$options&&i.appendChild(this.$options)}disconnectedCallback(){super.disconnectedCallback(),this.$options&&i.removeChild(this.$options)}onClick(){const t=this.option;this.hasmore?this.expanded||(this.expanded=!0):"toggle"===t.mode?t.selected=!t.selected:(t.action&&(t.action.apply(null,[t.value]),this.collapseRoot()),"select"===t.mode&&(t.options.length&&this.depth<=0?t.selectDefault():t.selected=!0,this.collapseRoot())),P(this).dispatch("io-menu-option-clicked",{option:t},!0)}onPointerdown(t){super.onPointerdown(t),"touch"!==t.pointerType&&(this.setPointerCapture(t.pointerId),t.stopPropagation(),this.hasmore&&(this.expanded=!0),z.call(this,t))}onPointermove(t){t.stopPropagation(),"touch"!==t.pointerType&&M.call(this,t)}onPointerup(t){super.onPointerup(t),t.stopPropagation(),this.onPointerupAction(t)}onPointerupAction(t){this.onClick()}onFocus(t){super.onFocus(t),this.hasmore&&this.inoverlay&&(this.expanded=!0);const e=w(P(this)),o=C(this);for(let n=e.length;n--;)e[n]!==this&&e[n]!==this.$options&&-1===o.indexOf(e[n])&&e[n].expanded&&e[n].collapse()}onBlur(t){super.onBlur(t),this.debounce(this.onBlurDebounced)}onBlurDebounced(){if(this._disposed)return;const t=w(this),e=O(this),o=C(this),n=t.some(t=>t===document.activeElement),s=e.some(t=>t===document.activeElement),r=o.some(t=>t===document.activeElement),l=document.activeElement===document.body,a=!i.contains(document.activeElement);n||l||(r||s?this.collapse():a&&this.collapseRoot())}onKeydown(t){const e=this.inoverlay;let o=this.direction,n=!1,i=!1,s=!1,r=!1;if(this.expanded&&this.$options){const t=this.getBoundingClientRect(),e=this.$options.getBoundingClientRect();n=t.top>e.top,i=t.bottom<e.bottom,s=t.left>e.left,r=t.right<e.right}"up"===o&&i&&(o="down"),"down"===o&&n&&(o="up"),"left"===o&&r&&(o="right"),"right"===o&&s&&(o="left");let l=null;if("Enter"===t.key||" "===t.key){if(!this.hasmore)return t.preventDefault(),void this.onClick();l="In"}else"Backspace"===t.key?l="Out":"Escape"===t.key?l="Collapse":"ArrowLeft"===t.key&&(e||this.expanded)?this.hasmore&&"left"===o?l="In":"right"===o&&(l="Out"):"ArrowRight"===t.key&&(e||this.expanded)?this.hasmore&&"right"===o?l="In":"left"===o&&(l="Out"):"ArrowUp"===t.key&&(e||this.expanded)?this.hasmore&&"up"===o?l="In":"down"===o&&(l="Out"):"ArrowDown"===t.key&&(e||this.expanded)&&(this.hasmore&&"down"===o?l="In":"up"===o&&(l="Out"));if(l)switch(t.preventDefault(),l){case"Collapse":this.collapseRoot();break;case"In":if(this.hasmore&&(this.expanded=!0),this.$options&&this.$options.children.length){const t=this.$options.querySelector("[selected]");t?t.focus():this.$options.children[0].focus()}break;case"Out":this.$parent&&this.$parent.$parent&&(this.$parent.$parent.focus(),this.$parent.$parent.collapse())}else super.onKeydown(t)}collapse(){w(this).forEach(t=>{t.expanded=!1}),this.expanded=!1}collapseRoot(){P(this).collapse()}optionChanged(){this.setProperties({selected:this.option.selected,disabled:this.option.disabled}),this.initOptions()}optionMutated(){this.setProperties({selected:this.option.selected,disabled:this.option.disabled}),this.changed()}initOptions(){this.option.options&&this.depth>0&&(void 0===this.$options?this.$options=new D({expanded:this.bind("expanded"),depth:this.depth-1,option:this.option,direction:this.direction,$parent:this}):this.$options.option=this.option)}changed(){const t=this.icon||this.option.icon,e=this.label||this.option.label;this.render([this.hasmore&&"left"===this.direction?h({value:"io:triangle_left",class:"hasmore"}):null,this.hasmore&&"up"===this.direction?h({value:"io:triangle_up",class:"hasmore"}):null,t?h({value:t}):null,e?a({class:"label"},e):null,this.option.hint?a({class:"hint"},this.option.hint):null,this.hasmore&&"right"===this.direction?h({value:"io:triangle_right",class:"hasmore"}):null,this.hasmore&&"down"===this.direction?h({value:"io:triangle_down",class:"hasmore"}):null])}dispose(){super.dispose(),delete this.$options}};j([t({type:y})],q.prototype,"option",2),j([s("")],q.prototype,"label",2),j([t({value:!1,reflect:!0})],q.prototype,"expanded",2),j([t({value:"right",reflect:!0})],q.prototype,"direction",2),j([t({value:1e3,reflect:!0})],q.prototype,"depth",2),j([s("false")],q.prototype,"contentEditable",2),j([s()],q.prototype,"$parent",2),q=j([n],q);const F=function(t){return q.vConstructor(t)};var J=Object.defineProperty,U=Object.getOwnPropertyDescriptor,X=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?U(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&J(e,o,s),s};let Y=class extends q{static get Style(){return"\n      :host {\n        display: flex;\n        flex-shrink: 0;\n      }\n      :host > * {\n        pointer-events: none;\n        text-overflow: ellipsis;\n      }\n    "}changed(){this.render([h({value:"io:hamburger"})])}};X([t({value:"down",reflect:!0})],Y.prototype,"direction",2),Y=X([n],Y);const K=Y.vConstructor;var W=Object.defineProperty,G=Object.getOwnPropertyDescriptor,H=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?G(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&W(e,o,s),s};let Q=class extends r{static get Style(){return'\n    :host {\n      display: flex;\n      flex-direction: column;\n    }\n    :host > io-boolean {\n      overflow: visible;\n      padding-left: var(--io_spacing3);\n      padding-right: var(--io_spacing3);\n    }\n    :host > io-boolean:before {\n      display: inline-block;\n      width: var(--io_fontSize);\n      content: "▸"\n    }\n    :host > io-boolean[value]:before {\n      content: "▾"\n    }\n    :host > io-menu-tree {\n      background: transparent;\n      border: none;\n      border-left: var(--io_border);\n      border-color: var(--io_colorLight);\n      margin-left: var(--io_spacing5);\n    }\n    '}optionMutated(){this.option.selected&&(this.expanded=this.option.selected)}changed(){this.render([v({icon:this.option.icon,true:this.option.label,false:this.option.label,value:this.bind("expanded")}),this.expanded?st({option:this.option,depth:this.depth+1}):null])}};H([t(Number)],Q.prototype,"depth",2),H([t({type:y})],Q.prototype,"option",2),H([t({value:!1,type:Boolean,reflect:!0})],Q.prototype,"expanded",2),H([s("region")],Q.prototype,"role",2),Q=H([n],Q);const Z=function(t){return Q.vConstructor(t)};var tt=Object.defineProperty,et=Object.getOwnPropertyDescriptor,ot=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?et(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&tt(e,o,s),s};function nt(t){const e=JSON.stringify(t);let o=0;for(let n=0;n<e.length;n++)o=Math.imul(31,o)+e.charCodeAt(n)|0;return"io-local-state-"+String(o)}let it=class extends r{static get Style(){return'\n    :host {\n      display: flex;\n      flex-direction: column;\n      align-self: flex-start;\n      border: var(--io_border);\n      border-radius: var(--io_borderRadius);\n      border-color: var(--io_borderColorOutset);\n      background-color: var(--io_bgColorLight);\n      padding: var(--io_spacing);\n      @apply --unselectable;\n    }\n    :host io-menu-tree {\n      padding: 0 !important;\n    }\n    :host > io-menu-item {\n      padding-left: var(--io_spacing);\n      padding-right: var(--io_spacing3);\n    }\n    :host > io-menu-item[selected] {\n      border-color: transparent var(--io_colorBlue) transparent transparent;\n    }\n    :host > io-menu-item:before {\n      display: inline-block;\n      width: var(--io_fontSize);\n      content: ""\n    }\n    '}constructor(t={}){super(t)}changed(){const t=this.widget?[this.widget]:[];if(this.searchable&&t.push(d({id:"search",role:"search",value:this.bind("search"),placeholder:"Search",live:!0})),this.search){const e=I(this.option,this.search,this.depth);if(0===e.length)t.push(c({label:"No matches"}));else for(let o=0;o<e.length;o++)t.push(F({option:e[o],depth:0}))}else t.push(...function(t,e,o=0){const n=[];if(o<=e)for(let i=0;i<t.options.length;i++){const e=t.options[i];if(e.options.length){const t=p({value:!1,storage:"local",key:nt(e)});!0===e.selected&&(t.value=!0),n.push(Z({option:e,depth:o,expanded:t}))}else n.push(F({option:e,depth:o}))}return n}(this.option,this.depth));this.render(t)}};ot([t({type:y})],it.prototype,"option",2),ot([t({value:!1,type:Boolean})],it.prototype,"searchable",2),ot([t({value:"",type:String})],it.prototype,"search",2),ot([t({value:1/0,type:Number})],it.prototype,"depth",2),ot([t(null)],it.prototype,"widget",2),ot([s()],it.prototype,"$parent",2),ot([s("listbox")],it.prototype,"role",2),it=ot([n],it);const st=function(t){return it.vConstructor(t)};var rt=Object.defineProperty,lt=Object.getOwnPropertyDescriptor,at=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?lt(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&rt(e,o,s),s};let pt=class extends r{static get Style(){return"\n    :host {\n      display: inline-block;\n      text-align: center;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorOutset);\n      background-color: var(--io_bgColorLight);\n      background-image: var(--io_gradientOutset);\n      text-align: left;\n    }\n    :host > io-menu-item {\n      margin: calc(-1 * var(--io_borderWidth));\n      background-color: transparent !important;\n      border-color: transparent !important;\n    }\n    "}constructor(t){super(t)}onOptionSelected(t){this._disposed||("value"===this.selectBy?this.inputValue(t.detail.option.value):"id"===this.selectBy&&this.inputValue(t.detail.option.id))}inputValue(t){if(this.value!==t||"object"==typeof this.value){const e=this.value;this.setProperty("value",t),this.dispatch("value-input",{value:t,oldValue:e},!1)}}optionChanged(t){t.oldValue&&t.oldValue.removeEventListener("option-selected",this.onOptionSelected),t.value&&t.value.addEventListener("option-selected",this.onOptionSelected)}changed(){let t;"value"===this.selectBy?t=this.option.findItemByValue(this.value):"id"===this.selectBy&&(t=this.option.findItemById(this.value));const e=t?t.label:this.label||String(this.value);this.render([F({option:this.option,label:e,icon:this.icon,direction:"down"})])}};at([t({value:void 0})],pt.prototype,"value",2),at([t("")],pt.prototype,"label",2),at([t("")],pt.prototype,"icon",2),at([t("value")],pt.prototype,"selectBy",2),at([t({type:y})],pt.prototype,"option",2),at([s("button")],pt.prototype,"role",2),pt=at([n],pt);const ht=function(t){return pt.vConstructor(t)};var dt=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,ut=(t,e,o,n)=>{for(var i,s=n>1?void 0:n?ct(e,o):e,r=t.length-1;r>=0;r--)(i=t[r])&&(s=(n?i(e,o,s):i(s))||s);return n&&s&&dt(e,o,s),s};let vt=class extends r{static get ReactiveProperties(){return{$options:null}}constructor(t){super(t),this.$options=new D({expanded:this.bind("expanded"),option:this.option,$parent:this})}init(){this.collapse=this.collapse.bind(this)}optionChanged(){this.$options&&(this.$options.option=this.option)}connectedCallback(){super.connectedCallback(),i.appendChild(this.$options),this.parentElement.addEventListener("pointerdown",this.onPointerdown),this.parentElement.addEventListener("click",this.onClick),this.parentElement.addEventListener("contextmenu",this.onContextmenu)}disconnectedCallback(){super.disconnectedCallback(),i.removeChild(this.$options),this.parentElement.removeEventListener("pointerdown",this.onPointerdown),this.parentElement.removeEventListener("click",this.onClick),this.parentElement.removeEventListener("contextmenu",this.onContextmenu)}getBoundingClientRect(){return this.parentElement.getBoundingClientRect()}onContextmenu(t){2===this.button&&t.preventDefault()}onPointerdown(t){t.stopPropagation(),this.$options.style.left=`${t.clientX}px`,this.$options.style.top=`${t.clientY}px`,this.parentElement.addEventListener("pointermove",this.onPointermove),this.parentElement.addEventListener("pointerleave",this.onPointerleave),this.parentElement.addEventListener("pointerup",this.onPointerup),clearTimeout(this._contextTimeout),"touch"!==t.pointerType?t.button===this.button&&(this.setPointerCapture(t.pointerId),this.expanded=!0):(t.preventDefault(),this._contextTimeout=setTimeout(()=>{this.setPointerCapture(t.pointerId),this.expanded=!0},150)),z.call(this,t)}onPointermove(t){t.stopPropagation(),clearTimeout(this._contextTimeout),("touch"!==t.pointerType||this.expanded)&&M.call(this,t)}onPointerup(t){clearTimeout(this._contextTimeout),this.releasePointerCapture(t.pointerId),this.parentElement.removeEventListener("pointermove",this.onPointermove),this.parentElement.removeEventListener("pointerleave",this.onPointerleave),this.parentElement.removeEventListener("pointerup",this.onPointerup),V.call(this,t)}onPointerleave(t){this.releasePointerCapture(t.pointerId),this.parentElement.removeEventListener("pointermove",this.onPointermove),this.parentElement.removeEventListener("pointerleave",this.onPointerleave),this.parentElement.removeEventListener("pointerup",this.onPointerup)}collapse(){i.collapse()}};ut([t({type:y})],vt.prototype,"option",2),ut([t({value:!1,reflect:!0})],vt.prototype,"expanded",2),ut([t(0)],vt.prototype,"button",2),vt=ut([n],vt);const mt=function(t){return vt.vConstructor(t)};export{vt as IoContextMenu,Y as IoMenuHamburger,q as IoMenuItem,D as IoMenuOptions,it as IoMenuTree,Q as IoMenuTreeBranch,pt as IoOptionSelect,y as MenuOption,mt as ioContextMenu,K as ioMenuHamburger,F as ioMenuItem,L as ioMenuOptions,st as ioMenuTree,Z as ioMenuTreeBranch,ht as ioOptionSelect,z as onOverlayPointerdown,M as onOverlayPointermove,V as onOverlayPointeup};
//# sourceMappingURL=index.js.map
