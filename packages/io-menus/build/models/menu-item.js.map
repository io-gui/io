{"version":3,"file":"menu-item.js","sourceRoot":"","sources":["../../src/models/menu-item.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoNode, Register, IoElementArgs, Property } from 'io-gui';\nimport { MenuOptions } from './menu-options.js';\n\nexport type MenuItemSelectType = 'select' | 'scroll' | 'toggle' | 'link' | 'none';\n\nexport type MenuItemArgsLoose = undefined | null | string | number | MenuItemArgs;\n\nexport type MenuItemArgs = IoElementArgs & {\n  value?: any,\n  icon?: string,\n  hint?: string,\n  action?: () => void,\n  mode?: MenuItemSelectType,\n  hidden?: boolean,\n  disabled?: boolean,\n  selected?: boolean,\n  options?: MenuItemArgsLoose[] | MenuOptions\n};\n\n// TODO: documentation!\n\n@Register\nexport class MenuItem extends IoNode {\n\n  @Property(undefined)\n  declare value: any;\n\n  @Property('')\n  declare label: string;\n\n  @Property('')\n  declare icon: string;\n\n  @Property('')\n  declare hint: string;\n\n  @Property(false)\n  declare hidden: boolean;\n\n  @Property(false)\n  declare disabled: boolean;\n\n  @Property(undefined)\n  declare action?: (value?: any) => void;\n\n  @Property('select')\n  declare mode: MenuItemSelectType;\n\n  @Property(false)\n  declare selected: boolean;\n\n  @Property(undefined)\n  declare options?: MenuOptions;\n\n  get hasmore() {\n    return !!(this.options?.length);\n  }\n\n  getSubitem(value: any) {\n    return this.options?.getItem(value);\n  }\n\n  constructor(args?: MenuItemArgsLoose) {\n    const item: MenuItemArgs = {\n      value: '',\n      label: '',\n    };\n\n    if (typeof args !== 'object' || args === null) {\n      item.value = args;\n      item.label = String(args);\n    } else {\n      item.value = args.value;\n      if (args.label === undefined) {\n        if (typeof item.value === 'object') {\n          if (item.value === null) {\n            item.label = 'null';\n          } else {\n            item.label = `${item.value.constructor.name}` + (item.value instanceof Array ? `(${item.value.length})` : '');\n          }\n        } else {\n          item.label = String(item.value);\n        }\n      } else {\n        item.label = args.label;\n      }\n      if (args.icon !== undefined) item.icon = args.icon;\n      if (args.hint !== undefined) item.hint = args.hint;\n      if (args.hidden !== undefined) item.hidden = args.hidden;\n      if (args.disabled !== undefined) item.disabled = args.disabled;\n      if (args.action !== undefined) item.action = args.action;\n      if (args.mode !== undefined) item.mode = args.mode;\n      if (args.selected !== undefined) item.selected = args.selected;\n      if (args.options !== undefined) {\n        if (args.options instanceof MenuOptions) {\n          item.options = args.options;\n        } else {\n          item.options = new MenuOptions(args.options);\n        }\n      }\n      if (item.selected === undefined && (args.mode === 'select' || args.mode === undefined) && item.options) {\n        item.selected = !!item.options.find((item: MenuItem) => item.selected && item.mode === 'select');\n      }\n    }\n\n    debug: {\n      if (item.mode && (item.mode === 'toggle') && item.options) {\n        console.warn('MenuItem: cannot have suboptions when `mode === \"toggle\"`');\n      }\n      if (item.mode && (item.mode === 'scroll') && item.options) {\n        console.warn('MenuItem: cannot have suboptions when `mode === \"scroll\"`');\n      }\n      if (item.mode && ['select', 'toggle', 'scroll', 'link', 'none'].indexOf(item.mode as string) === -1) {\n        console.warn('MenuItem: unknown `mode` property!', item.mode);\n      }\n      if (item.action && typeof item.action !== 'function') {\n        console.warn('MenuItem: invalid type of `action` property!', typeof item.action);\n      }\n    }\n\n    super(item);\n\n    if (this.options) {\n      this.options.addEventListener('item-selected', this._onSubItemSelected);\n      this.options.addEventListener('path-changed', this._onOptionsPathChanged);\n    }\n  }\n\n  toJSON() {\n    const json: Record<string, any> = {\n      value: this.value,\n      label: this.label,\n      icon: this.icon,\n      hint: this.hint,\n      hidden: this.hidden,\n      disabled: this.disabled,\n    };\n    if (this.options) json.options = this.options;\n    return json;\n  }\n\n  _onSubItemSelected() {\n    this.selected = true;\n  }\n\n  _onOptionsPathChanged(event: CustomEvent) {\n    this.dispatchEvent('path-changed', event.detail);\n  }\n\n  optionsChanged() {\n    // TODO test this behavior and look for regressions\n    if ((this.options?.first !== undefined || this.options?.scroll !== undefined) && this.mode === 'select') {\n      this.selected = true;\n    }\n  }\n\n  selectedChanged() {\n     if (this.mode === 'select' && this.selected === false && this.options) {\n      for (let i = 0; i < this.options.length; i++) {\n        if (this.options[i].mode === 'select' || this.options[i].mode === 'scroll') {\n          this.options[i].selected = false;\n        }\n      }\n      this.options.updatePaths();\n    }\n  }\n\n  dispose() {\n    if (this.options) {\n      this.options.removeEventListener('item-selected', this._onSubItemSelected);\n      this.options.removeEventListener('path-changed', this._onOptionsPathChanged);\n    }\n    super.dispose();\n  }\n}"]}