{"version":3,"file":"object-config.js","sourceRoot":"","sources":["../../src/models/object-config.ts"],"names":[],"mappings":"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","sourcesContent":["import { Binding } from 'io-gui';\n\n// TODO: display read only as non-editable\n\n/*\n\n **/\n\nexport class ObjectConfig {\n    constructor(prototypes: any) {\n      for (let i = 0; i < prototypes.length; i++) {\n        this.registerObjectConfig(prototypes[i].ObjectConfig || {});\n      }\n    }\n    registerObjectConfig(config: any) {\n      for (const c in config) {\n        const self = this as any;\n        self[c] = self[c] || [];\n        self[c] = [config[c][0] || self[c][0], Object.assign(self[c][1] || {}, config[c][1] || {})];\n      }\n    }\n    getObjectConfig(object: any, customConfig: any) {\n      // const keys = Object.getOwnPropertyNames(object);\n      const keys = Object.keys(object);\n      const prototypes = [];\n\n      let proto = object.__proto__;\n      while (proto) {\n        prototypes.push(proto.constructor.name);\n        keys.push(...Object.keys(proto));\n        proto = proto.__proto__;\n      }\n\n      const protoConfigs: any = {};\n\n      for (const i in this) {\n        const cfg = i.split('|');\n        if (cfg.length === 1) cfg.splice(0, 0, 'Object');\n        if (prototypes.indexOf(cfg[0]) !== -1) protoConfigs[cfg[1]] = this[i];\n      }\n\n      for (const i in customConfig) {\n        const cfg = i.split('|');\n        if (cfg.length === 1) cfg.splice(0, 0, 'Object');\n        if (prototypes.indexOf(cfg[0]) !== -1) {\n            protoConfigs[cfg[1]] = customConfig[i];\n        }\n      }\n\n      const config: any = {};\n\n      for (let i = 0; i < keys.length; i++) {\n        const k = keys[i];\n        const value = object[k] instanceof Binding ? object[k].value : object[k]; // TODO: Unhack demovalues\n        // const value = object[k]\n\n        const type = value === null ? 'null' : typeof value;\n        const cstr = (value !== undefined && value !== null && value.constructor) ? value.constructor.name : 'null';\n\n        if (type === 'function') continue;\n\n        const typeStr = 'type:' + type;\n        const cstrStr = 'constructor:' + cstr;\n        const keyStr = k.replace('type:', '').replace('constructor:', '');\n\n        config[k] = null;\n\n        if (protoConfigs[typeStr]) config[k] = protoConfigs[typeStr];\n        if (protoConfigs[cstrStr]) config[k] = protoConfigs[cstrStr];\n        if (protoConfigs[keyStr]) config[k] = protoConfigs[keyStr];\n      }\n\n      return config;\n    }\n}\n"]}