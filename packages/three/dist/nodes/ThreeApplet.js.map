{"version":3,"file":"ThreeApplet.js","sourceRoot":"","sources":["../../src/nodes/ThreeApplet.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,gBAAgB,EAAa,MAAM,cAAc,CAAA;AAC1E,OAAO,EAAkB,oBAAoB,EAAE,MAAM,iBAAiB,CAAA;AACtE,OAAO,EAAE,aAAa,EAAE,KAAK,EAA+B,MAAM,cAAc,CAAA;AAUzE,IAAM,WAAW,GAAjB,MAAM,WAAY,SAAQ,IAAI;IAe3B,SAAS,GAA0B,IAAI,CAAA;IACvC,MAAM,GAAW,CAAC,CAAA;IAClB,OAAO,GAAW,CAAC,CAAA;IACnB,SAAS,GAAW,CAAC,CAAC,CAAA;IAE9B,YAAY,IAAuB;QACjC,KAAK,CAAC,IAAI,CAAC,CAAA;IACb,CAAC;IAED,kBAAkB,CAAC,KAAa,EAAE,MAAc;QAC9C,IAAI,IAAI,CAAC,MAAM,KAAK,KAAK,IAAI,IAAI,CAAC,OAAO,KAAK,MAAM,EAAE,CAAC;YACrD,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC;gBACxB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA;gBACnB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAA;gBACrB,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;YAC/B,CAAC;QACH,CAAC;IAEH,CAAC;IACD,qBAAqB;QACnB,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,WAAW,KAAK,IAAI,CAAA;IAChE,CAAC;IACD,qBAAqB,CAAC,QAAwB;QAC5C,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAA;IAC3B,CAAC;IACD,6DAA6D;IAC7D,SAAS,CAAC,KAAa,EAAE,MAAc,IAAG,CAAC;IAE3C,OAAO,CAAC,IAAY,EAAE,KAAa;QACjC,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI;YAAE,OAAM;QACnC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAA;QACrB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAA;IACvB,CAAC;IACD,6DAA6D;IAC7D,SAAS,CAAC,KAAa,IAAG,CAAC;CAC5B,CAAA;AA/CS;IADP,gBAAgB,CAAC,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC;0CACxB;AAGZ;IADP,gBAAgB,CAAC,EAAC,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAC,CAAC;wDACR;AAG3B;IADP,gBAAgB,CAAC,EAAC,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,aAAa,EAAC,CAAC;gDACvB;AAIxB;IADP,gBAAgB,CAAC,EAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAC,CAAC;6CACV;AAbvB,WAAW;IADvB,QAAQ;GACI,WAAW,CAkDvB;;AAED,oBAAoB,CAAC,WAAW,EAAE;IAChC,KAAK,EAAE;QACL,OAAO;KACR;IACD,SAAS,EAAE;QACT,qBAAqB;QACrB,aAAa;KACd;IACD,MAAM,EAAE;QACN,UAAU;KACX;CACF,CAAC,CAAA","sourcesContent":["import { Register, Node, ReactiveProperty, NodeProps } from '@io-gui/core'\nimport { PropertyConfig, registerEditorGroups } from '@io-gui/editors'\nimport { NoToneMapping, Scene, ToneMapping, WebGPURenderer } from 'three/webgpu'\n\nexport type ThreeAppletProps = NodeProps & {\n  scene?: Scene\n  toneMappingExposure?: number\n  toneMapping?: ToneMapping\n  uiConfig?: PropertyConfig[]\n}\n\n@Register\nexport class ThreeApplet extends Node {\n\n  @ReactiveProperty({type: Scene, init: null})\n  declare scene: Scene\n\n  @ReactiveProperty({type: Number, value: 1})\n  declare toneMappingExposure: number\n\n  @ReactiveProperty({type: Number, value: NoToneMapping})\n  declare toneMapping: ToneMapping\n\n  // TODO: dispose uiConfig when applet is disposed\n  @ReactiveProperty({type: Array, init: null})\n  declare uiConfig: PropertyConfig[]\n\n  private _renderer: WebGPURenderer | null = null\n  private _width: number = 0\n  private _height: number = 0\n  private _prevTime: number = -1\n\n  constructor(args?: ThreeAppletProps) {\n    super(args)\n  }\n\n  updateViewportSize(width: number, height: number) {\n    if (this._width !== width || this._height !== height) {\n      if (!!width && !!height) {\n        this._width = width\n        this._height = height\n        this.onResized(width, height)\n      }\n    }\n\n  }\n  isRendererInitialized() {\n    return !!this._renderer && this._renderer.initialized === true\n  }\n  onRendererInitialized(renderer: WebGPURenderer) {\n    this._renderer = renderer\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  onResized(width: number, height: number) {}\n\n  animate(time: number, delta: number) {\n    if (this._prevTime === time) return\n    this._prevTime = time\n    this.onAnimate(delta)\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  onAnimate(delta: number) {}\n}\n\nregisterEditorGroups(ThreeApplet, {\n  Scene: [\n    'scene',\n  ],\n  Rendering: [\n    'toneMappingExposure',\n    'toneMapping',\n  ],\n  Hidden: [\n    'uiConfig',\n  ]\n})"]}