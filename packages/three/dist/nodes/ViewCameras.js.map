{"version":3,"file":"ViewCameras.js","sourceRoot":"","sources":["../../src/nodes/ViewCameras.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, ReactiveNode, ReactiveProperty, Property, ReactiveNodeProps, Binding  } from '@io-gui/core'\nimport { IoThreeViewport } from '../elements/IoThreeViewport.js'\nimport { ThreeApplet } from './ThreeApplet.js'\nimport { Box3, Camera, Object3D, OrthographicCamera, PerspectiveCamera, Sphere, Vector3 } from 'three/webgpu'\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js'\n\nconst box = new Box3()\nconst sphere = new Sphere()\nconst center = new Vector3()\nconst size = new Vector3()\nconst delta = new Vector3()\nconst cameraRight = new Vector3()\nconst cameraUp = new Vector3()\nconst cameraForward = new Vector3()\nconst corner = new Vector3()\nlet radius = 0\n\nconst resetCameras = new WeakMap<Camera, Camera>()\n\nclass DefaultCameras {\n  public perspective: PerspectiveCamera\n  public top: OrthographicCamera\n  public bottom: OrthographicCamera\n  public left: OrthographicCamera\n  public right: OrthographicCamera\n  public front: OrthographicCamera\n  public back: OrthographicCamera\n  constructor() {\n    this.perspective = new PerspectiveCamera(50, 1, 0.1, 1000)\n    this.top = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n    this.bottom = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n    this.left = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n    this.right = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n    this.front = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n    this.back = new OrthographicCamera(-1, 1, 1, -1, 0, 1000)\n\n    this.perspective.userData.position = new Vector3(0.5, 0.25, 1)\n    this.perspective.position.copy(this.perspective.userData.position)\n    this.perspective.lookAt(0, 0, 0)\n    this.perspective.name = 'perspective'\n\n    this.top.userData.position = new Vector3(0, 1, 0)\n    this.top.position.copy(this.top.userData.position)\n    this.top.lookAt(0, 0, 0)\n    this.top.name = 'top'\n\n    this.bottom.userData.position = new Vector3(0, -1, 0)\n    this.bottom.position.copy(this.bottom.userData.position)\n    this.bottom.lookAt(0, 0, 0)\n    this.bottom.name = 'bottom'\n\n    this.left.userData.position = new Vector3(-1, 0, 0)\n    this.left.position.copy(this.left.userData.position)\n    this.left.lookAt(0, 0, 0)\n    this.left.name = 'left'\n\n    this.right.userData.position = new Vector3(1, 0, 0)\n    this.right.position.copy(this.right.userData.position)\n    this.right.lookAt(0, 0, 0)\n    this.right.name = 'right'\n\n    this.front.userData.position = new Vector3(0, 0, 1)\n    this.front.position.copy(this.front.userData.position)\n    this.front.lookAt(0, 0, 0)\n    this.front.name = 'front'\n\n    this.back.userData.position = new Vector3(0, 0, -1)\n    this.back.position.copy(this.back.userData.position)\n    this.back.lookAt(0, 0, 0)\n    this.back.name = 'back'\n  }\n  get cameras() {\n    return [this.perspective, this.top, this.bottom, this.left, this.right, this.front, this.back]\n  }\n  getCamera(name: string) {\n    return this.cameras.find(camera => camera.name === name)\n  }\n}\n\n\n\nexport type ViewCamerasProps = ReactiveNodeProps & {\n  viewport: IoThreeViewport\n  applet: ThreeApplet | Binding\n  cameraSelect: string | Binding\n}\n\n@Register\nexport class ViewCameras extends ReactiveNode {\n\n  @Property()\n  declare private viewport: IoThreeViewport\n\n  @ReactiveProperty({type: ThreeApplet})\n  declare public applet: ThreeApplet\n\n  @ReactiveProperty({type: String, value: 'perspective'})\n  declare public cameraSelect: string\n\n  @ReactiveProperty({type: Camera})\n  declare public camera: PerspectiveCamera | OrthographicCamera\n\n  @ReactiveProperty({type: DefaultCameras, init: null})\n  declare private readonly defaultCameras: DefaultCameras\n\n  @ReactiveProperty({type: OrbitControls, init: ['this.defaultCameras.perspective']})\n  declare private readonly orbitControls: OrbitControls\n\n  static get Listeners() {\n    return {\n      'frame-object': 'onFrameObject'\n    }\n  }\n\n  constructor(args: ViewCamerasProps) {\n    super(args)\n\n    this.orbitControls.connect(this.viewport)\n    this.orbitControls.addEventListener('change', () => {\n      this.dispatchMutation()\n    })\n\n    if (this.camera === undefined) this.camera = this.defaultCameras.perspective\n  }\n\n  cameraSelectChanged() {\n    this.debounce(this.cameraSelectChangedDebounced)\n  }\n\n  cameraSelectChangedDebounced() {\n    let matchedCamera: PerspectiveCamera | OrthographicCamera | undefined\n    if (this.cameraSelect.startsWith('scene')) {\n      const cameraId = this.cameraSelect.split(':')[1] || ''\n      const persp = this.applet.scene.getObjectsByProperty('isPerspectiveCamera', true)\n      const ortho = this.applet.scene.getObjectsByProperty('isOrthographicCamera', true)\n      const cameras = [...persp, ...ortho]\n\n      if (cameraId) {\n        matchedCamera = cameras.find(camera => camera.name === cameraId) as PerspectiveCamera | OrthographicCamera | undefined\n        if (!matchedCamera) {\n          console.warn(`Camera ${cameraId} not found in the scene, using default perspective camera`)\n        }\n      } else {\n        matchedCamera = cameras[0] as PerspectiveCamera | OrthographicCamera | undefined\n        if (!matchedCamera) {\n          console.warn('No cameras found in the scene, using default perspective camera')\n        }\n      }\n      if (matchedCamera) {\n        this.camera = matchedCamera\n      } else {\n        this.camera = this.defaultCameras.perspective\n      }\n    } else {\n      matchedCamera = this.defaultCameras.getCamera(this.cameraSelect)\n      if (matchedCamera) {\n        this.camera = matchedCamera\n      } else {\n        console.warn(`Camera ${this.cameraSelect} not found in the default cameras, using default perspective camera`)\n        this.camera = this.defaultCameras.perspective\n      }\n    }\n  }\n\n  cameraChanged() {\n    // TODO: redundant if camera is one of the defaults?\n    // TODO: Consider leaving scene camera aspect ratio unchanged or:\n    // - Set it temporarily to match viewport aspect ratio (show frame mask) and restore it\n    if (!this.defaultCameras.cameras.includes(this.camera)) {\n      this.orbitControls.enabled = false\n    } else {\n      this.orbitControls.enabled = true\n      this.orbitControls.object = this.camera\n      this.orbitControls.enableRotate = !!(this.camera as PerspectiveCamera).isPerspectiveCamera\n    }\n  }\n\n  appletChanged() {\n    this.cameraSelectChangedDebounced()\n    this.frameObjectAll(this.applet.scene)\n  }\n\n  onFrameObject(event: CustomEvent<{object: Object3D; overscan: number}>) {\n    this.frameObjectAll(event.detail.object, event.detail.overscan)\n  }\n\n  frameObjectAll(object: Object3D, overscan: number = 1) {\n    debug: {\n      if (object === undefined) {\n        console.error('frameObject: object is undefined')\n        return\n      }\n    }\n    for (const camera of this.defaultCameras.cameras) {\n      camera.position.copy(camera.userData.position)\n      camera.lookAt(0, 0, 0)\n      this.frameObject(object, camera, overscan)\n    }\n    // TODO: Reconsider\n    // this.debounce(this.cameraSelectChangedDebounced)\n  }\n\n  frameObject(object: Object3D, camera: Camera, overscan: number = 1) {\n\n    box.setFromObject( object )\n\n    if ( box.isEmpty() === false ) {\n      box.getCenter( center )\n      radius = box.getBoundingSphere( sphere ).radius\n    } else {\n      // Focusing on an Group, AmbientLight, etc\n      // TODO: Investigate and make more robust\n      center.setFromMatrixPosition( camera.matrixWorld )\n      radius = 0.1\n    }\n\n    // Project box onto camera axes\n    cameraRight.set(1, 0, 0).applyQuaternion(camera.quaternion)\n    cameraUp.set(0, 1, 0).applyQuaternion(camera.quaternion)\n    cameraForward.set(0, 0, -1).applyQuaternion(camera.quaternion)\n\n    box.getSize(size).multiplyScalar(0.5)\n\n    const halfWidth = Math.abs(size.x * cameraRight.x) + Math.abs(size.y * cameraRight.y) + Math.abs(size.z * cameraRight.z)\n    const halfHeight = Math.abs(size.x * cameraUp.x) + Math.abs(size.y * cameraUp.y) + Math.abs(size.z * cameraUp.z)\n    const halfDepth = Math.abs(size.x * cameraForward.x) + Math.abs(size.y * cameraForward.y) + Math.abs(size.z * cameraForward.z)\n\n    if (camera instanceof PerspectiveCamera) {\n\n      const vfov = camera.fov * Math.PI / 180\n      const tanHalfVfov = Math.tan(vfov / 2)\n      const aspect = camera.aspect || 1\n\n      let distance = 0\n      for (let i = 0; i < 8; i++) {\n        corner.set(\n          (i & 1) ? box.max.x : box.min.x,\n          (i & 2) ? box.max.y : box.min.y,\n          (i & 4) ? box.max.z : box.min.z\n        ).sub(center)\n\n        const x = corner.dot(cameraRight)\n        const y = corner.dot(cameraUp)\n        const z = corner.dot(cameraForward)\n\n        const distV = Math.abs(y) / tanHalfVfov - z\n        const distH = Math.abs(x) / (tanHalfVfov * aspect) - z\n        distance = Math.max(distance, distV, distH)\n      }\n\n      delta.set(0, 0, 1)\n        .applyQuaternion(camera.quaternion)\n        .multiplyScalar(distance)\n      camera.position.copy(center).add(delta)\n\n      camera.near = halfDepth * 0.01\n      camera.far = distance + halfDepth * 20\n      camera.zoom = 1 / overscan\n      camera.updateProjectionMatrix()\n\n    } else if (camera instanceof OrthographicCamera) {\n\n      delta.set(0, 0, 1).applyQuaternion(camera.quaternion).multiplyScalar(radius)\n      camera.position.copy(center).add(delta)\n      camera.lookAt(center)\n\n      camera.left = -halfWidth\n      camera.right = halfWidth\n      camera.bottom = -halfHeight\n      camera.top = halfHeight\n\n      camera.zoom = 1 / overscan\n      camera.near = 0\n      camera.far = radius + halfDepth * 20\n\n      camera.updateProjectionMatrix()\n    }\n\n    this.orbitControls.target.copy( center )\n  }\n\n  setOverscan(width: number, height: number, overscan: number) {\n\n    const camera = this.camera\n    const resetCamera = resetCameras.get(camera) || camera.clone(false)\n    resetCamera.copy(camera, false)\n    resetCameras.set(camera, resetCamera)\n\n    const viewportAspect = width / height\n    if (camera instanceof PerspectiveCamera) {\n      const originalAspect = camera.aspect\n      camera.aspect = viewportAspect\n      const halfFovRad = camera.fov * Math.PI / 360\n      const aspectContain = Math.max(1, originalAspect / viewportAspect)\n\n      camera.fov = 2 * Math.atan(Math.tan(halfFovRad) * aspectContain) * 180 / Math.PI\n      camera.zoom = 1 / overscan\n    } else if (camera instanceof OrthographicCamera) {\n      const frustumHeight = camera.top - camera.bottom\n      const frustumWidth = camera.right - camera.left\n      const frustumAspect = frustumWidth / frustumHeight\n\n      if (frustumAspect > viewportAspect) {\n        camera.top = frustumWidth / 2 / viewportAspect\n        camera.bottom = -frustumWidth / 2 / viewportAspect\n      } else {\n        camera.left = -frustumHeight / 2 * viewportAspect\n        camera.right = frustumHeight / 2 * viewportAspect\n      }\n\n      camera.top *= overscan\n      camera.bottom *= overscan\n      camera.left *= overscan\n      camera.right *= overscan\n    }\n    camera.updateProjectionMatrix()\n  }\n\n  resetOverscan() {\n    const camera = this.camera\n    const resetCamera = resetCameras.get(camera)\n    if (resetCamera) {\n      camera.copy(resetCamera, false)\n    }\n  }\n\n  dispose() {\n    this.orbitControls.dispose()\n    super.dispose()\n  }\n}"]}