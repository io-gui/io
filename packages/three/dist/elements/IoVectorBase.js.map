{"version":3,"file":"IoVectorBase.js","sourceRoot":"","sources":["../../src/elements/IoVectorBase.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, IoElement, ReactiveProperty, Property, IoElementProps, VDOMElement, ReactiveNode } from '@io-gui/core'\nimport { ioNumber, ioBoolean } from '@io-gui/inputs'\nimport { Vector4 } from 'three/webgpu'\n\nexport type IoVectorBaseProps = IoElementProps & {\n  value?: Vector4\n  conversion?: number\n  step?: number\n  min?: number\n  max?: number\n  linkable?: boolean\n  linked?: boolean\n  ladder?: boolean\n  disabled?: boolean\n}\n\n@Register\nexport class IoVectorBase extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex: 1 1 auto;\n        max-width: 100%;\n        overflow: hidden;\n      }\n      :host > io-number {\n        flex: 1 1 0;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n      :host > io-boolicon {\n        flex-shrink: 0;\n        padding: var(--io_spacing);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object, init: null})\n  declare value: object\n\n  @ReactiveProperty(1)\n  declare conversion: number\n\n  @ReactiveProperty(0.001)\n  declare step: number\n\n  @ReactiveProperty(-Infinity)\n  declare min: number\n\n  @ReactiveProperty(Infinity)\n  declare max: number\n\n  @ReactiveProperty(false)\n  declare linkable: boolean\n\n  @ReactiveProperty(false)\n  declare linked: boolean\n\n  @ReactiveProperty(true)\n  declare ladder: boolean\n\n  @ReactiveProperty(false)\n  declare disabled: boolean\n\n  @Property([])\n  declare keys: Array<string>\n\n  public _ratios: any = {}\n\n  constructor(args: IoVectorBaseProps) {\n    super(args)\n  }\n\n  _onNumberPointerDown(event: PointerEvent) {\n    const item = event.composedPath()[0] as HTMLElement\n    const id = item.id as keyof typeof this.value\n    this._ratios = {}\n    if (this.linked && this.value[id] !== 0) {\n      const value = this.value as any\n      for (const k of this.keys) this._ratios[k] = value[k] / value[id]\n    }\n  }\n\n  _onNumberValueInput(event: CustomEvent) {\n    const item = event.composedPath()[0] as HTMLElement\n    const id = item.id as keyof typeof this.value;\n    (this.value as any)[id] = event.detail.value\n    if (this.linked) {\n      for (const k of this.keys) {\n        const value = this.value as any\n        if (k !== id && this._ratios[k]) (value as any)[k] = value[id] * this._ratios[k]\n      }\n    }\n    if (!(this.value as unknown as ReactiveNode)._isNode) {\n      this.dispatchMutation(this.value)\n    }\n  }\n\n  valueMutated() {\n    this.debounce(this.changed)\n  }\n  changed() {\n    const vChildren: Array<VDOMElement | null> = []\n    for (const k of this.keys) {\n      const value = this.value[k as keyof typeof this.value] as number\n      if (value !== undefined) {\n        vChildren.push(ioNumber({\n          id: k as string,\n          value: value,\n          conversion: this.conversion,\n          step: this.step,\n          min: this.min,\n          max: this.max,\n          ladder: this.ladder,\n          disabled: this.disabled,\n          '@pointerdown': this._onNumberPointerDown,\n          '@value-input': this._onNumberValueInput,\n        }))\n      }\n    }\n    vChildren.push(this.linkable ? ioBoolean({value: this.bind('linked') as any, true: 'io:link', false: 'io:unlink'}) : null)\n    this.render(vChildren)\n  }\n}"]}