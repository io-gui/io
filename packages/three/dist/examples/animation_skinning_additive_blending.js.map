{"version":3,"file":"animation_skinning_additive_blending.js","sourceRoot":"","sources":["../../src/examples/animation_skinning_additive_blending.ts"],"names":[],"mappings":"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","sourcesContent":["import { ReactiveProperty, Register } from '@io-gui/core'\nimport {\n  AnimationAction,\n  AnimationMixer,\n  AnimationUtils,\n  Color,\n  DirectionalLight,\n  Fog,\n  Group,\n  HemisphereLight,\n  Mesh,\n  MeshPhongMaterial,\n  PerspectiveCamera,\n  PlaneGeometry,\n  SkeletonHelper,\n} from 'three/webgpu'\nimport { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js'\nimport { ThreeApplet } from '@io-gui/three'\nimport { ioBoolean } from '@io-gui/inputs'\nimport { ioNumberSlider } from '@io-gui/sliders'\n\nconst loader = new GLTFLoader()\n\ninterface ActionSettings {\n  weight: number\n  action?: AnimationAction\n}\n\n@Register\nexport class AnimationSkinningAdditiveBlendingExample extends ThreeApplet {\n\n  @ReactiveProperty({type: Boolean, value: false})\n  declare isLoaded: boolean\n\n  @ReactiveProperty({type: Boolean, value: false})\n  declare showSkeleton: boolean\n\n  @ReactiveProperty({type: Number, value: 1})\n  declare timeScale: number\n\n  // Additive action weights\n  @ReactiveProperty({type: Number, value: 0})\n  declare sneakPoseWeight: number\n\n  @ReactiveProperty({type: Number, value: 0})\n  declare sadPoseWeight: number\n\n  @ReactiveProperty({type: Number, value: 0})\n  declare agreeWeight: number\n\n  @ReactiveProperty({type: Number, value: 0})\n  declare headShakeWeight: number\n\n  public camera: PerspectiveCamera\n  public mixer: AnimationMixer = new AnimationMixer(new Group())\n  public skeleton: SkeletonHelper | null = null\n\n  public currentBaseAction: string = 'idle'\n  public allActions: AnimationAction[] = []\n\n  public baseActions: Record<string, ActionSettings> = {\n    idle: { weight: 1 },\n    walk: { weight: 0 },\n    run: { weight: 0 },\n  }\n\n  public additiveActions: Record<string, ActionSettings> = {\n    sneak_pose: { weight: 0 },\n    sad_pose: { weight: 0 },\n    agree: { weight: 0 },\n    headShake: { weight: 0 },\n  }\n\n  constructor() {\n    super()\n\n    // Camera\n    this.camera = new PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 100)\n    this.camera.position.set(-1, 2, 3)\n    this.camera.lookAt(0, 1, 0)\n    this.scene.add(this.camera)\n\n    // Scene setup\n    this.scene.background = new Color(0xa0a0a0)\n    this.scene.fog = new Fog(0xa0a0a0, 10, 50)\n\n    // Lights\n    const hemiLight = new HemisphereLight(0xffffff, 0x8d8d8d, 3)\n    hemiLight.position.set(0, 20, 0)\n    this.scene.add(hemiLight)\n\n    const dirLight = new DirectionalLight(0xffffff, 3)\n    dirLight.position.set(3, 10, 10)\n    dirLight.castShadow = true\n    dirLight.shadow.camera.top = 2\n    dirLight.shadow.camera.bottom = -2\n    dirLight.shadow.camera.left = -2\n    dirLight.shadow.camera.right = 2\n    dirLight.shadow.camera.near = 0.1\n    dirLight.shadow.camera.far = 40\n    this.scene.add(dirLight)\n\n    const ground = new Mesh(\n      new PlaneGeometry(100, 100),\n      new MeshPhongMaterial({color: 0xcbcbcb, depthWrite: false})\n    )\n    ground.rotation.x = -Math.PI / 2\n    ground.receiveShadow = true\n    this.scene.add(ground)\n\n    this.uiConfig = [\n      ['showSkeleton', ioBoolean({label: 'Show Skeleton'})],\n      ['timeScale', ioNumberSlider({min: 0, max: 1.5, step: 0.01})],\n      ['sneakPoseWeight', ioNumberSlider({min: 0, max: 1, step: 0.01})],\n      ['sadPoseWeight', ioNumberSlider({min: 0, max: 1, step: 0.01})],\n      ['agreeWeight', ioNumberSlider({min: 0, max: 1, step: 0.01})],\n      ['headShakeWeight', ioNumberSlider({min: 0, max: 1, step: 0.01})],\n    ]\n\n    this.uiGroups = {\n      Main: [\n        'isLoaded',\n        'showSkeleton',\n        'timeScale',\n      ],\n      'Base Actions': [\n        'idle',\n        'walk',\n        'run',\n      ],\n      'Additive Weights': [\n        'sneakPoseWeight',\n        'sadPoseWeight',\n        'agreeWeight',\n        'headShakeWeight',\n      ],\n      Hidden: [\n        'scene',\n        'camera',\n        'mixer',\n        'allActions',\n        'baseActions',\n        'additiveActions',\n        'currentBaseAction',\n        'skeleton',\n      ],\n    }\n\n    void this.loadModel()\n  }\n\n  private async loadModel() {\n    loader.load('https://threejs.org/examples/models/gltf/Xbot.glb', (gltf) => {\n      const model = gltf.scene as Group\n      this.scene.add(model)\n\n      model.traverse((object) => {\n        if ((object as Mesh).isMesh) {\n          object.castShadow = true\n        }\n      })\n\n      this.skeleton = new SkeletonHelper(model)\n      this.skeleton.visible = this.showSkeleton\n      this.scene.add(this.skeleton)\n\n      this.mixer = new AnimationMixer(model)\n      const animations = gltf.animations\n\n      for (let i = 0; i < animations.length; i++) {\n        let clip = animations[i]\n        const name = clip.name\n\n        if (this.baseActions[name]) {\n          const action = this.mixer.clipAction(clip)\n          this.activateAction(action)\n          this.baseActions[name].action = action\n          this.allActions.push(action)\n        } else if (this.additiveActions[name]) {\n          // Make the clip additive and remove the reference frame\n          AnimationUtils.makeClipAdditive(clip)\n\n          if (clip.name.endsWith('_pose')) {\n            clip = AnimationUtils.subclip(clip, clip.name, 2, 3, 30)\n          }\n\n          const action = this.mixer.clipAction(clip)\n          this.activateAction(action)\n          this.additiveActions[name].action = action\n          this.allActions.push(action)\n        }\n      }\n\n      this.setProperties({\n        isLoaded: true,\n      })\n\n      this.dispatch('frame-object', {scene: model}, true)\n    })\n  }\n\n  private activateAction(action: AnimationAction) {\n    const clip = action.getClip()\n    const settings = this.baseActions[clip.name] || this.additiveActions[clip.name]\n    this.setWeight(action, settings.weight)\n    action.play()\n  }\n\n  private setWeight(action: AnimationAction, weight: number) {\n    action.enabled = true\n    action.setEffectiveTimeScale(1)\n    action.setEffectiveWeight(weight)\n  }\n\n  showSkeletonChanged() {\n    if (this.skeleton) {\n      this.skeleton.visible = this.showSkeleton\n    }\n  }\n\n  timeScaleChanged() {\n    this.mixer.timeScale = this.timeScale\n  }\n\n  // Additive weight change handlers\n  sneakPoseWeightChanged() {\n    const settings = this.additiveActions['sneak_pose']\n    if (settings.action) {\n      this.setWeight(settings.action, this.sneakPoseWeight)\n      settings.weight = this.sneakPoseWeight\n    }\n  }\n\n  sadPoseWeightChanged() {\n    const settings = this.additiveActions['sad_pose']\n    if (settings.action) {\n      this.setWeight(settings.action, this.sadPoseWeight)\n      settings.weight = this.sadPoseWeight\n    }\n  }\n\n  agreeWeightChanged() {\n    const settings = this.additiveActions['agree']\n    if (settings.action) {\n      this.setWeight(settings.action, this.agreeWeight)\n      settings.weight = this.agreeWeight\n    }\n  }\n\n  headShakeWeightChanged() {\n    const settings = this.additiveActions['headShake']\n    if (settings.action) {\n      this.setWeight(settings.action, this.headShakeWeight)\n      settings.weight = this.headShakeWeight\n    }\n  }\n\n  // Base action crossfade triggers\n  idle = () => { this.prepareCrossFade('idle') }\n  walk = () => { this.prepareCrossFade('walk') }\n  run = () => { this.prepareCrossFade('run') }\n\n  private prepareCrossFade(targetName: string) {\n    const currentSettings = this.baseActions[this.currentBaseAction]\n    const currentAction = currentSettings?.action || null\n    const targetSettings = this.baseActions[targetName]\n    const targetAction = targetSettings?.action || null\n\n    if (currentAction === targetAction) return\n\n    const duration = 0.35\n\n    if (this.currentBaseAction === 'idle' || !currentAction || !targetAction) {\n      this.executeCrossFade(currentAction, targetAction, duration)\n    } else {\n      this.synchronizeCrossFade(currentAction, targetAction, duration)\n    }\n\n    this.currentBaseAction = targetAction ? targetName : 'None'\n  }\n\n  private synchronizeCrossFade(startAction: AnimationAction, endAction: AnimationAction, duration: number) {\n    const onLoopFinished = (event: {action: AnimationAction}) => {\n      if (event.action === startAction) {\n        this.mixer.removeEventListener('loop', onLoopFinished as any)\n        this.executeCrossFade(startAction, endAction, duration)\n      }\n    }\n\n    this.mixer.addEventListener('loop', onLoopFinished as any)\n  }\n\n  private executeCrossFade(startAction: AnimationAction | null, endAction: AnimationAction | null, duration: number) {\n    if (endAction) {\n      this.setWeight(endAction, 1)\n      endAction.time = 0\n\n      if (startAction) {\n        startAction.crossFadeTo(endAction, duration, true)\n      } else {\n        endAction.fadeIn(duration)\n      }\n    } else if (startAction) {\n      startAction.fadeOut(duration)\n    }\n  }\n\n  onAnimate(delta: number) {\n    if (!this.isLoaded || !this.mixer) return\n\n    // Update effective weights for UI feedback\n    for (const action of this.allActions) {\n      const clip = action.getClip()\n      const settings = this.baseActions[clip.name] || this.additiveActions[clip.name]\n      if (settings) {\n        settings.weight = action.getEffectiveWeight()\n      }\n    }\n\n    this.mixer.update(delta)\n  }\n}\n\n"]}