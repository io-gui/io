{"version":3,"file":"IoGeometryConvexExample.js","sourceRoot":"","sources":["../../../src/demos/examples/IoGeometryConvexExample.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  AmbientLight,\n  BufferGeometry,\n  DodecahedronGeometry,\n  Group,\n  InstancedBufferAttribute,\n  Mesh,\n  MeshLambertMaterial,\n  PointLight,\n  PointsNodeMaterial,\n  SRGBColorSpace,\n  Sprite,\n  TextureLoader,\n  Vector3,\n  DoubleSide\n} from 'three/webgpu'\nimport { instancedBufferAttribute, texture, float, color } from 'three/tsl'\nimport { ConvexGeometry } from 'three/addons/geometries/ConvexGeometry.js'\nimport * as BufferGeometryUtils from 'three/addons/utils/BufferGeometryUtils.js'\nimport { Register, ReactiveProperty } from '@io-gui/core'\nimport { ThreeApplet, IoThreeExample, ThreeAppletProps } from '@io-gui/three'\nimport { ioSplit, Split } from '@io-gui/layout'\nimport { ioThreeViewport } from '@io-gui/three'\n\n@Register\nexport class GeometryConvexExample extends ThreeApplet {\n\n  public group: Group\n\n  constructor(args: ThreeAppletProps) {\n    super(args)\n\n    // ambient light\n\n    this.scene.add( new AmbientLight( 0x666666 ) )\n\n    // point light\n\n    const light = new PointLight( 0xffffff, 3, 0, 0 )\n    light.position.set( 15, 20, 30 )\n    this.scene.add( light )\n\n    // textures\n\n    const loader = new TextureLoader()\n    const spriteTexture = loader.load( 'https://threejs.org/examples/textures/sprites/disc.png' )\n    spriteTexture.colorSpace = SRGBColorSpace\n\n    this.group = new Group()\n    this.scene.add( this.group )\n\n    // points\n\n    let dodecahedronGeometry: BufferGeometry = new DodecahedronGeometry( 10 )\n\n    // if normal and uv attributes are not removed, mergeVertices() can't consolidate identical vertices with different normal/uv data\n\n    dodecahedronGeometry.deleteAttribute( 'normal' )\n    dodecahedronGeometry.deleteAttribute( 'uv' )\n\n    dodecahedronGeometry = BufferGeometryUtils.mergeVertices( dodecahedronGeometry )\n\n    const vertices: Vector3[] = []\n    const positionAttribute = dodecahedronGeometry.getAttribute( 'position' )\n\n    for ( let i = 0; i < positionAttribute.count; i++ ) {\n\n      const vertex = new Vector3()\n      vertex.fromBufferAttribute( positionAttribute, i )\n      vertices.push( vertex )\n\n    }\n\n    // Create instanced points using PointsNodeMaterial and Sprite\n    const positions: number[] = []\n\n    for ( const vertex of vertices ) {\n      positions.push( vertex.x, vertex.y, vertex.z )\n    }\n\n    const positionInstancedAttribute = new InstancedBufferAttribute( new Float32Array( positions ), 3 )\n\n    const pointsMaterial = new PointsNodeMaterial( {\n      colorNode: color( 0x0080ff ).mul( texture( spriteTexture ) ),\n      opacityNode: texture(spriteTexture).a,\n      positionNode: instancedBufferAttribute( positionInstancedAttribute ),\n      sizeNode: float( 10 ),\n      sizeAttenuation: false,\n      transparent: true,\n      alphaTest: 0.5\n    } )\n\n    const instancedPoints = new Sprite( pointsMaterial )\n    instancedPoints.count = vertices.length\n    this.group.add( instancedPoints )\n\n    // convex hull\n\n    const meshMaterial = new MeshLambertMaterial( {\n      color: 0xffffff,\n      opacity: 0.5,\n      side: DoubleSide,\n      transparent: true\n    } )\n\n    const meshGeometry = new ConvexGeometry( vertices )\n\n    const mesh = new Mesh( meshGeometry, meshMaterial )\n    this.group.add( mesh )\n  }\n\n  onAnimate() {\n    this.group.rotation.y += 0.005\n  }\n}\n\n@Register\nexport class IoGeometryConvexExample extends IoThreeExample {\n\n  @ReactiveProperty({type: GeometryConvexExample, init: {playing: true}})\n  declare applet: GeometryConvexExample\n\n  ready() {\n\n    this.render([\n      ioSplit({\n        elements: [\n          ioThreeViewport({id: 'Top', applet: this.applet, cameraSelect: 'top'}),\n          ioThreeViewport({id: 'Left', applet: this.applet, cameraSelect: 'left'}),\n          ioThreeViewport({id: 'Perspective', applet: this.applet, cameraSelect: 'perspective'}),\n          ioThreeViewport({id: 'SceneCamera', applet: this.applet, cameraSelect: 'scene'}),\n        ],\n        split: new Split({\n          type: 'split',\n          orientation: 'vertical',\n          children: [\n            {\n              type: 'split',\n              flex: '1 1 60px',\n              orientation: 'horizontal',\n              children: [\n                {type: 'panel',flex: '1 1 60px',tabs: [{id: 'Top'}]},\n                {type: 'panel',flex: '1 1 60px',tabs: [{id: 'Left'}]}\n              ]\n            },\n            {\n              type: 'split',\n              flex: '1 1 60px',\n              orientation: 'horizontal',\n              children: [\n                {type: 'panel',flex: '1 1 60px',tabs: [{id: 'Perspective'}]},\n                {type: 'panel',flex: '1 1 60px',tabs: [{id: 'SceneCamera'}]},\n              ]\n            }\n          ]\n        })\n      })\n    ])\n\n  }\n\n}\n\nexport const ioGeometryConvexExample = IoGeometryConvexExample.vConstructor\n"]}