{"version":3,"file":"WebGPUCamera.js","sourceRoot":"","sources":["../../../src/demos/examples/WebGPUCamera.ts"],"names":[],"mappings":"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","sourcesContent":["import { PerspectiveCamera, OrthographicCamera, CameraHelper, Group, BufferGeometry, Float32BufferAttribute, MathUtils, Mesh, MeshBasicMaterial, Points, PointsMaterial, SphereGeometry } from 'three/build/three.webgpu.js'\nimport { Register } from 'io-core'\nimport { ThreeState } from 'io-three'\n\nconst frustumSize = 600;\n\n@Register\nexport class WebGPUCamera extends ThreeState {\n\n  public perspectiveCamera: PerspectiveCamera\n  public orthographicCamera: OrthographicCamera\n  public cameraRig: Group\n  public perspectiveCameraHelper: CameraHelper\n  public orthographicCameraHelper: CameraHelper\n  public mesh: Mesh\n\n  constructor() {\n    super()\n\n    this.perspectiveCamera = new PerspectiveCamera( 50, 0.5, 150, 1000 );\n    this.perspectiveCamera.name = 'perspectiveCamera'\n    this.perspectiveCameraHelper = new CameraHelper( this.perspectiveCamera );\n    this.scene.add( this.perspectiveCameraHelper );\n\n    this.orthographicCamera = new OrthographicCamera( -1, 1, 1, -1, 150, 1000 );\n    this.orthographicCamera.name = 'orthographicCamera'\n    this.orthographicCameraHelper = new CameraHelper( this.orthographicCamera );\n    this.scene.add( this.orthographicCameraHelper );\n\n    // counteract different front orientation of cameras vs rig\n\n    this.orthographicCamera.rotation.y = Math.PI;\n    this.perspectiveCamera.rotation.y = Math.PI;\n\n    this.cameraRig = new Group();\n\n    this.cameraRig.add( this.perspectiveCamera );\n    this.cameraRig.add( this.orthographicCamera );\n\n    this.scene.add( this.cameraRig );\n\n    //\n\n    this.mesh = new Mesh(\n      new SphereGeometry( 100, 16, 8 ),\n      new MeshBasicMaterial( { color: 0xffffff, wireframe: true } )\n    );\n    this.scene.add( this.mesh );\n\n    const mesh2 = new Mesh(\n      new SphereGeometry( 50, 16, 8 ),\n      new MeshBasicMaterial( { color: 0x00ff00, wireframe: true } )\n    );\n    mesh2.position.y = 150;\n    this.mesh.add( mesh2 );\n\n    const mesh3 = new Mesh(\n      new SphereGeometry( 5, 16, 8 ),\n      new MeshBasicMaterial( { color: 0x0000ff, wireframe: true } )\n    );\n    mesh3.position.z = 150;\n    this.cameraRig.add( mesh3 );\n\n    //\n\n    const geometry = new BufferGeometry();\n    const vertices = [];\n\n    for ( let i = 0; i < 10000; i ++ ) {\n\n      vertices.push( MathUtils.randFloatSpread( 2000 ) ); // x\n      vertices.push( MathUtils.randFloatSpread( 2000 ) ); // y\n      vertices.push( MathUtils.randFloatSpread( 2000 ) ); // z\n\n    }\n\n    geometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n    const particles = new Points( geometry, new PointsMaterial( { color: 0xffffff } ) );\n    this.scene.add( particles );\n\n  }\n\n  onResized(width: number, height: number) {\n    super.onResized(width, height);\n    const aspect = width / height;\n\n    this.perspectiveCamera.aspect = aspect;\n    this.perspectiveCamera.updateProjectionMatrix();\n\n    this.orthographicCamera.left = - frustumSize * aspect / 2;\n    this.orthographicCamera.right = frustumSize * aspect / 2;\n    this.orthographicCamera.top = frustumSize / 2;\n    this.orthographicCamera.bottom = - frustumSize / 2;\n    this.orthographicCamera.updateProjectionMatrix();\n  }\n  onAnimate() {\n    const r = Date.now() * 0.0005;\n\n    this.mesh.position.x = 700 * Math.cos( r );\n    this.mesh.position.z = 700 * Math.sin( r );\n    this.mesh.position.y = 700 * Math.sin( r );\n\n    this.mesh.children[ 0 ].position.x = 70 * Math.cos( 2 * r );\n    this.mesh.children[ 0 ].position.z = 70 * Math.sin( r );\n\n    this.perspectiveCamera.fov = 35 + 30 * Math.sin( 0.5 * r );\n    this.perspectiveCamera.far = this.mesh.position.length();\n    this.perspectiveCamera.updateProjectionMatrix();\n    this.perspectiveCameraHelper.update();\n\n    this.orthographicCamera.far = this.mesh.position.length();\n    this.orthographicCamera.updateProjectionMatrix();\n    this.orthographicCameraHelper.update();\n\n    this.cameraRig.lookAt( this.mesh.position );\n  }\n}"]}