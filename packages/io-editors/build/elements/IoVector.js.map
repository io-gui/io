{"version":3,"file":"IoVector.js","sourceRoot":"","sources":["../../src/elements/IoVector.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, IoElement, ReactiveProperty, IoElementProps, WithBinding, VDOMElement, Node } from 'io-core';\nimport { ioNumber, ioBoolean } from 'io-inputs';\n\nexport type IoVectorProps = IoElementProps & {\n  value?: {\n    x?: number,\n    y?: number,\n    z?: number,\n    w?: number,\n    r?: number,\n    g?: number,\n    b?: number,\n    a?: number,\n    u?: number,\n    v?: number,\n  },\n  conversion?: number,\n  step?: number,\n  min?: number,\n  max?: number,\n  linkable?: boolean,\n  linked?: WithBinding<boolean>,\n  ladder?: boolean,\n};\n/**\n * Input element for vector arrays and objects.\n **/\n@Register\nexport class IoVector extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex: 1 1 auto;\n      }\n      :host > io-number {\n        flex: 1 1 auto;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n      :host > io-boolicon {\n        flex-shrink: 0;\n        padding: var(--io_spacing);\n      }\n    `;\n  }\n\n  @ReactiveProperty({type: Object})\n  declare value: {\n    x?: number,\n    y?: number,\n    z?: number,\n    w?: number,\n    r?: number,\n    g?: number,\n    b?: number,\n    a?: number,\n    u?: number,\n    v?: number,\n  };\n\n  @ReactiveProperty(1)\n  declare conversion: number;\n\n  @ReactiveProperty(0.001)\n  declare step: number;\n\n  @ReactiveProperty(-Infinity)\n  declare min: number;\n\n  @ReactiveProperty(Infinity)\n  declare max: number;\n\n  @ReactiveProperty(false)\n  declare linkable: boolean;\n\n  @ReactiveProperty(false)\n  declare linked: boolean;\n\n  @ReactiveProperty(true)\n  declare ladder: boolean;\n\n  @ReactiveProperty({type: Array, init: null})\n  declare keys: string[];\n\n  private _ratios: any = {};\n\n  _onNumberPointerDown(event: PointerEvent) {\n    const item = event.composedPath()[0] as HTMLElement;\n    const id = item.id as keyof typeof this.value;\n    this._ratios = {};\n    if (this.linked && this.value[id] !== 0) {\n      const value = this.value as any;\n      for (const k of this.keys) this._ratios[k] = value[k] / value[id];\n    }\n  }\n\n  _onNumberValueInput(event: CustomEvent) {\n    const item = event.composedPath()[0] as HTMLElement;\n    const id = item.id as keyof typeof this.value;\n    (this.value as any)[id] = event.detail.value;\n    if (this.linked) {\n      for (const k of this.keys) {\n        const value = this.value as any;\n        if (k !== id && this._ratios[k]) (value as any)[k] = value[id] * this._ratios[k];\n      }\n    }\n    if (!(this.value as unknown as Node)._isNode) {\n      this.dispatchMutation(this.value);\n    }\n    this.dispatch('value-input', {property: 'value', value: this.value}, false);\n  }\n\n  valueChanged() {\n    this.keys.length = 0;\n    this.keys.push(...Object.keys(this.value).filter(key => typeof (this.value as any)[key] === 'number') as Array<keyof typeof this.value>);\n    debug: if (this.keys.find(k => ['0', '1', '2', '3', 'x', 'y', 'z', 'w', 'r', 'g', 'b', 'a', 'u', 'v'].indexOf(k) === -1)) {\n      console.warn('IoVector: Unrecognized vector type!');\n    }\n  }\n  valueMutated() {\n    this.debounce(this.changed);\n  }\n  changed() {\n    const vChildren: Array<VDOMElement | null> = [];\n    for (const k of this.keys as [keyof typeof this.value]) {\n      if (this.value[k] !== undefined) {\n        vChildren.push(ioNumber({\n          id: k,\n          value: this.value[k],\n          conversion: this.conversion,\n          step: this.step,\n          min: this.min,\n          max: this.max,\n          ladder: this.ladder,\n          '@pointerdown': this._onNumberPointerDown,\n          '@value-input': this._onNumberValueInput,\n        }));\n      }\n    }\n    vChildren.push(this.linkable ? ioBoolean({value: this.bind('linked') as any, true: 'io:link', false: 'io:unlink'}) : null);\n    this.render(vChildren);\n  }\n}\nexport const ioVector = function(arg0?: IoVectorProps) {\n  return IoVector.vConstructor(arg0);\n};"]}