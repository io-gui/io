import{Property as t,Register as e,IoElement as o,div as i,span as n,Node as r,IoGl as s,Theme as l,Color as a,Storage as c}from"io-gui";import{ioOptionMenu as p,MenuOptions as d}from"io-menus";import{ioNumberSlider as h}from"io-sliders";import{ioColorRgba as u}from"io-colors";import{ioBoolean as g,ioNumber as f,ioString as v,ioSwitch as b,ioInputBase as y,ioField as m}from"io-inputs";import{ioCollapsible as _}from"io-navigation";var __decorate$5=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let j=class IoPropertyEditor extends o{static vConstructor;static get Style(){return"\n    :host {\n      display: flex;\n      flex-direction: column;\n      color: var(--io_colorInput);\n      background-color: var(--io_bgColor);\n    }\n    :host > .row {\n      display: flex;\n      flex-direction: row;\n    }\n    :host > .row > span {\n      margin-top: calc(var(--io_spacing) + var(--io_borderWidth));\n    }\n    :host > .row > span:after {\n      display: inline-block;\n      padding-right: var(--io_spacing2);\n      content: ':';\n    }\n    :host io-object > io-property-editor {\n      padding-left: var(--io_lineHeight);\n    }\n    "}_onValueInput(t){if(t.detail.object)return;if(t.composedPath()[0]===this)return;t.stopImmediatePropagation();const e=Object.keys(this.$).find((e=>this.$[e]===t.target));if(void 0!==e){const o=t.detail.value,i=t.detail.oldValue;if(this.value[e]=o,!this.value._isNode){const t={object:this.value,property:e,value:o,oldValue:i};this.dispatchEvent("object-mutated",t,!1,window)}}}valueMutated(){this.debounce(this.changed)}changed(){const t=getEditorConfig(this.value,this.config),e=[],o=this.properties.length?this.properties:Object.keys(this.value);for(let r=0;r<o.length;r++)if(Object.prototype.hasOwnProperty.call(this.value,o[r])){const s=o[r],l=this.value[s],a=t[s].name,c=t[s].props||{},p={$:s,value:l,"@value-input":this._onValueInput};Object.assign(p,c),e.push(i({class:"row"},[this.labeled?n(s):null,{name:a,props:p}]))}this.template(e)}toJSON(){return Object.assign({},super.toJSON(),this)}};__decorate$5([t("debounced")],j.prototype,"reactivity",void 0),__decorate$5([t({type:Object})],j.prototype,"value",void 0),__decorate$5([t({type:Array})],j.prototype,"properties",void 0),__decorate$5([t({type:Map})],j.prototype,"config",void 0),__decorate$5([t(!0)],j.prototype,"labeled",void 0),j=__decorate$5([e],j);const x=j.vConstructor;var __decorate$4=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let w=class IoObject extends o{static vConstructor;static get Style(){return'\n    :host {\n      /* Panel */\n      display: flex;\n      flex-direction: column; */\n      padding-left: var(--io_spacing);\n      padding-right: var(--io_spacing);\n      color: var(--io_colorInput);\n      background-color: var(--io_bgColor);\n    }\n    :host > io-boolean {\n      padding-left: 0;\n      padding-right: 0;\n      align-self: stretch;\n    }\n    :host > io-boolean:before {\n      display: inline-block;\n      width: 0.75em;\n      content: "▸"\n    }\n    :host > io-boolean[value]:before {\n      content: "▾";\n    }\n    '}changed(){const t=this.label||this.value.constructor.name,e=[];e.push(g({appearance:"neutral",true:t,false:t,value:this.bind("expanded")})),this.expanded&&e.push(x({value:this.value,properties:this.properties,config:this.config,labeled:this.labeled})),this.template(e),this.setAttribute("aria-expanded",String(this.expanded))}};__decorate$4([t({})],w.prototype,"value",void 0),__decorate$4([t({type:Array})],w.prototype,"properties",void 0),__decorate$4([t({type:Map})],w.prototype,"config",void 0),__decorate$4([t(!0)],w.prototype,"labeled",void 0),__decorate$4([t("")],w.prototype,"label",void 0),__decorate$4([t({value:!1,reflect:!0})],w.prototype,"expanded",void 0),__decorate$4([t("region")],w.prototype,"role",void 0),w=__decorate$4([e],w);const O=w.vConstructor;var __decorate$3=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let k=class IoVector extends o{static vConstructor;static get Style(){return"\n      :host {\n        display: flex;\n        flex: 0 1 auto;\n        min-width: var(--io_fieldHeight5);\n        width: var(--io_fieldHeight8);\n      }\n      :host > io-number {\n        flex: 1 1 100%;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n      :host > io-boolicon {\n        flex-shrink: 0;\n        padding: var(--io_spacing);\n      }\n    "}_ratios={};_onNumberPointerDown(t){const e=t.composedPath()[0].id;if(this._ratios={},this.linked&&0!==this.value[e])for(const t of this.keys)this._ratios[t]=this.value[t]/this.value[e]}_onNumberValueInput(t){const e=t.composedPath()[0].id,o=t.detail.value,i=t.detail.oldValue,n=this.value;if(n[e]=o,this.linked)for(const t of this.keys)t!==e&&this._ratios[t]&&(n[t]=n[e]*this._ratios[t]);const r=this.linked?{object:this.value}:{object:this.value,property:e,value:n,oldValue:i};this.dispatchEvent("object-mutated",r,!1,window)}valueChanged(){this.keys.length=0,this.keys.push(...Object.keys(this.value).filter((t=>"number"==typeof this.value[t])))}valueMutated(){this.debounce(this.changed)}changed(){const t=[];for(const e of this.keys)void 0!==this.value[e]&&t.push(f({id:e,value:this.value[e],conversion:this.conversion,step:this.step,min:this.min,max:this.max,ladder:this.ladder,"@pointerdown":this._onNumberPointerDown,"@value-input":this._onNumberValueInput}));t.push(this.getSlotted()),this.template(t)}getSlotted(){return this.linkable?g({value:this.bind("linked"),true:"io:link",false:"io:unlink"}):null}};__decorate$3([t({type:Object})],k.prototype,"value",void 0),__decorate$3([t(1)],k.prototype,"conversion",void 0),__decorate$3([t(.001)],k.prototype,"step",void 0),__decorate$3([t(-Infinity)],k.prototype,"min",void 0),__decorate$3([t(Infinity)],k.prototype,"max",void 0),__decorate$3([t(!1)],k.prototype,"linkable",void 0),__decorate$3([t(!1)],k.prototype,"linked",void 0),__decorate$3([t(!0)],k.prototype,"ladder",void 0),__decorate$3([t({type:Array})],k.prototype,"keys",void 0),k=__decorate$3([e],k);const C=k.vConstructor,P=new Map([[Object,[[String,v()],[Number,f({step:.01})],[Boolean,b()],[Object,O()],[null,y()],[void 0,y()]]],[Array,[[Number,f({step:.01})]]],[r,[["reactivity",p({options:(new d).fromJSON(["none","debounced","immediate"])})]]],[o,[["reactivity",p({options:(new d).fromJSON(["none","debounced","immediate"])})],["tabindex",p({options:(new d).fromJSON([{value:"",label:"none"},"-1","0","1","2","3"])})],["role",p({options:(new d).fromJSON(["alert","alertdialog","application","article","banner","button","cell","checkbox","columnheader","combobox","complementary","contentinfo","definition","dialog","directory","document","feed","figure","form","grid","gridcell","group","heading","img","link","list","listbox","listitem","log","main","marquee","math","menu","menubar","menuitem","menuitemcheckbox","menuitemradio","navigation","none","note","option","presentation","progressbar","radio","radiogroup","region","row","rowgroup","rowheader","scrollbar","search","searchbox","separator","slider","spinbutton","status","switch","tab","table","tablist","tabpanel","term","textbox","timer","toolbar","tooltip","tree","treegrid","treeitem"])})]]],[s,[["size",C({step:1})],["color",C({step:1})],["pxRatio",f({step:1e-4})]]],[l,[[Number,h({step:1,min:0,max:20})],["themeID",p({options:(new d).fromJSON(["light","dark"])})],["spacing2",m({disabled:!0})],["spacing3",m({disabled:!0})],["spacing5",m({disabled:!0})],["spacing8",m({disabled:!0})],["fieldHeight",m({disabled:!0})],["fieldHeight2",m({disabled:!0})],["fieldHeight3",m({disabled:!0})],["fieldHeight4",m({disabled:!0})],["fieldHeight5",m({disabled:!0})],["fieldHeight6",m({disabled:!0})],["fieldHeight7",m({disabled:!0})],["fieldHeight8",m({disabled:!0})],["fieldHeight9",m({disabled:!0})],["fieldHeight10",m({disabled:!0})],["fieldHeight11",m({disabled:!0})],["fieldHeight12",m({disabled:!0})],["borderRadius2",m({disabled:!0})],[a,u()]]]]);function getEditorConfig(t,e=new Map){const o=new Map;for(const[e,i]of P)if(t instanceof e)for(const[t,e]of i)o.set(t,e);for(const[i,n]of e)if(t instanceof i)for(const[t,e]of n)o.set(t,e);const i={};for(const[e,n]of Object.entries(t))for(const[t,r]of o){let o;("function"==typeof t&&n instanceof t||"function"==typeof t&&n?.constructor===t||"string"==typeof t&&e===t||null===t&&null===n||void 0===t&&void 0===n)&&(o=r),o&&(i[e]=o)}return i}class EditorGroups{constructor(t){for(let e=0;e<t.length;e++)this.registerEditorGroups(t[e].EditorGroups||{})}registerEditorGroups(t){for(const e in t){const o=this;o[e]=o[e]||[],o[e]=[...o[e],...t[e]]}}getEditorGroups(t,e,o){const i=[];let n=t.__proto__;for(;n;)i.push(n.constructor.name),n=n.__proto__;const r={},s=this;for(const e in s){const n=e.split("|");if(1===n.length&&n.splice(0,0,"Object"),n[1]=n[1].split(":"),-1!==i.indexOf(n[0])){if(!("properties"===n[1][1])){r[n[1][0]]=r[n[1][0]]||[];for(let i=0;i<s[e].length;i++){const l=s[e][i];if("string"==typeof l&&l.startsWith("constructor:")){const e=l.replace("constructor:","");for(let i=0;i<o.length;i++)t[o[i]]&&t[o[i]].name===e&&r[n[1][0]].push(o[i])}else if("string"==typeof l&&l.startsWith("type:")){const e=l.replace("type:","");for(let i=0;i<o.length;i++)t[o[i]]&&typeof t[o[i]]===e&&r[n[1][0]].push(o[i])}else r[n[1][0]].push(l)}}}}for(const t in e){const o=t.split("|");if(1===o.length&&o.splice(0,0,"Object"),o[1]=o[1].split(":"),-1!==i.indexOf(o[0])){"properties"===o[1][1]||(r[o[1][0]]=r[o[1][0]]||[],r[o[1][0]].push(...e[t]))}}const l={},a=[];for(const t in r){l[t]=l[t]||[];for(const e in r[t]){const i=r[t][e],n=new RegExp(i);for(let e=0;e<o.length;e++){const r=o[e];"string"==typeof i?r===i&&-1===a.indexOf(r)&&(l[t].push(r),a.push(r)):"object"==typeof i&&n.exec(r)&&-1===a.indexOf(r)&&(l[t].push(r),a.push(r))}}}if(0===a.length)l.properties=o;else{l.properties=l.properties||[];for(let t=0;t<o.length;t++)-1===a.indexOf(o[t])&&l.properties.push(o[t])}for(const t in l)0===l[t].length&&delete l[t];return delete l.hidden,l}}class ObjectWidgets{constructor(t){for(let e=0;e<t.length;e++)this.registerObjectWidgets(t[e].ObjectWidgets||{})}registerObjectWidgets(t){for(const e in t){const o=this;o[e]=o[e]||[],o[e]=[...o[e],...t[e]]}}getObjectWidgets(t){const e=[];let o=t.__proto__;for(;o;)e.push(o.constructor.name),o=o.__proto__;let i=null;const n={};for(const o in this){const r=o.split("|"),s=r[0],l=r[1];if(-1!==e.indexOf(s)){const e=this[o];e[1]=e[1]||{},e[1].$value?e[1].value=t[e[1].$value]:e[1].value=t,l?n[l]=e:i=e}}return{main:i,groups:n}}}var __decorate$2=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let R=class IoBreadcrumbs extends o{static vConstructor;static get Style(){return"\n    :host {\n      display: flex;\n      flex: 0 0 auto;\n      flex-direction: row;\n      align-self: stretch;\n      justify-self: stretch;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      padding: var(--io_spacing);\n      background-color: var(--io_bgColorInput);\n      overflow-x: hidden;\n    }\n    :host > io-input-base {\n      padding-left: var(--io_spacing);\n      padding-right: var(--io_spacing);\n      color: var(--io_colorBlue);\n    }\n    :host > io-input-base:hover {\n      text-decoration: underline;\n    }\n    :host > io-input-base:first-of-type {\n      overflow: visible;\n      text-overflow: clip;\n      margin-left: var(--io_spacing);\n    }\n    :host > io-input-base:last-of-type {\n      overflow: visible;\n      text-overflow: clip;\n      margin-right: var(--io_spacing);\n    }\n    :host > io-input-base:not(:first-of-type):before {\n      content: '>';\n      margin: 0 var(--io_spacing);\n      padding: 0 var(--io_spacing) 0 0;\n      opacity: 0.25;\n    }\n    "}_onClick(t){this.setProperty("selected",this.options[t.detail.value])}valueChanged(){this.options.length=0,this.options.push(this.value)}selectedChanged(){const t=this.options.indexOf(this.selected);-1!==t?this.options.length=t+1:this.options.push(this.selected)}changed(){const t=[];for(let e=0;e<this.options.length;e++)t.push(m({class:"select","@item-clicked":this._onClick},getLabel(this.options[e])));this.template(t)}};__decorate$2([t({type:Object})],R.prototype,"value",void 0),__decorate$2([t(null)],R.prototype,"selected",void 0),__decorate$2([t({type:Array})],R.prototype,"options",void 0),R=__decorate$2([e],R);const E=R.vConstructor;function getLabel(t){return String(t instanceof Array?`${t.constructor.name} (${t.length})`:"object"==typeof t?`${t.constructor.name}`:t)}var __decorate$1=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let I=class IoInspector extends o{static vConstructor;static get Style(){return"\n    :host {\n      display: flex;\n      flex: 1 1 auto;\n      flex-direction: column;\n      flex-wrap: nowrap;\n      align-self: stretch;\n      align-items: stretch;\n      justify-self: stretch;\n      flex: 0 1 calc(var(--io_lineHeight) * 17.5);\n    }\n    :host > * {\n      flex-shrink: 0;\n    }\n    :host > .inspector-header {\n      display: flex;\n      flex-direction: row;\n      margin-bottom: var(--io_spacing);\n      flex-grow: 0;\n    }\n    :host > .inspector-header > io-breadcrumbs {\n      flex: 1 1;\n    }\n    :host > .inspector-header > io-boolean {\n      width: calc(var(--io_spacing) + var(--io_lineHeight));\n      align-self: stretch;\n      height: auto;\n    }\n    :host > .inspector-header > io-boolean:not([value]) {\n      opacity: 0.25;\n    }\n    :host > .inspector-header > io-string {\n      margin: 0 var(--io_spacing);\n      padding: calc(2 * var(--io_spacing));\n      align-self: stretch;\n      height: auto;\n    }\n    :host > .inspector-header > io-string:focus {\n      width: 6em;\n    }\n    :host > .inspector-header > io-string:empty:before {\n      content: ' 🔍';\n      white-space: pre;\n      visibility: visible;\n      opacity: 0.33;\n    }\n    :host > io-collapsible > io-boolean,\n    :host > io-object > io-boolean {\n      text-transform: capitalize;\n    }\n    :host > io-object {\n      flex-basis: auto !important;\n    }\n    :host > io-object > io-property-editor {\n      border-radius: var(--io_borderRadius);\n      background-color: var(--io_bgColor) !important;\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      padding: var(--io_spacing);\n      overflow: hidden;\n    }\n    :host > io-object > io-property-editor:not([horizontal])[labeled] {\n      grid-template-columns: minmax(6em, min-content) minmax(12em, 1fr);\n    }\n    :host > io-object > io-property-editor:not([horizontal])[labeled] > span.io-input-base {\n      text-align: right;\n    }\n    :host io-property-editor io-input-base.select {\n      color: var(--io_colorBlue) !important;\n    }\n    :host io-property-editor io-input-base.select:hover {\n      text-decoration: underline;\n    }\n    "}static get Listeners(){return{"io-input-base-clicked":"_onItemClicked"}}_onItemClicked(t){t.stopPropagation();const e=t.detail.value,o=t.composedPath()[0];e&&"object"==typeof e&&o.classList.contains("select")&&this.setProperty("selected",e)}valueChanged(){this.selected=this.value}advancedChanged(){delete this._currentCfgLen}selectedMutated(){clearTimeout(this._cfgTimeout),this._cfgTimeout=setTimeout((()=>{this._onChange()}),100)}changed(){this._onChangedThrottled()}_onChangedThrottled(){this.throttle(this._onChange)}_onChange(){const t=getEditorConfig(this.selected);this._groups=this.__proto__._groups.getEditorGroups(this.selected,this.groups,Object.getOwnPropertyNames(t)),this._widgets=this.__proto__._widgets.getObjectWidgets(this.selected,this.widgets);const e=this.uuid||function genUUID(t){let e="io-object-collapse-state-"+t.constructor.name;e+="-"+(t.guid||t.uuid||t.id||"");const o=JSON.stringify(Object.keys(t));let i=0;for(let t=0;t<o.length;t++)i=(i<<5)-i+o.charCodeAt(t),i|=0;return i=(-i).toString(16),e+="-"+i,e}(this.selected),o=[i({class:"inspector-header"},[E({value:this.value,selected:this.bind("selected")})]),this._widgets.main?this._widgets.main:null];for(const t in this._widgets.groups)this._groups[t]||o.push(_({label:t,expanded:c({value:!0,storage:"local",key:e+"-"+t}),elements:[this._widgets.groups[t]]}));for(const t in this._groups)o.push(O({label:t,expanded:c({value:!0,storage:"local",key:this.uuid+"-"+t}),value:this.selected,properties:this._groups[t]}));this.template(o)}static get EditorGroups(){return{"Object|hidden":[/^_/],"Array|main":[/^[0-9]+$/],"HTMLElement|main":["localName","tagName","nodeName",/class/i,/attribute/i],"HTMLElement|hidden":[/^on/,/^[A-Z0-9_]*$/,"childElementCount"],"HTMLElement|content":[/content/i,/inner/i,/outer/i],"HTMLElement|display":[/width/i,/height/i,/top/i,/left/i,/scroll/i,/style/i],"HTMLElement|hierarchy":[/parent/i,/child/i,/element/i,/root/i,/slot/i,/sibling/i,/document/i]}}static get ObjectWidgets(){return{}}Register(t){super.Register(t),Object.defineProperty(t.prototype,"_groups",{writable:!0,value:new EditorGroups(t.prototype._protochain.constructors)}),Object.defineProperty(t.prototype,"_widgets",{writable:!0,value:new ObjectWidgets(t.prototype._protochain.constructors)})}};__decorate$1([t({})],I.prototype,"value",void 0),__decorate$1([t({})],I.prototype,"selected",void 0),__decorate$1([t("")],I.prototype,"uuid",void 0),__decorate$1([t("")],I.prototype,"search",void 0),__decorate$1([t({type:Object})],I.prototype,"groups",void 0),__decorate$1([t({type:Object})],I.prototype,"widgets",void 0),I=__decorate$1([e],I);const H=I.vConstructor;var __decorate=function(t,e,o,i){var n,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,i);else for(var l=t.length-1;l>=0;l--)(n=t[l])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let N=class IoMatrix extends k{static vConstructor;static get Style(){return'\n      :host {\n        display: grid;\n        align-self: stretch;\n        justify-self: stretch;\n        grid-gap: var(--io_spacing);\n      }\n      :host > *:not(:last-child) {\n        margin-right: 0;\n      }\n      :host[columns="4"] {\n        grid-template-columns: repeat(4, 1fr);\n      }\n      :host[columns="3"] {\n        grid-template-columns: repeat(3, 1fr);\n      }\n      :host[columns="2"] {\n        grid-template-columns: repeat(2, 1fr);\n      }\n    '}_onNumberValueInput(t){const e=t.composedPath()[0].id,o=t.detail.value,i=t.detail.oldValue;this.value[e]=o;const n={object:this.value,property:e,value:o,oldValue:i};this.dispatchEvent("object-mutated",n,!1,window)}valueChanged(){4===this.value.length&&this.setProperties({keys:["0","1","2","3"],columns:2}),9===this.value.length&&this.setProperties({keys:["0","1","2","3","4","5","6","7","8"],columns:3}),16===this.value.length&&this.setProperties({keys:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],columns:4})}};__decorate([t({type:Array,init:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]})],N.prototype,"value",void 0),__decorate([t({value:4,reflect:!0})],N.prototype,"columns",void 0),N=__decorate([e],N);const S=N.vConstructor;export{EditorGroups,R as IoBreadcrumbs,I as IoInspector,N as IoMatrix,w as IoObject,j as IoPropertyEditor,k as IoVector,ObjectWidgets,getEditorConfig,E as ioBreadcrumbs,H as ioInspector,S as ioMatrix,O as ioObject,x as ioPropertyEditor,C as ioVector};
