{"version":3,"file":"IoColorPicker.js","sourceRoot":"","sources":["../../src/elements/IoColorPicker.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, ReactiveProperty, IoElement, IoElementProps, Property, WithBinding, nudge } from 'io-core'\nimport { IoColorPanelSingleton as Panel } from './IoColorPanelSingleton.js'\nimport { ioColorSwatch } from './IoColorSwatch.js'\n\n// TODO: focus picker on expand.\n// TODO: collapse picker on blur.\n// TODO: fix focus keybord navigation.\n\nexport type IoColorPickerProps = IoElementProps &{\n  value: WithBinding<{ r: number; g: number; b: number; a?: number }>\n}\n\n@Register\nexport class IoColorPicker extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        height: var(--io_fieldHeight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorInset);\n        border-radius: var(--io_borderRadius);\n        overflow: hidden;\n      }\n      :host:focus {\n        @apply --io_focus;\n      }\n      :host > io-color-swatch {\n        width: 100%;\n        height: 100%;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: {r: 1, g: 1, b: 1, a: 1}})\n  declare value: {r: number; g: number; b: number; a?: number}\n\n  static get Listeners(): any {\n    return {\n      'click': 'onClick',\n      'keydown': 'onKeydown',\n    }\n  }\n\n  @Property(0)\n  declare tabIndex: number\n\n  get expanded() {\n    return Panel.expanded && Panel.value === this.value\n  }\n\n  ready() {\n    this.valueChanged()\n  }\n\n  onClick() {\n    if (!this.expanded) this.expand()\n  }\n\n  onKeydown(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Enter':\n      case ' ':\n        event.preventDefault()\n        if (!this.expanded) this.expand()\n        break\n      default:\n        if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'].includes(event.key)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n    }\n  }\n  onValueSet() {\n    this.dispatch('value-input', {property: 'value', value: this.value}, true)\n  }\n  onPanelCollapse() {\n    // TODO: Reconsider this.\n    if (!this.expanded) {\n      Panel.removeEventListener('value-input', this.onValueSet)\n      Panel.removeEventListener('expanded-changed', this.onPanelCollapse)\n    }\n  }\n  expand() {\n    Panel.value = this.value\n    Panel.expanded = true\n    Panel.addEventListener('value-input', this.onValueSet)\n    Panel.addEventListener('expanded-changed', this.onPanelCollapse)\n    nudge(Panel, this, 'right');\n    (Panel.firstChild?.firstChild as HTMLElement)?.focus()\n  }\n  collapse() {\n    Panel.expanded = false\n    Panel.value = {r: 1, g: 1, b: 1, a: 1}\n  }\n  valueChanged() {\n    this.render([\n      ioColorSwatch({value: this.value})\n    ])\n  }\n}\nexport const ioColorPicker = function(arg0: IoColorPickerProps) {\n  return IoColorPicker.vConstructor(arg0)\n}\n"]}