{"version":3,"file":"index.js","sources":["../src/lib/color.convert.ts","../src/elements/IoColorBase.ts","../src/elements/IoColorSliders.ts","../src/elements/IoColorPanelSingleton.ts","../src/elements/IoColorSwatch.ts","../src/elements/IoColorPicker.ts","../src/elements/IoColorRgba.ts"],"sourcesContent":["/**@License\n * Copyright (c) 2011-2016 Heather Arthur <fayearthur@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n/* MIT license */\n\nexport const rgb2hsl = function (rgb: number[]) {\n  const r = rgb[0] / 255\n  const g = rgb[1] / 255\n  const b = rgb[2] / 255\n  const min = Math.min(r, g, b)\n  const max = Math.max(r, g, b)\n  const delta = max - min\n  let h = 0\n  let s\n\n  if (max === min) {\n    h = 0\n  } else if (r === max) {\n    h = (g - b) / delta\n  } else if (g === max) {\n    h = 2 + (b - r) / delta\n  } else if (b === max) {\n    h = 4 + (r - g) / delta\n  }\n\n  h = Math.min(h * 60, 360)\n\n  if (h < 0) {\n    h += 360\n  }\n\n  const l = (min + max) / 2\n\n  if (max === min) {\n    s = 0\n  } else if (l <= 0.5) {\n    s = delta / (max + min)\n  } else {\n    s = delta / (2 - max - min)\n  }\n\n  return [h, s * 100, l * 100]\n}\n\nexport const rgb2hsv = function (rgb: number[]) {\n  let rdif\n  let gdif\n  let bdif\n  let h = 0\n  let s\n\n  const r = rgb[0] / 255\n  const g = rgb[1] / 255\n  const b = rgb[2] / 255\n  const v = Math.max(r, g, b)\n  const diff = v - Math.min(r, g, b)\n  const diffc = function (c: number) {\n    return (v - c) / 6 / diff + 1 / 2\n  }\n\n  if (diff === 0) {\n    h = 0\n    s = 0\n  } else {\n    s = diff / v\n    rdif = diffc(r)\n    gdif = diffc(g)\n    bdif = diffc(b)\n\n    if (r === v) {\n      h = bdif - gdif\n    } else if (g === v) {\n      h = (1 / 3) + rdif - bdif\n    } else if (b === v) {\n      h = (2 / 3) + gdif - rdif\n    }\n\n    if (h < 0) {\n      h += 1\n    } else if (h > 1) {\n      h -= 1\n    }\n  }\n\n  return [\n    h * 360,\n    s * 100,\n    v * 100\n  ]\n}\n\nexport const hsl2rgb = function (hsl: number[]) {\n  const h = hsl[0] / 360\n  const s = hsl[1] / 100\n  const l = hsl[2] / 100\n  let t2\n  let t3\n  let val\n\n  if (s === 0) {\n    val = l * 255\n    return [val, val, val]\n  }\n\n  if (l < 0.5) {\n    t2 = l * (1 + s)\n  } else {\n    t2 = l + s - l * s\n  }\n\n  const t1 = 2 * l - t2\n\n  const rgb = [0, 0, 0]\n  for (let i = 0; i < 3; i++) {\n    t3 = h + 1 / 3 * -(i - 1)\n    if (t3 < 0) {\n      t3++\n    }\n\n    if (t3 > 1) {\n      t3--\n    }\n\n    if (6 * t3 < 1) {\n      val = t1 + (t2 - t1) * 6 * t3\n    } else if (2 * t3 < 1) {\n      val = t2\n    } else if (3 * t3 < 2) {\n      val = t1 + (t2 - t1) * (2 / 3 - t3) * 6\n    } else {\n      val = t1\n    }\n\n    rgb[i] = val * 255\n  }\n\n  return rgb\n}\n\nexport const hsv2rgb = function (hsv: number[]) {\n  const h = hsv[0] / 60\n  const s = hsv[1] / 100\n  let v = hsv[2] / 100\n  const hi = Math.floor(h) % 6\n\n  const f = h - Math.floor(h)\n  const p = 255 * v * (1 - s)\n  const q = 255 * v * (1 - (s * f))\n  const t = 255 * v * (1 - (s * (1 - f)))\n  v *= 255\n\n  switch (hi) {\n    case 0:\n      return [v, t, p]\n    case 1:\n      return [q, v, p]\n    case 2:\n      return [p, v, t]\n    case 3:\n      return [p, q, v]\n    case 4:\n      return [t, p, v]\n    case 5:\n    default:\n      return [v, p, q]\n  }\n}\n","import { IoElement, IoElementProps, ReactiveProperty, Register, WithBinding, ReactivityType } from '@io-gui/core'\nimport { hsl2rgb, rgb2hsl, rgb2hsv, hsv2rgb } from '../lib/color.convert.js'\n\nexport type IoColorBaseProps = IoElementProps & {\n  value?: WithBinding<{ r: number; g: number; b: number; a?: number }>\n}\n\n@Register\nexport class IoColorBase extends IoElement {\n\n  @ReactiveProperty('throttled')\n  declare reactivity: ReactivityType\n\n  @ReactiveProperty({type: Object, init: {r: 1, g: 1, b: 1, a: 1}})\n  declare value: {r: number; g: number; b: number; a?: number}\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1, 1]})\n  declare rgba: [number, number, number, number]\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1]})\n  declare hsv: [number, number, number]\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1]})\n  declare hsl: [number, number, number]\n\n  ready() {\n    // this.throttle(this.valueChanged);\n    this.valueChanged()\n    this.changed()\n  }\n  valueMutated() {\n    // this.throttle(this.valueChanged);\n    this.valueChanged()\n    this.changed()\n  }\n  rgbFromHsv() {\n    const rgb = hsv2rgb([\n      this.hsv[0] * 360,\n      this.hsv[1] * 100,\n      this.hsv[2] * 100,\n    ])\n    this.rgba[0] = rgb[0] / 255\n    this.rgba[1] = rgb[1] / 255\n    this.rgba[2] = rgb[2] / 255\n  }\n  rgbFromHsl() {\n    const rgb = hsl2rgb([\n      this.hsl[0] * 360,\n      this.hsl[1] * 100,\n      this.hsl[2] * 100,\n    ])\n    this.rgba[0] = rgb[0] / 255\n    this.rgba[1] = rgb[1] / 255\n    this.rgba[2] = rgb[2] / 255\n  }\n  valueFromRgb() {\n    this.value.r = this.rgba[0]\n    this.value.g = this.rgba[1]\n    this.value.b = this.rgba[2]\n  }\n  valueChanged() {\n    debug: {\n      const c = Object.keys(this.value)\n      if (c.indexOf('r') === -1 || c.indexOf('g') === -1 || c.indexOf('b') === -1) {\n        console.warn('IoColor: Incorrect value type!')\n      }\n    }\n\n    const rgb = [this.value.r * 255, this.value.g * 255, this.value.b * 255]\n    const hsv = rgb2hsv(rgb)\n    const hsl = rgb2hsl(rgb)\n\n    // Prevent color conversion from flippping hue 360.\n    if (hsv[0] === 0 || hsv[0] === 360) hsv[0] = this.hsv[0] * 360\n    if (hsl[0] === 0 || hsl[0] === 360) hsl[0] = this.hsl[0] * 360\n\n    // Prevent saturation 0 from collapsing hue to 0.\n    if (hsv[1] === 0) hsv[0] = this.hsv[0] * 360\n    if (hsl[1] === 0) hsl[0] = this.hsl[0] * 360\n\n    // Prevent lightness/value 0 from collapsing hue/saturation to 0.\n    if (hsv[2] === 0) hsv[1] = this.hsv[1] * 100\n    if (hsl[2] === 0 || hsl[2] === 100) {\n      hsl[0] = this.hsl[0] * 360\n      hsl[1] = this.hsl[1] * 100\n    }\n\n    this.rgba[0] = rgb[0] / 255\n    this.rgba[1] = rgb[1] / 255\n    this.rgba[2] = rgb[2] / 255\n    this.rgba[3] = this.value.a ?? 1\n    this.hsv[0] = hsv[0] / 360\n    this.hsv[1] = hsv[1] / 100\n    this.hsv[2] = hsv[2] / 100\n    this.hsl[0] = hsl[0] / 360\n    this.hsl[1] = hsl[1] / 100\n    this.hsl[2] = hsl[2] / 100\n\n    this.setProperties({\n      rgba: this.rgba,\n      hsv: this.hsv,\n      hsl: this.hsl,\n    })\n  }\n}\n","import { Register, ReactiveProperty, glsl, WithBinding, ReactiveNode } from '@io-gui/core'\nimport { IoSlider, IoSlider2d } from '@io-gui/sliders'\nimport { IoColorBase, IoColorBaseProps } from './IoColorBase.js'\n\nexport type IoColorSliderProps = IoColorBaseProps & {\n  color?: WithBinding<[number, number, number, number]>\n  step?: number\n  channel?: 'r' | 'g' | 'b' | 'a' | 'h' | 's' | 'v' | 'l' | 'hs' | 'sv' | 'sl'\n  vertical?: boolean\n}\n\n/**\n * A generic color slider element.\n * It is a wrapper for channel-specific sliders which are added as a child of this element depending on the `channel` property.\n * For example, setting `channel: 'h'` will instantiate a slider for \"hue\" color channel and hook up necessary conversions, bindings and event callbacks.\n **/\n@Register\nexport class IoColorSlider extends IoColorBase {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n      }\n    `\n  }\n\n  // Is this needed? Perhgaps value can be used in glsl?\n  @ReactiveProperty({type: Array, init: [0, 0, 0, 0]})\n  declare color: [number, number, number, number]\n\n  @ReactiveProperty({type: Number, value: 0.01})\n  declare step: number\n\n  @ReactiveProperty('a')\n  declare channel: 'r' | 'g' | 'b' | 'a' | 'h' | 's' | 'v' | 'l' | 'hs' | 'sv' | 'sl'\n\n  @ReactiveProperty({value: false, reflect: true})\n  declare vertical: boolean\n\n  _onValueInput(event: CustomEvent) {\n    const v = event.detail.value\n    const oldValue = JSON.stringify(this.value)\n    switch (this.channel) {\n      case 'r':\n        this.value.r = v\n        break\n        case 'g':\n        this.value.g = v\n        break\n        case 'b':\n        this.value.b = v\n        break\n        case 'a':\n        this.value.a = v\n        break\n      case 'h':\n        this.hsv[0] = v\n        this.rgbFromHsv()\n        this.valueFromRgb()\n        break\n      case 's':\n        this.hsv[1] = v\n        this.rgbFromHsv()\n        this.valueFromRgb()\n        break\n      case 'v':\n        this.hsv[2] = v\n        this.rgbFromHsv()\n        this.valueFromRgb()\n        break\n      case 'l':\n        this.hsl[2] = v\n        this.rgbFromHsl()\n        this.valueFromRgb()\n        break\n      case 'hs':\n        this.hsv[0] = v[0]\n        this.hsv[1] = v[1]\n        this.rgbFromHsv()\n        this.valueFromRgb()\n        break\n      case 'sv':\n        this.hsv[1] = v[0]\n        this.hsv[2] = v[1]\n        this.rgbFromHsv()\n        this.valueFromRgb()\n        break\n      case 'sl':\n        this.hsl[1] = v[0]\n        this.hsl[2] = v[1]\n        this.rgbFromHsl()\n        this.valueFromRgb()\n        break\n    }\n    if (oldValue === JSON.stringify(this.value)) return\n\n    if (!(this.value as unknown as ReactiveNode)._isNode) {\n      this.dispatchMutation(this.value)\n    }\n    this.dispatch('value-input', {property: 'value', value: this.value}, false)\n  }\n\n  changed() {\n    const c = this.channel\n\n    debug: if (['r', 'g', 'b', 'a', 'h', 's', 'v', 'l', 'hs', 'sv', 'sl'].indexOf(c) === -1) {\n      console.warn('IoColorSlider: Incorrect channel value!', c)\n    }\n\n    let slider = null\n    switch (c) {\n      case 'r': slider = ioColorSliderR(); break\n      case 'g': slider = ioColorSliderG(); break\n      case 'b': slider = ioColorSliderB(); break\n      case 'a': slider = ioColorSliderA(); break\n      case 'h': slider = ioColorSliderH(); break\n      case 's': slider = ioColorSliderS(); break\n      case 'v': slider = ioColorSliderV(); break\n      case 'l': slider = ioColorSliderL(); break\n      case 'hs': slider = ioColorSliderHs(); break\n      case 'sv': slider = ioColorSliderSv(); break\n      case 'sl': slider = ioColorSliderSl(); break\n    }\n    let value: number | [number, number] = 0\n    let color: [number, number, number, number] = [0, 0, 0, 0]\n    let min: number | [number, number] = 0\n    let max: number | [number, number] = 1\n    let step: number | [number, number] = this.step\n\n    switch (this.channel) {\n      case 'r':\n        value = this.value.r\n        color = [...this.rgba]\n        break\n      case 'g':\n        value = this.value.g\n        color = [...this.rgba]\n        break\n      case 'b':\n        value = this.value.b\n        color = [...this.rgba]\n        break\n      case 'a':\n        value = this.value.a || 0\n        color = [...this.rgba]\n        break\n      case 'h':\n        value = this.hsv[0]\n        color = [...this.hsv, 1]\n        break\n      case 's':\n        value = this.hsv[1]\n        color = [...this.hsv, 1]\n        break\n      case 'v':\n        value = this.hsv[2]\n        color = [...this.hsv, 1]\n        break\n      case 'l':\n        value = this.hsl[2]\n        color = [...this.hsl, 1]\n        break\n      case 'hs':\n        value = [this.hsv[0], this.hsv[1]]\n        color = [...this.hsv, 1]\n        min = [min, min]\n        max = [max, max]\n        step = [step, step]\n        break\n      case 'sv':\n        value = [this.hsv[1], this.hsv[2]]\n        color = [...this.hsv, 1]\n        min = [min, min]\n        max = [max, max]\n        step = [step, step]\n        break\n      case 'sl':\n        value = [this.hsl[1], this.hsl[2]]\n        color = [...this.hsl, 1]\n        min = [min, min]\n        max = [max, max]\n        step = [step, step]\n        break\n    }\n\n    // TODO: values are always new objects which causes double rendering when interacting with the slider.\n    // This causes change() to be called so does valueMutated() from the slider itself.\n    // TODO: Fix!\n    slider.props = {id: c, value: value, min: min, max: max, step: step, vertical: this.vertical, color: color, '@value-input': this._onValueInput}\n\n    this.render([\n      slider,\n    ])\n  }\n}\nexport const ioColorSlider = function(arg0?: IoColorSliderProps) {\n  return IoColorSlider.vConstructor(arg0)\n}\n/**\n * A base class for 1D color slider.\n * It as an incomplete implementation of a color slider desiged to be fully implemented in channel-specific subclasses.\n **/\nclass IoColorSliderBase extends IoSlider {\n  @ReactiveProperty({type: Array, init: [0, 0, 0, 0]})\n  declare color: [number, number, number, number]\n\n  static get GlUtils() {\n    return /* glsl */`\n      // Note: Implement in subclass!\n      // TODO: Allow GlUtils to rewrite inherited functions!\n      // vec3 getStartColor(vec2 uv) {}\n      // vec3 getEndColor(vec2 uv) {}\n      ${glsl.hue2rgb}\n      ${glsl.hsv2rgb}\n      ${glsl.hsl2rgb}\n\n      vec3 paintHorizontalLine(vec3 dstCol, vec2 p, vec3 color) {\n        float lineShape = lineHorizontal(p, io_borderWidth * 2.0);\n        return compose(dstCol, vec4(color, lineShape));\n      }\n    `\n  }\n  static get Frag() {\n    return /* glsl */`\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * vec2(uv.x, uv.y - 0.5);\n      float valueInRange = (uValue - uMin) / (uMax - uMin);\n\n      // Colors\n      vec3 finalCol = io_bgColorInput.rgb;\n      vec3 startCol = getStartColor(uv);\n      vec3 gridCol = io_bgColorLight.rgb;\n      vec3 endCol = getEndColor(uv);\n      vec3 sliderCol = mix(startCol, endCol, uv.x);\n\n      vec2 linePos = translate(size * uv, 0.0, size.y / 2.);\n      finalCol = paintHorizontalLine(finalCol, linePos, sliderCol);\n\n      // Grid\n      float gridSize = size.x / abs((uMax - uMin) / uStep);\n      float gridOffset = mod(uStep - uMin, uStep) / (uMax - uMin) * size.x;\n      float gridShape = paintDerivativeGrid2D(translate(position, gridOffset, 0.0), vec2(gridSize, 0.0), io_borderWidth);\n      if (size.x * uStep < 4.0) gridShape = 0.0;\n      finalCol = compose(finalCol, vec4(sliderCol, gridShape * 0.25));\n\n      // Slider\n      float sliderShape = rectangle(position, vec2(size.x * valueInRange, size.y));\n      finalCol = compose(finalCol, vec4(sliderCol, sliderShape));\n      finalCol = compose(finalCol, vec4(io_bgColorInput.rgb, gridShape * sliderShape * 0.125));\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }`\n  }\n  // TODO: temp fix\n  valueMutated() {}\n}\n\n/**\n * A base class for 2D color slider.\n * It as an incomplete implementation of a color slider desiged to be fully implemented in channel-specific subclasses.\n **/\nclass IoColorSlider2dBase extends IoSlider2d {\n  @ReactiveProperty({type: Array, init: [0, 0, 0, 0]})\n  declare color: [number, number, number, number]\n\n  static get GlUtils() {\n    return /* glsl */`\n      // Note: Implement in subclass!\n      // TODO: Allow GlUtils to rewrite inherited functions!\n      // vec3 getColor(vec2 uv) {}\n      ${glsl.hue2rgb}\n      ${glsl.hsv2rgb}\n      ${glsl.hsl2rgb}\n    `\n  }\n  static get Frag() {\n    return /* glsl */`\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * (uv - vec2(0.5));\n\n      // Colors\n      vec3 finalCol = color_field(uv);\n      vec3 gridCol = io_bgColorLight.rgb;\n      vec3 sliderCol = color_field(uValue);\n\n      // Grid\n      vec2 gridSize = size / abs((uMax - uMin) / uStep);\n      vec2 gridOffset = (uMax + uMin) / (uMax - uMin) * size / 2.;\n      vec2 gridPosition = translate(position, -gridOffset);\n      float gridShape = paintDerivativeGrid2D(gridPosition, gridSize, io_borderWidth);\n      if (min(size.x * uStep.x, size.y * uStep.y) < 2.0) gridShape = 0.0;\n      finalCol = compose(finalCol, vec4(gridCol, gridShape * 0.5));\n\n      vec2 knobPos = uValue / (uMax - uMin) * size;\n      finalCol = paintKnob(finalCol, gridPosition, knobPos, sliderCol);\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }`\n  }\n  // TODO: temp fix\n  valueMutated() {}\n}\n\n/**\n * A 1D slider for \"red\" color channel.\n **/\n@Register\nexport class IoColorSliderR extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uv.x, uColor[1], uColor[2]);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uv.x, uColor[1], uColor[2]);\n      }\n    `\n  }\n}\nexport const ioColorSliderR = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderR.vConstructor(arg0)\n}\n\n/**\n * A 1D slider for \"green\" color channel.\n **/\n@Register\nexport class IoColorSliderG extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uColor[0], uv.x, uColor[2]);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uColor[0], uv.x, uColor[2]);\n      }\n    `\n  }\n}\nexport const ioColorSliderG = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderG.vConstructor(arg0)\n}\n\n/**\n * A 1D slider for \"blue\" color channel.\n **/\n@Register\nexport class IoColorSliderB extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uColor[0], uColor[1], uv.x);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uColor[0], uColor[1], uv.x);\n      }\n    `\n  }\n}\nexport const ioColorSliderB = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderB.vConstructor(arg0)\n}\n/**\n * A 1D slider for \"alpha\" color channel.\n **/\n@Register\nexport class IoColorSliderA extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        vec2 size = uVertical == 1 ? uSize.yx : uSize;\n        vec2 position = size * (uv - vec2(0.0, 0.5));\n        return mix(vec3(0.5), vec3(1.0), checkerX(position, io_fieldHeight / 4.0));\n      }\n      vec3 getEndColor(vec2 uv) {\n        vec2 size = uVertical == 1 ? uSize.yx : uSize;\n        vec2 position = size * (uv - vec2(0.0, 0.5));\n        vec3 chkCol = mix(vec3(0.5), vec3(1.0), checkerX(position, io_fieldHeight / 4.0));\n        return mix(chkCol, uColor.rgb, 1.0);\n      }\n    `\n  }\n}\nexport const ioColorSliderA = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderA.vConstructor(arg0)\n}\n\n/**\n * A 1D slider for \"hue\" color channel.\n **/\n@Register\nexport class IoColorSliderH extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uv.x, uColor[1], uColor[2]));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uv.x, uColor[1], uColor[2]));\n      }\n    `\n  }\n}\nexport const ioColorSliderH = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderH.vConstructor(arg0)\n}\n/**\n * A 1D slider for \"saturation\" color channel.\n **/\n@Register\nexport class IoColorSliderS extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv.x, uColor[2]));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv.x, uColor[2]));\n      }\n    `\n  }\n}\nexport const ioColorSliderS = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderS.vConstructor(arg0)\n}\n\n/**\n * A 1D slider for \"value\" color channel.\n **/\n@Register\nexport class IoColorSliderV extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n    `\n  }\n}\nexport const ioColorSliderV = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderV.vConstructor(arg0)\n}\n\n/**\n * A 1D slider for \"level\" color channel.\n **/\n@Register\nexport class IoColorSliderL extends IoColorSliderBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 getStartColor(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n    `\n  }\n}\nexport const ioColorSliderL = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderL.vConstructor(arg0)\n}\n\n/**\n * A 2D slider gor \"hue\" and \"saturation\" color channels.\n **/\n@Register\nexport class IoColorSliderHs extends IoColorSlider2dBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 color_field(vec2 uv) {\n        return hsv2rgb(vec3(uv, uColor[2]));\n      }\n    `\n  }\n}\nexport const ioColorSliderHs = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderHs.vConstructor(arg0)\n}\n\n/**\n * A 2D slider gor \"saturation\" and \"value\" color channels.\n **/\n@Register\nexport class IoColorSliderSv extends IoColorSlider2dBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 color_field(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv));\n      }\n    `\n  }\n}\nexport const ioColorSliderSv = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderSv.vConstructor(arg0)\n}\n\n/**\n * A 2D slider gor \"saturation\" and \"level\" color channels.\n **/\n@Register\nexport class IoColorSliderSl extends IoColorSlider2dBase {\n  static get GlUtils() {\n    return /* glsl */`\n      vec3 color_field(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uv));\n      }\n    `\n  }\n}\nexport const ioColorSliderSl = function(arg0?: IoColorSliderProps) {\n  return IoColorSliderSl.vConstructor(arg0)\n}\n","import { Register, ReactiveProperty, IoOverlaySingleton } from '@io-gui/core'\nimport { IoColorBase } from './IoColorBase.js'\nimport { ioColorSlider } from './IoColorSliders.js'\n\n/**\n * Input element for color displayed as a set of sliders.\n * This element has a singleton instance `IoColorPanelSingleton` used by `IoColorPicker` and other elements.\n **/\n@Register\nclass IoColorPanel extends IoColorBase {\n  static get Style() {\n    return /* css */`\n    :host {\n      display: flex;\n      flex-direction: row;\n      border: var(--io_border);\n      border-color: var(--io_borderColorOutset);\n      background-color: var(--io_bgColorLight);\n      padding: var(--io_spacing2);\n      border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n    }\n    :host:not([expanded]) {\n      display: none;\n    }\n    :host > *:not(:last-child) {\n      margin: 0 var(--io_spacing2) 0 0;\n    }\n    `\n  }\n\n  @ReactiveProperty({value: false, reflect: true})\n  declare expanded: boolean\n\n  static get Listeners() {\n    return {\n      'keydown': 'onKeydown',\n      'io-focus-to': 'onIoFocusTo',\n    }\n  }\n\n  onKeydown(event: KeyboardEvent) {\n    if (event.key === 'Escape' || event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault()\n      this.expanded = false\n    }\n  }\n  onIoFocusTo(event: CustomEvent) {\n    const source = event.detail.source\n    const command = event.detail.command\n    const sliders = Array.from(this.querySelectorAll('[tabindex]')) as HTMLElement[]\n    const index = Array.from(sliders).indexOf(source)\n    if (command === 'ArrowDown' || (command === 'ArrowLeft' && index === 0)) {\n      sliders[sliders.length - 1].focus()\n      event.stopPropagation()\n    } else if (command === 'ArrowUp' || (command === 'ArrowRight' && index === sliders.length - 1)) {\n      sliders[0].focus()\n      event.stopPropagation()\n    }\n  }\n  onValueInput() {\n    this.dispatch('value-input', {property: 'value', value: this.value}, true)\n  }\n  changed() {\n    this.render([\n      ioColorSlider({value: this.value, channel: 'sv', '@value-input': this.onValueInput}),\n      ioColorSlider({value: this.value, channel: 'h', vertical: true, '@value-input': this.onValueInput}),\n      this.value.a !== undefined ? ioColorSlider({value: this.value, channel: 'a', '@value-input': this.onValueInput, vertical: true}) : null,\n    ])\n  }\n}\n\nexport const IoColorPanelSingleton = new IoColorPanel()\nsetTimeout(() => {\n  IoOverlaySingleton.appendChild(IoColorPanelSingleton as HTMLElement)\n}, 100)\n","import { Register, div } from '@io-gui/core'\nimport { IoColorBase, IoColorBaseProps } from './IoColorBase.js'\n\n/**\n * Element displaying colored square.\n *\n * <io-element-demo element=\"io-color-swatch\"\n * properties='{\"value\": [1, 0.5, 0, 1]}'\n * config='{\"value\": [\"io-property-editor\"]}\n * '></io-element-demo>\n **/\n@Register\nexport class IoColorSwatch extends IoColorBase {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: inline-block;\n        min-width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: white;\n        background-image: linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%);\n        background-size: 12px 12px;\n        background-position: 0 0, 0 6px, 6px -6px, -6px 0px;\n        overflow: visible;\n      }\n      :host > div { \n        width: 100%;\n        height: 100%;\n      }\n    `\n  }\n  valueChanged() {\n    super.valueChanged()\n    this.render([\n      div({style: {'background-color': `rgba(${this.rgba[0] * 255 },${this.rgba[1] * 255}, ${this.rgba[2] * 255}, ${this.rgba[3]})`}})\n    ])\n  }\n}\nexport const ioColorSwatch = function(arg0?: IoColorBaseProps) {\n  return IoColorSwatch.vConstructor(arg0)\n}","import { Register, ReactiveProperty, IoElement, IoElementProps, Property, WithBinding, nudge } from '@io-gui/core'\nimport { IoColorPanelSingleton as Panel } from './IoColorPanelSingleton.js'\nimport { ioColorSwatch } from './IoColorSwatch.js'\n\n// TODO: focus picker on expand.\n// TODO: collapse picker on blur.\n// TODO: fix focus keybord navigation.\n\nexport type IoColorPickerProps = IoElementProps &{\n  value: WithBinding<{ r: number; g: number; b: number; a?: number }>\n}\n\n@Register\nexport class IoColorPicker extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        height: var(--io_fieldHeight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorInset);\n        border-radius: var(--io_borderRadius);\n        overflow: hidden;\n      }\n      :host:focus {\n        @apply --io_focus;\n      }\n      :host > io-color-swatch {\n        width: 100%;\n        height: 100%;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: {r: 1, g: 1, b: 1, a: 1}})\n  declare value: {r: number; g: number; b: number; a?: number}\n\n  static get Listeners(): any {\n    return {\n      'click': 'onClick',\n      'keydown': 'onKeydown',\n    }\n  }\n\n  @Property(0)\n  declare tabIndex: number\n\n  get expanded() {\n    return Panel.expanded && Panel.value === this.value\n  }\n\n  ready() {\n    this.valueChanged()\n  }\n\n  onClick() {\n    if (!this.expanded) this.expand()\n  }\n\n  onKeydown(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Enter':\n      case ' ':\n        event.preventDefault()\n        if (!this.expanded) this.expand()\n        break\n      default:\n        if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'].includes(event.key)) {\n          event.preventDefault()\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true)\n        }\n    }\n  }\n  onValueSet() {\n    this.dispatch('value-input', {property: 'value', value: this.value}, true)\n  }\n  onPanelCollapse() {\n    // TODO: Reconsider this.\n    if (!this.expanded) {\n      Panel.removeEventListener('value-input', this.onValueSet)\n      Panel.removeEventListener('expanded-changed', this.onPanelCollapse)\n    }\n  }\n  expand() {\n    Panel.value = this.value\n    Panel.expanded = true\n    Panel.addEventListener('value-input', this.onValueSet)\n    Panel.addEventListener('expanded-changed', this.onPanelCollapse)\n    nudge(Panel, this, 'right');\n    (Panel.firstChild?.firstChild as HTMLElement)?.focus()\n  }\n  collapse() {\n    Panel.expanded = false\n    Panel.value = {r: 1, g: 1, b: 1, a: 1}\n  }\n  valueChanged() {\n    this.render([\n      ioColorSwatch({value: this.value})\n    ])\n  }\n}\nexport const ioColorPicker = function(arg0: IoColorPickerProps) {\n  return IoColorPicker.vConstructor(arg0)\n}\n","import { Register } from '@io-gui/core'\nimport { ioNumber } from '@io-gui/inputs'\nimport { IoColorBase, IoColorBaseProps } from './IoColorBase.js'\nimport { ioColorPicker } from './IoColorPicker.js'\n\n/**\n * Input element for color displayed as vector and an interactive picker.\n **/\n@Register\nexport class IoColorRgba extends IoColorBase {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex: 1 1 auto;\n        overflow: hidden;\n      }\n      :host > io-number {\n        flex: 1 0 0;\n      }\n      :host > io-number#r {\n        border-bottom-color: var(--io_bgColorRed);\n      }\n      :host > io-number#g {\n        border-bottom-color: var(--io_bgColorGreen);\n      }\n      :host > io-number#b {\n        border-bottom-color: var(--io_bgColorBlue);\n      }\n      :host > io-number#a {\n        border-bottom-color: var(--io_color);\n      }\n      :host > io-color-picker {\n        flex-shrink: 0;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n    `\n  }\n\n  _onNumberValueInput(event: CustomEvent) {\n    event.stopPropagation()\n    const item = event.composedPath()[0] as HTMLElement\n    if (['r', 'g', 'b'].includes(item.id)) {\n      this.value[item.id as keyof typeof this.value] = event.detail.value\n    }\n    this.dispatch('value-input', {property: 'value', value: this.value}, false)\n  }\n\n  changed() {\n    this.render([\n      // Consider removing global id collisions.\n      ioNumber({id: 'r', value: this.value.r, min: 0, max: 1, step: 0.001, ladder: true, '@value-input': this._onNumberValueInput}),\n      ioNumber({id: 'g', value: this.value.g, min: 0, max: 1, step: 0.001, ladder: true, '@value-input': this._onNumberValueInput}),\n      ioNumber({id: 'b', value: this.value.b, min: 0, max: 1, step: 0.001, ladder: true, '@value-input': this._onNumberValueInput}),\n      this.value.a !== undefined\n        ? ioNumber({id: 'a', value: this.value.a, min: 0, max: 1, step: 0.0001, ladder: true, '@value-input': this._onNumberValueInput})\n        : null,\n      ioColorPicker({id: 'swatch', value: this.value, '@value-input': this._onNumberValueInput}),\n    ])\n  }\n}\nexport const ioColorRgba = function(arg0?: IoColorBaseProps) {\n  return IoColorRgba.vConstructor(arg0)\n}\n"],"names":["rgb2hsl","rgb","r","g","b","min","Math","max","delta","s","h","l","rgb2hsv","rdif","gdif","bdif","v","diff","diffc","c","hsl2rgb","hsl","t2","t3","val","t1","i","hsv2rgb","hsv","hi","floor","f","p","q","t","IoColorBase","IoElement","ready","this","valueChanged","changed","valueMutated","rgbFromHsv","rgba","rgbFromHsl","valueFromRgb","value","Object","keys","indexOf","console","warn","a","setProperties","__decorateClass","ReactiveProperty","prototype","type","init","Array","Register","IoColorSlider","Style","_onValueInput","event","detail","oldValue","JSON","stringify","channel","_isNode","dispatchMutation","dispatch","property","slider","ioColorSliderR","ioColorSliderG","ioColorSliderB","ioColorSliderA","ioColorSliderH","ioColorSliderS","ioColorSliderV","ioColorSliderL","ioColorSliderHs","ioColorSliderSv","ioColorSliderSl","color","step","props","id","vertical","render","Number","reflect","ioColorSlider","arg0","vConstructor","IoColorSliderBase","IoSlider","GlUtils","glsl","hue2rgb","Frag","IoColorSlider2dBase","IoSlider2d","IoColorSliderR","IoColorSliderG","IoColorSliderB","IoColorSliderA","IoColorSliderH","IoColorSliderS","IoColorSliderV","IoColorSliderL","IoColorSliderHs","IoColorSliderSv","IoColorSliderSl","IoColorPanel","Listeners","keydown","onKeydown","key","preventDefault","expanded","onIoFocusTo","source","command","sliders","from","querySelectorAll","index","length","focus","stopPropagation","onValueInput","IoColorPanelSingleton","setTimeout","IoOverlaySingleton","appendChild","IoColorSwatch","super","div","style","ioColorSwatch","IoColorPicker","click","Panel","onClick","expand","includes","onValueSet","onPanelCollapse","removeEventListener","addEventListener","nudge","firstChild","collapse","Property","ioColorPicker","IoColorRgba","_onNumberValueInput","item","composedPath","ioNumber","ladder","ioColorRgba"],"mappings":"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"}