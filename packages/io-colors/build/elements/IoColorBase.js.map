{"version":3,"file":"IoColorBase.js","sourceRoot":"","sources":["../../src/elements/IoColorBase.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoElement, IoElementProps, ReactiveProperty, Register, WithBinding, ReactivityType } from 'io-core';\nimport { hsl2rgb, rgb2hsl, rgb2hsv, hsv2rgb } from '../lib/color.convert.js';\n\nexport type IoColorBaseProps = IoElementProps & {\n  value?: WithBinding<{ r: number, g: number, b: number, a?: number }>,\n};\n\n@Register\nexport class IoColorBase extends IoElement {\n\n  @ReactiveProperty('throttled')\n  declare reactivity: ReactivityType;\n\n  @ReactiveProperty({type: Object, init: {r: 1, g: 1, b: 1, a: 1}})\n  declare value: {r: number, g: number, b: number, a?: number};\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1, 1]})\n  declare rgba: [number, number, number, number];\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1]})\n  declare hsv: [number, number, number];\n\n  @ReactiveProperty({type: Array, init: [1, 1, 1]})\n  declare hsl: [number, number, number];\n\n  ready() {\n    // this.throttle(this.valueChanged);\n    this.valueChanged();\n    this.changed();\n  }\n  valueMutated() {\n    // this.throttle(this.valueChanged);\n    this.valueChanged();\n    this.changed();\n  }\n  rgbFromHsv() {\n    const rgb = hsv2rgb([\n      this.hsv[0] * 360,\n      this.hsv[1] * 100,\n      this.hsv[2] * 100,\n    ]);\n    this.rgba[0] = rgb[0] / 255;\n    this.rgba[1] = rgb[1] / 255;\n    this.rgba[2] = rgb[2] / 255;\n  }\n  rgbFromHsl() {\n    const rgb = hsl2rgb([\n      this.hsl[0] * 360,\n      this.hsl[1] * 100,\n      this.hsl[2] * 100,\n    ]);\n    this.rgba[0] = rgb[0] / 255;\n    this.rgba[1] = rgb[1] / 255;\n    this.rgba[2] = rgb[2] / 255;\n  }\n  valueFromRgb() {\n    this.value.r = this.rgba[0];\n    this.value.g = this.rgba[1];\n    this.value.b = this.rgba[2];\n  }\n  valueChanged() {\n    debug: {\n      const c = Object.keys(this.value);\n      if (c.indexOf('r') === -1 || c.indexOf('g') === -1 || c.indexOf('b') === -1) {\n        console.warn('IoColor: Incorrect value type!');\n      }\n    }\n\n    const rgb = [this.value.r * 255, this.value.g * 255, this.value.b * 255];\n    const hsv = rgb2hsv(rgb);\n    const hsl = rgb2hsl(rgb);\n\n    // Prevent color conversion from flippping hue 360.\n    if (hsv[0] === 0 || hsv[0] === 360) hsv[0] = this.hsv[0] * 360;\n    if (hsl[0] === 0 || hsl[0] === 360) hsl[0] = this.hsl[0] * 360;\n\n    // Prevent saturation 0 from collapsing hue to 0.\n    if (hsv[1] === 0) hsv[0] = this.hsv[0] * 360;\n    if (hsl[1] === 0) hsl[0] = this.hsl[0] * 360;\n\n    // Prevent lightness/value 0 from collapsing hue/saturation to 0.\n    if (hsv[2] === 0) hsv[1] = this.hsv[1] * 100;\n    if (hsl[2] === 0 || hsl[2] === 100) {\n      hsl[0] = this.hsl[0] * 360;\n      hsl[1] = this.hsl[1] * 100;\n    }\n\n    this.rgba[0] = rgb[0] / 255;\n    this.rgba[1] = rgb[1] / 255;\n    this.rgba[2] = rgb[2] / 255;\n    this.rgba[3] = this.value.a ?? 1;\n    this.hsv[0] = hsv[0] / 360;\n    this.hsv[1] = hsv[1] / 100;\n    this.hsv[2] = hsv[2] / 100;\n    this.hsl[0] = hsl[0] / 360;\n    this.hsl[1] = hsl[1] / 100;\n    this.hsl[2] = hsl[2] / 100;\n\n    this.setProperties({\n      rgba: this.rgba,\n      hsv: this.hsv,\n      hsl: this.hsl,\n    });\n  }\n}\n"]}