{"version":3,"file":"io-number.js","sourceRoot":"","sources":["../src/io-number.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, Property, IoField, IoOverlaySingleton } from 'io-gui';\nimport { IoNumberLadderSingleton } from './io-number-ladder.js';\n/**\n * Input element for `Number` data type.\n * It clamps the `value` to `min` / `max` and rounds it to the nearest `step` increment.\n * If `ladder` property is enabled, it displays an interactive float ladder element when clicked/taped.\n * Alternatively, ladder can be expanded by middle click or ctrl key regardless of ladder property.\n **/\n@Register\nexport class IoNumber extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        font-family: monospace;\n        padding-left: var(--io_spacing3);\n        padding-right: var(--io_spacing3);\n      }\n    `;\n  }\n\n  @Property('textbox')\n  declare role: string;\n\n  @Property({value: 0, type: Number})\n  declare value: number;\n\n  @Property({value: 1, type: Number})\n  declare conversion: number;\n\n  @Property({value: 0.0001, type: Number})\n  declare step: number;\n\n  @Property({value: -Infinity, type: Number})\n  declare min: number;\n\n  @Property({value: Infinity, type: Number})\n  declare max: number;\n\n  @Property({value: false, type: Boolean})\n  declare ladder: boolean;\n\n  @Property({value: true, type: Boolean})\n  declare contenteditable: boolean;\n\n  @Property({value: 'number', type: String, reflect: true})\n  declare type: string;\n\n  @Property({value: 'pattern=\"[0-9]*\"', type: String, reflect: true})\n  declare pattern: string;\n\n  @Property({value: 'numeric', type: String, reflect: true})\n  declare inputmode: string;\n\n  @Property({value: 'false', type: String, reflect: true})\n  declare spellcheck: string;\n\n  @Property({value: 'inset', type: String, reflect: true})\n  declare appearance: 'flush' | 'inset' | 'outset';\n\n  private _pointer = '';\n\n  _onBlur(event: FocusEvent) {\n    super._onBlur(event);\n    this._setFromTextNode();\n    this.scrollTop = 0;\n    this.scrollLeft = 0;\n    // TODO: unhack race condition\n    setTimeout(() => {\n      if ((document.activeElement as Element).parentElement !== IoNumberLadderSingleton as unknown as Element) {\n        IoNumberLadderSingleton.expanded = false;\n      }\n    });\n  }\n  _onPointerdown(event: PointerEvent) {\n    if (this._pointer === 'touch') event.preventDefault();\n    this.addEventListener('pointermove', this._onPointermove);\n    this.addEventListener('pointerup', this._onPointerup);\n    if (document.activeElement === this as unknown as Element && event.button === 0) return;\n    this._pointer = event.pointerType;\n  }\n  _onPointerup(event: PointerEvent) {\n    this.removeEventListener('pointermove', this._onPointermove);\n    this.removeEventListener('pointerup', this._onPointerup);\n    if (this.ladder || event.button === 1) {\n      if (this._pointer === 'touch') {\n        event.preventDefault();\n        (document.activeElement as HTMLElement).blur();\n      } else {\n        if (document.activeElement !== this as unknown as Element) {\n          this.focus();\n          this.setCaretPosition(this.textNode.length);\n        }\n      }\n      this._expandLadder();\n    } else {\n      if (document.activeElement !== this as unknown as Element) {\n        this.focus();\n        this.setCaretPosition(this.textNode.length);\n      }\n    }\n  }\n  _onFocus(event: FocusEvent) {\n    super._onFocus(event);\n    if (this._pointer === 'touch') {\n      IoNumberLadderSingleton.expanded = false;\n    }\n  }\n  _expandLadder() {\n    IoNumberLadderSingleton.src = this;\n    IoNumberLadderSingleton.expanded = true;\n  }\n  _onKeydown(event: KeyboardEvent) {\n    const rng = (window.getSelection() as Selection).getRangeAt(0);\n    const start = rng.startOffset;\n    const end = rng.endOffset;\n    const length = this.childNodes[0] ? this.childNodes[0].length : 0;\n    const rngInside = rng.startContainer === rng.endContainer && (rng.startContainer === this.childNodes[0] || rng.startContainer === this as unknown as Node);\n\n    if (event.which === 27 || event.which === 13 || event.which === 32) { //  esc || enter || space\n      event.preventDefault();\n      this._setFromTextNode();\n    } else if (event.which === 36) { // home\n      this.textNode = this.min;\n      this._setFromTextNode();\n    } else if (event.which === 35) { // end\n      this.textNode = this.max;\n      this._setFromTextNode();\n    } else if (event.which === 33) { // pgup\n      const valueNumber = Number(this.textNode);\n      if (!isNaN(valueNumber) && Math.abs(valueNumber) < Infinity) {\n        this.textNode = Number(this.textNode) + this.step;\n      } else {\n        this.textNode = this.step;\n      }\n      this._setFromTextNode();\n    } else if (event.which === 34) { // pgdown\n      const valueNumber = Number(this.textNode);\n      if (!isNaN(valueNumber) && Math.abs(valueNumber) < Infinity) {\n        this.textNode = Number(this.textNode) - this.step;\n      } else {\n        this.textNode = -this.step;\n      }\n      this._setFromTextNode();\n    } else if (event.which === 37) { // left\n      if (event.ctrlKey || (rngInside && start === end && start === 0)) {\n        event.preventDefault();\n        this.focusTo('left');\n      }\n    } else if (event.which === 38) { // up\n      if (IoNumberLadderSingleton.expanded) {\n        const upStep = IoNumberLadderSingleton.querySelector('.io-up1');\n        if (upStep) upStep.focus();\n      } else if (event.ctrlKey || (rngInside && start === end && start === 0)) {\n        event.preventDefault();\n        this.focusTo('up');\n      }\n    } else if (event.which === 39) { // right\n      if (event.ctrlKey || (rngInside && start === end && start === length)) {\n        event.preventDefault();\n        this.focusTo('right');\n      }\n    } else if (event.which === 40) { // down\n      if (IoNumberLadderSingleton.expanded) {\n        const downStep = IoNumberLadderSingleton.querySelector('.io-down1');\n        if (downStep) downStep.focus();\n      } else if (event.ctrlKey || (rngInside && start === end && start === length)) {\n        event.preventDefault();\n        this.focusTo('down');\n      }\n    }\n  }\n  _onKeyup(event: KeyboardEvent) {\n    if (event.which === 17) { // ctrl\n      this._expandLadder();\n    } else if (event.which === 27 || event.which === 13 || event.which === 32) { // esc || enter || space\n      IoOverlaySingleton.expanded = false;\n    }\n  }\n  _setFromTextNode() {\n    const valueText = this.textNode;\n    let valueNumber = Number(valueText) / this.conversion;\n    valueNumber = Math.min(this.max, Math.max(this.min, valueNumber));\n    valueNumber = Math.round(valueNumber / this.step) * this.step;\n    const d = Math.max(0, Math.min(100, -Math.floor(Math.log(this.step) / Math.LN10)));\n    valueNumber = Number(valueNumber.toFixed(d));\n    if (!isNaN(valueNumber)) this.inputValue(valueNumber);\n    else this.textNode = 'NaN';\n  }\n  init() {\n    this.changed();\n  }\n  changed() {\n    this.setAttribute('value', this.value);\n    this.setAttribute('aria-valuenow', this.value);\n    this.setAttribute('aria-valuemin', this.min);\n    this.setAttribute('aria-valuemax', this.max);\n    this.setAttribute('aria-valuestep', this.step);\n    if (typeof this.value !== 'number' || isNaN(this.value)) {\n      this.setAttribute('aria-invalid', 'true');\n    } else {\n      this.removeAttribute('aria-invalid');\n    }\n    let value = this.value;\n    let valueText;\n    if (typeof value === 'number' && !isNaN(value)) {\n      value *= this.conversion;\n      let d = -Math.floor(Math.log(this.step * this.conversion) / Math.LN10);\n      d = Math.max(0, Math.min(100, d));\n      value = Number(value.toFixed(d));\n      valueText = String(value);\n    } else {\n      valueText = 'NaN';\n    }\n    this.setAttribute('value', valueText);\n    this.setAttribute('positive', this.value >= 0);\n    this.textNode = valueText;\n  }\n}\n"]}