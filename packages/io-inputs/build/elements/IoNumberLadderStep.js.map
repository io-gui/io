{"version":3,"file":"IoNumberLadderStep.js","sourceRoot":"","sources":["../../src/elements/IoNumberLadderStep.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, ReactiveProperty, span, Property } from 'io-core';\nimport { IoField, IoFieldProps } from './IoField.js';\n\nexport type IoNumberLadderStepProps = IoFieldProps & {\n  value: number,\n  label: string,\n};\n\n//TODO: Dont extend IoField.\n@Register\nexport class IoNumberLadderStep extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        pointer-events: all;\n        display: inline-block;\n        cursor: ew-resize;\n        text-align: center;\n        background-color: var(--io_bgColorStrong) !important;\n        color: var(--io_color);\n        align-self: stretch;\n        touch-action: none;\n        width: 6em;\n      }\n      :host:focus {\n        background-color: var(--io_bgColor) !important;\n      }\n      /* TODO: use icons */\n      :host:before {\n        float: left;\n        content: '<';\n        opacity: 0.25;\n      }\n      :host:after {\n        float: right;\n        content: '>';\n        opacity: 0.25;\n      }\n    `;\n  }\n\n  @ReactiveProperty({value: 1, type: Number})\n  declare value: number;\n\n  @ReactiveProperty({value: '', type: String})\n  declare label: string;\n\n  @Property('spinbutton')\n  declare role: string;\n\n  declare private startX: number;\n\n  constructor(args: IoNumberLadderStepProps) { super(args); }\n\n  onKeydown(event: KeyboardEvent) {\n    // TODO: fix ladder focus handling. Wrap around.\n    let stepMove = 0;\n    switch (event.key) {\n      case 'Enter':\n      case 'Escape':\n      case ' ':\n        this.dispatch('ladder-step-collapse', {}, true);\n        break;\n      case 'ArrowLeft':\n      case 'Backspace':\n        event.preventDefault();\n        stepMove = this.value * -1;\n        break;\n      case 'ArrowUp':\n        event.preventDefault();\n        this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        break;\n      case 'ArrowRight':\n        event.preventDefault();\n        stepMove = this.value * 1;\n        break;\n      case 'ArrowDown':\n        event.preventDefault();\n        this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        break;\n    }\n    if (stepMove !== 0) {\n      this.dispatch('ladder-step-change', {step: Number(stepMove.toFixed(5)), round: event.shiftKey}, true);\n    }\n  }\n  onPointerdown(event: PointerEvent) {\n    this.setPointerCapture(event.pointerId);\n    this.addEventListener('pointermove', this.onPointermove);\n    this.addEventListener('pointerup', this.onPointerup);\n    this.startX = event.clientX;\n  }\n  onPointermove(event: PointerEvent) {\n    const deltaX = event.clientX - this.startX;\n    if (Math.abs(deltaX) > 5) {\n      const expMove = Math.pow(deltaX / 5, 2) * deltaX < 0 ? -1: 1;\n      const roundMove = deltaX > 0 ? Math.floor(expMove) : Math.ceil(expMove);\n      const stepMove = this.value * roundMove;\n      this.startX = event.clientX;\n      this.dispatch('ladder-step-change', {step: Number(stepMove.toFixed(5)), round: event.shiftKey}, true);\n    }\n  }\n  onPointerup(event: PointerEvent) {\n    this.releasePointerCapture(event.pointerId);\n    this.removeEventListener('pointermove', this.onPointermove);\n    this.removeEventListener('pointerup', this.onPointerup);\n    this.dispatch('ladder-step-collapse', {}, true);\n  }\n  ready() {\n    this.changed();\n  }\n  changed() {\n    this.render([span(this.label)]);\n    this.setAttribute('aria-label', this.label);\n    this.setAttribute('aria-valuestep', this.label);\n  }\n}\nexport const ioNumberLadderStep = function(arg0?: IoNumberLadderStepProps) {\n  return IoNumberLadderStep.vConstructor(arg0);\n};"]}