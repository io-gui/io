{"version":3,"file":"IoNumber.js","sourceRoot":"","sources":["../../src/elements/IoNumber.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, ReactiveProperty, WithBinding, Property } from 'io-core';\nimport { IoNumberLadderSingleton } from './IoNumberLadderSingleton.js';\nimport { IoField, IoFieldProps } from './IoField.js';\n\nexport type IoNumberProps = IoFieldProps & {\n  value?: WithBinding<number>;\n  live?: boolean;\n  conversion?: number;\n  step?: number;\n  min?: number;\n  max?: number;\n  ladder?: boolean;\n};\n\n/**\n * Input element for `Number` data type.\n * It clamps the `value` to `min` / `max` and rounds it to the nearest `step` increment.\n * If `ladder` property is enabled, it displays an interactive float ladder element when clicked/taped.\n * Alternatively, ladder can be expanded by middle click or ctrl key regardless of ladder property.\n **/\n@Register\nexport class IoNumber extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        font-family: monospace;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorInput);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n    `;\n  }\n\n  @ReactiveProperty({value: 0, type: Number})\n  declare value: number;\n\n  @ReactiveProperty({value: false, type: Boolean})\n  declare live: boolean;\n\n  @ReactiveProperty({value: 1, type: Number})\n  declare conversion: number;\n\n  @ReactiveProperty({value: 0.0001, type: Number})\n  declare step: number;\n\n  @ReactiveProperty({value: -Infinity, type: Number})\n  declare min: number;\n\n  @ReactiveProperty({value: Infinity, type: Number})\n  declare max: number;\n\n  @ReactiveProperty({value: false, type: Boolean})\n  declare ladder: boolean;\n\n  @ReactiveProperty({value: 'inset', type: String, reflect: true})\n  declare appearance: 'neutral' | 'inset' | 'outset';\n\n  @Property('true')\n  declare contentEditable: string;\n\n  @ReactiveProperty({value: 'pattern=\"-?[0-9]*?[0-9]*\"', type: String, reflect: true})\n  declare pattern: string;\n\n  // TODO: 'decimal' mode on iOS does not display minus and decimal point\n  @Property('text')\n  declare inputMode: string;\n\n  @Property('textbox')\n  declare role: string;\n\n  constructor(args: IoNumberProps = {}) { super(args); }\n\n  get textNode() {\n    this._flattenTextNode(this);\n    return this._textNode.nodeValue;\n  }\n  set textNode(value) {\n    this._flattenTextNode(this);\n    this._textNode.nodeValue = String(value);\n  }\n\n  onBlur(event: FocusEvent) {\n    super.onBlur(event);\n    this._setFromTextNode();\n    this.scrollTop = 0;\n    this.scrollLeft = 0;\n    // TODO: unhack race condition\n    setTimeout(() => {\n      if ((document.activeElement as Element).parentElement !== IoNumberLadderSingleton as unknown as Element) {\n        IoNumberLadderSingleton.expanded = false;\n      }\n    });\n  }\n  onPointerdown(event: PointerEvent) {\n    if (event.pointerType === 'touch') event.preventDefault();\n    this.addEventListener('pointermove', this.onPointermove);\n    this.addEventListener('pointerup', this.onPointerup);\n    if (document.activeElement === this as unknown as Element && event.button === 0) return;\n  }\n  onPointerup(event: PointerEvent) {\n    this.removeEventListener('pointermove', this.onPointermove);\n    this.removeEventListener('pointerup', this.onPointerup);\n    if (this.ladder || event.button === 1) {\n      if (event.pointerType === 'touch') {\n        event.preventDefault();\n        (document.activeElement as HTMLElement).blur();\n      } else {\n        if (document.activeElement !== this as unknown as Element) {\n          this.focus();\n          this.setCaretPosition(this.textNode!.length);\n        }\n      }\n      this.expandLadder();\n    } else {\n      if (document.activeElement !== this as unknown as Element) {\n        this.focus();\n        this.setCaretPosition(this.textNode!.length);\n      }\n    }\n  }\n  expandLadder() {\n    IoNumberLadderSingleton.src = this;\n    IoNumberLadderSingleton.expanded = true;\n  }\n  collapseLadder() {\n    IoNumberLadderSingleton.expanded = false;\n  }\n  onKeydown(event: KeyboardEvent) {\n    const range = (window.getSelection() as Selection).getRangeAt(0);\n    const rangeStart = range.startOffset;\n    const rangeEnd = range.endOffset;\n    const length = this.childNodes[0] ? (this.childNodes[0] as Text).length : 0;\n    const rangeInside = range.startContainer === range.endContainer && (range.startContainer === this.childNodes[0] || range.startContainer === this as unknown as Node);\n\n    switch (event.key) {\n      case 'Escape':\n      case 'Enter':\n      case ' ':\n        event.preventDefault();\n        this._setFromTextNode();\n        // Only blur if on mobile\n        if (isMobileDevice()) {\n          (this as unknown as HTMLElement).blur();\n        }\n        break;\n      case 'Home':\n        event.preventDefault();\n        this.textNode = String(this.min);\n        this._setFromTextNode();\n        break;\n      case 'End':\n        event.preventDefault();\n        this.textNode = String(this.max);\n        this._setFromTextNode();\n        break;\n      case 'ArrowLeft':\n        if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === 0)) {\n          event.preventDefault();\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        }\n        // TODO: shift step\n        break;\n      case 'ArrowUp':\n        if (IoNumberLadderSingleton.expanded) {\n          event.preventDefault();\n          const upStep = IoNumberLadderSingleton.querySelector('.io-up1') as HTMLElement;\n          if (upStep) upStep.focus();\n        } else if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === 0)) {\n          event.preventDefault();\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        }\n        break;\n      case 'ArrowRight':\n        if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === length)) {\n          event.preventDefault();\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        }\n        // TODO: shift step\n        break;\n      case 'ArrowDown':\n        if (IoNumberLadderSingleton.expanded) {\n          event.preventDefault();\n          const downStep = IoNumberLadderSingleton.querySelector('.io-down1') as HTMLElement;\n          if (downStep) downStep.focus();\n        } else if (event.ctrlKey || (rangeInside && rangeStart === rangeEnd && rangeStart === length)) {\n          event.preventDefault();\n          this.dispatch('io-focus-to', {source: this, command: event.key}, true);\n        }\n        break;\n    }\n  }\n  onKeyup(event: KeyboardEvent) {\n    // TODO: move to onkeydown?\n    if (event.key === 'Control' || event.key === 'Shift') {\n      IoNumberLadderSingleton.expanded ? this.collapseLadder() : this.expandLadder();\n    } else if (event.key === 'Escape' || event.key === 'Enter' || event.key === ' ') {\n      this.collapseLadder();\n    }\n\n    if (this.live) {\n      const carretPosition = this.getCaretPosition();\n      this._setFromTextNode();\n      this.setCaretPosition(carretPosition);\n    }\n  }\n  _setFromTextNode() {\n    // Normalize comma to period for decimal separator\n    let valueText = this.textNode!.trim().replace(',', '.');\n    let valueNumber = Number(valueText) / this.conversion;\n    valueNumber = Math.min(this.max, Math.max(this.min, valueNumber));\n    valueNumber = Math.round(valueNumber / this.step) * this.step;\n    const d = Math.max(0, Math.min(100, -Math.floor(Math.log(this.step) / Math.LN10)));\n    valueNumber = Number(valueNumber.toFixed(d));\n    if (!isNaN(valueNumber)) {\n      this._reactiveProperties.get('invalid')!.value = false;\n      this.removeAttribute('invalid');\n      this.removeAttribute('aria-invalid');\n      this.inputValue(valueNumber);\n    } else {\n      this._reactiveProperties.get('invalid')!.value = true;\n      this.setAttribute('invalid', 'true');\n      this.setAttribute('aria-invalid', 'true');\n    }\n  }\n  ready() {\n    this.disabledChanged();\n    this.changed();\n  }\n  changed() {\n    this.setAttribute('aria-valuenow', this.value);\n    this.setAttribute('aria-valuemin', this.min);\n    this.setAttribute('aria-valuemax', this.max);\n    this.setAttribute('aria-valuestep', this.step);\n    if (typeof this.value !== 'number' || isNaN(this.value)) {\n      this.setAttribute('invalid', 'true');\n      this.setAttribute('aria-invalid', 'true');\n    } else {\n      this.removeAttribute('invalid');\n      this.removeAttribute('aria-invalid');\n    }\n    let value = this.value;\n    let valueText;\n    if (typeof value === 'number' && !isNaN(value)) {\n      value *= this.conversion;\n      let d = -Math.floor(Math.log(this.step * this.conversion) / Math.LN10);\n      d = Math.max(0, Math.min(100, d));\n      value = Number(value.toFixed(d));\n      valueText = String(value);\n    } else {\n      valueText = 'NaN';\n    }\n    this.setAttribute('value', valueText);\n    this.setAttribute('positive', this.value >= 0);\n    this.textNode = valueText;\n  }\n}\n\nfunction isMobileDevice(): boolean {\n  return /Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)\n    || ('ontouchstart' in window && !window.matchMedia('(pointer: fine)').matches);\n}\n\nexport const ioNumber = function(arg0?: IoNumberProps) {\n  return IoNumber.vConstructor(arg0);\n};"]}