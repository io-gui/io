{"version":3,"file":"io-number-ladder.js","sourceRoot":"","sources":["../src/io-number-ladder.ts"],"names":[],"mappings":"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","sourcesContent":["import { Register, Property, IoElement, IoOverlaySingleton, IoThemeSingleton } from 'io-gui';\nimport { IoNumber } from './io-number';\nimport './io-number-ladder-step';\n\nlet lastFocus: Element | null = null;\n{\n  window.addEventListener('focusin', () => {\n    lastFocus = document.activeElement;\n  }, {capture: false});\n  window.addEventListener('blur', () => {\n    setTimeout(() => {\n      if (document.activeElement === document.body) {\n        lastFocus = null;\n      }\n    });\n  }, {capture: true});\n}\n\n\n/**\n * Interactive number ladder.\n * When dragged horizontally, it changes the value in step increments.\n * Dragging speed affects the rate of change exponentially.\n * Up/down arrow keys change the step focus while left/right change the value in step increments.\n * Escape key collapses the ladder and restores the focus to previously focused element.\n * If shift key is pressed, value is rounded to the nearest step incement.\n *\n * <io-element-demo element=\"io-ladder\" expanded properties='{\"value\": 0, \"step\": 0.0001, \"conversion\": 1, \"min\": -10000, \"max\": 10000, \"expanded\": true}'></io-element-demo>\n **/\n@Register\nexport class IoNumberLadder extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        position: absolute;\n        pointer-events: none;\n        user-select: none;\n        -webkit-tap-highlight-color: transparent;\n        -webkit-user-select: none;\n        -webkit-touch-callout: none;\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n      }\n      :host:not([expanded]) > io-number-ladder-step {\n        opacity: 0.5;\n      }\n      :host > io-number-ladder-step:nth-child(-n+5) {\n        box-shadow: 0 -1px 4px rgba(0,0,0,0.2);\n      }\n      :host > io-number-ladder-step:nth-child(n+6) {\n        box-shadow: 0 1px 4px rgba(0,0,0,0.2);\n      }\n      :host > .io-up1,\n      :host > .io-down1{\n        z-index: 4;\n        transition: opacity 0.1s, transform 0.1s;\n      }\n      :host > .io-up2,\n      :host > .io-down2 {\n        z-index: 3;\n        opacity: 0.8;\n        transition: opacity 0.2s, transform 0.2s;\n      }\n      :host:not([expanded]) > .io-up4 {\n        transform: translateY(calc(3 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-up3 {\n        transform: translateY(calc(2 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-up2 {\n        transform: translateY(calc(1 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down2 {\n        transform: translateY(calc(-1 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down3 {\n        transform: translateY(calc(-2 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down4 {\n        transform: translateY(calc(-3 * var(--io_fieldHeight)));\n      }\n      :host > .io-up3,\n      :host > .io-down3 {\n        z-index: 2;\n        opacity: 0.6;\n        transition: opacity 0.4s, transform 0.4s;\n      }\n      :host > .io-up4,\n      :host > .io-down4 {\n        z-index: 1;\n        opacity: 0.4;\n        transition: opacity 0.8s, transform 0.8s;\n      }\n      :host > io-number-ladder-step:hover,\n      :host > io-number-ladder-step:focus {\n        background-color: var(--io_bgColorStrong);\n        border-color: var(--io_colorBlue);\n        transition: opacity 0.2s;\n        opacity: 1;\n      }\n      :host > .io-number-ladder-empty {\n        height: var(--io_fieldHeight);\n      }\n      :host > .io-number-ladder-center {\n        height: calc(1.5 * var(--io_fieldHeight));\n      }\n    `;\n  }\n\n  @Property({value: 'list', type: String})\n  declare role: string;\n\n  @Property({value: undefined, type: IoElement})\n  declare src?: IoNumber;\n\n  @Property({value: false, type: Boolean, reflect: true})\n  declare expanded: boolean;\n\n  static get Listeners() {\n    return {\n      'ladder-step-change': '_onLadderStepChange',\n      'ladder-step-collapse': '_onLadderStepCollapse',\n      'focusin': '_onFocusIn',\n    };\n  }\n  get value() {\n    return this.src ? this.src.value : 0;\n  }\n  get min() {\n    return this.src ? this.src.min : -Infinity;\n  }\n  get max() {\n    return this.src ? this.src.max : Infinity;\n  }\n  get step() {\n    return this.src ? this.src.step : 0.0001;\n  }\n  get conversion() {\n    return this.src ? this.src.conversion : 1;\n  }\n  _onFocusIn(event: FocusEvent) {\n    event.stopPropagation();\n  }\n  _onFocusTo(event: CustomEvent) {\n    event.stopPropagation();\n    const srcStep = event.composedPath()[0];\n    const src = this.src;\n    const dir = event.detail.dir;\n    if (src) {\n      if ((srcStep === this.querySelector('.io-up1') && dir === 'down') ||\n          (srcStep === this.querySelector('.io-down1') && dir === 'up')) {\n        src.focus();\n        src.selectionStart = src.selectionEnd = src.textNode.length;\n        return;\n      }\n    }\n    super._onFocusTo(event);\n  }\n  _onLadderStepChange(event: CustomEvent) {\n    const src = this.src;\n    if (src) {\n      const step = event.detail.step;\n      const value = event.detail.round ? (Math.round(this.value / step) * step) : this.value;\n      let newValue = Math.min(this.max, Math.max(this.min, value + step));\n      newValue = Number(newValue.toFixed(5));\n      src.inputValue(newValue);\n    }\n  }\n  _onLadderStepCollapse() {\n    this.setProperty('expanded', false);\n  }\n  expandedChanged() {\n    const src = this.src;\n    if (this.expanded) {\n      if (src) {\n        const rect = src.getBoundingClientRect();\n        const selfRect = this.getBoundingClientRect();\n        // NOTE: layerRect fix for Safari zoom.\n        const layerRect = IoOverlaySingleton.getBoundingClientRect();\n        this.style.top = rect.bottom - layerRect.top + 'px';\n        this.style.left = rect.left - layerRect.left + 'px';\n        this.style.marginTop = - (selfRect.height / 2 + IoThemeSingleton.lineHeight / 2 + IoThemeSingleton.spacing) + 'px';\n      } else {\n        this.removeAttribute('style');\n      }\n    } else {\n      if (src && src._pointerType !== 'touch') {\n        src.focus();\n      } else if (lastFocus) {\n        (lastFocus as HTMLElement).focus();\n      }\n    }\n    this.dispatchEvent('expanded', {value: this.expanded}, true);\n  }\n  changed() {\n    const range = this.max - this.min;\n    const hiddenItem = ['span', {class: 'io-number-ladder-empty'}];\n\n    // TODO: unhack\n    let step = this.step / 10000;\n    while (step < .1) step = step * 10;\n\n    const upStep4 = 10000 * step;\n    const upStep3 = 1000 * step;\n    const upStep2 = 100 * step;\n    const upStep1 = 10 * step;\n    const downStep1 = 1 * step;\n    const downStep2 = .1 * step;\n    const downStep3 = .01 * step;\n    const downStep4 = .001 * step;\n\n    const upLabel4 = Number((upStep4 * this.conversion).toFixed(6));\n    const upLabel3 = Number((upStep3 * this.conversion).toFixed(6));\n    const upLabel2 = Number((upStep2 * this.conversion).toFixed(6));\n    const upLabel1 = Number((upStep1 * this.conversion).toFixed(6));\n    const downLabel1 = Number((downStep1 * this.conversion).toFixed(6));\n    const downLabel2 = Number((downStep2 * this.conversion).toFixed(6));\n    const downLabel3 = Number((downStep3 * this.conversion).toFixed(6));\n    const downLabel4 = Number((downStep4 * this.conversion).toFixed(6));\n\n    this.template([\n      (range >= upStep4) ? ['io-number-ladder-step', {class: 'io-up4', value: upStep4, label: String(upLabel4)}] : hiddenItem,\n      (range >= upStep3) ? ['io-number-ladder-step', {class: 'io-up3', value: upStep3, label: String(upLabel3)}] : hiddenItem,\n      (range >= upStep2) ? ['io-number-ladder-step', {class: 'io-up2', value: upStep2, label: String(upLabel2)}] : hiddenItem,\n      (range >= upStep1) ? ['io-number-ladder-step', {class: 'io-up1', value: upStep1, label: String(upLabel1)}] : hiddenItem,\n      ['span', {class: 'io-number-ladder-center'}],\n      (this.step <= downStep1) ? ['io-number-ladder-step', {class: 'io-down1', value: downStep1, label: String(downLabel1)}] : hiddenItem,\n      (this.step <= downStep2) ? ['io-number-ladder-step', {class: 'io-down2', value: downStep2, label: String(downLabel2)}] : hiddenItem,\n      (this.step <= downStep3) ? ['io-number-ladder-step', {class: 'io-down3', value: downStep3, label: String(downLabel3)}] : hiddenItem,\n      (this.step <= downStep4) ? ['io-number-ladder-step', {class: 'io-down4', value: downStep4, label: String(downLabel4)}] : hiddenItem,\n    ]);\n\n    this.setAttribute('aria-valuemin', this.min);\n    this.setAttribute('aria-valuemax', this.max);\n    this.setAttribute('aria-valuenow', this.value);\n    this.setAttribute('aria-valuestep', this.step);\n    this.setAttribute('aria-invalid', (typeof this.value !== 'number' || isNaN(this.value))  ? 'true' : false);\n\n    const steps = this.querySelectorAll('io-number-ladder-step');\n    for (let i = steps.length; i--;) {\n      steps[i].setAttribute('aria-valuemin', this.min);\n      steps[i].setAttribute('aria-valuemax', this.max);\n      steps[i].setAttribute('aria-valuenow', this.value);\n      steps[i].changed();\n    }\n  }\n}\n\nexport const IoNumberLadderSingleton = new IoNumberLadder();\nIoOverlaySingleton.appendChild(IoNumberLadderSingleton as unknown as HTMLElement);\n"]}