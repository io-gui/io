{"version":3,"file":"gl.test.js","sourceRoot":"","sources":["../../src/elements/gl.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoGl, IoNode, IoThemeSingleton } from '../index';;\n\nconst element = new IoGl();\nelement.size = [0, 0];\nelement.color = [0, 0, 0, 0];\nelement.pxRatio = 1;\nelement.style.visibility = 'hidden';\nelement.style.position = 'fixed';\nelement.style.left = '0';\nelement.style.bottom = '0';\nelement.style.zIndex = '1000000';\ndocument.body.appendChild(element as unknown as HTMLElement);\n\nexport default class {\n  run() {\n    describe('gl.test.ts', () => {\n      it('Should have core API functions defined', () => {\n        expect(element.initShader).to.be.a('function');\n        expect(element.onResized).to.be.a('function');\n        expect(element.themeMutated).to.be.a('function');\n        expect(element.setShaderProgram).to.be.a('function');\n        expect(element.updatePropertyUniform).to.be.a('function');\n        expect(element.updateThemeUniforms).to.be.a('function');\n        expect(element.setUniform).to.be.a('function');\n      });\n      it('Should initialize property definitions correctly', () => {\n        element.onResized();\n        expect(element.size).to.be.eql([0, 0]);\n        expect(element.color).to.be.eql([0, 0, 0, 0]);\n        expect(element.pxRatio).to.be.equal(window.devicePixelRatio);\n        expect(element.theme).to.be.equal(IoThemeSingleton);\n\n        expect(element._properties.get('size')).to.eql({\n          binding: undefined,\n          init: [0, 0],\n          reflect: false,\n          type: Array,\n          value: [0, 0],\n        });\n\n        expect(element._properties.get('color')).to.eql({\n          binding: undefined,\n          init: [1, 1, 1, 1],\n          reflect: false,\n          type: Array,\n          value: [0, 0, 0, 0],\n        });\n\n        expect(element._properties.get('pxRatio')).to.eql({\n          binding: undefined,\n          init: undefined,\n          reflect: false,\n          type: Number,\n          value: window.devicePixelRatio,\n        });\n\n        expect(element._properties.get('theme')).to.eql({\n          binding: undefined,\n          init: undefined,\n          reflect: false,\n          type: IoNode,\n          value: IoThemeSingleton,\n        });\n      });\n      it('has <canvas> element', () => {\n        expect(element.children[0].localName).to.equal('canvas');\n      });\n      it('has correct size and pxRatio', () => {\n        element.style.border = 'none';\n        element.style.width = '32px';\n        element.style.height = '32px';\n        element.onResized();\n        expect(element.size[0]).to.equal(32);\n        expect(element.size[1]).to.equal(32);\n        expect(element.pxRatio).to.equal(window.devicePixelRatio);\n      });\n      it('has correct color', () => {\n        let color = (element as IoGl).ctx.getImageData(0, 0, 1, 1).data;\n        expect(color).to.eql(new Uint8ClampedArray([0, 0, 0, 0]));\n        element.color = [1, 0.5, 0.25, 1];\n        element._onRender();\n        color = (element as IoGl).ctx.getImageData(0, 0, 1, 1).data;\n        expect(color).to.eql(new Uint8ClampedArray([255, 128, 64, 255]));\n\n        element.transparent = true;\n        element.color = [1, 0.25, 0.5, 0.5];\n        element._onRender();\n        color = (element as IoGl).ctx.getImageData(0, 0, 1, 1).data;\n        expect(color).to.eql(new Uint8ClampedArray([128, 32, 64, 64]));\n      });\n    });\n  }\n}\n"]}