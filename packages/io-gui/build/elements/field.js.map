{"version":3,"file":"field.js","sourceRoot":"","sources":["../../src/elements/field.ts"],"names":[],"mappings":"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","sourcesContent":["\nimport { Register } from '../core/decorators/register';\nimport { Property } from '../core/decorators/property';\nimport { IoElement } from '../core/element';\n\n// let focusBacktrack = new WeakMap();\n// const backtrackDir = {'left': 'right', 'right': 'left', 'down': 'up', 'up': 'down'};\n// function setBacktrack(element, dir, target) {\n//   const backtrack = focusBacktrack.get(element) || {};\n//   backtrack[backtrackDir[dir]] = target;\n//   focusBacktrack.set(element, backtrack);\n// }\n\n@Register\nexport class IoField extends IoElement {\n  static get Style() {\n    return /* css */`\n      --ioField: {\n        display: flex;\n\n        cursor: pointer;\n        user-select: none;\n        -webkit-touch-callout: none;\n\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n\n        height: var(--io_fieldHeight);\n        line-height: var(--io_lineHeight);\n\n        font-size: var(--io_fontSize);\n        border: var(--io_border);\n        border-radius: var(--io_borderRadius);\n        border-color: transparent;\n        color: var(--io_colorField);\n        background-color: var(--io_bgColorField);\n        padding-top: var(--io_spacing);\n        padding-bottom: var(--io_spacing);\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n        transition: background-color 0.25s;\n      }\n      :host {\n        @apply --ioField;\n      }\n      :host[appearance=neutral] {\n        color: var(--io_color);\n        background-color: transparent;\n      }\n      :host[appearance=inset] {\n        border-color: var(--io_borderColorInset);\n        padding-top: calc(var(--io_spacing) + 0.05em);\n        padding-bottom: calc(var(--io_spacing) - 0.05em);\n      }\n      :host[appearance=outset] {\n        border-color: var(--io_borderColorOutset);\n        background-image: var(--io_gradientOutset);\n      }\n      :host.red,\n      :host[invalid] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorRed);\n        border-color: var(--io_colorRed);\n      }\n      :host.green {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorGreen);\n        border-color: var(--io_colorGreen);\n      }\n\n      :host.blue,\n      :host[selected] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorBlue);\n        border-color: var(--io_colorBlue);\n      }\n      :host:focus {\n        text-overflow: inherit;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorField);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n      :host[appearance=inset] io-icon {\n        margin-top: -0.05em;\n        margin-bottom: 0.05em;\n      }\n    `;\n  }\n\n  @Property('0')\n  declare tabindex: string;\n\n  @Property(undefined)\n  declare value: any;\n\n  @Property({value: '', reflect: true})\n  declare icon: string;\n\n  @Property({value: 'flush', reflect: true})\n  declare appearance: 'flush' | 'inset' | 'outset' | 'neutral';\n\n  @Property({value: false, type: Boolean, reflect: true})\n  declare stroke: boolean;\n\n  @Property({value: false, type: Boolean, reflect: true})\n  declare selected: boolean;\n\n  @Property({value: false, type: Boolean, reflect: true})\n  declare invalid: boolean;\n\n  @Property({value: '', type: String, reflect: true})\n  declare placeholder: string;\n\n  static get Listeners() {\n    return {\n      'focus-to': '_onFocusTo',\n      'focus': '_onFocus',\n      'pointerdown': '_onPointerdown',\n      'click': '_onClick',\n    };\n  }\n  _onFocus(event: FocusEvent) {\n    this.addEventListener('blur', this._onBlur);\n    this.addEventListener('keydown', this._onKeydown);\n    this.addEventListener('keyup', this._onKeyup);\n  }\n  _onBlur(event: FocusEvent) {\n    this.removeEventListener('blur', this._onBlur);\n    this.removeEventListener('keydown', this._onKeydown);\n    this.removeEventListener('keyup', this._onKeyup);\n  }\n  _onPointerdown(event: PointerEvent) {\n    this.addEventListener('pointermove', this._onPointermove);\n    this.addEventListener('pointerleave', this._onPointerleave);\n    this.addEventListener('pointerup', this._onPointerup);\n  }\n  _onPointermove(event: PointerEvent) {}\n\n  _onPointerleave(event: PointerEvent) {\n    this.removeEventListener('pointermove', this._onPointermove);\n    this.removeEventListener('pointerleave', this._onPointerleave);\n    this.removeEventListener('pointerup', this._onPointerup);\n  }\n  _onPointerup(event: PointerEvent) {\n    this.removeEventListener('pointermove', this._onPointermove);\n    this.removeEventListener('pointerleave', this._onPointerleave);\n    this.removeEventListener('pointerup', this._onPointerup);\n    this.focus();\n  }\n  _onClick() {\n    this.dispatchEvent('io-field-clicked', {value: this.value}, true);\n  }\n  _onKeydown(event: KeyboardEvent) {\n    if (event.key === 'Enter' || event.key === ' ') {\n      event.preventDefault();\n      this._onClick();\n    }\n    else if (event.key === 'ArrowLeft') {\n      event.preventDefault();\n      this.focusTo('left');\n    } else if (event.key === 'ArrowUp') {\n      event.preventDefault();\n      this.focusTo('up');\n    } else if (event.key === 'ArrowRight') {\n      event.preventDefault();\n      this.focusTo('right');\n    } else if (event.key === 'ArrowDown') {\n      event.preventDefault();\n      this.focusTo('down');\n    }\n  }\n  _onKeyup(event: KeyboardEvent) {}\n  _onFocusTo(event: CustomEvent) {\n    const src = event.composedPath()[0];\n    const dir = event.detail.dir;\n    const rect = event.detail.rect;\n    rect.center = {x: rect.x + rect.width / 2, y: rect.y + rect.height / 2};\n\n    if (src !== this as any) {\n      let closest = src;\n      let closestX = Infinity;\n      let closestY = Infinity;\n\n      // TODO: improve backtracking\n      // const backtrack = focusBacktrack.get(src);\n      // if (backtrack && backtrack[dir]) {\n      //   backtrack[dir].focus();\n      //   setBacktrack(backtrack[dir], dir, src);\n      //   return;\n      // }\n\n      const siblings = this.querySelectorAll('[tabindex=\"0\"]:not([disabled])');\n\n      for (let i = siblings.length; i--;) {\n\n        if (!siblings[i].offsetParent) {\n          continue;\n        }\n        // TODO: unhack\n        const sStyle = window.getComputedStyle(siblings[i]);\n        if (sStyle.visibility !== 'visible') {\n          continue;\n        }\n\n        const sRect = siblings[i].getBoundingClientRect();\n        sRect.center = {x: sRect.x + sRect.width / 2, y: sRect.y + sRect.height / 2};\n\n        // TODO: improve automatic direction routing.\n        switch (dir) {\n          case 'right': {\n            if (sRect.left >= (rect.right - 1)) {\n              const distX = Math.abs(sRect.left - rect.right);\n              const distY = Math.abs(sRect.center.y - rect.center.y);\n              if (distX < closestX || distY < closestY / 3) {\n                closest = siblings[i];\n                closestX = distX;\n                closestY = distY;\n              } else if (distX === closestX && distY < closestY) {\n                closest = siblings[i];\n                closestY = distY;\n              }\n            }\n            break;\n          }\n          case 'left': {\n            if (sRect.right <= (rect.left + 1)) {\n              const distX = Math.abs(sRect.right - rect.left);\n              const distY = Math.abs(sRect.center.y - rect.center.y);\n              if (distX < closestX || distY < closestY / 3) {\n                closest = siblings[i];\n                closestX = distX;\n                closestY = distY;\n              } else if (distX === closestX && distY < closestY) {\n                closest = siblings[i];\n                closestY = distY;\n              }\n            }\n            break;\n          }\n          case 'down': {\n            if (sRect.top >= (rect.bottom - 1)) {\n              const distX = Math.abs(sRect.center.x - rect.center.x);\n              const distY = Math.abs(sRect.top - rect.bottom);\n              if (distY < closestY || distX < closestX / 3) {\n                closest = siblings[i];\n                closestX = distX;\n                closestY = distY;\n              } else if (distY === closestY && distX < closestX) {\n                closest = siblings[i];\n                closestX = distX;\n              }\n            }\n            break;\n          }\n          case 'up':{\n            if (sRect.bottom <= (rect.top + 1)) {\n              const distX = Math.abs(sRect.center.x - rect.center.x);\n              const distY = Math.abs(sRect.bottom - rect.top);\n              if (distY < closestY || distX < closestX / 3) {\n                closest = siblings[i];\n                closestX = distX;\n                closestY = distY;\n              } else if (distY === closestY && distX < closestX) {\n                closest = siblings[i];\n                closestX = distX;\n              }\n            }\n            break;\n          }\n        }\n      }\n\n      if (closest !== src) {\n        (closest as any).focus();\n        // setBacktrack(closest, dir, src);\n        event.stopPropagation();\n      }\n    }\n  }\n  focusTo(dir: string) {\n    const rect = this.getBoundingClientRect();\n    this.dispatchEvent('focus-to', {dir: dir, rect: rect}, true);\n  }\n  getCaretPosition() {\n    let position = 0;\n    const selection = window.getSelection();\n    if (selection && selection.rangeCount) {\n      const range = selection.getRangeAt(0);\n      const selected = range.toString().length;\n      const preCaretRange = range.cloneRange();\n      preCaretRange.selectNodeContents(this as unknown as Node);\n      preCaretRange.setEnd(range.endContainer, range.endOffset);\n      position = preCaretRange.toString().length - selected;\n    }\n    return position;\n  }\n  setCaretPosition(position: number){\n    if (!position) return;\n    const selection = window.getSelection();\n    if (selection) {\n      const range = document.createRange();\n      range.setStart(this.firstChild, position);\n      range.collapse(true);\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n  changed() {\n    let label = '';\n    if (this.label) {\n      label = this.label;\n    } else {\n      if (this.value && typeof this.value === 'object') {\n        label = `${this.value.constructor.name}` + (this.value instanceof Array ? `(${this.value.length})` : '');\n      } else if (this.value !== undefined) {\n        label = String(this.value);\n      }\n    }\n    this.template([\n      this.icon ? ['io-icon', {icon: this.icon, stroke: this.stroke}] : null,\n      ['io-label', {label: label}]\n    ]);\n  }\n}\n"]}