{"version":3,"file":"IoTabsHamburgerMenuSingleton.js","sourceRoot":"","sources":["../../src/elements/IoTabsHamburgerMenuSingleton.ts"],"names":[],"mappings":"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","sourcesContent":["import { IoOverlaySingleton, NudgeDirection, NodeArray, VDOMElement, IoElement, IoElementProps, Register, ReactiveProperty, nudge, ListenerDefinition } from 'io-core'\nimport { Tab } from '../nodes/Tab.js'\nimport { ioTab, IoTab } from './IoTab.js'\n\nexport interface IoTabsHamburgerMenuExpandProps {\n  source: HTMLElement\n  direction: NudgeDirection\n  tabs: NodeArray<Tab>\n  onEditTab: (event: CustomEvent) => void\n}\n\n@Register\nclass IoTabsHamburgerMenu extends IoElement {\n  static vConstructor: (arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string) => VDOMElement\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        border: var(--io_border);\n        border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n        border-color: var(--io_borderColorOutset);\n        background-color: var(--io_bgColorLight);\n        padding: calc(var(--io_spacing) + var(--io_borderWidth));\n        position: absolute;\n        overflow-y: auto;\n        box-shadow: 1px 1px 16px var(--io_shadowColor),\n                    1px 1px 8px var(--io_shadowColor), \n                    1px 1px 4px var(--io_shadowColor);\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host > io-tab {\n        border-color: transparent !important;\n        background-color: var(--io_bgColorLight) !important;\n        border-radius: var(--io_borderRadius) !important;\n      }\n      :host > io-tab[selected] {\n        background-color: var(--io_bgColor) !important;\n      }\n      :host > io-tab > .marker {\n        border-radius: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare private expanded: boolean\n\n  declare private onEditTab: (event: CustomEvent) => void\n\n  static get Listeners() {\n    return {\n      'touchstart': ['stopPropagation', {passive: false}] as ListenerDefinition, // TODO: why?\n      'io-focus-to': 'onIoFocusTo',\n      'io-edit-tab': 'onEditTabCapture',\n    }\n  }\n\n  constructor(args: IoElementProps = {}) { super(args) }\n\n  stopPropagation(event: TouchEvent) {\n    event.stopPropagation()\n  }\n\n  onIoFocusTo(event: CustomEvent) {\n    const source = event.detail.source\n    const cmd = event.detail.command\n    const siblings = Array.from(this.querySelectorAll('io-tab')) as IoTab[]\n    const index = siblings.indexOf(source)\n\n    let cmdOverride = ''\n\n    if (cmd === 'ArrowDown') cmdOverride = 'Next'\n    if (cmd === 'ArrowUp') cmdOverride = 'Prev'\n    if (cmd === 'ArrowLeft') cmdOverride = 'First'\n    if (cmd === 'ArrowRight') cmdOverride = 'Last'\n\n    if (cmdOverride) {\n      if (cmdOverride === 'Next') {\n        siblings[(index + 1) % siblings.length].focus()\n      } else if (cmdOverride === 'Prev') {\n        siblings[(index - 1 + siblings.length) % siblings.length].focus()\n      } else if (cmdOverride === 'First') {\n        siblings[0].focus()\n      } else if (cmdOverride === 'Last') {\n        siblings[siblings.length - 1].focus()\n      }\n      event.stopPropagation()\n    }\n  }\n\n  onEditTabCapture(event: CustomEvent) {\n    event.stopPropagation()\n    this.onEditTab(event)\n    this.expanded = false\n  }\n\n  expand(props: IoTabsHamburgerMenuExpandProps) {\n    this.setProperties({\n      tabs: props.tabs,\n      expanded: true,\n    })\n    this.onEditTab = props.onEditTab\n    nudge(this, props.source, props.direction)\n    this.debounce(this.onExpand)\n  }\n  onExpand() {\n    (this.querySelector('[selected]') as HTMLElement)?.focus()\n  }\n  changed() {\n    this.render([\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n    ])\n  }\n}\n\nexport const IoTabsHamburgerMenuSingleton = new IoTabsHamburgerMenu()\nsetTimeout(() => {\n  IoOverlaySingleton.appendChild(IoTabsHamburgerMenuSingleton as HTMLElement)\n}, 100)"]}