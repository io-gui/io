{"version":3,"file":"Split.js","sourceRoot":"","sources":["../../src/nodes/Split.ts"],"names":[],"mappings":"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","sourcesContent":["import { ReactiveNode, NodeArray, ReactiveProperty, Register } from '@io-gui/core'\nimport { Panel, PanelProps } from './Panel.js'\n\nexport type SplitOrientation = 'horizontal' | 'vertical'\n\nexport type SplitProps = {\n  type: 'split'\n  children: Array<SplitProps | PanelProps>\n  orientation?: SplitOrientation\n  flex?: string\n}\n\nfunction createChild(child: SplitProps | PanelProps): Split | Panel {\n  return child.type === 'panel' ? new Panel(child) : new Split(child)\n}\n\nfunction consolidateChildren(\n  children: Array<Split | Panel>,\n  orientation: SplitOrientation\n): { children: Array<Split | Panel>; orientation: SplitOrientation } {\n  let result = children\n  let resultOrientation = orientation\n  while (result.length === 1 && result[0] instanceof Split) {\n    const soleChild = result[0]\n    resultOrientation = soleChild.orientation\n    result = [...soleChild.children]\n  }\n  return { children: result, orientation: resultOrientation }\n}\n\n@Register\nexport class Split extends ReactiveNode {\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare children: NodeArray<Split | Panel>\n\n  @ReactiveProperty({type: String, value: 'horizontal'})\n  declare orientation: SplitOrientation\n\n  @ReactiveProperty({type: String, value: '1 1 auto'})\n  declare flex: string\n\n  constructor(args: SplitProps) {\n    debug: {\n      if (args.type !== 'split') {\n        console.error(`Split: Invalid type \"${args.type}\". Expected \"split\".`)\n      }\n    }\n\n    const processedChildren = args.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, args.orientation ?? 'horizontal')\n\n    super({\n      ...args,\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n    })\n  }\n  childrenMutated() {\n    this.debounce(this.onChildrenMutatedDebounced)\n  }\n  onChildrenMutatedDebounced() {\n    this.dispatchMutation()\n  }\n  flexChanged() {\n    const flexRegex = /^[\\d.]+\\s+[\\d.]+\\s+(?:auto|[\\d.]+(?:px|%))$/\n    if (!flexRegex.test(this.flex)) {\n      debug: {\n        console.error(`Split: Invalid flex value \"${this.flex}\". Expected a valid CSS flex value.`)\n      }\n      this.flex = '0 1 auto'\n    }\n  }\n  toJSON(): SplitProps {\n    const json: SplitProps = {\n      type: 'split',\n      children: this.children.map((child: Split | Panel) => child.toJSON()),\n    }\n    if (this.orientation !== 'horizontal') json.orientation = this.orientation\n    if (this.flex !== '1 1 auto') json.flex = this.flex\n    return json\n  }\n  fromJSON(json: SplitProps) {\n    debug: {\n      if (json.type !== 'split') {\n        console.error(`Split.fromJSON: Invalid type \"${json.type}\". Expected \"split\".`)\n      }\n    }\n    const processedChildren = json.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, json.orientation ?? 'horizontal')\n\n    this.setProperties({\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n      flex: json.flex ?? '1 1 auto',\n    })\n    return this\n  }\n  dispose() {\n    this.children.length = 0\n    super.dispose()\n  }\n}"]}