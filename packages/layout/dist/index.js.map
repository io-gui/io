{"version":3,"file":"index.js","sources":["../src/elements/IoDivider.ts","../src/nodes/Tab.ts","../src/nodes/Panel.ts","../src/nodes/Split.ts","../src/elements/IoTabDropRect.ts","../src/elements/IoTabDragIcon.ts","../src/elements/IoTab.ts","../src/elements/IoTabsHamburgerMenuSingleton.ts","../src/elements/IoTabsHamburger.ts","../src/elements/IoTabs.ts","../src/elements/IoLayout.ts","../src/elements/IoPanel.ts","../src/elements/IoSplit.ts","../src/elements/IoDrawer.ts"],"sourcesContent":["import { Register, ReactiveProperty, IoElement, IoElementProps, ListenerDefinition } from '@io-gui/core'\n\nexport type IoDividerProps = IoElementProps & {\n  orientation: 'vertical' | 'horizontal'\n}\n\n@Register\nexport class IoDivider extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        flex: 0 0 var(--io_spacing3);\n        background-color: var(--io_colorLight);\n        border-style: solid;\n        border-width: 0 var(--io_borderWidth);\n        border-color: var(--io_color);\n        cursor: col-resize;\n        @apply --unselectable;\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorBlue);\n        background-color: var(--io_bgColorBlue);\n      }\n      :host[pressed]:before,\n      :host[pressed]:after {\n        background-color: var(--io_colorWhite);\n      }\n      :host:before,\n      :host:after {\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        z-index: 1;\n        opacity: 0;\n      }\n      :host:before {\n        width: var(--io_fieldHeight);\n        height: var(--io_spacing);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(90deg);\n        border-radius: var(--io_spacing);\n        opacity: 0.5;\n      }\n      :host[orientation='vertical']:before {\n        transform: translate(-50%, -50%);\n      }\n      :host:after {\n        width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(45deg);\n        border-radius: 25%;\n      }\n      :host[orientation='vertical'] {\n        cursor: row-resize;\n        border-width: var(--io_borderWidth) 0;\n      }\n      :host:hover {\n        border-style: dashed;\n      }\n      :host:hover:before {\n        opacity: 1;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: false, type: Boolean, reflect: true})\n  declare pressed: boolean\n\n  @ReactiveProperty({value: 'horizontal', type: String, reflect: true})\n  declare orientation: 'horizontal' | 'vertical'\n\n  static get Listeners() {\n    return {\n      'pointerdown': 'onPointerdown',\n      'touchstart': ['onTouchstart', {passive: false}] as ListenerDefinition,\n    }\n  }\n\n  constructor(args: IoDividerProps) { super(args) }\n\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    this.addEventListener('pointermove', this.onPointermove)\n    this.addEventListener('pointerup', this.onPointerup)\n    this.addEventListener('pointercancel', this.onPointercancel)\n    this.setPointerCapture(event.pointerId)\n    this.pressed = true\n  }\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    this.dispatch('io-divider-move', {\n      clientX: event.clientX,\n      clientY: event.clientY,\n      element: this,\n    }, true)\n  }\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n    this.removeEventListener('pointercancel', this.onPointercancel)\n    this.releasePointerCapture(event.pointerId)\n    this.pressed = false\n    this.dispatch('io-divider-move-end', {\n      clientX: event.clientX,\n      clientY: event.clientY,\n      element: this,\n    }, true)\n  }\n  onPointercancel(event: PointerEvent) {\n    event.preventDefault()\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n    this.removeEventListener('pointercancel', this.onPointercancel)\n    this.releasePointerCapture(event.pointerId)\n    this.pressed = false\n  }\n  onTouchstart(event: TouchEvent) {\n    this.addEventListener('touchmove', this.onTouchmove, {passive: false})\n    this.addEventListener('touchend', this.onTouchend)\n  }\n  onTouchmove(event: TouchEvent) {\n    event.preventDefault()\n  }\n  onTouchend() {\n    this.removeEventListener('touchmove', this.onTouchmove)\n    this.removeEventListener('touchend', this.onTouchend)\n  }\n}\nexport const ioDivider = function(arg0: IoDividerProps) {\n  return IoDivider.vConstructor(arg0)\n}\n","import { ReactiveNode, ReactiveProperty, Register } from '@io-gui/core'\n\nexport type TabProps = {\n  id: string\n  label?: string\n  icon?: string\n  selected?: boolean\n}\n\n@Register\nexport class Tab extends ReactiveNode {\n\n  @ReactiveProperty({type: String, value: ''})\n  declare id: string\n\n  @ReactiveProperty({type: String, value: ''})\n  declare label: string\n\n  @ReactiveProperty({type: String, value: ''})\n  declare icon: string\n\n  @ReactiveProperty({type: Boolean, value: false})\n  declare selected: boolean\n\n  constructor(args: TabProps) {\n    debug: {\n      if (!args.id) {\n        console.error('Tab: construction error - empty id')\n      }\n    }\n    super({\n      ...args,\n      label: args.label ? args.label : args.id,\n    })\n  }\n  toJSON(): TabProps {\n    const json: TabProps = { id: this.id }\n    if (this.label !== this.id) json.label = this.label\n    if (this.icon) json.icon = this.icon\n    if (this.selected) json.selected = this.selected\n    return json\n  }\n  fromJSON(json: TabProps) {\n    this.setProperties({\n      id: json.id,\n      label: json.label ? json.label : json.id,\n      icon: json.icon ? json.icon : '',\n      selected: json.selected ? json.selected : false,\n    })\n    return this\n  }\n}","import { ReactiveNode, NodeArray, ReactiveProperty, Register } from '@io-gui/core'\nimport { Tab, TabProps } from './Tab.js'\n\nexport type PanelProps = {\n  type: 'panel'\n  tabs: Array<TabProps>\n  flex?: string\n}\n\nfunction deduplicateTabs<T extends TabProps>(tabs: Array<T>, context: string): Array<T> {\n  const seenIds = new Set<string>()\n  const uniqueTabs: Array<T> = []\n  for (const tab of tabs) {\n    if (seenIds.has(tab.id)) {\n      console.warn(`${context}: Duplicate tab id \"${tab.id}\" - keeping first occurrence`)\n    } else {\n      seenIds.add(tab.id)\n      uniqueTabs.push(tab)\n    }\n  }\n  return uniqueTabs\n}\n\n@Register\nexport class Panel extends ReactiveNode {\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: String, value: '1 1 auto'})\n  declare flex: string\n\n  constructor(args: PanelProps) {\n    debug: {\n      if (args.type !== 'panel') {\n        console.error(`Panel: Invalid type \"${args.type}\". Expected \"panel\".`)\n      }\n    }\n    args = { ...args }\n    args.tabs = deduplicateTabs(args.tabs, 'Panel')\n\n    if (args.tabs.length > 0 && !args.tabs.find(tab => tab.selected)) {\n      args.tabs[0].selected = true\n    }\n    args.tabs = args.tabs.map(tab => new Tab({...tab}))\n    super(args)\n  }\n  tabsMutated() {\n    this.debounce(this.onTabsMutatedDebounced)\n  }\n  onTabsMutatedDebounced() {\n    this.dispatchMutation()\n  }\n  getSelected() {\n    let selected = ''\n    for (let i = 0; i < this.tabs.length; i++) {\n      const item = this.tabs[i]\n      if (item.selected && item.id) {\n        selected = item.id\n        break\n      }\n    }\n    return selected\n  }\n  setSelected(id: string) {\n    // TODO Test and reconsider withInternalOperation\n    this.tabs.withInternalOperation(() => {\n      for (let i = 0; i < this.tabs.length; i++) {\n        const item = this.tabs[i]\n        if (item.id === id) {\n          item.selected = true\n        } else {\n          item.selected = false\n        }\n      }\n    })\n    this.tabs.dispatchMutation()\n  }\n  flexChanged() {\n    const flexRegex = /^[\\d.]+\\s+[\\d.]+\\s+(?:auto|[\\d.]+(?:px|%))$/\n    if (!flexRegex.test(this.flex)) {\n      debug: {\n        console.error(`Split: Invalid flex value \"${this.flex}\". Expected a valid CSS flex value.`)\n      }\n      this.flex = '0 1 auto'\n    }\n  }\n  toJSON(): PanelProps {\n    const json: PanelProps = {\n      type: 'panel',\n      tabs: this.tabs.map(tab => tab.toJSON()),\n    }\n    if (this.flex !== '1 1 auto') json.flex = this.flex\n    return json\n  }\n  fromJSON(json: PanelProps) {\n    debug: {\n      if (json.type !== 'panel') {\n        console.error(`Panel.fromJSON: Invalid type \"${json.type}\". Expected \"panel\".`)\n      }\n    }\n    const uniqueTabs = deduplicateTabs(json.tabs, 'Panel.fromJSON')\n    this.setProperties({\n      tabs: uniqueTabs.map(tab => new Tab(tab)),\n      flex: json.flex ?? '1 1 auto',\n    })\n    return this\n  }\n  dispose() {\n    this.tabs.length = 0\n    super.dispose()\n  }\n}","import { ReactiveNode, NodeArray, ReactiveProperty, Register } from '@io-gui/core'\nimport { Panel, PanelProps } from './Panel.js'\n\nexport type SplitOrientation = 'horizontal' | 'vertical'\n\nexport type SplitProps = {\n  type: 'split'\n  children: Array<SplitProps | PanelProps>\n  orientation?: SplitOrientation\n  flex?: string\n}\n\nfunction createChild(child: SplitProps | PanelProps): Split | Panel {\n  return child.type === 'panel' ? new Panel(child) : new Split(child)\n}\n\nfunction consolidateChildren(\n  children: Array<Split | Panel>,\n  orientation: SplitOrientation\n): { children: Array<Split | Panel>; orientation: SplitOrientation } {\n  let result = children\n  let resultOrientation = orientation\n  while (result.length === 1 && result[0] instanceof Split) {\n    const soleChild = result[0]\n    resultOrientation = soleChild.orientation\n    result = [...soleChild.children]\n  }\n  return { children: result, orientation: resultOrientation }\n}\n\n@Register\nexport class Split extends ReactiveNode {\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare children: NodeArray<Split | Panel>\n\n  @ReactiveProperty({type: String, value: 'horizontal'})\n  declare orientation: SplitOrientation\n\n  @ReactiveProperty({type: String, value: '1 1 auto'})\n  declare flex: string\n\n  constructor(args: SplitProps) {\n    debug: {\n      if (args.type !== 'split') {\n        console.error(`Split: Invalid type \"${args.type}\". Expected \"split\".`)\n      }\n    }\n\n    const processedChildren = args.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, args.orientation ?? 'horizontal')\n\n    super({\n      ...args,\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n    })\n  }\n  childrenMutated() {\n    this.debounce(this.onChildrenMutatedDebounced)\n  }\n  onChildrenMutatedDebounced() {\n    this.dispatchMutation()\n  }\n  flexChanged() {\n    const flexRegex = /^[\\d.]+\\s+[\\d.]+\\s+(?:auto|[\\d.]+(?:px|%))$/\n    if (!flexRegex.test(this.flex)) {\n      debug: {\n        console.error(`Split: Invalid flex value \"${this.flex}\". Expected a valid CSS flex value.`)\n      }\n      this.flex = '0 1 auto'\n    }\n  }\n  toJSON(): SplitProps {\n    const json: SplitProps = {\n      type: 'split',\n      children: this.children.map((child: Split | Panel) => child.toJSON()),\n    }\n    if (this.orientation !== 'horizontal') json.orientation = this.orientation\n    if (this.flex !== '1 1 auto') json.flex = this.flex\n    return json\n  }\n  fromJSON(json: SplitProps) {\n    debug: {\n      if (json.type !== 'split') {\n        console.error(`Split.fromJSON: Invalid type \"${json.type}\". Expected \"split\".`)\n      }\n    }\n    const processedChildren = json.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, json.orientation ?? 'horizontal')\n\n    this.setProperties({\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n      flex: json.flex ?? '1 1 auto',\n    })\n    return this\n  }\n  dispose() {\n    this.children.length = 0\n    super.dispose()\n  }\n}","import { Register, ReactiveProperty, IoElement, IoElementProps, ThemeSingleton } from '@io-gui/core'\nimport { SplitDirection } from './IoSplit.js'\nimport { IoPanel } from './IoPanel.js'\nimport { IoTab } from './IoTab.js'\n\n@Register\nclass IoTabDropRect extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: fixed;\n        height: calc(var(--io_fieldHeight) - var(--io_borderWidth) - var(--io_borderRadius));\n        width: var(--io_spacing);\n        background-color: var(--io_bgColorBlue);\n        margin-bottom: var(--io_borderWidth);\n        z-index: 100000;\n        display: none;\n      }\n      :host:not([dropindex=\"-1\"]) {\n        display: block;\n      }\n      :host:not([splitdirection=\"none\"]) {\n        display: block;\n        opacity: 0.25;\n      }\n    `\n  }\n\n  @ReactiveProperty(null)\n  declare dropTarget: IoPanel | null\n\n  @ReactiveProperty({type: String, value: 'none', reflect: true})\n  declare splitDirection: SplitDirection\n\n  @ReactiveProperty({type: Number, value: -1, reflect: true})\n  declare dropIndex: number\n\n  constructor(args: IoElementProps = {}) { super(args) }\n\n  changed() {\n    if (this.dropTarget && this.dropIndex !== -1) {\n      const tabs = this.dropTarget.querySelectorAll('io-tab')\n      this.style.width = ''\n      this.style.height = ''\n      if (tabs.length === 0) {\n        const rect = this.dropTarget.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left}px`\n      } else if (this.dropIndex > tabs.length - 1) {\n        const tab = tabs[tabs.length - 1] as IoTab\n        const rect = tab.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left + rect.width}px`\n      } else {\n        const tab = tabs[this.dropIndex] as IoTab\n        const rect = tab.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left - ThemeSingleton.spacing}px`\n      }\n    } else if (this.dropTarget && this.splitDirection !== 'none') {\n      const rect = this.dropTarget.getBoundingClientRect()\n      if (this.splitDirection === 'top') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height / 2}px`\n      } else if (this.splitDirection === 'bottom') {\n        this.style.top = `${rect.top + rect.height / 2}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height / 2}px`\n      } else if (this.splitDirection === 'left') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width / 2}px`\n        this.style.height = `${rect.height}px`\n      } else if (this.splitDirection === 'right') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left + rect.width / 2}px`\n        this.style.width = `${rect.width / 2}px`\n        this.style.height = `${rect.height}px`\n      } else if (this.splitDirection === 'center') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height}px`\n      }\n    }\n  }\n}\n\nexport const ioTabDropRectSingleton = new IoTabDropRect()\ndocument.body.appendChild(ioTabDropRectSingleton as HTMLElement)\n\n","import { Register, ReactiveProperty, span, ThemeSingleton } from '@io-gui/core'\nimport { IoField, IoFieldProps } from '@io-gui/inputs'\nimport { ioIcon } from '@io-gui/icons'\nimport { ioTabDropRectSingleton } from './IoTabDropRect.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { SplitDirection } from './IoSplit.js'\nimport { IoPanel } from './IoPanel.js'\nimport { IoLayout } from './IoLayout.js'\nimport { IoTabs } from './IoTabs.js'\n\nconst DRAG_THRESHOLD = 10\n\n@Register\nclass IoTabDragIcon extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        transform: translate(-50%, -50%);\n        z-index: 100000;\n        pointer-events: none;\n        border-color: var(--io_borderColorLight);\n        background-color: var(--io_bgColorLight) !important;\n        opacity: 0.75;\n      }\n      :host[dragging] {\n        display: flex;\n      }\n      :host > * {\n        display: inline-block;\n        white-space: nowrap;\n        padding: 0 var(--io_spacing);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare dragging: boolean\n\n  @ReactiveProperty()\n  declare tab: Tab | null\n\n  @ReactiveProperty()\n  declare dropSource: IoPanel | null\n\n  @ReactiveProperty()\n  declare dropTarget: IoPanel | null\n\n  @ReactiveProperty({type: String, value: 'none', reflect: true})\n  declare splitDirection: SplitDirection\n\n  @ReactiveProperty({type: Number, value: -1})\n  declare dropIndex: number\n\n  private _startX: number = 0\n  private _startY: number = 0\n\n  constructor(args: IoFieldProps = {}) { super(args) }\n\n  setStartPosition(x: number, y: number) {\n    this._startX = x\n    this._startY = y\n  }\n\n  updateDrag(tab: Tab, sourcePanel: IoPanel, x: number, y: number, root: IoLayout | null) {\n    if (!this.dragging) {\n      const dx = Math.abs(this._startX - x)\n      const dy = Math.abs(this._startY - y)\n      if (dx > DRAG_THRESHOLD || dy > DRAG_THRESHOLD) {\n        this.setProperties({\n          tab: tab,\n          dragging: true,\n          dropSource: sourcePanel,\n          dropTarget: null,\n          dropIndex: -1,\n        })\n        this.style.top = y + 'px'\n        this.style.left = x + 'px'\n      }\n      return\n    }\n\n    this.style.top = y + 'px'\n    this.style.left = x + 'px'\n\n    if (!root) {\n      console.error('IoTabDragIcon: No io-layout found!')\n      return\n    }\n\n    this.detectDropTargets(x, y, root)\n  }\n\n  private detectDropTargets(x: number, y: number, root: IoLayout) {\n    const m = ThemeSingleton.spacing\n\n    // Check tab bars first (higher priority)\n    const tabsContainers = root.querySelectorAll('io-tabs')\n    for (let i = 0; i < tabsContainers.length; i++) {\n      const tabsContainer = tabsContainers[i] as IoTabs\n      const targetPanel = tabsContainer.parentElement as IoPanel\n      const tcr = tabsContainer.getBoundingClientRect()\n\n      if (y >= tcr.top && y <= tcr.bottom && x >= tcr.left && x <= tcr.right) {\n        const tabs = tabsContainer.querySelectorAll('io-tab')\n        if (tabs.length === 0) {\n          this.setProperties({\n            dropTarget: targetPanel,\n            splitDirection: 'none',\n            dropIndex: 0,\n          })\n          return\n        }\n\n        for (let j = 0; j < tabs.length; j++) {\n          const tab = tabs[j]\n          const tr = tab.getBoundingClientRect()\n          const isLast = j === tabs.length - 1\n\n          if (y >= tr.top - m && y <= tr.bottom + m && x >= tr.left - m && (x <= tr.right + m || isLast && x <= tcr.right)) {\n            const side = x < tr.left + tr.width / 2 ? 'left' : 'right'\n            const dropIndex = side === 'left' ? j : j + 1\n            this.setProperties({\n              dropTarget: targetPanel,\n              splitDirection: 'none',\n              dropIndex: dropIndex,\n            })\n            return\n          }\n        }\n      }\n    }\n\n    const panels = root.querySelectorAll('io-panel')\n    for (let i = 0; i < panels.length; i++) {\n      const targetPanel = panels[i] as IoPanel\n      const pr = targetPanel.getBoundingClientRect()\n\n      if (y >= pr.top && y <= pr.bottom && x >= pr.left && x <= pr.right) {\n        const direction = this.calculateSplitDirection(x, y, pr)\n        this.setProperties({\n          dropTarget: targetPanel,\n          splitDirection: direction,\n          dropIndex: -1,\n        })\n        return\n      }\n    }\n  }\n\n  private calculateSplitDirection(x: number, y: number, rect: DOMRect): SplitDirection {\n    const rx = (x - rect.left - rect.width / 2) / rect.width * 2\n    const ry = (y - rect.top - rect.height / 2) / rect.height * 2\n\n    if (Math.abs(rx) < 0.5 && Math.abs(ry) < 0.5) return 'center'\n    if (Math.abs(ry) > Math.abs(rx)) return ry > 0 ? 'bottom' : 'top'\n    return rx > 0 ? 'right' : 'left'\n  }\n\n  endDrag() {\n    const source = this.dropSource\n    const target = this.dropTarget\n    const index = this.dropIndex\n    const direction = this.splitDirection\n    const tab = this.tab\n\n    if (tab && target && index !== -1) {\n      if (source && source !== target) {\n        source.removeTab(tab)\n      }\n      target.addTab(tab, index)\n    } else if (tab && source && target && direction !== 'none') {\n      target.moveTabToSplit(source, tab, direction)\n    }\n\n    this.cancelDrag()\n  }\n\n  cancelDrag() {\n    this.setProperties({\n      dragging: false,\n      tab: null,\n      dropSource: null,\n      dropTarget: null,\n      splitDirection: 'none',\n      dropIndex: -1,\n    })\n  }\n\n  changed() {\n    ioTabDropRectSingleton.setProperties({\n      dropTarget: this.dropTarget,\n      splitDirection: this.splitDirection,\n      dropIndex: this.dropIndex,\n    })\n    this.render([\n      ioIcon({value: this.tab?.icon || ' '}),\n      span({class: 'label'}, this.tab?.label || ''),\n    ])\n  }\n}\n\nexport const tabDragIconSingleton = new IoTabDragIcon()\ndocument.body.appendChild(tabDragIconSingleton as HTMLElement)\n","import { Register, ReactiveProperty, span } from '@io-gui/core'\nimport { IoField, IoFieldProps, ioString, ioButton } from '@io-gui/inputs'\nimport { IoContextEditorSingleton } from '@io-gui/editors'\nimport { IconsetDB, ioIcon } from '@io-gui/icons'\nimport { MenuOptionProps, MenuOption, ioOptionSelect } from '@io-gui/menus'\nimport { IoPanel } from './IoPanel.js'\nimport { IoLayout } from './IoLayout.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { tabDragIconSingleton } from './IoTabDragIcon.js'\n\nconst icons: MenuOptionProps[] = []\nfor (const set of Object.keys(IconsetDB)) {\n  for (const icon of Object.keys(IconsetDB[set])) {\n    const id = `${set}:${icon}`\n    icons.push({value: id, id: icon, icon: id})\n  }\n}\n\nconst iconOptions = ioOptionSelect({selectBy: 'value', label: 'Icon', option: new MenuOption({options: icons})})\n\nexport type IoTabProps = IoFieldProps & {\n  tab: Tab\n}\n\n// TODO: fix and improve keyboard navigation in all cases.\n@Register\nexport class IoTab extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        position: relative;\n        height: inherit;\n        min-height: inherit;\n        /* TODO: use vars for this */\n        min-width: calc(var(--io_fieldHeight) * 1.25);\n        margin: 0;\n        margin-right: var(--io_spacing);\n        background-color: var(--io_bgColor) !important;\n        border-bottom-left-radius: 0;\n        border-bottom-right-radius: 0;\n        border-color: var(--io_borderColorLight);\n        padding-right: calc(var(--io_lineHeight) / 2);\n        padding-left: calc(var(--io_lineHeight) / 2);\n      }\n      :host[pressed] {\n        border-color: unset !important;\n        box-shadow: unset !important;\n      }\n      :host[selected] {\n        color: var(--io_colorStrong);\n        background-color: var(--io_bgColorLight) !important;\n        border-color: var(--io_borderColorStrong);\n        border-bottom-color: var(--io_bgColorLight);\n        z-index: 1;\n      }\n      :host[selected]:focus {\n        color: var(--io_colorWhite);\n        z-index: 2;\n      }\n      :host > .io-icon:not([value=' ']) {\n        margin: 0 var(--io_spacing2) 0 0;\n      }\n      :host > .io-tab-drop-marker {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 100%;\n        background-color: var(--io_bgColorBlue);\n        border-bottom-right-radius: var(--io_borderRadius);\n      }\n      :host > span {\n        padding: 0 var(--io_spacing);\n        overflow: hidden; \n        text-overflow: ellipsis !important;\n      }\n      :host > * {\n        pointer-events: none;\n        display: inline-block;\n        white-space: nowrap;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Tab})\n  declare tab: Tab\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare overflow: boolean\n\n  static get Listeners() {\n    return {\n      'click': 'preventDefault',\n      'contextmenu': 'onContextMenu',\n    }\n  }\n\n  constructor(args: IoTabProps) { super(args) }\n\n  onResized() {\n    const span = this.querySelector('span')!\n    this.overflow = span.scrollWidth > span.clientWidth\n  }\n  onTouchmove(event: TouchEvent) {\n    event.preventDefault()\n  }\n  preventDefault(event: Event) {\n    event.stopPropagation()\n    event.preventDefault()\n  }\n  // TODO: test on iOS\n  onContextMenu(event: MouseEvent) {\n    event.stopPropagation()\n    event.preventDefault()\n    this.expandContextEditor()\n  }\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    this.setPointerCapture(event.pointerId)\n    tabDragIconSingleton.setStartPosition(event.clientX, event.clientY)\n    super.onPointerdown(event)\n    if (event.buttons === 1) {\n      this.focus()\n    }\n  }\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    if (event.buttons !== 1) return\n    const panel = this.parentElement!.parentElement as IoPanel\n    const root = this.closest('io-layout') as IoLayout\n    tabDragIconSingleton.updateDrag(this.tab, panel, event.clientX, event.clientY, root)\n  }\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    super.onPointerup(event)\n    this.releasePointerCapture(event.pointerId)\n    if (tabDragIconSingleton.dragging) {\n      tabDragIconSingleton.endDrag()\n    } else {\n      this.onClick()\n    }\n  }\n  onPointercancel(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    super.onPointercancel(event)\n    tabDragIconSingleton.cancelDrag()\n  }\n  onPointerleave(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n  }\n  onClick() {\n    this.dispatch('io-edit-tab', {tab: this.tab, key: 'Select'}, true)\n  }\n  onDeleteClick() {\n    this.dispatch('io-edit-tab', {tab: this.tab, key: 'Backspace'}, true)\n  }\n  expandContextEditor() {\n    const deleteAction = () => {\n      IoContextEditorSingleton.expanded = false\n      this.onDeleteClick()\n    }\n    IoContextEditorSingleton.expand({\n      source: this,\n      direction: 'down',\n      value: this.tab,\n      properties: ['label', 'icon'],\n      config: [\n        ['label', ioString({live: true})],\n        ['icon', iconOptions],\n      ],\n      widget: ioButton({label: 'Delete Tab', icon: 'io:close', action: deleteAction}),\n    })\n  }\n  onKeydown(event: KeyboardEvent) {\n    if (event.shiftKey && ['Backspace', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Home', 'End'].includes(event.key)) {\n      event.preventDefault()\n      this.dispatch('io-edit-tab', {tab: this.tab, key: event.key}, true)\n    } else if (event.shiftKey && event.key === 'Enter') {\n      this.expandContextEditor()\n    } else {\n      super.onKeydown(event)\n    }\n  }\n  tabMutated() {\n    this.changed()\n  }\n  changed() {\n    this.setAttribute('selected', this.tab.selected)\n    this.setAttribute('title', this.tab.label)\n    this.render([\n      this.tab.selected ? span({class: 'io-tab-drop-marker'}) : null,\n      this.tab.icon ? ioIcon({value: this.tab.icon}) : null,\n      span({class: 'io-tab-label'}, this.tab.label),\n    ])\n  }\n}\n\nexport const ioTab = function(arg0: IoTabProps) {\n  return IoTab.vConstructor(arg0)\n}\n","import { IoOverlaySingleton, NudgeDirection, NodeArray, VDOMElement, IoElement, IoElementProps, Register, ReactiveProperty, nudge, ListenerDefinition } from '@io-gui/core'\nimport { Tab } from '../nodes/Tab.js'\nimport { ioTab, IoTab } from './IoTab.js'\n\nexport interface IoTabsHamburgerMenuExpandProps {\n  source: HTMLElement\n  direction: NudgeDirection\n  tabs: NodeArray<Tab>\n  onEditTab: (event: CustomEvent) => void\n}\n\n@Register\nclass IoTabsHamburgerMenu extends IoElement {\n  static vConstructor: (arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string) => VDOMElement\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        border: var(--io_border);\n        border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n        border-color: var(--io_borderColorOutset);\n        background-color: var(--io_bgColorLight);\n        padding: calc(var(--io_spacing) + var(--io_borderWidth));\n        position: absolute;\n        overflow-y: auto;\n        box-shadow: 1px 1px 16px var(--io_shadowColor),\n                    1px 1px 8px var(--io_shadowColor), \n                    1px 1px 4px var(--io_shadowColor);\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host > io-tab {\n        border-color: transparent !important;\n        background-color: var(--io_bgColorLight) !important;\n        border-radius: var(--io_borderRadius) !important;\n      }\n      :host > io-tab[selected] {\n        background-color: var(--io_bgColor) !important;\n      }\n      :host > io-tab > .io-tab-drop-marker {\n        border-radius: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare private expanded: boolean\n\n  declare private onEditTab: (event: CustomEvent) => void\n\n  static get Listeners() {\n    return {\n      'touchstart': ['stopPropagation', {passive: false}] as ListenerDefinition, // TODO: why?\n      'io-focus-to': 'onIoFocusTo',\n      'io-edit-tab': 'onEditTabCapture',\n    }\n  }\n\n  constructor(args: IoElementProps = {}) { super(args) }\n\n  stopPropagation(event: TouchEvent) {\n    event.stopPropagation()\n  }\n\n  onIoFocusTo(event: CustomEvent) {\n    const source = event.detail.source\n    const cmd = event.detail.command\n    const siblings = Array.from(this.querySelectorAll('io-tab')) as IoTab[]\n    const index = siblings.indexOf(source)\n\n    let cmdOverride = ''\n\n    if (cmd === 'ArrowDown') cmdOverride = 'Next'\n    if (cmd === 'ArrowUp') cmdOverride = 'Prev'\n    if (cmd === 'ArrowLeft') cmdOverride = 'First'\n    if (cmd === 'ArrowRight') cmdOverride = 'Last'\n\n    if (cmdOverride) {\n      if (cmdOverride === 'Next') {\n        siblings[(index + 1) % siblings.length].focus()\n      } else if (cmdOverride === 'Prev') {\n        siblings[(index - 1 + siblings.length) % siblings.length].focus()\n      } else if (cmdOverride === 'First') {\n        siblings[0].focus()\n      } else if (cmdOverride === 'Last') {\n        siblings[siblings.length - 1].focus()\n      }\n      event.stopPropagation()\n    }\n  }\n\n  onEditTabCapture(event: CustomEvent) {\n    event.stopPropagation()\n    this.onEditTab(event)\n    this.expanded = false\n  }\n\n  expand(props: IoTabsHamburgerMenuExpandProps) {\n    this.setProperties({\n      tabs: props.tabs,\n      expanded: true,\n    })\n    this.onEditTab = props.onEditTab\n    nudge(this, props.source, props.direction)\n    this.debounce(this.onExpand)\n  }\n  onExpand() {\n    (this.querySelector('[selected]') as HTMLElement)?.focus()\n  }\n  changed() {\n    this.render([\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n    ])\n  }\n}\n\nexport const ioTabsHamburgerMenuSingleton = new IoTabsHamburgerMenu()\nIoOverlaySingleton.appendChild(ioTabsHamburgerMenuSingleton as HTMLElement)","import { Register, NodeArray, ReactiveProperty } from '@io-gui/core'\nimport { IoField, IoFieldProps } from '@io-gui/inputs'\nimport { ioIcon } from '@io-gui/icons'\nimport { Tab } from '../nodes/Tab.js'\nimport { ioTabsHamburgerMenuSingleton } from './IoTabsHamburgerMenuSingleton.js'\n\nexport type IoTabsHamburgerProps = IoFieldProps & {\n  tabs: NodeArray<Tab>\n}\n\n@Register\nexport class IoTabsHamburger extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-shrink: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>\n\n  constructor(args: IoTabsHamburgerProps) { super(args) }\n\n  onClick() {\n    ioTabsHamburgerMenuSingleton.expand({\n      source: this,\n      direction: 'over',\n      tabs: this.tabs,\n      onEditTab: this.onEditTab,\n    })\n  }\n  onEditTab(event: CustomEvent) {\n    this.dispatch('io-edit-tab', {tab: event.detail.tab, key: event.detail.key}, true)\n  }\n  changed() {\n    this.render([\n      ioIcon({value: 'io:hamburger'})\n    ])\n  }\n}\n\nexport const ioTabsHamburger = function(arg0: IoTabsHamburgerProps) {\n  return IoTabsHamburger.vConstructor(arg0)\n}","import { Register, IoElement, IoElementProps, ReactiveProperty, NodeArray } from '@io-gui/core'\nimport { MenuOption, ioMenuItem } from '@io-gui/menus'\nimport { ioTab } from './IoTab.js'\nimport { ioTabsHamburger } from './IoTabsHamburger.js'\nimport { Tab } from '../nodes/Tab.js'\n\nexport type IoTabsProps = IoElementProps & {\n  tabs: Array<Tab>\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoTabs extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        background-color: var(--io_bgColorStrong);\n        padding-top: var(--io_spacing);\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n      }\n      :host io-tab {\n        transition: opacity 2s cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      :host:not([overflow=\"-1\"]) io-tab {\n        /* TODO: make niceer animations */\n        pointer-events: none;\n        opacity: 0;\n      }\n      :host[overflow=\"-1\"] io-tabs-hamburger {\n        /* TODO: make niceer animations */\n        display: none;\n      }\n      :host > io-tabs-hamburger {\n        margin-bottom: var(--io_spacing);\n        /* transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1); */\n      }\n      :host > io-menu-item {\n        margin-left: auto;\n        flex-shrink: 0;\n        opacity: 0.125;\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host > io-menu-item:focus,\n      :host > io-menu-item:hover {\n        opacity: 1;\n      }\n      :host > io-menu-item > .label,\n      :host > io-menu-item > .icon,\n      :host > io-menu-item > .hasmore {\n        display: none;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: Number, value: -1, reflect: true})\n  declare overflow: number\n\n  @ReactiveProperty({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  constructor(args: IoTabsProps) { super(args) }\n\n  tabsMutated() {\n    this.changed()\n    this.overflow = -1\n    this.onResized()\n  }\n\n  onResized() {\n    const lastElement = this.children[this.children.length - 1]\n    if (!lastElement) return\n\n    const rect = this.getBoundingClientRect()\n    const lastElementRect = lastElement.getBoundingClientRect()\n\n    if (this.overflow === -1) {\n      if (lastElementRect.right > rect.right) {\n        this.overflow = rect.width\n      }\n    } else if (rect.width > (this.overflow + 32)) {\n      this.overflow = -1\n    }\n  }\n\n  changed() {\n    const hasOptions = this.addMenuOption && this.addMenuOption.options?.length > 0\n    this.render([\n      ioTabsHamburger({tabs: this.tabs}),\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n      hasOptions ?ioMenuItem({\n        class: 'io-tabs-add-tab',\n        icon: 'io:box_fill_plus',\n        direction: 'down',\n        option: this.addMenuOption,\n      }) : null,\n    ])\n  }\n}\n\nexport const ioTabs = function(arg0: IoTabsProps) {\n  return IoTabs.vConstructor(arg0)\n}","import { Register, IoElement, VDOMElement, IoElementProps, ReactiveProperty, Property, Binding } from '@io-gui/core'\nimport { MenuOption } from '@io-gui/menus'\nimport { ioSplit } from './IoSplit.js'\nimport { Split } from '../nodes/Split.js'\n\nexport function sizeToFlex(size: number | 'auto'): string {\n  return size === 'auto' ? '1 1 auto' : `0 0 ${size}px`\n}\n\nexport type IoLayoutProps = IoElementProps & {\n  split: Split | Binding\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n  frozen?: boolean\n}\n\n@Register\nexport class IoLayout extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n      }\n      :host > io-split {\n        max-width: 100%;\n        max-height: 100%;\n      }\n      :host[frozen] .io-close-icon,\n      :host[frozen] .io-tabs-add-tab {\n        display: none;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare split: Split\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  @ReactiveProperty({type: Boolean, value: false, reflect: true})\n  declare frozen: boolean\n\n  changed() {\n    this.render([\n      ioSplit({\n        split: this.split,\n        style: {flex: this.split.flex},\n        elements: this.elements,\n        addMenuOption: this.addMenuOption,\n      })\n    ])\n  }\n}\n\nexport const ioLayout = function(arg0: IoLayoutProps) {\n  return IoLayout.vConstructor(arg0)\n}","import { Register, IoElement, VDOMElement, IoElementProps, ReactiveProperty, Property } from '@io-gui/core'\nimport { ioSelector } from '@io-gui/navigation'\nimport { IoMenuItem, MenuOption } from '@io-gui/menus'\nimport { ioTabs } from './IoTabs.js'\nimport { IoSplit, SplitDirection } from './IoSplit.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { Panel } from '../nodes/Panel.js'\nimport { IoLayout } from './IoLayout.js'\n\nexport type IoPanelProps = IoElementProps & {\n  panel: Panel\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoPanel extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: column;\n        flex: 1 1 auto;\n        background-color: var(--io_bgColorLight);\n      }\n      :host > io-selector {\n        margin-top: calc(-1 * var(--io_borderWidth));\n        border-top: var(--io_border);\n        border-top-color: var(--io_borderColorStrong);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare panel: Panel\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  static get Listeners() {\n    return {\n      'io-edit-tab': 'onEditTab',\n    }\n  }\n\n  onEditTab(event: CustomEvent) {\n    event.stopPropagation()\n    const tab: Tab = event.detail.tab\n    const key = event.detail.key\n    const index = this.panel.tabs.indexOf(tab)\n    if (index === -1) {\n      debug: console.warn('IoTabs:Tab not found in panel', tab)\n      return\n    }\n    switch (key) {\n      case 'Select': {\n        this.selectTab(tab)\n        break\n      }\n      case 'Backspace': {\n        this.removeTab(tab)\n        break\n      }\n      case 'ArrowLeft': {\n        this.moveTab(tab, index - 1)\n        break\n      }\n      case 'ArrowRight': {\n        this.moveTab(tab, index + 1)\n        break\n      }\n    }\n  }\n  onNewTabClicked(event: CustomEvent) {\n    event.stopPropagation()\n    const option: MenuOption = event.detail.option\n    if (option.id && option.options.length === 0) {\n      const tab = new Tab({id: option.id, label: option.label, icon: option.icon})\n      this.addTab(tab)\n      const addMenuOption = this.querySelector('.io-tabs-add-tab') as IoMenuItem\n      if (addMenuOption) addMenuOption.expanded = false\n    }\n  }\n  selectIndex(index: number) {\n    index = Math.min(index, this.panel.tabs.length - 1)\n    this.panel.setSelected(this.panel.tabs[index].id)\n    this.debounce(this.focusTabDebounced, index)\n  }\n  selectTab(tab: Tab) {\n    const index = this.panel.tabs.indexOf(tab)\n    this.panel.setSelected(tab.id)\n    this.debounce(this.focusTabDebounced, index)\n  }\n  moveTabToSplit(sourcePanel: IoPanel, tab: Tab, direction: SplitDirection) {\n    const parentSplit = this.parentElement as IoSplit\n    if (direction === 'center') {\n      sourcePanel.removeTab(tab)\n      this.addTab(tab)\n    } else {\n      parentSplit.moveTabToSplit(sourcePanel, this.panel, tab, direction)\n    }\n  }\n  addTab(tab: Tab, index?: number) {\n    const existingIndex = this.panel.tabs.findIndex(t => t.id === tab.id)\n    if (existingIndex !== -1) {\n      console.warn(`IoPanel.addTab: Duplicate tab id \"${tab.id}\", removing duplicate tab.`)\n      this.panel.tabs.splice(existingIndex, 1)\n    }\n    index = index ?? this.panel.tabs.length\n    index = Math.min(index, this.panel.tabs.length)\n    this.panel.tabs.splice(index, 0, tab)\n    this.selectIndex(index)\n  }\n  removeTab(tab: Tab) {\n    const index = this.panel.tabs.indexOf(tab)\n    this.panel.tabs.splice(index, 1)\n    if (this.panel.tabs.length > 0) {\n      const newIndex = Math.min(index, this.panel.tabs.length - 1)\n      this.selectIndex(newIndex)\n    } else {\n      const parentSplit = this.parentElement as IoSplit\n      const isRootPanel = parentSplit.parentElement instanceof IoLayout &&\n      parentSplit.split.children.length === 1\n      // If this is the last panel at root level, don't remove\n      if (!isRootPanel) {\n        this.dispatch('io-panel-remove', {panel: this.panel}, true)\n      }\n    }\n  }\n  moveTab(tab: Tab, index: number) {\n    index = Math.max(Math.min(index, this.panel.tabs.length - 1), 0)\n    const currIndex = this.panel.tabs.findIndex(t => t.id === tab.id)\n    this.panel.tabs.splice(currIndex, 1)\n    index = Math.min(index, this.panel.tabs.length)\n    this.panel.tabs.splice(index, 0, tab)\n    this.selectIndex(index)\n  }\n  focusTabDebounced(index: number) {\n    const tabs = Array.from(this.querySelectorAll('io-tab')) as HTMLElement[]\n    index = Math.min(index, tabs.length - 1)\n    if (tabs[index]) tabs[index].focus()\n  }\n  panelMutated() {\n    this.debounce(this.changed)\n  }\n  getAddMenuOption(): MenuOption | undefined {\n    if (this.addMenuOption && this.addMenuOption.options?.length > 0) {\n      return this.addMenuOption\n    }\n    if (!this.elements || this.elements.length === 0) return undefined\n\n    const existingTabIds = new Set(this.panel.tabs.map(tab => tab.id))\n    const options = this.elements\n      .filter(el => el.props?.id && !existingTabIds.has(el.props.id))\n      .map(el => new MenuOption({\n        id: el.props!.id,\n        label: el.props!.label ?? el.props!.id,\n        icon: el.props!.icon ?? '',\n      }))\n\n    if (options.length === 0) return undefined\n    return new MenuOption({options})\n  }\n  changed() {\n    this.render([\n      ioTabs({\n        tabs: this.panel.tabs,\n        addMenuOption: this.getAddMenuOption(),\n        '@io-menu-option-clicked': this.onNewTabClicked,\n      }),\n      ioSelector({\n        selected: this.panel.getSelected(),\n        elements: this.elements,\n        anchor: '',\n      })\n    ])\n  }\n}\nexport const ioPanel = function(arg0: IoPanelProps) {\n  return IoPanel.vConstructor(arg0)\n}","import { Register, ReactiveProperty, VDOMElement, IoElement, IoElementProps, Property, ThemeSingleton, div } from '@io-gui/core'\nimport { MenuOption } from '@io-gui/menus'\nimport { IoPanel, ioPanel } from './IoPanel.js'\nimport { ioDivider } from './IoDivider.js'\nimport { ioDrawer, IoDrawer } from './IoDrawer.js'\nimport { Split, SplitOrientation } from '../nodes/Split.js'\nimport { Panel } from '../nodes/Panel.js'\nimport { Tab } from '../nodes/Tab.js'\n\nexport function parseFlexBasis(flex: string): number {\n  const parts = flex.trim().split(/\\s+/)\n  const basis = parts[2] ?? 'auto'\n  if (basis === 'auto' || basis === '0') return 240\n  const match = basis.match(/^(\\d+(?:\\.\\d+)?)px$/)\n  return match ? parseInt(match[1], 10) : 240\n}\n\nexport function hasFlexGrow(flex: string): boolean {\n  const grow = parseFloat(flex.trim().split(/\\s+/)[0] ?? '0')\n  return !isNaN(grow) && grow > 0\n}\n\nexport type SplitDirection = 'none' | 'left' | 'right' | 'top' | 'bottom' | 'center'\n\nexport type IoSplitProps = IoElementProps & {\n  split: Split\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoSplit extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        display: flex;\n        overflow: hidden;\n        flex-direction: row;\n      }\n      :host[orientation='vertical'] {\n        flex-direction: column;\n      }\n      :host:not([hasvisibleflexgrow]) > .io-split-last-visible {\n        flex: 1 1 auto !important;\n      }\n      :host > .io-split-veil {\n        position: absolute;\n        opacity: 0;\n        transition: opacity 0.125s ease-out;\n        background-color: rgba(0, 0, 0, 1);\n        pointer-events: none;\n        z-index: 2;\n        inset: 0;\n      }\n      :host[showveil] > .io-split-veil {\n        display: block;\n        opacity: 0.5;\n        pointer-events: auto;\n        cursor: pointer;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare split: Split\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @ReactiveProperty({type: Object, value: null})\n  declare leadingDrawer: Split | Panel | null\n\n  @ReactiveProperty({type: Object, value: null})\n  declare trailingDrawer: Split | Panel | null\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  @ReactiveProperty({type: Boolean, value: true, reflect: true})\n  declare hasVisibleFlexGrow: boolean\n\n  @ReactiveProperty({type: Boolean, value: false, reflect: true})\n  declare showVeil: boolean\n\n  static get Listeners() {\n    return {\n      'io-divider-move': 'onDividerMove',\n      'io-divider-move-end': 'onDividerMoveEnd',\n      'io-panel-remove': 'onPanelRemove',\n      'io-split-remove': 'onSplitRemove',\n      'io-split-consolidate': 'onSplitConsolidate',\n      'io-drawer-expanded-changed': 'onDrawerExpandedChanged',\n    }\n  }\n  // TODO: Make sure one panel is available even when all tabs are removed.\n\n  constructor(args: IoSplitProps) {\n    super(args)\n  }\n\n  onResized() {\n    this.debounce(this.calculateCollapsedDrawersDebounced)\n  }\n  calculateCollapsedDrawersDebounced() {\n    this.calculateCollapsedDrawers()\n  }\n  calculateCollapsedDrawers() {\n    const rect = this.getBoundingClientRect()\n    if (rect.width === 0 && rect.height === 0) return\n\n    const split = this.split\n    const children = split.children\n    const orientation = split.orientation\n    let size: number = Infinity\n    let minSize = 0\n    const sizes: Array<number> = []\n\n    if (orientation === 'horizontal') {\n      size = rect.width\n    } else {\n      size = rect.height\n    }\n    children.forEach(child => {\n      const childMinSize = parseFlexBasis(child.flex)\n      minSize += childMinSize\n      sizes.push(childMinSize)\n    })\n\n    let collapsePriority: 'start' | 'end' = 'end'\n    const lastIndex = children.length - 1\n    const firstGrows = hasFlexGrow(children[0].flex)\n    const lastGrows = hasFlexGrow(children[lastIndex].flex)\n    const bothGrow = firstGrows && lastGrows\n    const neitherGrows = !firstGrows && !lastGrows\n    if (neitherGrows) {\n      collapsePriority = sizes[0] <= sizes[lastIndex] ? 'start' : 'end'\n    } else if (!bothGrow) {\n      collapsePriority = lastGrows ? 'start' : 'end'\n    }\n    const collapsedSize = collapsePriority === 'start' ? sizes[0] : sizes[sizes.length - 1]\n\n    if (size < minSize) {\n      if (children.length >= 3 && size < (minSize - collapsedSize)) {\n        this.setProperties({\n          leadingDrawer: children[0],\n          trailingDrawer: children[lastIndex],\n        })\n      } else if (children.length >= 2) {\n        if (collapsePriority === 'start') {\n          this.setProperties({\n            leadingDrawer: children[0],\n            trailingDrawer: null,\n          })\n        } else {\n          this.setProperties({\n            leadingDrawer: null,\n            trailingDrawer: children[lastIndex],\n          })\n        }\n      }\n\n    } else {\n      this.setProperties({\n        leadingDrawer: null,\n        trailingDrawer: null,\n      })\n    }\n  }\n\n  onDividerMove(event: CustomEvent) {\n    event.stopPropagation()\n\n    const orientation = this.split.orientation\n    const dividerSize = ThemeSingleton.spacing3\n    const minSize = ThemeSingleton.fieldHeight * 4\n\n    const leftSplit = event.detail.element.previousElementSibling as HTMLElement\n    const rightSplit = event.detail.element.nextElementSibling as HTMLElement\n    const leftRect = leftSplit.getBoundingClientRect()\n    const rightRect = rightSplit.getBoundingClientRect()\n\n    const combinedSize = orientation === 'horizontal'\n      ? leftRect.width + rightRect.width\n      : leftRect.height + rightRect.height\n\n    const pointerPos = orientation === 'horizontal'\n      ? event.detail.clientX - leftRect.left - dividerSize / 2\n      : event.detail.clientY - leftRect.top - dividerSize / 2\n\n    const leftSize = Math.max(minSize, Math.min(combinedSize - minSize, pointerPos))\n    const rightSize = combinedSize - leftSize\n\n    leftSplit.style.setProperty('flex', `0 0 ${leftSize}px`)\n    rightSplit.style.setProperty('flex', `0 0 ${rightSize}px`)\n  }\n\n  onDividerMoveEnd(event: CustomEvent) {\n    event.stopPropagation()\n    const orientation = this.split.orientation\n\n    const childrenElements = this.querySelectorAll(':scope > io-split, :scope > io-panel')\n    for (let i = 0; i < childrenElements.length; i++) {\n      const child = childrenElements[i] as IoSplit | IoPanel\n      const childmodel = child instanceof IoSplit ? child.split : child.panel\n\n      const childRect = child.getBoundingClientRect()\n      const childSize = orientation === 'horizontal' ? childRect.width : childRect.height\n\n      if (hasFlexGrow(childmodel.flex)) {\n        const [grow, shrink] = childmodel.flex.trim().split(/\\s+/)\n        childmodel.flex = `${grow} ${shrink} ${childSize}px`\n      } else {\n        childmodel.flex = `0 0 ${childSize}px`\n      }\n    }\n\n    this.ensureOneHasFlexGrow()\n    this.debounce(this.calculateCollapsedDrawersDebounced)\n  }\n\n  onPanelRemove(event: CustomEvent) {\n    event.stopPropagation()\n    for (let i = this.split.children.length; i--;) {\n      const child = this.split.children[i]\n      if (child instanceof Panel && child.tabs.length === 0) {\n        this.split.children.splice(i, 1)\n      }\n    }\n    if (this.split.children.length === 0) {\n      this.dispatch('io-split-remove', {split: this.split}, true)\n    } else if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n    this.ensureOneHasFlexGrow()\n  }\n\n  onSplitRemove(event: CustomEvent) {\n    if (event.detail.split === this.split) return\n    event.stopPropagation()\n    const index = this.split.children.indexOf(event.detail.split)\n    if (index === -1) return\n    this.split.children.splice(index, 1)\n\n    if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n    this.ensureOneHasFlexGrow()\n  }\n\n  ensureOneHasFlexGrow() {\n    const hasGrow = this.split.children.some(child => hasFlexGrow(child.flex))\n    if (!hasGrow && this.split.children.length > 0) {\n      const i = Math.min(1, this.split.children.length - 1)\n      const child = this.split.children[i]\n      const currentBasis = parseFlexBasis(child.flex)\n      child.flex = `1 1 ${currentBasis}px`\n    }\n\n    this.hasVisibleFlexGrow = this.split.children.some((child, i) => {\n      if (i === 0 && this.leadingDrawer !== null) return false\n      if (i === this.split.children.length - 1 && this.trailingDrawer !== null) return false\n      return hasFlexGrow(child.flex)\n    })\n  }\n\n  onSplitConsolidate(event: CustomEvent) {\n    if (event.detail.split === this.split) return\n    event.stopPropagation()\n    this.consolidateChild(event.detail.split)\n    // Recursive consolidation: if this split now has only 1 child, propagate up the tree\n    if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n  }\n\n  convertToSplit(panel: Panel, first: Panel, second: Panel, orientation: SplitOrientation) {\n    const index = this.split.children.indexOf(panel)\n    const newSplit = new Split({type: 'split', orientation, children: []})\n    newSplit.children.push(first, second)\n    this.split.children.splice(index, 1, newSplit)\n  }\n\n  consolidateChild(childSplit: Split) {\n    const index = this.split.children.indexOf(childSplit)\n    if (index === -1 || childSplit.children.length === 0) return\n    const soleChild = childSplit.children[0]\n    if (soleChild instanceof Panel) {\n      soleChild.flex = '1 1 auto'\n      this.split.children.splice(index, 1, soleChild)\n    } else if (soleChild instanceof Split) {\n      this.split.orientation = soleChild.orientation\n      this.split.children.splice(index, 1, ...soleChild.children)\n      this.ensureOneHasFlexGrow()\n    }\n  }\n\n  moveTabToSplit(sourcePanel: IoPanel, panel: Panel, tab: Tab, direction: SplitDirection) {\n    const index = this.split.children.indexOf(panel)\n    let orientation: SplitOrientation = 'horizontal'\n    if (direction === 'top' || direction === 'bottom') {\n      orientation = 'vertical'\n    }\n    let newIndex = ['left', 'top'].includes(direction) ? index - 1 : index + 1\n\n    if (this.split.orientation === orientation) {\n      newIndex = Math.max(0, newIndex)\n      this.split.children.splice(newIndex, 0, new Panel({type: 'panel', tabs: [tab]}))\n      sourcePanel.removeTab(tab)\n    } else {\n      if (panel.tabs.length > 1 || panel !== sourcePanel.panel) {\n        sourcePanel.removeTab(tab)\n        if (newIndex === -1) {\n          this.convertToSplit(panel, new Panel({type: 'panel', tabs: [tab]}), panel, orientation)\n        } else {\n          this.convertToSplit(panel, panel, new Panel({type: 'panel', tabs: [tab]}), orientation)\n        }\n      }\n    }\n  }\n\n  onDrawerExpandedChanged(event: CustomEvent) {\n    const srcDrawer = event.detail.element as IoDrawer\n    if (srcDrawer.expanded) {\n      const drawers = [...this.querySelectorAll(':scope > io-drawer')] as IoDrawer[]\n      drawers.forEach(drawer => drawer !== srcDrawer && (drawer.expanded = false))\n    }\n    event.stopPropagation()\n    this.updateVeil()\n  }\n\n  updateVeil() {\n    const drawers = [...this.querySelectorAll(':scope > io-drawer')] as IoDrawer[]\n    this.showVeil = drawers.some(drawer => drawer.expanded)\n  }\n\n  collapseAllDrawers() {\n    const drawers = [...this.querySelectorAll(':scope > io-drawer')] as IoDrawer[]\n    drawers.forEach(drawer => drawer.expanded = false)\n  }\n\n  leadingDrawerChanged() {\n    this.collapseAllDrawers()\n  }\n  trailingDrawerChanged() {\n    this.collapseAllDrawers()\n  }\n\n  onVeilClick(event: MouseEvent) {\n    event.stopPropagation()\n    this.collapseAllDrawers()\n  }\n\n  splitMutated() {\n    this.calculateCollapsedDrawers()\n    this.changed()\n  }\n  splitChanged() {\n    this.calculateCollapsedDrawers()\n  }\n  changed() {\n    this.setAttribute('orientation', this.split.orientation)\n    const childCount = this.split.children.length\n    const lastIndex = childCount - 1\n    const orientation = this.split.orientation\n\n    const vChildren: VDOMElement[] = []\n\n    vChildren.push(div({\n      class: 'io-split-veil',\n      '@click': this.onVeilClick,\n    }))\n\n    if (this.leadingDrawer !== null) {\n      vChildren.push(ioDrawer({\n        orientation: orientation,\n        direction: 'leading',\n        parent: this,\n        child: this.leadingDrawer,\n        elements: this.elements,\n        addMenuOption: this.addMenuOption,\n      }))\n    }\n\n    // Render visible children\n    for (let i = 0; i < childCount; i++) {\n\n      if (i === 0 && this.leadingDrawer !== null) {\n        continue\n      }\n      if (i === lastIndex && this.trailingDrawer !== null) {\n        continue\n      }\n\n      const isLastVisible = (i === lastIndex - 1 && this.trailingDrawer !== null) || (i === lastIndex && this.trailingDrawer === null)\n\n      const child = this.split.children[i]\n      if (child instanceof Split) {\n        vChildren.push(ioSplit({\n          split: child,\n          style: {flex: child.flex},\n          class: isLastVisible ? 'io-split-last-visible' : '',\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        }))\n      } else if (child instanceof Panel) {\n        vChildren.push(ioPanel({\n          panel: child,\n          style: {flex: child.flex},\n          class: isLastVisible ? 'io-split-last-visible' : '',\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        }))\n      } else debug: {\n        console.warn('IOSplit: Invalid child type', child)\n      }\n\n      if (!isLastVisible) {\n        vChildren.push(ioDivider({\n          orientation: orientation,\n        }))\n      }\n    }\n\n    if (this.trailingDrawer !== null) {\n      vChildren.push(ioDrawer({\n        orientation: orientation,\n        direction: 'trailing',\n        parent: this,\n        child: this.trailingDrawer,\n        elements: this.elements,\n        addMenuOption: this.addMenuOption,\n      }))\n    }\n\n    this.render(vChildren)\n  }\n}\nexport const ioSplit = function(arg0: IoSplitProps) {\n  return IoSplit.vConstructor(arg0)\n}\n","import { Register, ReactiveProperty, IoElement, IoElementProps, VDOMElement, div, ThemeSingleton } from '@io-gui/core'\nimport { ioIcon } from '@io-gui/icons'\nimport { MenuOption } from '@io-gui/menus'\nimport { Split } from '../nodes/Split.js'\nimport { Panel } from '../nodes/Panel.js'\nimport { IoSplit, ioSplit, parseFlexBasis } from './IoSplit.js'\nimport { ioPanel } from './IoPanel.js'\n\nexport type DrawerDirection = 'leading' | 'trailing'\n\nexport type IoDrawerProps = IoElementProps & {\n  orientation: 'horizontal' | 'vertical'\n  direction: DrawerDirection\n  parent: IoSplit\n  child: Split | Panel | null\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoDrawer extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        z-index: 2;\n        pointer-events: auto;\n        position: relative;\n      }\n      :host[orientation=\"horizontal\"] {\n        top: 0;\n        bottom: 0;\n        width: var(--io_lineHeight) !important;\n        cursor: ew-resize;\n      }\n      :host[orientation=\"vertical\"] {\n        left: 0;\n        right: 0;\n        height: var(--io_lineHeight) !important;\n        cursor: ns-resize;\n      }\n\n      :host > .io-drawer-content {\n        position: relative;\n        display: flex;\n        overflow: hidden;\n        transition: transform 0.125s ease-out;\n        justify-content: flex-end;\n      }\n      :host[orientation=\"horizontal\"] > .io-drawer-content {\n        height: 100%;\n        width: var(--io-drawer-size);\n      }\n      :host[orientation=\"vertical\"] > .io-drawer-content {\n        width: 100%;\n        height: var(--io-drawer-size);\n        flex-direction: column;\n      }\n\n      :host[orientation=\"horizontal\"][direction=\"leading\"] > .io-drawer-content {\n        transform: translateX(calc(var(--io-drawer-size) * -1 + var(--io_lineHeight)));\n        flex-direction: row;\n      }\n      :host[orientation=\"horizontal\"][direction=\"leading\"][expanded] > .io-drawer-content {\n        transform: translateX(0);\n      }\n\n      :host[orientation=\"horizontal\"][direction=\"trailing\"] > .io-drawer-content {\n        transform: translateX(0);\n        flex-direction: row-reverse;\n      }\n      :host[orientation=\"horizontal\"][direction=\"trailing\"][expanded] > .io-drawer-content {\n        transform: translateX(calc(var(--io-drawer-size) * -1 + var(--io_lineHeight)));\n      }\n\n      :host[orientation=\"vertical\"][direction=\"leading\"] > .io-drawer-content {\n        transform: translateY(calc(var(--io-drawer-size) * -1 + var(--io_lineHeight)));\n        flex-direction: column;\n      }\n      :host[orientation=\"vertical\"][direction=\"leading\"][expanded] > .io-drawer-content {\n        transform: translateY(0);\n      }\n\n      :host[orientation=\"vertical\"][direction=\"trailing\"] > .io-drawer-content {\n        transform: translateY(0);\n        flex-direction: column-reverse;\n      }\n      :host[orientation=\"vertical\"][direction=\"trailing\"][expanded] > .io-drawer-content {\n        transform: translateY(calc(var(--io-drawer-size) * -1 + var(--io_lineHeight)));\n      }\n\n      :host > .io-drawer-content > .io-drawer-handle {\n        display: flex;\n        align-items: center;\n        background-color: var(--io_bgColorLight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorStrong);\n        @apply --unselectable;\n      }\n      :host[orientation=\"horizontal\"] > .io-drawer-content > .io-drawer-handle {\n        border-top: 0;\n        border-bottom: 0;\n        flex-direction: row;\n      }\n      :host[orientation=\"vertical\"] > .io-drawer-content > .io-drawer-handle {\n        border-left: 0;\n        border-right: 0;\n        flex-direction: column;\n      }\n\n      :host > .io-drawer-content > io-panel,\n      :host > .io-drawer-content > io-split {\n        flex: 0 0 auto;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: String, value: 'horizontal', reflect: true})\n  declare orientation: 'horizontal' | 'vertical'\n\n  @ReactiveProperty({type: String, value: 'leading', reflect: true})\n  declare direction: DrawerDirection\n\n  @ReactiveProperty({type: Boolean, value: false, reflect: true})\n  declare expanded: boolean\n\n  @ReactiveProperty({type: Object})\n  declare parent: IoSplit\n\n  @ReactiveProperty({type: Object})\n  declare child: Split | Panel\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @ReactiveProperty({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  constructor(args: IoDrawerProps) {\n    super(args)\n  }\n\n  onClick(event: MouseEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    this.expanded = !this.expanded\n  }\n\n  expandedChanged() {\n    this.dispatch('io-drawer-expanded-changed', {element:this}, true)\n  }\n\n  childMutated() {\n    this.changed()\n  }\n\n  changed() {\n    let availableSize = Infinity\n    const parent = this.parent as IoSplit\n    if (parent) {\n      const parentRect = parent.getBoundingClientRect()\n      availableSize = this.orientation === 'horizontal' ? parentRect.width : parentRect.height\n    }\n\n    const drawerSize = Math.min(parseFlexBasis(this.child.flex), availableSize - ThemeSingleton.lineHeight * 2)\n    const contentSize = drawerSize + ThemeSingleton.lineHeight\n    const style = this.orientation === 'horizontal' ? {width: `${drawerSize}px`} : {height: `${drawerSize}px`} as Record<string, string>\n\n    let childVDOM: VDOMElement | null = null\n\n    if (this.child) {\n      if (this.child instanceof Split) {\n        childVDOM = ioSplit({\n          split: this.child,\n          style: style,\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        })\n      } else if (this.child instanceof Panel) {\n        childVDOM = ioPanel({\n          panel: this.child,\n          style: style,\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        })\n      }\n    }\n\n    const icon = {\n      horizontal: {\n        leading: this.expanded ? 'io:triangle_left' : 'io:triangle_right',\n        trailing: this.expanded ? 'io:triangle_right' : 'io:triangle_left',\n      },\n      vertical: {\n        leading: this.expanded ? 'io:triangle_up' : 'io:triangle_down',\n        trailing: this.expanded ? 'io:triangle_down' : 'io:triangle_up',\n      }\n    }[this.orientation][this.direction]\n\n    this.render([\n      div({class: 'io-drawer-content', style: {'--io-drawer-size': `${contentSize}px`}}, [\n        childVDOM,\n        div({class: 'io-drawer-handle', '@click': this.onClick}, [\n          ioIcon({value: icon, size: 'small'})\n        ]),\n      ])\n    ])\n  }\n}\n\nexport const ioDrawer = function(args: IoDrawerProps) {\n  return IoDrawer.vConstructor(args)\n}\n"],"names":["IoDivider","IoElement","Style","Listeners","pointerdown","touchstart","passive","constructor","args","super","onPointerdown","event","preventDefault","stopPropagation","this","addEventListener","onPointermove","onPointerup","onPointercancel","setPointerCapture","pointerId","pressed","dispatch","clientX","clientY","element","removeEventListener","releasePointerCapture","onTouchstart","onTouchmove","onTouchend","__decorateClass","ReactiveProperty","value","type","Boolean","reflect","prototype","String","Register","ioDivider","arg0","vConstructor","Tab","ReactiveNode","id","console","error","label","toJSON","json","icon","selected","fromJSON","setProperties","deduplicateTabs","tabs","context","seenIds","Set","uniqueTabs","tab","has","warn","add","push","Panel","length","find","map","tabsMutated","debounce","onTabsMutatedDebounced","dispatchMutation","getSelected","i","item","setSelected","withInternalOperation","flexChanged","test","flex","dispose","NodeArray","init","createChild","child","Split","consolidateChildren","children","orientation","result","resultOrientation","soleChild","consolidated","childrenMutated","onChildrenMutatedDebounced","IoTabDropRect","changed","dropTarget","dropIndex","querySelectorAll","style","width","height","rect","getBoundingClientRect","top","ThemeSingleton","borderRadius","left","spacing","splitDirection","Number","ioTabDropRectSingleton","document","body","appendChild","IoTabDragIcon","IoField","_startX","_startY","setStartPosition","x","y","updateDrag","sourcePanel","root","dragging","dx","Math","abs","dy","dropSource","detectDropTargets","m","tabsContainers","tabsContainer","targetPanel","parentElement","tcr","bottom","right","j","tr","isLast","panels","pr","direction","calculateSplitDirection","rx","ry","endDrag","source","target","index","removeTab","addTab","moveTabToSplit","cancelDrag","render","ioIcon","span","class","tabDragIconSingleton","icons","set","Object","keys","IconsetDB","iconOptions","ioOptionSelect","selectBy","option","MenuOption","options","IoTab","click","contextmenu","onResized","querySelector","overflow","scrollWidth","clientWidth","onContextMenu","expandContextEditor","buttons","focus","panel","closest","onClick","onPointerleave","key","onDeleteClick","IoContextEditorSingleton","expand","properties","config","ioString","live","widget","ioButton","action","expanded","onKeydown","shiftKey","includes","tabMutated","setAttribute","ioTab","IoTabsHamburgerMenu","onIoFocusTo","detail","cmd","command","siblings","Array","from","indexOf","cmdOverride","onEditTabCapture","onEditTab","props","nudge","onExpand","ioTabsHamburgerMenuSingleton","IoOverlaySingleton","IoTabsHamburger","ioTabsHamburger","IoTabs","lastElement","lastElementRect","hasOptions","addMenuOption","ioMenuItem","ioTabs","sizeToFlex","size","IoLayout","ioSplit","split","elements","Property","ioLayout","IoPanel","selectTab","moveTab","onNewTabClicked","selectIndex","min","focusTabDebounced","parentSplit","existingIndex","findIndex","t","splice","newIndex","max","currIndex","panelMutated","getAddMenuOption","existingTabIds","filter","el","ioSelector","anchor","ioPanel","parseFlexBasis","basis","trim","match","parseInt","hasFlexGrow","grow","parseFloat","isNaN","IoSplit","calculateCollapsedDrawersDebounced","calculateCollapsedDrawers","Infinity","minSize","sizes","forEach","childMinSize","collapsePriority","lastIndex","firstGrows","lastGrows","bothGrow","collapsedSize","leadingDrawer","trailingDrawer","onDividerMove","dividerSize","spacing3","fieldHeight","leftSplit","previousElementSibling","rightSplit","nextElementSibling","leftRect","rightRect","combinedSize","pointerPos","leftSize","rightSize","setProperty","onDividerMoveEnd","childrenElements","childmodel","childRect","childSize","shrink","ensureOneHasFlexGrow","onPanelRemove","onSplitRemove","some","currentBasis","hasVisibleFlexGrow","onSplitConsolidate","consolidateChild","convertToSplit","first","second","newSplit","childSplit","onDrawerExpandedChanged","srcDrawer","drawer","updateVeil","drawers","showVeil","collapseAllDrawers","leadingDrawerChanged","trailingDrawerChanged","onVeilClick","splitMutated","splitChanged","childCount","vChildren","div","ioDrawer","parent","isLastVisible","IoDrawer","expandedChanged","childMutated","availableSize","parentRect","drawerSize","lineHeight","contentSize","childVDOM","horizontal","leading","trailing","vertical"],"mappings":"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"}