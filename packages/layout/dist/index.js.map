{"version":3,"file":"index.js","sources":["../src/elements/IoDivider.ts","../src/nodes/Tab.ts","../src/elements/IoTabDropMarker.ts","../src/elements/IoTabDragIcon.ts","../src/elements/IoTab.ts","../src/elements/IoTabsHamburgerMenuSingleton.ts","../src/elements/IoTabsHamburger.ts","../src/elements/IoTabs.ts","../src/elements/IoPanel.ts","../src/nodes/Panel.ts","../src/nodes/Split.ts","../src/elements/IoSplit.ts","../src/elements/IoLayout.ts"],"sourcesContent":["import { Register, ReactiveProperty, IoElement, IoElementProps, Property, ListenerDefinition } from '@io-gui/core'\n\nexport type IoDividerProps = IoElementProps & {\n  orientation: 'vertical' | 'horizontal'\n  index: number\n}\n\n@Register\nexport class IoDivider extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        flex: 0 0 var(--io_spacing3);\n        background-color: var(--io_colorLight);\n        border-style: solid;\n        border-width: 0 var(--io_borderWidth);\n        border-color: var(--io_color);\n        cursor: col-resize;\n        @apply --unselectable;\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorBlue);\n        background-color: var(--io_bgColorBlue);\n      }\n      :host[pressed]:before,\n      :host[pressed]:after {\n        background-color: var(--io_colorWhite);\n      }\n      :host:before,\n      :host:after {\n        content: '';\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        z-index: 1;\n        opacity: 0;\n      }\n      :host:before {\n        width: var(--io_fieldHeight);\n        height: var(--io_spacing);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(90deg);\n        border-radius: var(--io_spacing);\n        opacity: 0.5;\n      }\n      :host[orientation='vertical']:before {\n        transform: translate(-50%, -50%);\n      }\n      :host:after {\n        width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: var(--io_color);\n        transform: translate(-50%, -50%) rotate(45deg);\n        border-radius: 25%;\n      }\n      :host[orientation='vertical'] {\n        cursor: row-resize;\n        border-width: var(--io_borderWidth) 0;\n      }\n      :host:hover {\n        border-style: dashed;\n      }\n      :host:hover:before {\n        opacity: 1;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: false, type: Boolean, reflect: true})\n  declare pressed: boolean\n\n  @ReactiveProperty({value: 'horizontal', type: String, reflect: true})\n  declare orientation: 'horizontal' | 'vertical'\n\n  @Property(Number)\n  declare index: number\n\n  static get Listeners() {\n    return {\n      'pointerdown': 'onPointerdown',\n      'touchstart': ['onTouchstart', {passive: false}] as ListenerDefinition,\n    }\n  }\n\n  constructor(args: IoDividerProps) { super(args) }\n\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    this.addEventListener('pointermove', this.onPointermove)\n    this.addEventListener('pointerup', this.onPointerup)\n    this.addEventListener('pointercancel', this.onPointercancel)\n    this.setPointerCapture(event.pointerId)\n    this.pressed = true\n  }\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    this.dispatch('io-divider-move', {\n      index: this.index,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    }, true)\n  }\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n    this.removeEventListener('pointercancel', this.onPointercancel)\n    this.releasePointerCapture(event.pointerId)\n    this.pressed = false\n    this.dispatch('io-divider-move-end', {\n      index: this.index,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    }, true)\n  }\n  onPointercancel(event: PointerEvent) {\n    event.preventDefault()\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n    this.removeEventListener('pointercancel', this.onPointercancel)\n    this.pressed = false\n  }\n  onTouchstart(event: TouchEvent) {\n    this.addEventListener('touchmove', this.onTouchmove, {passive: false})\n    this.addEventListener('touchend', this.onTouchend)\n  }\n  onTouchmove(event: TouchEvent) {\n    event.preventDefault()\n  }\n  onTouchend() {\n    this.removeEventListener('touchmove', this.onTouchmove)\n    this.removeEventListener('touchend', this.onTouchend)\n  }\n}\nexport const ioDivider = function(arg0: IoDividerProps) {\n  return IoDivider.vConstructor(arg0)\n}\n","import { Node, ReactiveProperty, Register } from '@io-gui/core'\n\nexport type TabProps = {\n  id: string\n  label?: string\n  icon?: string\n  selected?: boolean\n}\n\n@Register\nexport class Tab extends Node {\n\n  @ReactiveProperty({type: String, value: ''})\n  declare id: string\n\n  @ReactiveProperty({type: String, value: ''})\n  declare label: string\n\n  @ReactiveProperty({type: String, value: ''})\n  declare icon: string\n\n  @ReactiveProperty({type: Boolean, value: false})\n  declare selected: boolean\n\n  constructor(args: TabProps) {\n    debug: {\n      if (!args.id) {\n        console.error('Tab: construction error - empty id')\n      }\n    }\n    super({\n      ...args,\n      label: args.label ? args.label : args.id,\n    })\n  }\n  toJSON(): TabProps {\n    const json: TabProps = { id: this.id }\n    if (this.label !== this.id) json.label = this.label\n    if (this.icon) json.icon = this.icon\n    if (this.selected) json.selected = this.selected\n    return json\n  }\n  fromJSON(json: TabProps) {\n    this.setProperties({\n      id: json.id,\n      label: json.label ? json.label : json.id,\n      icon: json.icon ? json.icon : '',\n      selected: json.selected ? json.selected : false,\n    })\n    return this\n  }\n}","import { Register, ReactiveProperty, IoElement, IoElementProps, ThemeSingleton } from '@io-gui/core'\nimport { SplitDirection } from './IoSplit.js'\nimport { IoPanel } from './IoPanel.js'\nimport { IoTab } from './IoTab.js'\n\n@Register\nclass IoTabDropMarker extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: fixed;\n        height: calc(var(--io_fieldHeight) - var(--io_borderWidth) - var(--io_borderRadius));\n        width: var(--io_spacing);\n        background-color: var(--io_bgColorBlue);\n        margin-bottom: var(--io_borderWidth);\n        z-index: 100000;\n        display: none;\n      }\n      :host:not([dropindex=\"-1\"]) {\n        display: block;\n      }\n      :host:not([splitdirection=\"none\"]) {\n        display: block;\n        opacity: 0.25;\n      }\n    `\n  }\n\n  @ReactiveProperty(null)\n  declare dropTarget: IoPanel | null\n\n  @ReactiveProperty({type: String, value: 'none', reflect: true})\n  declare splitDirection: SplitDirection\n\n  @ReactiveProperty({type: Number, value: -1, reflect: true})\n  declare dropIndex: number\n\n  constructor(args: IoElementProps = {}) { super(args) }\n\n  changed() {\n    if (this.dropTarget && this.dropIndex !== -1) {\n      const tabs = this.dropTarget.querySelectorAll('io-tab')\n      this.style.width = ''\n      this.style.height = ''\n      if (tabs.length === 0) {\n        const rect = this.dropTarget.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left}px`\n      } else if (this.dropIndex > tabs.length - 1) {\n        const tab = tabs[tabs.length - 1] as IoTab\n        const rect = tab.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left + rect.width}px`\n      } else {\n        const tab = tabs[this.dropIndex] as IoTab\n        const rect = tab.getBoundingClientRect()\n        this.style.top = `${rect.top + ThemeSingleton.borderRadius}px`\n        this.style.left = `${rect.left - ThemeSingleton.spacing}px`\n      }\n    } else if (this.dropTarget && this.splitDirection !== 'none') {\n      const rect = this.dropTarget.getBoundingClientRect()\n      if (this.splitDirection === 'top') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height / 2}px`\n      } else if (this.splitDirection === 'bottom') {\n        this.style.top = `${rect.top + rect.height / 2}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height / 2}px`\n      } else if (this.splitDirection === 'left') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width / 2}px`\n        this.style.height = `${rect.height}px`\n      } else if (this.splitDirection === 'right') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left + rect.width / 2}px`\n        this.style.width = `${rect.width / 2}px`\n        this.style.height = `${rect.height}px`\n      } else if (this.splitDirection === 'center') {\n        this.style.top = `${rect.top}px`\n        this.style.left = `${rect.left}px`\n        this.style.width = `${rect.width}px`\n        this.style.height = `${rect.height}px`\n      }\n    }\n  }\n}\n\nexport const ioTabDropMarkerSingleton = new IoTabDropMarker()\ndocument.body.appendChild(ioTabDropMarkerSingleton as HTMLElement)\n","import { Register, ReactiveProperty, span, ThemeSingleton } from '@io-gui/core'\nimport { IoField, IoFieldProps } from '@io-gui/inputs'\nimport { ioIcon } from '@io-gui/icons'\nimport { ioTabDropMarkerSingleton } from './IoTabDropMarker.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { SplitDirection } from './IoSplit.js'\nimport { IoPanel } from './IoPanel.js'\nimport { IoLayout } from './IoLayout.js'\nimport { IoTabs } from './IoTabs.js'\n\nconst DRAG_THRESHOLD = 10\n\n@Register\nclass IoTabDragIcon extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        transform: translate(-50%, -50%);\n        z-index: 100000;\n        pointer-events: none;\n        border-color: var(--io_borderColorLight);\n        background-color: var(--io_bgColorLight) !important;\n        opacity: 0.75;\n      }\n      :host[dragging] {\n        display: flex;\n      }\n      :host > * {\n        display: inline-block;\n        white-space: nowrap;\n        padding: 0 var(--io_spacing);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare dragging: boolean\n\n  @ReactiveProperty()\n  declare tab: Tab | null\n\n  @ReactiveProperty()\n  declare dropSource: IoPanel | null\n\n  @ReactiveProperty()\n  declare dropTarget: IoPanel | null\n\n  @ReactiveProperty({type: String, value: 'none', reflect: true})\n  declare splitDirection: SplitDirection\n\n  @ReactiveProperty({type: Number, value: -1})\n  declare dropIndex: number\n\n  private _startX: number = 0\n  private _startY: number = 0\n\n  constructor(args: IoFieldProps = {}) { super(args) }\n\n  setStartPosition(x: number, y: number) {\n    this._startX = x\n    this._startY = y\n  }\n\n  updateDrag(tab: Tab, sourcePanel: IoPanel, x: number, y: number, root: IoLayout | null) {\n    if (!this.dragging) {\n      const dx = Math.abs(this._startX - x)\n      const dy = Math.abs(this._startY - y)\n      if (dx > DRAG_THRESHOLD || dy > DRAG_THRESHOLD) {\n        this.setProperties({\n          tab: tab,\n          dragging: true,\n          dropSource: sourcePanel,\n          dropTarget: null,\n          dropIndex: -1,\n        })\n        this.style.top = y + 'px'\n        this.style.left = x + 'px'\n      }\n      return\n    }\n\n    this.style.top = y + 'px'\n    this.style.left = x + 'px'\n\n    if (!root) {\n      console.error('IoTabDragIcon: No io-layout found!')\n      return\n    }\n\n    this.detectDropTargets(x, y, root)\n  }\n\n  private detectDropTargets(x: number, y: number, root: IoLayout) {\n    const m = ThemeSingleton.spacing\n\n    // Check tab bars first (higher priority)\n    const tabsContainers = root.querySelectorAll('io-tabs')\n    for (let i = 0; i < tabsContainers.length; i++) {\n      const tabsContainer = tabsContainers[i] as IoTabs\n      const targetPanel = tabsContainer.parentElement as IoPanel\n      const tcr = tabsContainer.getBoundingClientRect()\n\n      if (y >= tcr.top && y <= tcr.bottom && x >= tcr.left && x <= tcr.right) {\n        const tabs = tabsContainer.querySelectorAll('io-tab')\n        if (tabs.length === 0) {\n          this.setProperties({\n            dropTarget: targetPanel,\n            splitDirection: 'none',\n            dropIndex: 0,\n          })\n          return\n        }\n\n        for (let j = 0; j < tabs.length; j++) {\n          const tab = tabs[j]\n          const tr = tab.getBoundingClientRect()\n          const isLast = j === tabs.length - 1\n\n          if (y >= tr.top - m && y <= tr.bottom + m && x >= tr.left - m && (x <= tr.right + m || isLast && x <= tcr.right)) {\n            const side = x < tr.left + tr.width / 2 ? 'left' : 'right'\n            const dropIndex = side === 'left' ? j : j + 1\n            this.setProperties({\n              dropTarget: targetPanel,\n              splitDirection: 'none',\n              dropIndex: dropIndex,\n            })\n            return\n          }\n        }\n      }\n    }\n\n    const panels = root.querySelectorAll('io-panel')\n    for (let i = 0; i < panels.length; i++) {\n      const targetPanel = panels[i] as IoPanel\n      const pr = targetPanel.getBoundingClientRect()\n\n      if (y >= pr.top && y <= pr.bottom && x >= pr.left && x <= pr.right) {\n        const direction = this.calculateSplitDirection(x, y, pr)\n        this.setProperties({\n          dropTarget: targetPanel,\n          splitDirection: direction,\n          dropIndex: -1,\n        })\n        return\n      }\n    }\n  }\n\n  private calculateSplitDirection(x: number, y: number, rect: DOMRect): SplitDirection {\n    const rx = (x - rect.left - rect.width / 2) / rect.width * 2\n    const ry = (y - rect.top - rect.height / 2) / rect.height * 2\n\n    if (Math.abs(rx) < 0.5 && Math.abs(ry) < 0.5) return 'center'\n    if (Math.abs(ry) > Math.abs(rx)) return ry > 0 ? 'bottom' : 'top'\n    return rx > 0 ? 'right' : 'left'\n  }\n\n  endDrag() {\n    const source = this.dropSource\n    const target = this.dropTarget\n    const index = this.dropIndex\n    const direction = this.splitDirection\n    const tab = this.tab\n\n    if (tab && target && index !== -1) {\n      if (source && source !== target) {\n        source.removeTab(tab)\n      }\n      target.addTab(tab, index)\n    } else if (tab && source && target && direction !== 'none') {\n      target.moveTabToSplit(source, tab, direction)\n    }\n\n    this.cancelDrag()\n  }\n\n  cancelDrag() {\n    this.setProperties({\n      dragging: false,\n      tab: null,\n      dropSource: null,\n      dropTarget: null,\n      splitDirection: 'none',\n      dropIndex: -1,\n    })\n  }\n\n  changed() {\n    ioTabDropMarkerSingleton.setProperties({\n      dropTarget: this.dropTarget,\n      splitDirection: this.splitDirection,\n      dropIndex: this.dropIndex,\n    })\n    this.render([\n      ioIcon({value: this.tab?.icon || ' '}),\n      span({class: 'label'}, this.tab?.label || ''),\n    ])\n  }\n}\n\nexport const tabDragIconSingleton = new IoTabDragIcon()\ndocument.body.appendChild(tabDragIconSingleton as HTMLElement)\n","import { Register, ReactiveProperty, span } from '@io-gui/core'\nimport { IoField, IoFieldProps, ioField, ioString } from '@io-gui/inputs'\nimport { IoContextEditorSingleton } from '@io-gui/editors'\nimport { IconsetDB, ioIcon } from '@io-gui/icons'\nimport { MenuOptionProps, MenuOption, ioOptionSelect } from '@io-gui/menus'\nimport { IoPanel } from './IoPanel.js'\nimport { IoLayout } from './IoLayout.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { tabDragIconSingleton } from './IoTabDragIcon.js'\n\nconst icons: MenuOptionProps[] = []\nfor (const set of Object.keys(IconsetDB)) {\n  for (const icon of Object.keys(IconsetDB[set])) {\n    const id = `${set}:${icon}`\n    icons.push({value: id, id: icon, icon: id})\n  }\n}\n\nconst iconOptions = ioOptionSelect({selectBy: 'value', label: 'Icon', option: new MenuOption({options: icons})})\n\nexport type IoTabProps = IoFieldProps & {\n  tab: Tab\n}\n\n// TODO: fix and improve keyboard navigation in all cases.\n@Register\nexport class IoTab extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        position: relative;\n        height: inherit;\n        min-height: inherit;\n        /* TODO: use vars for this */\n        min-width: calc(var(--io_fieldHeight) * 1.25);\n        margin: 0;\n        margin-right: var(--io_spacing);\n        background-color: var(--io_bgColor) !important;\n        border-bottom-left-radius: 0;\n        border-bottom-right-radius: 0;\n        border-color: var(--io_borderColorLight);\n        padding-right: calc(var(--io_lineHeight) / 2);\n        padding-left: calc(var(--io_lineHeight) / 2);\n      }\n      :host[pressed] {\n        border-color: unset !important;\n        box-shadow: unset !important;\n      }\n      :host[selected] {\n        color: var(--io_colorStrong);\n        background-color: var(--io_bgColorLight) !important;\n        border-color: var(--io_borderColorStrong);\n        border-bottom-color: var(--io_bgColorLight);\n        z-index: 1;\n      }\n      :host[overflow]:not([selected]) > .io-close-icon {\n        display: none;\n      }\n      :host[selected]:focus {\n        color: var(--io_colorWhite);\n        z-index: 2;\n      }\n      :host > .io-icon:not([value=' ']) {\n        margin: 0 var(--io_spacing2) 0 0;\n      }\n      :host > .io-tab-drop-marker {\n        position: absolute;\n        top: 0;\n        left: 0;\n        height: 100%;\n        background-color: var(--io_bgColorBlue);\n        border-bottom-right-radius: var(--io_borderRadius);\n      }\n      :host > span {\n        padding: 0 var(--io_spacing);\n        overflow: hidden; \n        text-overflow: ellipsis !important;\n      }\n      :host > * {\n        pointer-events: none;\n        display: inline-block;\n        white-space: nowrap;\n      }\n      :host:not(:hover) > .io-close-icon {\n        opacity: 0;\n        transform: scale(0.2);\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host:hover > .io-close-icon {\n        opacity: 1;\n        transform: scale(0.4);\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host > .io-close-icon {\n        position: absolute;\n        right: var(--io_spacing);\n        top: var(--io_spacing);\n        pointer-events: inherit;\n        background: linear-gradient(to right, transparent 0%, var(--io_bgColor) 25%);\n      }\n      :host[selected] > .io-close-icon {\n        background: linear-gradient(to right, transparent 0%, var(--io_bgColorLight) 25%);\n      }\n      :host > .io-close-icon:hover {\n        transform: scale(0.5);\n        fill: var(--io_colorStrong);\n        stroke: var(--io_colorStrong);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Tab})\n  declare tab: Tab\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare overflow: boolean\n\n  static get Listeners() {\n    return {\n      'click': 'preventDefault',\n      'contextmenu': 'preventDefault',\n    }\n  }\n\n  constructor(args: IoTabProps) { super(args) }\n\n  onResized() {\n    const span = this.querySelector('span')!\n    this.overflow = span.scrollWidth > span.clientWidth\n  }\n  onTouchmove(event: TouchEvent) {\n    event.preventDefault()\n  }\n  preventDefault(event: Event) {\n    event.stopPropagation()\n    event.preventDefault()\n  }\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    this.setPointerCapture(event.pointerId)\n    tabDragIconSingleton.setStartPosition(event.clientX, event.clientY)\n    super.onPointerdown(event)\n    if (event.buttons === 2) {\n      this.expandContextEditor()\n    } else {\n      this.focus()\n    }\n  }\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    if (event.buttons !== 1) return\n    const panel = this.parentElement!.parentElement as IoPanel\n    const root = this.closest('io-layout') as IoLayout\n    tabDragIconSingleton.updateDrag(this.tab, panel, event.clientX, event.clientY, root)\n  }\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    super.onPointerup(event)\n    this.releasePointerCapture(event.pointerId)\n    if (tabDragIconSingleton.dragging) {\n      tabDragIconSingleton.endDrag()\n    } else {\n      this.onClick()\n    }\n  }\n  onPointercancel(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n    super.onPointercancel(event)\n    tabDragIconSingleton.cancelDrag()\n  }\n  onPointerleave(event: PointerEvent) {\n    event.preventDefault()\n    event.stopPropagation()\n  }\n  onClick() {\n    this.dispatch('io-edit-tab', {tab: this.tab, key: 'Select'}, true)\n  }\n  onDeleteClick() {\n    this.dispatch('io-edit-tab', {tab: this.tab, key: 'Backspace'}, true)\n  }\n  expandContextEditor() {\n    IoContextEditorSingleton.expand({\n      source: this,\n      direction: 'down',\n      value: this.tab,\n      properties: ['id', 'label', 'icon'],\n      orientation: 'horizontal',\n      config: [\n        ['id', ioField({inert: true})],\n        ['label', ioString({live: true})],\n        ['icon', iconOptions],\n      ],\n    })\n  }\n  onKeydown(event: KeyboardEvent) {\n    if (event.shiftKey && ['Backspace', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'Home', 'End'].includes(event.key)) {\n      event.preventDefault()\n      this.dispatch('io-edit-tab', {tab: this.tab, key: event.key}, true)\n    } else if (event.shiftKey && event.key === 'Enter') {\n      this.expandContextEditor()\n    } else {\n      super.onKeydown(event)\n    }\n  }\n  tabMutated() {\n    this.changed()\n  }\n  changed() {\n    this.setAttribute('selected', this.tab.selected)\n    this.setAttribute('title', this.tab.label)\n    this.render([\n      this.tab.selected ? span({class: 'io-tab-drop-marker'}) : null,\n      this.tab.icon ? ioIcon({value: this.tab.icon}) : null,\n      span({class: 'io-tab-label'}, this.tab.label),\n      ioIcon({value: 'io:close', size: 'small', class: 'io-close-icon', '@click': this.onDeleteClick, '@pointerdown': this.preventDefault}),\n    ])\n  }\n}\n\nexport const ioTab = function(arg0: IoTabProps) {\n  return IoTab.vConstructor(arg0)\n}\n","import { IoOverlaySingleton, NudgeDirection, NodeArray, VDOMElement, IoElement, IoElementProps, Register, ReactiveProperty, nudge, ListenerDefinition } from '@io-gui/core'\nimport { Tab } from '../nodes/Tab.js'\nimport { ioTab, IoTab } from './IoTab.js'\n\nexport interface IoTabsHamburgerMenuExpandProps {\n  source: HTMLElement\n  direction: NudgeDirection\n  tabs: NodeArray<Tab>\n  onEditTab: (event: CustomEvent) => void\n}\n\n@Register\nclass IoTabsHamburgerMenu extends IoElement {\n  static vConstructor: (arg0?: IoElementProps | Array<VDOMElement | null> | string, arg1?: Array<VDOMElement | null> | string) => VDOMElement\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        border: var(--io_border);\n        border-radius: calc(var(--io_borderRadius) + var(--io_spacing2));\n        border-color: var(--io_borderColorOutset);\n        background-color: var(--io_bgColorLight);\n        padding: calc(var(--io_spacing) + var(--io_borderWidth));\n        position: absolute;\n        overflow-y: auto;\n        box-shadow: 1px 1px 16px var(--io_shadowColor),\n                    1px 1px 8px var(--io_shadowColor), \n                    1px 1px 4px var(--io_shadowColor);\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n        opacity: 0;\n      }\n      :host > io-tab {\n        border-color: transparent !important;\n        background-color: var(--io_bgColorLight) !important;\n        border-radius: var(--io_borderRadius) !important;\n      }\n      :host > io-tab[selected] {\n        background-color: var(--io_bgColor) !important;\n      }\n      :host > io-tab > .io-tab-drop-marker {\n        border-radius: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: Boolean, reflect: true})\n  declare private expanded: boolean\n\n  declare private onEditTab: (event: CustomEvent) => void\n\n  static get Listeners() {\n    return {\n      'touchstart': ['stopPropagation', {passive: false}] as ListenerDefinition, // TODO: why?\n      'io-focus-to': 'onIoFocusTo',\n      'io-edit-tab': 'onEditTabCapture',\n    }\n  }\n\n  constructor(args: IoElementProps = {}) { super(args) }\n\n  stopPropagation(event: TouchEvent) {\n    event.stopPropagation()\n  }\n\n  onIoFocusTo(event: CustomEvent) {\n    const source = event.detail.source\n    const cmd = event.detail.command\n    const siblings = Array.from(this.querySelectorAll('io-tab')) as IoTab[]\n    const index = siblings.indexOf(source)\n\n    let cmdOverride = ''\n\n    if (cmd === 'ArrowDown') cmdOverride = 'Next'\n    if (cmd === 'ArrowUp') cmdOverride = 'Prev'\n    if (cmd === 'ArrowLeft') cmdOverride = 'First'\n    if (cmd === 'ArrowRight') cmdOverride = 'Last'\n\n    if (cmdOverride) {\n      if (cmdOverride === 'Next') {\n        siblings[(index + 1) % siblings.length].focus()\n      } else if (cmdOverride === 'Prev') {\n        siblings[(index - 1 + siblings.length) % siblings.length].focus()\n      } else if (cmdOverride === 'First') {\n        siblings[0].focus()\n      } else if (cmdOverride === 'Last') {\n        siblings[siblings.length - 1].focus()\n      }\n      event.stopPropagation()\n    }\n  }\n\n  onEditTabCapture(event: CustomEvent) {\n    event.stopPropagation()\n    this.onEditTab(event)\n    this.expanded = false\n  }\n\n  expand(props: IoTabsHamburgerMenuExpandProps) {\n    this.setProperties({\n      tabs: props.tabs,\n      expanded: true,\n    })\n    this.onEditTab = props.onEditTab\n    nudge(this, props.source, props.direction)\n    this.debounce(this.onExpand)\n  }\n  onExpand() {\n    (this.querySelector('[selected]') as HTMLElement)?.focus()\n  }\n  changed() {\n    this.render([\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n    ])\n  }\n}\n\nexport const ioTabsHamburgerMenuSingleton = new IoTabsHamburgerMenu()\nIoOverlaySingleton.appendChild(ioTabsHamburgerMenuSingleton as HTMLElement)","import { Register, NodeArray, ReactiveProperty } from '@io-gui/core'\nimport { IoField, IoFieldProps } from '@io-gui/inputs'\nimport { ioIcon } from '@io-gui/icons'\nimport { Tab } from '../nodes/Tab.js'\nimport { ioTabsHamburgerMenuSingleton } from './IoTabsHamburgerMenuSingleton.js'\n\nexport type IoTabsHamburgerProps = IoFieldProps & {\n  tabs: NodeArray<Tab>\n}\n\n@Register\nexport class IoTabsHamburger extends IoField {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-shrink: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare private tabs: NodeArray<Tab>\n\n  constructor(args: IoTabsHamburgerProps) { super(args) }\n\n  onClick() {\n    ioTabsHamburgerMenuSingleton.expand({\n      source: this,\n      direction: 'over',\n      tabs: this.tabs,\n      onEditTab: this.onEditTab,\n    })\n  }\n  onEditTab(event: CustomEvent) {\n    this.dispatch('io-edit-tab', {tab: event.detail.tab, key: event.detail.key}, true)\n  }\n  changed() {\n    this.render([\n      ioIcon({value: 'io:hamburger'})\n    ])\n  }\n}\n\nexport const ioTabsHamburger = function(arg0: IoTabsHamburgerProps) {\n  return IoTabsHamburger.vConstructor(arg0)\n}","import { Register, IoElement, IoElementProps, ReactiveProperty, NodeArray } from '@io-gui/core'\nimport { MenuOption, ioMenuItem } from '@io-gui/menus'\nimport { ioTab } from './IoTab.js'\nimport { ioTabsHamburger } from './IoTabsHamburger.js'\nimport { Tab } from '../nodes/Tab.js'\n\nexport type IoTabsProps = IoElementProps & {\n  tabs: Array<Tab>\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoTabs extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        background-color: var(--io_bgColorStrong);\n        padding-top: var(--io_spacing);\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n      }\n      :host io-tab {\n        transition: opacity 2s cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      :host:not([overflow=\"-1\"]) io-tab {\n        /* TODO: make niceer animations */\n        pointer-events: none;\n        opacity: 0;\n      }\n      :host[overflow=\"-1\"] io-tabs-hamburger {\n        /* TODO: make niceer animations */\n        display: none;\n      }\n      :host > io-tabs-hamburger {\n        margin-bottom: var(--io_spacing);\n        /* transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1); */\n      }\n      :host > io-menu-item {\n        margin-left: auto;\n        flex-shrink: 0;\n        opacity: 0.125;\n        transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity linear 0.2s;\n      }\n      :host > io-menu-item:focus,\n      :host > io-menu-item:hover {\n        opacity: 1;\n      }\n      :host > io-menu-item > .label,\n      :host > io-menu-item > .icon,\n      :host > io-menu-item > .hasmore {\n        display: none;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: Number, value: -1, reflect: true})\n  declare overflow: number\n\n  @ReactiveProperty({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  constructor(args: IoTabsProps) { super(args) }\n\n  tabsMutated() {\n    this.changed()\n    this.overflow = -1\n    this.onResized()\n  }\n\n  onResized() {\n    const lastElement = this.children[this.children.length - 1]\n    if (!lastElement) return\n\n    const rect = this.getBoundingClientRect()\n    const lastElementRect = lastElement.getBoundingClientRect()\n\n    if (this.overflow === -1) {\n      if (lastElementRect.right > rect.right) {\n        this.overflow = rect.width\n      }\n    } else if (rect.width > (this.overflow + 32)) {\n      this.overflow = -1\n    }\n  }\n\n  changed() {\n    const hasOptions = this.addMenuOption && this.addMenuOption.options?.length > 0\n    this.render([\n      ioTabsHamburger({tabs: this.tabs}),\n      ...this.tabs.map(tab => ioTab({tab: tab})),\n      hasOptions ?ioMenuItem({\n        class: 'add-tab',\n        icon: 'io:box_fill_plus',\n        direction: 'down',\n        option: this.addMenuOption,\n      }) : null,\n    ])\n  }\n}\n\nexport const ioTabs = function(arg0: IoTabsProps) {\n  return IoTabs.vConstructor(arg0)\n}","import { Register, IoElement, VDOMElement, IoElementProps, ReactiveProperty, Property } from '@io-gui/core'\nimport { ioSelector } from '@io-gui/navigation'\nimport { IoMenuItem, MenuOption } from '@io-gui/menus'\nimport { ioTabs } from './IoTabs.js'\nimport { IoSplit, SplitDirection } from './IoSplit.js'\nimport { Tab } from '../nodes/Tab.js'\nimport { Panel } from '../nodes/Panel.js'\nimport { IoLayout } from './IoLayout.js'\n\nexport type IoPanelProps = IoElementProps & {\n  panel: Panel\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoPanel extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: column;\n        flex: 1 1 auto;\n        background-color: var(--io_bgColorLight);\n      }\n      :host > io-selector {\n        margin-top: calc(-1 * var(--io_borderWidth));\n        border-top: var(--io_border);\n        border-top-color: var(--io_borderColorStrong);\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare panel: Panel\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  static get Listeners() {\n    return {\n      'io-edit-tab': 'onEditTab',\n    }\n  }\n\n  onEditTab(event: CustomEvent) {\n    event.stopPropagation()\n    const tab: Tab = event.detail.tab\n    const key = event.detail.key\n    const index = this.panel.tabs.indexOf(tab)\n    if (index === -1) {\n      debug: console.warn('IoTabs:Tab not found in panel', tab)\n      return\n    }\n    switch (key) {\n      case 'Select': {\n        this.selectTab(tab)\n        break\n      }\n      case 'Backspace': {\n        this.removeTab(tab)\n        break\n      }\n      case 'ArrowLeft': {\n        this.moveTab(tab, index - 1)\n        break\n      }\n      case 'ArrowRight': {\n        this.moveTab(tab, index + 1)\n        break\n      }\n    }\n  }\n  onNewTabClicked(event: CustomEvent) {\n    event.stopPropagation()\n    const option: MenuOption = event.detail.option\n    if (option.id && option.options.length === 0) {\n      const tab = new Tab({id: option.id, label: option.label, icon: option.icon})\n      this.addTab(tab)\n      const addMenuOption = this.querySelector('.add-tab') as IoMenuItem\n      if (addMenuOption) addMenuOption.expanded = false\n    }\n  }\n  selectIndex(index: number) {\n    index = Math.min(index, this.panel.tabs.length - 1)\n    this.panel.setSelected(this.panel.tabs[index].id)\n    this.debounce(this.focusTabDebounced, index)\n  }\n  selectTab(tab: Tab) {\n    const index = this.panel.tabs.indexOf(tab)\n    this.panel.setSelected(tab.id)\n    this.debounce(this.focusTabDebounced, index)\n  }\n  moveTabToSplit(sourcePanel: IoPanel, tab: Tab, direction: SplitDirection) {\n    const parentSplit = this.parentElement as IoSplit\n    if (direction === 'center') {\n      sourcePanel.removeTab(tab)\n      this.addTab(tab)\n    } else {\n      parentSplit.moveTabToSplit(sourcePanel, this.panel, tab, direction)\n    }\n  }\n  addTab(tab: Tab, index?: number) {\n    const existingIndex = this.panel.tabs.findIndex(t => t.id === tab.id)\n    if (existingIndex !== -1) {\n      console.warn(`IoPanel.addTab: Duplicate tab id \"${tab.id}\", removing duplicate tab.`)\n      this.panel.tabs.splice(existingIndex, 1)\n    }\n    index = index ?? this.panel.tabs.length\n    index = Math.min(index, this.panel.tabs.length)\n    this.panel.tabs.splice(index, 0, tab)\n    this.selectIndex(index)\n  }\n  removeTab(tab: Tab) {\n    const index = this.panel.tabs.indexOf(tab)\n    this.panel.tabs.splice(index, 1)\n    if (this.panel.tabs.length > 0) {\n      const newIndex = Math.min(index, this.panel.tabs.length - 1)\n      this.selectIndex(newIndex)\n    } else {\n      const parentSplit = this.parentElement as IoSplit\n      const isRootPanel = parentSplit.parentElement instanceof IoLayout &&\n      parentSplit.split.children.length === 1\n      // If this is the last panel at root level, don't remove\n      if (!isRootPanel) {\n        this.dispatch('io-panel-remove', {panel: this.panel}, true)\n      }\n    }\n  }\n  moveTab(tab: Tab, index: number) {\n    index = Math.max(Math.min(index, this.panel.tabs.length - 1), 0)\n    const currIndex = this.panel.tabs.findIndex(t => t.id === tab.id)\n    this.panel.tabs.splice(currIndex, 1)\n    index = Math.min(index, this.panel.tabs.length)\n    this.panel.tabs.splice(index, 0, tab)\n    this.selectIndex(index)\n  }\n  focusTabDebounced(index: number) {\n    const tabs = Array.from(this.querySelectorAll('io-tab')) as HTMLElement[]\n    index = Math.min(index, tabs.length - 1)\n    if (tabs[index]) tabs[index].focus()\n  }\n  panelMutated() {\n    this.debounce(this.changed)\n  }\n  getAddMenuOption(): MenuOption | undefined {\n    if (this.addMenuOption && this.addMenuOption.options?.length > 0) {\n      return this.addMenuOption\n    }\n    if (!this.elements || this.elements.length === 0) return undefined\n\n    const existingTabIds = new Set(this.panel.tabs.map(tab => tab.id))\n    const options = this.elements\n      .filter(el => el.props?.id && !existingTabIds.has(el.props.id))\n      .map(el => new MenuOption({\n        id: el.props!.id,\n        label: el.props!.label ?? el.props!.id,\n        icon: el.props!.icon ?? '',\n      }))\n\n    if (options.length === 0) return undefined\n    return new MenuOption({options})\n  }\n  changed() {\n    this.render([\n      ioTabs({\n        tabs: this.panel.tabs,\n        addMenuOption: this.getAddMenuOption(),\n        '@io-menu-option-clicked': this.onNewTabClicked,\n      }),\n      ioSelector({\n        selected: this.panel.getSelected(),\n        elements: this.elements,\n        anchor: '',\n      })\n    ])\n  }\n}\nexport const ioPanel = function(arg0: IoPanelProps) {\n  return IoPanel.vConstructor(arg0)\n}","import { Node, NodeArray, ReactiveProperty, Register } from '@io-gui/core'\nimport { Tab, TabProps } from './Tab.js'\n\nexport type PanelProps = {\n  type: 'panel'\n  tabs: Array<TabProps>\n  flex?: string\n}\n\nfunction deduplicateTabs<T extends TabProps>(tabs: Array<T>, context: string): Array<T> {\n  const seenIds = new Set<string>()\n  const uniqueTabs: Array<T> = []\n  for (const tab of tabs) {\n    if (seenIds.has(tab.id)) {\n      console.warn(`${context}: Duplicate tab id \"${tab.id}\" - keeping first occurrence`)\n    } else {\n      seenIds.add(tab.id)\n      uniqueTabs.push(tab)\n    }\n  }\n  return uniqueTabs\n}\n\n@Register\nexport class Panel extends Node {\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare tabs: NodeArray<Tab>\n\n  @ReactiveProperty({type: String, value: '1 1 100%'})\n  declare flex: string\n\n  constructor(args: PanelProps) {\n    debug: {\n      if (args.type !== 'panel') {\n        console.error(`Panel: Invalid type \"${args.type}\". Expected \"panel\".`)\n      }\n    }\n    args = { ...args }\n    args.tabs = deduplicateTabs(args.tabs, 'Panel')\n\n    if (args.tabs.length > 0 && !args.tabs.find(tab => tab.selected)) {\n      args.tabs[0].selected = true\n    }\n    args.tabs = args.tabs.map(tab => new Tab({...tab}))\n    super(args)\n  }\n  tabsMutated() {\n    this.debounce(this.onTabsMutatedDebounced)\n  }\n  onTabsMutatedDebounced() {\n    this.dispatchMutation()\n  }\n  getSelected() {\n    let selected = ''\n    for (let i = 0; i < this.tabs.length; i++) {\n      const item = this.tabs[i]\n      if (item.selected && item.id) {\n        selected = item.id\n        break\n      }\n    }\n    return selected\n  }\n  setSelected(id: string) {\n    // TODO Test and reconsider withInternalOperation\n    this.tabs.withInternalOperation(() => {\n      for (let i = 0; i < this.tabs.length; i++) {\n        const item = this.tabs[i]\n        if (item.id === id) {\n          item.selected = true\n        } else {\n          item.selected = false\n        }\n      }\n    })\n    this.tabs.dispatchMutation()\n  }\n  toJSON(): PanelProps {\n    return {\n      type: 'panel',\n      tabs: this.tabs.map(tab => tab.toJSON()),\n      flex: this.flex,\n    }\n  }\n  fromJSON(json: PanelProps) {\n    debug: {\n      if (json.type !== 'panel') {\n        console.error(`Panel.fromJSON: Invalid type \"${json.type}\". Expected \"panel\".`)\n      }\n    }\n    const uniqueTabs = deduplicateTabs(json.tabs, 'Panel.fromJSON')\n    this.setProperties({\n      tabs: uniqueTabs.map(tab => new Tab(tab)),\n      flex: json.flex ?? '1 1 100%',\n    })\n    return this\n  }\n  dispose() {\n    this.tabs.length = 0\n    super.dispose()\n  }\n}","import { Node, NodeArray, ReactiveProperty, Register } from '@io-gui/core'\nimport { Panel, PanelProps } from './Panel.js'\n\nexport type SplitOrientation = 'horizontal' | 'vertical'\n\nexport type SplitProps = {\n  type: 'split'\n  children: Array<SplitProps | PanelProps>\n  orientation?: SplitOrientation\n  flex?: string\n}\n\nfunction createChild(child: SplitProps | PanelProps): Split | Panel {\n  return child.type === 'panel' ? new Panel(child) : new Split(child)\n}\n\nfunction consolidateChildren(\n  children: Array<Split | Panel>,\n  orientation: SplitOrientation\n): { children: Array<Split | Panel>; orientation: SplitOrientation } {\n  let result = children\n  let resultOrientation = orientation\n  while (result.length === 1 && result[0] instanceof Split) {\n    const soleChild = result[0]\n    resultOrientation = soleChild.orientation\n    result = [...soleChild.children]\n  }\n  return { children: result, orientation: resultOrientation }\n}\n\n@Register\nexport class Split extends Node {\n\n  @ReactiveProperty({type: NodeArray, init: 'this'})\n  declare children: NodeArray<Split | Panel>\n\n  @ReactiveProperty({type: String, value: 'horizontal'})\n  declare orientation: SplitOrientation\n\n  @ReactiveProperty({type: String, value: '1 1 100%'})\n  declare flex: string\n\n  constructor(args: SplitProps) {\n    debug: {\n      if (args.type !== 'split') {\n        console.error(`Split: Invalid type \"${args.type}\". Expected \"split\".`)\n      }\n    }\n\n    const processedChildren = args.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, args.orientation ?? 'horizontal')\n\n    super({\n      ...args,\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n    })\n  }\n  childrenMutated() {\n    this.debounce(this.onChildrenMutatedDebounced)\n  }\n  onChildrenMutatedDebounced() {\n    this.dispatchMutation()\n  }\n  toJSON(): SplitProps {\n    const json: SplitProps = {\n      type: 'split',\n      children: this.children.map((child: Split | Panel) => child.toJSON()),\n    }\n    if (this.orientation !== 'horizontal') json.orientation = this.orientation\n    if (this.flex !== '1 1 100%') json.flex = this.flex\n    return json\n  }\n  fromJSON(json: SplitProps) {\n    debug: {\n      if (json.type !== 'split') {\n        console.error(`Split.fromJSON: Invalid type \"${json.type}\". Expected \"split\".`)\n      }\n    }\n    const processedChildren = json.children.map(createChild)\n    const consolidated = consolidateChildren(processedChildren, json.orientation ?? 'horizontal')\n\n    this.setProperties({\n      children: consolidated.children,\n      orientation: consolidated.orientation,\n      flex: json.flex ?? '1 1 100%',\n    })\n    return this\n  }\n  dispose() {\n    this.children.length = 0\n    super.dispose()\n  }\n}","import { Register, ReactiveProperty, VDOMElement, IoElement, IoElementProps, Property, ThemeSingleton } from '@io-gui/core'\nimport { MenuOption } from '@io-gui/menus'\nimport { IoPanel, ioPanel } from './IoPanel.js'\nimport { ioDivider } from './IoDivider.js'\nimport { Split, SplitOrientation } from '../nodes/Split.js'\nimport { Panel } from '../nodes/Panel.js'\nimport { Tab } from '../nodes/Tab.js'\n\nexport type SplitDirection = 'none' | 'left' | 'right' | 'top' | 'bottom' | 'center'\n\ninterface SplitMeasurements {\n  splits: HTMLElement[]\n  splitSizes: number[]\n  splitResize: number[]\n}\n\ninterface SpaceDistribution {\n  fixedSpaceBefore: number\n  fixedSpaceAfter: number\n  flexSpace: number\n  flexCountBefore: number\n  flexCountAfter: number\n}\n\nexport type IoSplitProps = IoElementProps & {\n  split: Split\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoSplit extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        overflow: hidden;\n        flex-direction: row;\n      }\n      :host[orientation='vertical'] {\n        flex-direction: column;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare split: Split\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  static get Listeners() {\n    return {\n      'io-divider-move': 'onDividerMove',\n      'io-divider-move-end': 'onDividerMoveEnd',\n      'io-panel-remove': 'onPanelRemove',\n      'io-split-remove': 'onSplitRemove',\n      'io-split-consolidate': 'onSplitConsolidate',\n    }\n  }\n  // TODO: Make sure one panel is available even when all tabs are removed.\n\n  constructor(args: IoSplitProps) {\n    super(args)\n  }\n\n  onDividerMove(event: CustomEvent) {\n    event.stopPropagation()\n    const index = event.detail.index\n    const rect = this.getBoundingClientRect()\n    const orientation = this.split.orientation\n\n    const dividerSize = ThemeSingleton.spacing3\n    const totalSpace = (orientation === 'horizontal' ? rect.width : rect.height) - dividerSize * (this.children.length - 1) / 2\n    const minSize = orientation === 'horizontal' ? ThemeSingleton.fieldHeight * 4 : ThemeSingleton.fieldHeight\n\n    const measurements = this.collectSplitMeasurements(orientation, rect, dividerSize, event.detail)\n    const distribution = this.calculateSpaceDistribution(measurements, index)\n\n    this.applyResizeSizes(measurements, distribution, index, totalSpace, minSize)\n  }\n\n  collectSplitMeasurements(\n    orientation: SplitOrientation,\n    rect: DOMRect,\n    dividerSize: number,\n    pointer: {clientX: number; clientY: number}\n  ): SplitMeasurements {\n    const splits: HTMLElement[] = []\n    const splitSizes: number[] = []\n    const splitResize: number[] = []\n\n    for (let i = 0; i < this.children.length; i += 2) {\n      const splitElement = this.children[i] as HTMLElement\n      const splitRect = splitElement.getBoundingClientRect()\n      const splitSize = orientation === 'horizontal' ? splitRect.width : splitRect.height\n\n      let x = pointer.clientX - splitRect.left - dividerSize / 2\n      let y = pointer.clientY - splitRect.top - dividerSize / 2\n      if (i === this.children.length - 1) {\n        x = rect.width - (pointer.clientX - rect.left) - dividerSize / 2\n        y = rect.height - (pointer.clientY - rect.top) - dividerSize / 2\n      }\n      const size = orientation === 'horizontal' ? x : y\n\n      splits.push(splitElement)\n      splitSizes.push(splitSize)\n      splitResize.push(size)\n    }\n\n    return {splits, splitSizes, splitResize}\n  }\n\n  calculateSpaceDistribution(measurements: SplitMeasurements, index: number): SpaceDistribution {\n    const {splits, splitSizes} = measurements\n\n    let fixedSpaceBefore = 0\n    let fixedSpaceAfter = 0\n    let flexSpace = 0\n    let flexCountBefore = 0\n    let flexCountAfter = 0\n\n    for (let i = 0; i < splits.length; i++) {\n      let idx = index\n      if (idx === splits.length - 2) {\n        idx = splits.length - 1\n      }\n      if (splits[i].style.flex.endsWith('%')) {\n        flexSpace += splitSizes[i]\n        if (i < idx) {\n          flexCountBefore++\n        } else if (i > idx) {\n          flexCountAfter++\n        }\n      } else {\n        if (i < idx) {\n          fixedSpaceBefore += splitSizes[i]\n        } else if (i > idx) {\n          fixedSpaceAfter += splitSizes[i]\n        }\n      }\n    }\n\n    return {fixedSpaceBefore, fixedSpaceAfter, flexSpace, flexCountBefore, flexCountAfter}\n  }\n\n  applyResizeSizes(\n    measurements: SplitMeasurements,\n    distribution: SpaceDistribution,\n    index: number,\n    totalSpace: number,\n    minSize: number\n  ) {\n    const {splits, splitSizes, splitResize} = measurements\n    const {fixedSpaceBefore, fixedSpaceAfter, flexSpace, flexCountBefore, flexCountAfter} = distribution\n\n    if (index === 0) {\n      const maxSize = totalSpace - minSize * flexCountAfter - fixedSpaceAfter\n      const size = Math.max(minSize, Math.min(maxSize, splitResize[0]))\n      splits[index].style.flex = `0 0 ${size}px`\n      for (let i = 0; i < splits.length; i++) {\n        if (splits[i].style.flex.endsWith('%') && i !== index) {\n          splits[i].style.flex = `1 1 ${Math.max(minSize, splitSizes[i]) / flexSpace * 100}%`\n        }\n      }\n\n    } else if (index === splits.length - 2) {\n      const maxSize = totalSpace - minSize * flexCountBefore - fixedSpaceBefore\n      const size = Math.max(minSize, Math.min(maxSize, splitResize[index + 1]))\n      splits[index + 1].style.flex = `0 0 ${size}px`\n      for (let i = 0; i < splits.length; i++) {\n        if (splits[i].style.flex.endsWith('%') && i !== index + 1) {\n          splits[i].style.flex = `1 1 ${Math.max(minSize, splitSizes[i]) / flexSpace * 100}%`\n        }\n      }\n\n    } else {\n      const maxSize = splitSizes[index] + splitSizes[index + 1] - minSize\n      const size = Math.max(minSize, Math.min(maxSize, splitResize[index]))\n      const sizeNext = splitSizes[index + 1] - (size - splitSizes[index])\n      for (let i = 0; i < splits.length; i++) {\n        if (splits[i].style.flex.endsWith('%')) {\n          if (i === index) {\n            splits[i].style.flex = `1 1 ${size / flexSpace * 100}%`\n          } else if (i === index + 1) {\n            splits[i].style.flex = `1 1 ${sizeNext / flexSpace * 100}%`\n          } else {\n            splits[i].style.flex = `1 1 ${Math.max(minSize, splitSizes[i]) / flexSpace * 100}%`\n          }\n        }\n      }\n    }\n  }\n\n  onDividerMoveEnd(event: CustomEvent) {\n    event.stopPropagation()\n    let index = 0\n    for (let i = 0; i < this.children.length; i += 2) {\n      const splitElement = this.children[i] as HTMLElement\n      this.split.children[index].flex = splitElement.style.flex\n      index++\n    }\n  }\n\n  onPanelRemove(event: CustomEvent) {\n    event.stopPropagation()\n    for (let i = this.split.children.length; i--;) {\n      const child = this.split.children[i]\n      if (child instanceof Panel && child.tabs.length === 0) {\n        this.split.children.splice(i, 1)\n      }\n    }\n    if (this.split.children.length === 0) {\n      this.dispatch('io-split-remove', {split: this.split}, true)\n    } else if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n    this.ensureFlexGrow()\n  }\n\n  onSplitRemove(event: CustomEvent) {\n    if (event.detail.split === this.split) return\n    event.stopPropagation()\n    const index = this.split.children.indexOf(event.detail.split)\n    if (index === -1) return\n    this.split.children.splice(index, 1)\n\n    if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n    this.ensureFlexGrow()\n  }\n\n  ensureFlexGrow() {\n    const hasFlexGrow = this.split.children.some(child => child.flex.startsWith('1'))\n    if (!hasFlexGrow && this.split.children.length > 0) {\n      this.split.children[0].flex = '1 1 auto'\n    }\n  }\n\n  onSplitConsolidate(event: CustomEvent) {\n    if (event.detail.split === this.split) return\n    event.stopPropagation()\n    this.consolidateChild(event.detail.split)\n    // Recursive consolidation: if this split now has only 1 child, propagate up the tree\n    if (this.split.children.length === 1) {\n      this.dispatch('io-split-consolidate', {split: this.split}, true)\n    }\n  }\n\n  convertToSplit(panel: Panel, first: Panel, second: Panel, orientation: SplitOrientation) {\n    const index = this.split.children.indexOf(panel)\n    const newSplit = new Split({type: 'split', orientation, children: []})\n    newSplit.children.push(first, second)\n    this.split.children.splice(index, 1, newSplit)\n  }\n\n  consolidateChild(childSplit: Split) {\n    const index = this.split.children.indexOf(childSplit)\n    if (index === -1 || childSplit.children.length === 0) return\n    const soleChild = childSplit.children[0]\n    if (soleChild instanceof Panel) {\n      soleChild.flex = '1 1 100%'\n      this.split.children.splice(index, 1, soleChild)\n    } else if (soleChild instanceof Split) {\n      this.split.orientation = soleChild.orientation\n      this.split.children.splice(index, 1, ...soleChild.children)\n    }\n  }\n\n  moveTabToSplit(sourcePanel: IoPanel, panel: Panel, tab: Tab, direction: SplitDirection) {\n    const index = this.split.children.indexOf(panel)\n    let orientation: SplitOrientation = 'horizontal'\n    if (direction === 'top' || direction === 'bottom') {\n      orientation = 'vertical'\n    }\n    let newIndex = ['left', 'top'].includes(direction) ? index - 1 : index + 1\n\n    if (this.split.orientation === orientation) {\n      newIndex = Math.max(0, newIndex)\n      this.split.children.splice(newIndex, 0, new Panel({type: 'panel', tabs: [tab]}))\n      sourcePanel.removeTab(tab)\n    } else {\n      if (panel.tabs.length > 1 || panel !== sourcePanel.panel) {\n        sourcePanel.removeTab(tab)\n        if (newIndex === -1) {\n          this.convertToSplit(panel, new Panel({type: 'panel', tabs: [tab]}), panel, orientation)\n        } else {\n          this.convertToSplit(panel, panel, new Panel({type: 'panel', tabs: [tab]}), orientation)\n        }\n      }\n    }\n  }\n  splitMutated() {\n    this.debounce(this.changed)\n  }\n  changed() {\n    this.setAttribute('orientation', this.split.orientation)\n    this.style.flex = this.split.flex\n    // TODO: Validate split\n    const vChildren: VDOMElement[] = []\n    for (let i = 0; i < this.split.children.length; i++) {\n      const child = this.split.children[i]\n      if (child instanceof Split) {\n        vChildren.push(ioSplit({\n          split: child,\n          style: {flex: child.flex},\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        }))\n      } else if (child instanceof Panel) {\n        vChildren.push(ioPanel({\n          panel: child,\n          style: {flex: child.flex},\n          elements: this.elements,\n          addMenuOption: this.addMenuOption,\n        }))\n      } else debug: {\n        console.warn('IOSplit: Invalid child type', child)\n      }\n      if (i < this.split.children.length - 1) {\n        vChildren.push(ioDivider({orientation: this.split.orientation, index: i}))\n      }\n    }\n    this.render(vChildren)\n  }\n}\nexport const ioSplit = function(arg0: IoSplitProps) {\n  return IoSplit.vConstructor(arg0)\n}\n","import { Register, IoElement, VDOMElement, IoElementProps, ReactiveProperty, Property, Binding } from '@io-gui/core'\nimport { MenuOption } from '@io-gui/menus'\nimport { ioSplit } from './IoSplit.js'\nimport { Split } from '../nodes/Split.js'\n\nexport type IoLayoutProps = IoElementProps & {\n  split: Split | Binding\n  elements: VDOMElement[]\n  addMenuOption?: MenuOption\n}\n\n@Register\nexport class IoLayout extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        position: relative;\n        display: flex;\n        flex: 1 1 100%;\n        max-width: 100%;\n        max-height: 100%;\n      }\n      :host > io-split {\n        max-width: 100%;\n        max-height: 100%;\n      }\n    `\n  }\n\n  @ReactiveProperty({type: Object})\n  declare split: Split\n\n  @ReactiveProperty(Array)\n  declare elements: VDOMElement[]\n\n  @Property({type: MenuOption})\n  declare addMenuOption: MenuOption | undefined\n\n  changed() {\n    this.render([\n      ioSplit({\n        split: this.split,\n        elements: this.elements,\n        addMenuOption: this.addMenuOption,\n      })\n    ])\n  }\n}\n\nexport const ioLayout = function(arg0: IoLayoutProps) {\n  return IoLayout.vConstructor(arg0)\n}"],"names":["IoDivider","IoElement","Style","Listeners","pointerdown","touchstart","passive","constructor","args","super","onPointerdown","event","preventDefault","stopPropagation","this","addEventListener","onPointermove","onPointerup","onPointercancel","setPointerCapture","pointerId","pressed","dispatch","index","clientX","clientY","removeEventListener","releasePointerCapture","onTouchstart","onTouchmove","onTouchend","__decorateClass","ReactiveProperty","value","type","Boolean","reflect","prototype","String","Property","Number","Register","ioDivider","arg0","vConstructor","Tab","Node","id","console","error","label","toJSON","json","icon","selected","fromJSON","setProperties","IoTabDropMarker","changed","dropTarget","dropIndex","tabs","querySelectorAll","style","width","height","length","rect","getBoundingClientRect","top","ThemeSingleton","borderRadius","left","spacing","splitDirection","ioTabDropMarkerSingleton","document","body","appendChild","IoTabDragIcon","IoField","_startX","_startY","setStartPosition","x","y","updateDrag","tab","sourcePanel","root","dragging","dx","Math","abs","dy","dropSource","detectDropTargets","m","tabsContainers","i","tabsContainer","targetPanel","parentElement","tcr","bottom","right","j","tr","isLast","panels","pr","direction","calculateSplitDirection","rx","ry","endDrag","source","target","removeTab","addTab","moveTabToSplit","cancelDrag","render","ioIcon","span","class","tabDragIconSingleton","icons","set","Object","keys","IconsetDB","push","iconOptions","ioOptionSelect","selectBy","option","MenuOption","options","IoTab","click","contextmenu","onResized","querySelector","overflow","scrollWidth","clientWidth","buttons","expandContextEditor","focus","panel","closest","onClick","onPointerleave","key","onDeleteClick","IoContextEditorSingleton","expand","properties","orientation","config","ioField","inert","ioString","live","onKeydown","shiftKey","includes","tabMutated","setAttribute","size","ioTab","IoTabsHamburgerMenu","onIoFocusTo","detail","cmd","command","siblings","Array","from","indexOf","cmdOverride","onEditTabCapture","onEditTab","expanded","props","nudge","debounce","onExpand","map","NodeArray","init","ioTabsHamburgerMenuSingleton","IoOverlaySingleton","IoTabsHamburger","ioTabsHamburger","IoTabs","tabsMutated","lastElement","children","lastElementRect","hasOptions","addMenuOption","ioMenuItem","ioTabs","IoPanel","selectTab","moveTab","warn","onNewTabClicked","selectIndex","min","setSelected","focusTabDebounced","parentSplit","existingIndex","findIndex","t","splice","newIndex","IoLayout","split","max","currIndex","panelMutated","getAddMenuOption","elements","existingTabIds","Set","filter","el","has","ioSelector","getSelected","anchor","ioPanel","deduplicateTabs","context","seenIds","uniqueTabs","add","Panel","find","onTabsMutatedDebounced","dispatchMutation","item","withInternalOperation","flex","dispose","createChild","child","Split","consolidateChildren","result","resultOrientation","soleChild","consolidated","childrenMutated","onChildrenMutatedDebounced","IoSplit","onDividerMove","dividerSize","spacing3","totalSpace","minSize","fieldHeight","measurements","collectSplitMeasurements","distribution","calculateSpaceDistribution","applyResizeSizes","pointer","splits","splitSizes","splitResize","splitElement","splitRect","splitSize","fixedSpaceBefore","fixedSpaceAfter","flexSpace","flexCountBefore","flexCountAfter","idx","endsWith","maxSize","sizeNext","onDividerMoveEnd","onPanelRemove","ensureFlexGrow","onSplitRemove","some","startsWith","onSplitConsolidate","consolidateChild","convertToSplit","first","second","newSplit","childSplit","splitMutated","vChildren","ioSplit","ioLayout"],"mappings":"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"}