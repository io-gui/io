{"version":3,"file":"Queue.test.js","sourceRoot":"","sources":["../../src/core/Queue.test.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,SAAS,CAAC;AAE9D,MAAM,CAAC,OAAO;IACZ,GAAG;QACD,QAAQ,CAAC,OAAO,EAAE,GAAG,EAAE;YACrB,EAAE,CAAC,iEAAiE,EAAE,KAAK,IAAI,EAAE;gBAC/E,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;gBACxE,IAAI,GAAG,GAAG,EAAE,CAAC;gBACb,MAAM,IAAI,GAAG,CAAC,CAAS,EAAE,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACzC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBACxB,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;gBACzB,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;gBAC5B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAClC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBACxB,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;gBACzB,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;gBACvB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,8EAA8E,EAAE,KAAK,IAAI,EAAE;gBAC5F,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;gBACvE,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;gBACzC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;gBACzC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;gBACzC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;gBACzC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;gBACpE,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;gBACxE,IAAI,GAAG,GAAG,EAAE,CAAC;gBACb,MAAM,IAAI,GAAG,CAAC,CAAS,EAAE,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACzC,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBACxB,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;gBACzB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAClC,MAAM,SAAS,EAAE,CAAC;gBAClB,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBACxB,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;gBACzB,QAAQ,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;gBACvB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAClC,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,8FAA8F,EAAE,KAAK,IAAI,EAAE;gBAC5G,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACf,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;gBACvE,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;gBACzC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;gBAC1D,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,MAAM,IAAI,GAAG,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;gBAChC,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;gBACxB,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;gBAChC,IAAI,CAAC,OAAO,EAAE,CAAC;gBACf,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;gBAChC,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;gBAChC,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC7B,MAAM,SAAS,EAAE,CAAC;gBAClB,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;CACF","sourcesContent":["import { throttle, debounce, nextQueue, Node } from 'io-core';\n\nexport default class {\n  run() {\n    describe('Queue', () => {\n      it('Should exectute twice throttled function once in the next frame', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        throttle(func);\n        throttle(func);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should exectute throttled function with correct argument', async () => {\n        let arg = '';\n        const func = (a: string) => { arg = a; };\n        throttle(func, 'first');\n        throttle(func, 'second');\n        expect(arg).to.be.equal('');\n        await nextQueue();\n        expect(arg).to.be.equal('second');\n        throttle(func, 'third');\n        throttle(func, 'fourth');\n        throttle(func, 'sixt');\n        await nextQueue();\n        expect(arg).to.be.equal('sixt');\n      });\n      it('Should execute throttled function in the next frame if called multiple times', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        throttle(func);\n        throttle(func);\n        throttle(func);\n        throttle(func);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should execute throttled function after specified delay', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        throttle(func, undefined, undefined, 10);\n        throttle(func, undefined, undefined, 10);\n        throttle(func, undefined, undefined, 10);\n        throttle(func, undefined, undefined, 10);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        expect(count).to.be.equal(1);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should exectute debounced function in the next frame', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        debounce(func);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should exectute debounced function with correct argument', async () => {\n        let arg = '';\n        const func = (a: string) => { arg = a; };\n        debounce(func, 'first');\n        debounce(func, 'second');\n        await nextQueue();\n        expect(arg).to.be.equal('second');\n        await nextQueue();\n        debounce(func, 'third');\n        debounce(func, 'fourth');\n        debounce(func, 'sixt');\n        await nextQueue();\n        expect(arg).to.be.equal('sixt');\n      });\n      it('Should postpone debounced function execution if called multiple times before specified delay', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        debounce(func, undefined, undefined, 2);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        debounce(func, undefined, undefined, 2);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        debounce(func);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should execute debounced function after specified delay', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        debounce(func, undefined, undefined, 10);\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        await nextQueue();\n        expect(count).to.be.equal(1);\n      });\n      it('Should abort execution if node is disposed', async () => {\n        let count = 0;\n        const func = () => { count++; };\n        const node = new Node();\n        debounce(func, undefined, node);\n        node.dispose();\n        await nextQueue();\n        expect(count).to.be.equal(0);\n        throttle(func, undefined, node);\n        throttle(func, undefined, node);\n        await nextQueue();\n        expect(count).to.be.equal(0);\n        await nextQueue();\n        expect(count).to.be.equal(0);\n      });\n    });\n  }\n}\n"]}