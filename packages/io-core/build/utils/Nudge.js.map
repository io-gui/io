{"version":3,"file":"Nudge.js","sourceRoot":"","sources":["../../src/utils/Nudge.ts"],"names":[],"mappings":"AAWA,MAAM,QAAQ,GAAG;IACf,IAAI,KAAK;QACP,OAAO,MAAM,CAAC,cAAc;YAC1B,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,KAAK,GAAG,MAAM,CAAC,cAAc,CAAC,KAAK;YAC3D,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC;IAC3C,CAAC;IACD,IAAI,MAAM;QACR,OAAO,MAAM,CAAC,cAAc;YAC1B,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,GAAG,MAAM,CAAC,cAAc,CAAC,KAAK;YAC5D,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,YAAY,CAAC;IAC5C,CAAC;IACD,IAAI,UAAU;QACZ,OAAO,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;IACtE,CAAC;IACD,IAAI,SAAS;QACX,OAAO,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IACrE,CAAC;CACF,CAAC;AAEF,SAAS,OAAO,CAAC,OAAgC,EAAE,CAAS,EAAE,CAAS,EAAE,QAAiB,EAAE,KAAe,EAAE,MAAgB;IAC3H,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;IAC9D,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;IACnB,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;IACpB,MAAM,UAAU,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,IAAI,CAAC,CAAC;IAC5C,MAAM,SAAS,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;IACvD,IAAI,UAAU,IAAI,KAAK,EAAE,CAAC;QACxB,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACX,UAAU,GAAG,CAAC,CAAC;gBACf,CAAC,GAAG,CAAC,CAAC;YACR,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;YAC1B,CAAC;QACH,CAAC;aAAM,CAAC;YACN,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC;QAC1B,CAAC;QACD,IAAI,CAAC,SAAS,EAAE,CAAC;YACf,IAAI,MAAM,EAAE,CAAC;gBACX,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC;YAC7B,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;YACtC,CAAC;QACH,CAAC;QACD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;QAC7B,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;QAC9B,OAAO,CAAC,KAAK,CAAC,KAAK,GAAG,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/D,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAClE,OAAO,IAAI,CAAC;IACd,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,SAAS,CAAC,OAAgC,EAAE,CAAS,EAAE,CAAS,EAAE,QAAiB,EAAE,KAAe,EAAE,MAAgB;IAC7H,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,SAAS,CAAC;IAC3B,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC;IAC5B,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;IAC9D,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;IACnB,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;IACpB,MAAM,UAAU,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC;IAC1D,MAAM,SAAS,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;IACvD,IAAI,UAAU,IAAI,KAAK,EAAE,CAAC;QACxB,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACX,UAAU,GAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;YACnC,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;YACxC,CAAC;QACH,CAAC;QACD,IAAI,CAAC,SAAS,EAAE,CAAC;YACf,IAAI,MAAM,EAAE,CAAC;gBACX,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC;YAC7B,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;YACtC,CAAC;QACH,CAAC;QACD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;QAC7B,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;QAC9B,OAAO,CAAC,KAAK,CAAC,KAAK,GAAG,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/D,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAClE,OAAO,IAAI,CAAC;IACd,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,SAAS,CAAC,OAAgC,EAAE,CAAS,EAAE,CAAS,EAAE,QAAiB,EAAE,KAAe,EAAE,MAAgB;IAC7H,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAChE,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;IACnB,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;IACpB,MAAM,SAAS,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,IAAI,CAAC,CAAC;IAC1C,MAAM,UAAU,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC;IAC1D,IAAI,SAAS,IAAI,KAAK,EAAE,CAAC;QACvB,IAAI,CAAC,SAAS,EAAE,CAAC;YACf,IAAI,MAAM,EAAE,CAAC;gBACX,SAAS,GAAG,CAAC,CAAC;gBACd,CAAC,GAAG,CAAC,CAAC;YACR,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,CAAC,CAAC;YACR,CAAC;QACH,CAAC;aAAM,CAAC;YACN,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC;QACzB,CAAC;QACD,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACX,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC;YAC/B,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;YACxC,CAAC;QACH,CAAC;QACD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;QAC7B,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;QAC9B,OAAO,CAAC,KAAK,CAAC,KAAK,GAAG,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/D,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAClE,OAAO,IAAI,CAAC;IACd,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,UAAU,CAAC,OAAgC,EAAE,CAAS,EAAE,CAAS,EAAE,QAAiB,EAAE,KAAe,EAAE,MAAgB;IAC9H,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;IAChE,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;IACnB,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC;IACpB,MAAM,SAAS,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;IACvD,MAAM,UAAU,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC;IAC1D,IAAI,SAAS,IAAI,KAAK,EAAE,CAAC;QACvB,IAAI,CAAC,SAAS,EAAE,CAAC;YACf,IAAI,MAAM,EAAE,CAAC;gBACX,SAAS,GAAG,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC;YACjC,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;YACtC,CAAC;QACH,CAAC;QACD,IAAI,CAAC,UAAU,EAAE,CAAC;YAChB,IAAI,MAAM,EAAE,CAAC;gBACX,UAAU,GAAG,QAAQ,CAAC,MAAM,CAAC;YAC/B,CAAC;iBAAM,CAAC;gBACN,CAAC,GAAG,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;YACxC,CAAC;QACH,CAAC;QACD,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAC;QAC7B,OAAO,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,GAAG,IAAI,CAAC;QAC9B,OAAO,CAAC,KAAK,CAAC,KAAK,GAAG,SAAS,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAC/D,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QAClE,OAAO,IAAI,CAAC;IACd,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,MAAM,UAAU,KAAK,CAAC,OAAgC,EAAE,UAAmC,EAAE,SAAyB,EAAE,MAAgB;IACtI,MAAM,QAAQ,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;IACjD,MAAM,OAAO,GAAG,UAAU,CAAC,qBAAqB,EAAE,CAAC;IACnD,MAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;IAC1B,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;IACxB,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;IAC5B,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;IAC9B,MAAM,cAAc,GAAG,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;IAChD,MAAM,YAAY,GAAG,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;IAC5C,MAAM,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC;IACxB,MAAM,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC;IACvB,QAAQ,SAAS,EAAE,CAAC;QAClB,KAAK,MAAM;YACT,UAAU,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBAClD,SAAS,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACjD,UAAU,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,YAAY,GAAG,IAAI,EAAE,MAAM,CAAC;gBAChE,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,YAAY,IAAI,IAAI,EAAE,MAAM,CAAC,CAAC;YACtE,MAAM;QACR,KAAK,IAAI;YACP,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACpD,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACzD,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,GAAG,GAAG,cAAc,EAAE,MAAM,CAAC;gBACnE,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,cAAc,EAAE,MAAM,CAAC,CAAC;YAC1E,MAAM;QACR,KAAK,MAAM;YACT,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACtD,UAAU,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACxD,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,GAAG,YAAY,EAAE,MAAM,CAAC;gBACpE,UAAU,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,IAAI,YAAY,EAAE,MAAM,CAAC,CAAC;YACxE,MAAM;QACR,KAAK,MAAM;YACT,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACzD,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACpD,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,cAAc,GAAG,GAAG,EAAE,MAAM,CAAC;gBACxE,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,cAAc,IAAI,GAAG,EAAE,MAAM,CAAC,CAAC;YACrE,MAAM;QACR,KAAK,OAAO;YACV,UAAU,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACxD,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACtD,UAAU,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,YAAY,GAAG,IAAI,EAAE,MAAM,CAAC;gBACtE,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,YAAY,IAAI,IAAI,EAAE,MAAM,CAAC,CAAC;YACtE,MAAM;QACR,KAAK,MAAM,CAAC;QACZ;YACE,UAAU,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACvD,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,CAAC;gBACvD,UAAU,CAAC,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,YAAY,GAAG,IAAI,EAAE,MAAM,CAAC;gBACrE,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE,QAAQ,EAAE,YAAY,IAAI,IAAI,EAAE,MAAM,CAAC,CAAC;YACvE,MAAM;IACV,CAAC;AACH,CAAC","sourcesContent":["import { IoElement } from '../elements/IoElement';\n\n/**\n * Nudge direction.\n *\n * @description Nudge direction.\n * @example\n *\n */\nexport type NudgeDirection = 'none' | 'up' | 'left' | 'down' | 'right' | 'over';\n\nconst viewport = {\n  get width(): number {\n    return window.visualViewport\n      ? window.visualViewport.width * window.visualViewport.scale\n      : document.documentElement.clientWidth;\n  },\n  get height(): number {\n    return window.visualViewport\n      ? window.visualViewport.height * window.visualViewport.scale\n      : document.documentElement.clientHeight;\n  },\n  get offsetLeft(): number {\n    return window.visualViewport ? window.visualViewport.offsetLeft : 0;\n  },\n  get offsetTop(): number {\n    return window.visualViewport ? window.visualViewport.offsetTop : 0;\n  },\n};\n\nfunction nudgeUp(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  x = Math.max(0, Math.min(x, viewport.width - elemRect.width));\n  let clipWidth = -1;\n  let clipHeight = -1;\n  const fitsHeight = y - elemRect.height >= 0;\n  const fitsWidth = x + elemRect.width <= viewport.width;\n  if (fitsHeight || force) {\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = y;\n        y = 0;\n      } else {\n        y = elemRect.height - y;\n      }\n    } else {\n      y = y - elemRect.height;\n    }\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width;\n      } else {\n        x = viewport.width - elemRect.width;\n      }\n    }\n    element.style.top = y + 'px';\n    element.style.left = x + 'px';\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : '';\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : '';\n    return true;\n  }\n  return false;\n}\n\nfunction nudgeDown(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = y + viewport.offsetTop;\n  x = x + viewport.offsetLeft;\n  x = Math.max(0, Math.min(x, viewport.width - elemRect.width));\n  let clipWidth = -1;\n  let clipHeight = -1;\n  const fitsHeight = y + elemRect.height <= viewport.height;\n  const fitsWidth = x + elemRect.width <= viewport.width;\n  if (fitsHeight || force) {\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height - y;\n      } else {\n        y = viewport.height - elemRect.height;\n      }\n    }\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width;\n      } else {\n        x = viewport.width - elemRect.width;\n      }\n    }\n    element.style.top = y + 'px';\n    element.style.left = x + 'px';\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : '';\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : '';\n    return true;\n  }\n  return false;\n}\n\nfunction nudgeLeft(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = Math.max(0, Math.min(y, viewport.height - elemRect.height));\n  let clipWidth = -1;\n  let clipHeight = -1;\n  const fitsWidth = x - elemRect.width >= 0;\n  const fitsHeight = y + elemRect.height <= viewport.height;\n  if (fitsWidth || force) {\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = x;\n        x = 0;\n      } else {\n        x = 0;\n      }\n    } else {\n      x = x - elemRect.width;\n    }\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height;\n      } else {\n        y = viewport.height - elemRect.height;\n      }\n    }\n    element.style.top = y + 'px';\n    element.style.left = x + 'px';\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : '';\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : '';\n    return true;\n  }\n  return false;\n}\n\nfunction nudgeRight(element: HTMLElement | IoElement, x: number, y: number, elemRect: DOMRect, force?: boolean, doClip?: boolean) {\n  y = Math.max(0, Math.min(y, viewport.height - elemRect.height));\n  let clipWidth = -1;\n  let clipHeight = -1;\n  const fitsWidth = x + elemRect.width <= viewport.width;\n  const fitsHeight = y + elemRect.height <= viewport.height;\n  if (fitsWidth || force) {\n    if (!fitsWidth) {\n      if (doClip) {\n        clipWidth = viewport.width - x;\n      } else {\n        x = viewport.width - elemRect.width;\n      }\n    }\n    if (!fitsHeight) {\n      if (doClip) {\n        clipHeight = viewport.height;\n      } else {\n        y = viewport.height - elemRect.height;\n      }\n    }\n    element.style.top = y + 'px';\n    element.style.left = x + 'px';\n    element.style.width = clipWidth !== -1 ? clipWidth + 'px' : '';\n    element.style.height = clipHeight !== -1 ? clipHeight + 'px' : '';\n    return true;\n  }\n  return false;\n}\n\nexport function nudge(element: HTMLElement | IoElement, srcElement: HTMLElement | IoElement, direction: NudgeDirection, doClip?: boolean) {\n  const elemRect = element.getBoundingClientRect();\n  const srcRect = srcElement.getBoundingClientRect();\n  const left = srcRect.left;\n  const top = srcRect.top;\n  const right = srcRect.right;\n  const bottom = srcRect.bottom;\n  const bottomToHeight = viewport.height - bottom;\n  const rightToWidth = viewport.width - right;\n  const x = elemRect.left;\n  const y = elemRect.top;\n  switch (direction) {\n    case 'none':\n      nudgeRight(element, x, y, elemRect, false, doClip) ||\n      nudgeLeft(element, x, y, elemRect, false, doClip) ||\n      nudgeRight(element, x, y, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, left, top, elemRect, rightToWidth <= left, doClip);\n      break;\n    case 'up':\n      nudgeUp(element, left, top, elemRect, false, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, false, doClip) ||\n      nudgeUp(element, left, top, elemRect, top > bottomToHeight, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, top <= bottomToHeight, doClip);\n      break;\n    case 'left':\n      nudgeLeft(element, left, top, elemRect, false, doClip) ||\n      nudgeRight(element, right, top, elemRect, false, doClip) ||\n      nudgeLeft(element, left, top, elemRect, left > rightToWidth, doClip) ||\n      nudgeRight(element, right, top, elemRect, left <= rightToWidth, doClip);\n      break;\n    case 'down':\n      nudgeDown(element, left, bottom, elemRect, false, doClip) ||\n      nudgeUp(element, left, top, elemRect, false, doClip) ||\n      nudgeDown(element, left, bottom, elemRect, bottomToHeight > top, doClip) ||\n      nudgeUp(element, left, top, elemRect, bottomToHeight <= top, doClip);\n      break;\n    case 'right':\n      nudgeRight(element, right, top, elemRect, false, doClip) ||\n      nudgeLeft(element, left, top, elemRect, false, doClip) ||\n      nudgeRight(element, right, top, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, left, top, elemRect, rightToWidth <= left, doClip);\n      break;\n    case 'over':\n    default:\n      nudgeRight(element, left, top, elemRect, false, doClip) ||\n      nudgeLeft(element, right, top, elemRect, false, doClip) ||\n      nudgeRight(element, left, top, elemRect, rightToWidth > left, doClip) ||\n      nudgeLeft(element, right, top, elemRect, rightToWidth <= left, doClip);\n      break;\n  }\n}"]}