{"version":3,"file":"CircuitsBoard.js","sourceRoot":"","sources":["../src/CircuitsBoard.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  IoElement,\n  Register,\n  ReactiveProperty,\n  IoElementProps,\n  div,\n} from '@io-gui/core'\nimport {\n  BoxGeometry,\n  BufferGeometry,\n  Color,\n  GridHelper,\n  Line,\n  LineBasicMaterial,\n  Mesh,\n  MeshBasicMaterial,\n  OrthographicCamera,\n  Scene as ThreeScene,\n  SphereGeometry,\n  Vector3,\n  WebGLRenderer,\n} from 'three'\nimport { Game } from './game/game.js'\nimport { Pad } from './game/items/pad.js'\nimport { Terminal, TERMINAL_COLORS as COLORS } from './game/items/terminal.js'\nimport { Line as GameLine } from './game/items/line.js'\n\n/**\n * Scene — Three.js WebGL scene for the circuits board.\n * Renders grid (GridHelper), lines (Line), pads (spheres), terminals (cubes), and touch marker.\n */\n\nexport class Scene {\n  canvasWidth = 0\n  canvasHeight = 0\n  gridWidth = 0\n  gridHeight = 0\n  gridUnit = 0\n  gridOffsetX = 0\n  gridOffsetY = 0\n  markerRadius = 0\n\n  private _renderer: WebGLRenderer | null = null\n  private _scene = new ThreeScene()\n  private _camera: OrthographicCamera | null = null\n  private _grid: GridHelper | null = null\n  private _gameGroup = new ThreeScene()\n  private _marker: Mesh | null = null\n\n  /** Set up Three.js from a container; canvas is created and appended. */\n  init(container: HTMLElement): void {\n    if (this._renderer) {\n      if (!container.contains(this._renderer.domElement))\n        container.appendChild(this._renderer.domElement)\n      return\n    }\n    this._scene.add(this._gameGroup)\n    const renderer = new WebGLRenderer({ antialias: true, alpha: true })\n    renderer.setPixelRatio(window.devicePixelRatio ?? 1)\n    renderer.setClearColor(0x000000, 0.8)\n    container.appendChild(renderer.domElement)\n    this._renderer = renderer\n  }\n\n  /** Recalculate grid geometry, resize renderer, and build grid. */\n  initGrid(\n    gameWidth: number,\n    gameHeight: number,\n    containerWidth: number,\n    containerHeight: number,\n  ): void {\n    this.canvasWidth = containerWidth\n    this.canvasHeight = containerHeight\n    this.gridWidth = gameWidth\n    this.gridHeight = gameHeight\n\n    if (\n      this.canvasHeight / this.gridHeight >\n      this.canvasWidth / this.gridWidth\n    ) {\n      this.gridUnit = this.canvasWidth / (this.gridWidth + 1)\n    } else {\n      this.gridUnit = this.canvasHeight / (this.gridHeight + 1)\n    }\n\n    this.gridOffsetX = (this.canvasWidth - this.gridUnit * this.gridWidth) / 2\n    this.gridOffsetY =\n      (this.canvasHeight - this.gridUnit * this.gridHeight) / 2\n\n    if (this._renderer) {\n      this._renderer.setSize(this.canvasWidth, this.canvasHeight)\n    }\n\n    this._camera = new OrthographicCamera(\n      0,\n      this.canvasWidth,\n      0,\n      this.canvasHeight,\n      0.1,\n      1000,\n    )\n    this._camera.position.set(\n      this.canvasWidth / 2,\n      this.canvasHeight / 2,\n      500,\n    )\n    this._camera.lookAt(\n      this.canvasWidth / 2,\n      this.canvasHeight / 2,\n      0,\n    )\n\n    if (this._grid) this._scene.remove(this._grid)\n    const size = Math.max(this.gridWidth, this.gridHeight) * this.gridUnit\n    const divisions = Math.max(this.gridWidth, this.gridHeight)\n    this._grid = new GridHelper(size, divisions, 0xffffff, 0xffffff)\n    this._grid.rotation.x = -Math.PI / 2\n    this._grid.position.set(\n      this.gridOffsetX + (this.gridWidth * this.gridUnit) / 2,\n      this.gridOffsetY + (this.gridHeight * this.gridUnit) / 2,\n      0,\n    )\n    this._scene.add(this._grid)\n\n    this.markerRadius = this.canvasWidth * 0.1\n  }\n\n  private _gridToWorld(gx: number, gy: number, z: number): Vector3 {\n    return new Vector3(\n      this.gridOffsetX + gx * this.gridUnit,\n      this.gridOffsetY + gy * this.gridUnit,\n      z,\n    )\n  }\n\n  /** Full re-render of lines, pads and terminals. */\n  render(pads: Pad[], terminals: Terminal[], lines: GameLine[]): void {\n    while (this._gameGroup.children.length > 0) {\n      const obj = this._gameGroup.children[0]\n      this._gameGroup.remove(obj)\n      if (obj instanceof Line) {\n        obj.geometry.dispose()\n        if (obj.material instanceof LineBasicMaterial) obj.material.dispose()\n      } else if (obj instanceof Mesh) {\n        obj.geometry.dispose()\n        const mat = obj.material\n        if (Array.isArray(mat)) for (const m of mat) m.dispose()\n        else if (mat) mat.dispose()\n      }\n    }\n\n    const padRadius = this.gridUnit / 3\n    const termHalf = this.gridUnit / 3\n    const lineZBottom = -0.5\n    const lineZTop = 0.5\n\n    for (const line of lines) {\n      if (line.pos.length < 2) continue\n      const z = line.layer === -1 ? lineZBottom : lineZTop\n      const points = line.pos.map((p) => this._gridToWorld(p[0], p[1], z))\n      const geometry = new BufferGeometry().setFromPoints(points)\n      const material = new LineBasicMaterial({\n        color: new Color(COLORS[line._color] ?? '#ffffff'),\n      })\n      const lineObj = new Line(geometry, material)\n      this._gameGroup.add(lineObj)\n    }\n\n    for (const pad of pads) {\n      const geom = new SphereGeometry(padRadius, 12, 8)\n      const mat = new MeshBasicMaterial({\n        color: new Color(COLORS[pad._color] ?? '#ffffff'),\n      })\n      const mesh = new Mesh(geom, mat)\n      mesh.position.copy(this._gridToWorld(pad.pos[0], pad.pos[1], 0.5))\n      this._gameGroup.add(mesh)\n    }\n\n    for (const term of terminals) {\n      const geom = new BoxGeometry(termHalf * 2, termHalf * 2, termHalf * 2)\n      const mat = new MeshBasicMaterial({\n        color: new Color(COLORS[term.color] ?? '#ffffff'),\n      })\n      const mesh = new Mesh(geom, mat)\n      mesh.position.copy(this._gridToWorld(term.pos[0], term.pos[1], 0.5))\n      this._gameGroup.add(mesh)\n    }\n\n    this._renderFrame()\n  }\n\n  drawMarker(touchX: number, touchY: number): void {\n    this.hideMarker()\n    if (!this._gameGroup) return\n    const geom = new SphereGeometry(this.markerRadius, 16, 12)\n    const mat = new MeshBasicMaterial({\n      color: 0xffffff,\n      transparent: true,\n      opacity: 0.15,\n    })\n    this._marker = new Mesh(geom, mat)\n    this._marker.position.copy(this._gridToWorld(touchX, touchY, 1))\n    this._gameGroup.add(this._marker)\n    this._renderFrame()\n  }\n\n  hideMarker(): void {\n    if (this._marker && this._gameGroup) {\n      this._gameGroup.remove(this._marker)\n      this._marker.geometry.dispose()\n      const mat = this._marker.material\n      if (Array.isArray(mat)) for (const m of mat) m.dispose()\n      else mat.dispose()\n      this._marker = null\n    }\n    this._renderFrame()\n  }\n\n  private _renderFrame(): void {\n    if (this._renderer && this._camera) {\n      this._renderer.render(this._scene, this._camera)\n    }\n  }\n}\n\ntype CircuitsBoardProps = IoElementProps & {\n  game?: Game\n}\n\n/**\n * CircuitsBoard — canvas-based game board IoElement.\n * Owns the Scene, creates 4 layered canvases, handles pointer events,\n * and translates screen coordinates to grid positions (plotter logic).\n */\nexport class CircuitsBoard extends IoElement {\n  static get Style() {\n    return /* css */ `\n      :host {\n        flex: 1;\n        position: relative;\n        background: rgba(0, 0, 0, 0.8);\n        border: 1px solid #99f;\n        border-radius: 12px;\n        margin: 2px;\n        overflow: hidden;\n        touch-action: none;\n      }\n      :host > div {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n    `\n  }\n\n  static get Listeners(): Record<string, string> {\n    return {\n      pointerdown: 'onPointerdown',\n      'game-init-scene': 'onGameInitScene',\n      'game-render': 'onGameRender',\n    }\n  }\n\n  @ReactiveProperty({ type: Game })\n  declare game: Game\n\n  @ReactiveProperty({ type: Scene, init: null })\n  declare scene: Scene\n\n  // Plotter state\n  private _touchX = 0\n  private _touchY = 0\n  private _gridX = 0\n  private _gridY = 0\n  private _gridXOld = 0\n  private _gridYOld = 0\n  private _drag = false\n  private _randomID = 0\n\n  constructor(args: CircuitsBoardProps = {}) {\n    super(args)\n  }\n\n  ready() {\n    this.changed()\n  }\n\n  changed() {\n    this.render([div({ id: 'scene-container' })])\n    this._initScene()\n  }\n\n  onResized() {\n    this._initScene()\n  }\n\n  private _initScene(): void {\n    const container = this.querySelector('#scene-container') as HTMLElement\n    if (!container) return\n\n    if (!this.scene) this.scene = new Scene()\n    this.scene.init(container)\n\n    const rect = this.getBoundingClientRect()\n    if (rect.width === 0 || rect.height === 0) return\n\n    if (this.game) {\n      this.scene.initGrid(\n        this.game.width,\n        this.game.height,\n        rect.width,\n        rect.height,\n      )\n      this.scene.render(\n        this.game.pads,\n        this.game.terminals,\n        this.game.lines,\n      )\n    }\n  }\n\n  gameChanged() {\n    this._initScene()\n  }\n\n  onGameInitScene() {\n    const rect = this.getBoundingClientRect()\n    if (rect.width === 0 || rect.height === 0) return\n    this.scene.initGrid(\n      this.game.width,\n      this.game.height,\n      rect.width,\n      rect.height,\n    )\n    this.scene.render(\n      this.game.pads,\n      this.game.terminals,\n      this.game.lines,\n    )\n  };\n  onGameRender() {\n    this.scene.render(\n      this.game.pads,\n      this.game.terminals,\n      this.game.lines,\n    )\n  };\n\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    this.setPointerCapture(event.pointerId)\n    this.addEventListener('pointermove', this.onPointermove)\n    this.addEventListener('pointerup', this.onPointerup)\n\n    this._randomID = Math.floor(Math.random() * 100000)\n    this._drag = true\n    this._initPosition(event)\n    this.scene.drawMarker(this._touchX, this._touchY)\n\n    if (!this.game) return\n\n    if (this.game.drawMode === 'pad') {\n      this.game.plotter.addPad(this._randomID, this._gridX, this._gridY)\n    }\n    if (this.game.drawMode === 'terminal') {\n      this.game.plotter.addTerminal(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawColor,\n      )\n    }\n    if (this.game.drawMode === 'line') {\n      this.game.plotter.addLineSegment(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawLayer,\n      )\n    }\n    if (this.game.drawMode === 'delete') {\n      this.game.plotter.delete(this._gridX, this._gridY)\n    }\n  }\n\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    this._updatePosition(event)\n    this.scene.drawMarker(this._gridX, this._gridY)\n\n    if (!this.game) return\n\n    if (\n      this.game.drawMode === 'line' &&\n      this._drag &&\n      (this._gridX !== this._gridXOld || this._gridY !== this._gridYOld)\n    ) {\n      const { endDrag } = this.game.plotter.addLineSegment(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawLayer,\n      )\n      if (endDrag) this._drag = false\n    }\n  }\n\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    this.releasePointerCapture(event.pointerId)\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n\n    this._drag = false\n    this.scene.hideMarker()\n\n    if (!this.game) return\n\n    this.game.finalizeMove(this._randomID)\n  }\n\n  private _initPosition(event: PointerEvent): void {\n    const rect = this.getBoundingClientRect()\n\n    this._touchX =\n      (event.clientX - rect.left - this.scene.gridOffsetX) /\n      this.scene.gridUnit\n    this._touchY =\n      (event.clientY - rect.top - this.scene.gridOffsetY) / this.scene.gridUnit\n\n    this._gridX = Math.round(this._touchX)\n    this._gridY = Math.round(this._touchY)\n    this._gridXOld = this._gridX\n    this._gridYOld = this._gridY\n  }\n\n  private _updatePosition(event: PointerEvent): void {\n    const rect = this.getBoundingClientRect()\n\n    this._touchX =\n      (event.clientX - rect.left - this.scene.gridOffsetX) /\n      this.scene.gridUnit\n    this._touchY =\n      (event.clientY - rect.top - this.scene.gridOffsetY) / this.scene.gridUnit\n\n    const distance = Math.sqrt(\n      Math.pow(this._touchX - Math.round(this._touchX), 2) +\n        Math.pow(this._touchY - Math.round(this._touchY), 2),\n    )\n\n    if (!this.game) return\n\n    if (\n      distance < 0.5 &&\n      // this._touchX <= this.game.width + 0.5 &&\n      // this._touchY <= this.game.height + 0.5 &&\n      this._touchX >= -0.5 &&\n      this._touchY >= -0.5\n    ) {\n      this._gridXOld = this._gridX\n      this._gridYOld = this._gridY\n\n      this._gridX = Math.round(this._touchX)\n      this._gridY = Math.round(this._touchY)\n\n      if (this._gridX > this._gridXOld) this._gridX = this._gridXOld + 1\n      if (this._gridX < this._gridXOld) this._gridX = this._gridXOld - 1\n      if (this._gridY > this._gridYOld) this._gridY = this._gridYOld + 1\n      if (this._gridY < this._gridYOld) this._gridY = this._gridYOld - 1\n    }\n  }\n}\nRegister(CircuitsBoard)\nexport const circuitsBoard = function (arg0: CircuitsBoardProps) {\n  return CircuitsBoard.vConstructor(arg0)\n}\n"]}