{"version":3,"file":"grid.js","sourceRoot":"","sources":["../../src/objects/grid.ts"],"names":[],"mappings":"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","sourcesContent":["import { LineSegments, LineBasicMaterial, Float32BufferAttribute, BufferGeometry, Color, AdditiveBlending } from 'three/webgpu'\n\nclass Grid extends LineSegments {\n\n  declare public geometry: BufferGeometry\n  declare public material: LineBasicMaterial\n\n  constructor() {\n\n\t\tconst geometry = new BufferGeometry()\n\t\tconst material = new LineBasicMaterial( { transparent: true, vertexColors: true, toneMapped: false, blending: AdditiveBlending } )\n\t\tsuper( geometry, material )\n\n\t}\n\n\tupdate( width: number, height: number ) {\n\n\t\tif ( width === 0 || height === 0 ) {\n\t\t\tthis.geometry.setAttribute( 'position', new Float32BufferAttribute( [], 3 ) )\n\t\t\tthis.geometry.setAttribute( 'color', new Float32BufferAttribute( [], 4 ) )\n\t\t\treturn\n\t\t}\n\n\t\tconst color = new Color( 0x666666 )\n\t\tconst color2 = new Color( 0x333333 )\n\n    const hSegments = width * ( height + 1 )\n\t\tconst vSegments = height * ( width + 1 )\n\t\tconst dSegments = width * height * 4\n\t\tconst totalSegments = hSegments + vSegments + dSegments\n\t\tconst totalVertices = totalSegments * 2\n\n\t\tconst positions = new Float32Array( totalVertices * 3 )\n\t\tconst colors = new Float32Array( totalVertices * 4 )\n\n\t\tlet vi = 0\n\n\t\tconst pushVertex = ( x: number, y: number, c: Color ) => {\n\n\t\t\tconst pi = vi * 3\n\t\t\tconst ci = vi * 4\n\t\t\tpositions[ pi ] = x\n\t\t\tpositions[ pi + 1 ] = y\n\t\t\tpositions[ pi + 2 ] = 0\n\t\t\tc.toArray( colors, ci )\n\t\t\tcolors[ ci + 3 ] = 1\n\t\t\tvi ++\n\n\t\t}\n\n\t\t// Horizontal segments\n\t\tfor ( let iz = 0; iz <= height; iz ++ ) {\n\t\t\tfor ( let ix = 0; ix < width; ix ++ ) {\n\t\t\t\tpushVertex( ix, iz, color )\n\t\t\t\tpushVertex( ix + 1, iz, color )\n\t\t\t}\n\t\t}\n\n\t\t// Vertical segments\n\t\tfor ( let ix = 0; ix <= width; ix ++ ) {\n\t\t\tfor ( let iz = 0; iz < height; iz ++ ) {\n\t\t\t\tpushVertex( ix, iz, color )\n\t\t\t\tpushVertex( ix, iz + 1, color )\n\t\t\t}\n\t\t}\n\n\t\t// Diagonal segments (4 per cell: center to each corner)\n\t\tfor ( let cz = 0; cz < height; cz ++ ) {\n\t\t\tfor ( let cx = 0; cx < width; cx ++ ) {\n\t\t\t\tconst centerX = cx + 0.5\n\t\t\t\tconst centerZ = cz + 0.5\n\t\t\t\tpushVertex( centerX, centerZ, color2 )\n\t\t\t\tpushVertex( cx, cz, color )\n\t\t\t\tpushVertex( centerX, centerZ, color2 )\n\t\t\t\tpushVertex( cx + 1, cz, color )\n\t\t\t\tpushVertex( centerX, centerZ, color2 )\n\t\t\t\tpushVertex( cx, cz + 1, color )\n\t\t\t\tpushVertex( centerX, centerZ, color2 )\n\t\t\t\tpushVertex( cx + 1, cz + 1, color )\n\t\t\t}\n\n\t\t}\n\n\t\tthis.geometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) )\n\t\tthis.geometry.setAttribute( 'color', new Float32BufferAttribute( colors, 4 ) )\n\t}\n\n\tdispose() {\n\t\tthis.geometry.dispose()\n\t\tthis.material.dispose()\n\t}\n\n}\n\n\nexport { Grid }\n"]}