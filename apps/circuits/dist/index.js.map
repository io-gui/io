{"version":3,"file":"index.js","sources":["../src/CircuitsLevels.ts","../src/game/pad.ts","../src/game/terminal.ts","../src/game/line.ts","../src/game/game.ts","../src/game/colors.ts","../src/CircuitsBoard.ts","../src/CircuitsGame.ts","../src/CircuitsEditor.ts","../src/CircuitsApp.ts"],"sourcesContent":["import { IoElement, Register } from '@io-gui/core'\nimport { MenuOption, ioMenuTree } from '@io-gui/menus'\n\n@Register\nexport class CircuitsLevels extends IoElement {\n  static get Style() {\n    return /* css */ `\n      :host > .app-title {\n        margin-left: 1rem;\n        font-size: 2rem;\n        font-weight: bold;\n        letter-spacing: 2px;\n        text-transform: uppercase;\n      }\n    `\n  }\n\n  private _option = new MenuOption({ id: 'levels', options: [] })\n\n  async ready() {\n    await this._loadLevels()\n    this.changed()\n  }\n\n  private async _loadLevels() {\n    const response = await fetch('./public/levels/index.json')\n    const levelIds: string[] = await response.json()\n    this._option = new MenuOption({\n      id: 'levels',\n      options: levelIds.map((id) => ({\n        id: id,\n        action: () => this.dispatch('level-select', { level: id }, true),\n      })),\n    })\n  }\n\n  changed() {\n    this.render([ioMenuTree({ option: this._option })])\n  }\n}\n\nexport const circuitsLevels = CircuitsLevels.vConstructor\n","export interface PadData {\n  ID: number\n  pos: [number, number]\n}\n\nexport class Pad {\n  ID: number\n  pos: [number, number]\n\n  constructor(ID: number, pos: [number, number]) {\n    this.ID = ID\n    this.pos = pos\n  }\n\n  toJSON(): PadData {\n    return { pos: this.pos, ID: this.ID }\n  }\n\n  static fromJSON(data: PadData): Pad {\n    return new Pad(data.ID, data.pos)\n  }\n}\n","export interface TerminalData {\n  ID: number\n  pos: [number, number]\n  color: string\n}\n\nexport class Terminal {\n  ID: number\n  pos: [number, number]\n  color: string\n\n  constructor(ID: number, pos: [number, number], color: string) {\n    this.ID = ID\n    this.pos = pos\n    this.color = color\n  }\n\n  toJSON(): TerminalData {\n    return { pos: this.pos, color: this.color, ID: this.ID }\n  }\n\n  static fromJSON(data: TerminalData): Terminal {\n    return new Terminal(data.ID, data.pos, data.color)\n  }\n}\n","export interface LineData {\n  ID: number\n  pos: [number, number][]\n  color: string\n  readonly?: boolean\n}\n\nexport class Line {\n  ID: number\n  pos: [number, number][]\n  color: string\n  readonly: boolean\n  constructor(ID: number, pos: [number, number], color: string) {\n    this.ID = ID\n    this.pos = [pos]\n    this.color = color\n    this.readonly = false\n  }\n\n  /**\n   * Add a grid segment.\n   * Returns false if the segment was rejected.\n   */\n  addSegment(x: number, y: number): boolean {\n    if (!this._checkErase(x, y)) return false\n    if (!this._checkDirection(x, y)) return false\n\n    this.pos.push([x, y])\n    return true\n  }\n\n  removeLast(): void {\n    this.pos.pop()\n  }\n\n  toJSON(): LineData {\n    return { ID: this.ID, pos: this.pos, color: this.color }\n  }\n\n  static fromJSON(data: LineData): Line {\n    const line = new Line(data.ID, data.pos[0], data.color)\n    for (let j = 1; j < data.pos.length; j++) {\n      line.addSegment(data.pos[j][0], data.pos[j][1])\n    }\n    if (data.readonly) line.readonly = true\n    return line\n  }\n\n  /** Prevent backtracking over more than one step. */\n  private _checkDirection(x: number, y: number): boolean {\n    const ln = this.pos.length\n    if (ln > 1) {\n      if (y === this.pos[ln - 2][1] && Math.abs(x - this.pos[ln - 2][0]) === 1)\n        return false\n      if (x === this.pos[ln - 2][0] && Math.abs(y - this.pos[ln - 2][1]) === 1)\n        return false\n    }\n    const last = this.pos[ln - 1]\n    if (Math.abs(last[0] - x) > 1) return false\n    if (Math.abs(last[1] - y) > 1) return false\n    return true\n  }\n\n  /** Erase last segment if user drags back to prev node. */\n  private _checkErase(x: number, y: number): boolean {\n    const ln = this.pos.length\n    if (ln < 2) return true\n    if (x === this.pos[ln - 2][0] && y === this.pos[ln - 2][1]) {\n      this.removeLast()\n      return false\n    }\n    return true\n  }\n\n}\n\n","import { Pad } from './pad.js'\nimport { Terminal } from './terminal.js'\nimport { Line } from './line.js'\nimport type { PadData } from './pad.js'\nimport type { TerminalData } from './terminal.js'\nimport type { LineData } from './line.js'\n\nexport type DrawMode = 'pad' | 'terminal' | 'line' | 'delete'\n\ninterface LegacyPadData {\n  ID: number\n  pos: [number, number]\n  color?: string\n}\n\ninterface LevelData {\n  width: number\n  height: number\n  pads: PadData[]\n  terminals?: TerminalData[]\n  lines: LineData[]\n}\n\n/**\n * Game — central state machine.\n * Manages pads, lines, load/save, undo/redo, colour propagation,\n * and completion checking.\n */\nexport class Game {\n  width = 4\n  height = 5\n  pads: Record<number, Pad> = {}\n  terminals: Record<number, Terminal> = {}\n  lines: Record<number, Line> = {}\n  padColors: Record<number, string> = {}\n  terminalColors: Record<number, string> = {}\n  lineColors: Record<number, string> = {}\n  drawMode: DrawMode = 'line'\n  drawColor = 'white'\n  undoStack: string[] = []\n  redoStack: string[] = []\n  currentLevel = ''\n\n  /** Callback invoked after save — host element persists state. */\n  onSave: ((level: string, json: string) => void) | null = null\n  /** Callback invoked on completion change. */\n  onComplete: ((level: string, completed: boolean) => void) | null = null\n  /** Callback invoked when grid dimensions change and scene needs re-init. */\n  onInitScene: (() => void) | null = null\n  /** Callback invoked when game state changes and scene needs re-render. */\n  onRender: (() => void) | null = null\n\n  init(): void {\n    this.width = 4\n    this.height = 5\n    this.pads = {}\n    this.terminals = {}\n    this.lines = {}\n    this.drawMode = 'line'\n    this.drawColor = 'white'\n    this._renderScene()\n  }\n\n  // -- Level loading --\n\n  load(level: string, savedState?: string): void {\n    this.init()\n    this.redoStack = []\n    this.undoStack = []\n    this.currentLevel = level\n\n    if (savedState) {\n      this.fromJSON(savedState)\n      this.save()\n      this.updateUndoStack()\n      this.propagateColors()\n    } else {\n      void this.reset(level)\n    }\n  }\n\n  clear() {\n    this.init()\n  }\n\n  async reset(level: string): Promise<void> {\n    try {\n      const resp = await fetch('./public/levels/' + level + '.json')\n      if (!resp.ok) throw new Error('Level not found')\n      const text = await resp.text()\n      this.fromJSON(text)\n      for (const i in this.lines) this.lines[i].readonly = true\n      this.save()\n      this.updateUndoStack()\n      this.propagateColors()\n    } catch (e) {\n      console.warn('Could not load level:', level, e)\n    }\n  }\n\n  // -- Serialisation --\n\n  fromJSON(jsonText: string): void {\n    const state: LevelData = JSON.parse(jsonText)\n    this.width = state.width\n    this.height = state.height\n    this.pads = {}\n    this.terminals = {}\n    const legacyPads = state.pads as LegacyPadData[]\n    for (const p of legacyPads) {\n      if ('color' in p && p.color !== undefined) {\n        if (p.color === 'white') {\n          this.pads[p.ID] = new Pad(p.ID, p.pos)\n        } else {\n          this.terminals[p.ID] = new Terminal(p.ID, p.pos, p.color)\n        }\n      } else {\n        this.pads[p.ID] = Pad.fromJSON(p as PadData)\n      }\n    }\n    if (state.terminals) {\n      for (const t of state.terminals) {\n        this.terminals[t.ID] = Terminal.fromJSON(t)\n      }\n    }\n    this.lines = {}\n    for (const l of state.lines) {\n      this.lines[l.ID] = Line.fromJSON(l)\n    }\n    this.initScene()\n  }\n\n  toJSON(): string {\n    return JSON.stringify({\n      width: this.width,\n      height: this.height,\n      pads: this._cleanPads(),\n      terminals: this._cleanTerminals(),\n      lines: this._cleanLines(),\n    })\n  }\n\n  private _cleanPads(): PadData[] {\n    return Object.values(this.pads).map((p) => p.toJSON())\n  }\n\n  private _cleanTerminals(): TerminalData[] {\n    return Object.values(this.terminals).map((t) => t.toJSON())\n  }\n\n  private _cleanLines(): LineData[] {\n    return Object.values(this.lines).map((l) => l.toJSON())\n  }\n\n  save(): void {\n    if (this.currentLevel && this.onSave) {\n      this.onSave(this.currentLevel, this.toJSON())\n    }\n  }\n\n  // -- Undo / Redo --\n\n  updateUndoStack(): void {\n    const state = this.toJSON()\n    if (state !== this.undoStack[this.undoStack.length - 1]) {\n      this.undoStack.push(state)\n    }\n  }\n\n  undo(): void {\n    if (this.undoStack.length > 1) {\n      this.fromJSON(this.undoStack[this.undoStack.length - 2])\n      this.redoStack.push(this.undoStack.pop()!)\n      this.save()\n      this.propagateColors()\n      this.checkCompletion()\n    }\n  }\n\n  redo(): void {\n    if (this.redoStack.length > 0) {\n      const state = this.redoStack.pop()!\n      this.fromJSON(state)\n      this.undoStack.push(state)\n      this.save()\n      this.propagateColors()\n      this.checkCompletion()\n    }\n  }\n\n  getPointAt(\n    x: number,\n    y: number\n  ): { id: number; color: string; isTerminal: boolean } | false {\n    for (const i in this.pads) {\n      if (this.pads[i].pos[0] === x && this.pads[i].pos[1] === y)\n        return {\n          id: this.pads[i].ID,\n          color: this.padColors[this.pads[i].ID] ?? 'white',\n          isTerminal: false,\n        }\n    }\n    for (const i in this.terminals) {\n      if (this.terminals[i].pos[0] === x && this.terminals[i].pos[1] === y)\n        return {\n          id: this.terminals[i].ID,\n          color: this.terminalColors[this.terminals[i].ID] ?? this.terminals[i].color,\n          isTerminal: true,\n        }\n    }\n    return false\n  }\n\n  // -- Pad operations --\n\n  addPad(ID: number, x: number, y: number): void {\n    if (!this.getPointAt(x, y)) {\n      this.pads[ID] = new Pad(ID, [x, y])\n      this._renderScene()\n    }\n  }\n\n  addTerminal(ID: number, x: number, y: number, color: string): void {\n    if (!this.getPointAt(x, y)) {\n      this.terminals[ID] = new Terminal(ID, [x, y], color)\n      this._renderScene()\n    }\n  }\n\n  deletePad(x: number, y: number): void {\n    for (const i in this.pads) {\n      if (\n        this.pads[i] &&\n        this.pads[i].pos[0] === x &&\n        this.pads[i].pos[1] === y\n      ) {\n        delete this.pads[i]\n        this._renderScene()\n        return\n      }\n    }\n  }\n\n  deleteTerminal(x: number, y: number): void {\n    for (const i in this.terminals) {\n      if (\n        this.terminals[i] &&\n        this.terminals[i].pos[0] === x &&\n        this.terminals[i].pos[1] === y\n      ) {\n        delete this.terminals[i]\n        this._renderScene()\n        return\n      }\n    }\n  }\n\n  // -- Line operations --\n\n  /**\n   * Add / extend a line.\n   * Returns true if the line reached a destination pad or terminal (drag should stop).\n   */\n  addLine(ID: number, x: number, y: number, color: string): boolean {\n    const point = this.getPointAt(x, y)\n    const pointColor = point ? point.color : false\n    const lineCount = this.getLineCount(x, y)\n\n    const connectionLimit = point ? (point.isTerminal ? 1 : 2) : 0\n    if (point && lineCount >= connectionLimit) {\n      this._renderScene()\n      return false\n    }\n\n    if (!this.lines[ID]) {\n      if (!pointColor) {\n        this._renderScene()\n        return false\n      }\n      this.lines[ID] = new Line(ID, [x, y], color)\n      this.lineColors[ID] = pointColor\n      this._renderScene()\n      return false\n    }\n\n    if (!this._checkCrossing(this.lines[ID], x, y)) {\n      this._renderScene()\n      return false\n    }\n\n    const lineColor = this.lineColors[ID] ?? this.lines[ID].color\n    let endDrag = false\n\n    if (!pointColor && (!lineCount || color === 'grey')) {\n      this.lines[ID].addSegment(x, y)\n    } else if (\n      pointColor === 'white' ||\n      pointColor === lineColor ||\n      ((lineColor === 'white' || lineColor === 'grey') && pointColor)\n    ) {\n      this.lines[ID].addSegment(x, y)\n      endDrag = true\n    }\n\n    this._renderScene()\n    return endDrag\n  }\n\n  getLineColor(x: number, y: number): string | false {\n    for (const i in this.lines) {\n      for (const pos of this.lines[i].pos) {\n        if (pos[0] === x && pos[1] === y) return this.lines[i].color\n      }\n    }\n    return false\n  }\n\n  getLineCount(x: number, y: number): number {\n    let count = 0\n    for (const i in this.lines) {\n      for (const pos of this.lines[i].pos) {\n        if (pos[0] === x && pos[1] === y && this.lines[i].color === 'white')\n          count++\n      }\n    }\n    return count\n  }\n\n  getUnderlineCount(x: number, y: number): number {\n    let count = 0\n    for (const i in this.lines) {\n      for (const pos of this.lines[i].pos) {\n        if (pos[0] === x && pos[1] === y && this.lines[i].color === 'grey')\n          count++\n      }\n    }\n    return count\n  }\n\n  checkLine(ID: number): void {\n    if (this.lines[ID]) {\n      const first = this.lines[ID].pos[0]\n      const last = this.lines[ID].pos[this.lines[ID].pos.length - 1]\n      const p1 = this.getPointAt(first[0], first[1])\n      const p2 = this.getPointAt(last[0], last[1])\n      if (\n        !p1 ||\n        !p2 ||\n        (first[0] === last[0] && first[1] === last[1])\n      ) {\n        this.undo()\n      }\n      this.redoStack = []\n    }\n  }\n\n  deleteLine(x: number, y: number): void {\n    for (const i in this.lines) {\n      for (const pos of this.lines[i].pos) {\n        if (pos[0] === x && pos[1] === y) {\n          delete this.lines[i]\n          this._renderScene()\n          return\n        }\n      }\n    }\n  }\n\n  /** Prevent diagonal lines from crossing other diagonals (unless grey). */\n  private _checkCrossing(line: Line, x: number, y: number): boolean {\n    const last = line.pos[line.pos.length - 1]\n    const mx = (x + last[0]) / 2\n    const my = (y + last[1]) / 2\n\n    for (const id in this.lines) {\n      const other = this.lines[id]\n      if (line.color === 'grey' || other.color === 'grey') continue\n      const pos = other.pos\n      for (let i = 1; i < pos.length; i++) {\n        if (\n          Math.abs(pos[i][0] - pos[i - 1][0]) === 1 &&\n          Math.abs(pos[i][1] - pos[i - 1][1]) === 1 &&\n          (pos[i][0] + pos[i - 1][0]) / 2 === mx &&\n          (pos[i][1] + pos[i - 1][1]) / 2 === my\n        ) {\n          return false\n        }\n      }\n    }\n    return true\n  }\n\n  // -- Colour propagation --\n\n  resetColors(): void {\n    this.lineColors = {}\n    for (const i in this.lines)\n      this.lineColors[this.lines[i].ID] = this.lines[i].color\n    this.padColors = {}\n    for (const i in this.pads) this.padColors[this.pads[i].ID] = 'white'\n    this.terminalColors = {}\n    for (const i in this.terminals)\n      this.terminalColors[this.terminals[i].ID] = this.terminals[i].color\n  }\n\n  propagateColors(): void {\n    this.resetColors()\n\n    for (let iter = 0; iter < 16; iter++) {\n      for (const i in this.lines) {\n        const line = this.lines[i]\n        const first = line.pos[0]\n        const last = line.pos[line.pos.length - 1]\n\n        const p1 = this.getPointAt(first[0], first[1])\n        const p2 = this.getPointAt(last[0], last[1])\n        if (!p1 || !p2) continue\n\n        const c1 = p1.isTerminal\n          ? (this.terminalColors[p1.id] ?? this.terminals[p1.id].color)\n          : this.padColors[p1.id]\n        const c2 = p2.isTerminal\n          ? (this.terminalColors[p2.id] ?? this.terminals[p2.id].color)\n          : this.padColors[p2.id]\n\n        if (c1 !== 'white' && c2 !== 'white') {\n          if (c1 === c2) this.lineColors[line.ID] = c1\n        } else {\n          if (c1 !== 'white') {\n            this.lineColors[line.ID] = c1\n            if (!p1.isTerminal) this.padColors[p1.id] = c1\n            if (!p2.isTerminal) this.padColors[p2.id] = c1\n          } else {\n            this.lineColors[line.ID] = c2\n            if (!p1.isTerminal) this.padColors[p1.id] = c2\n            if (!p2.isTerminal) this.padColors[p2.id] = c2\n          }\n        }\n      }\n    }\n\n    this._renderScene()\n  }\n\n  // -- Completion check --\n\n  checkCompletion(): void {\n    let completed = true\n\n    for (const i in this.terminals) {\n      const term = this.terminals[i]\n      const nConn = this.getLineCount(term.pos[0], term.pos[1])\n      if (nConn !== 1) completed = false\n    }\n\n    for (const i in this.pads) {\n      const pad = this.pads[i]\n      const nConn = this.getLineCount(pad.pos[0], pad.pos[1])\n      const nUnder = this.getUnderlineCount(pad.pos[0], pad.pos[1])\n      const pc = this.padColors[pad.ID] ?? 'white'\n      if (nConn !== 2 && pc !== 'white') completed = false\n      if (nConn !== 1 && nUnder !== 1 && pc !== 'white') completed = false\n    }\n\n    if (this.onComplete) {\n      this.onComplete(this.currentLevel, completed)\n    }\n  }\n\n  // -- Move finalisation --\n\n  finalizeMove(lineID: number): void {\n    this.save()\n    this.updateUndoStack()\n    this.checkLine(lineID)\n    this.propagateColors()\n    this.checkCompletion()\n  }\n\n  // -- Internal --\n\n  initScene(): void {\n    this.onInitScene?.()\n  }\n\n  private _renderScene(): void {\n    this.onRender?.()\n  }\n}\n","export const COLORS: Record<string, string> = {\n  white: '#ffffff',\n  red: '#e52800',\n  green: '#005923',\n  blue: '#06afff',\n  pink: '#ef47cc',\n  yellow: '#fec41a',\n  orange: '#ff6910',\n  purple: '#760281',\n  brown: '#820419',\n  grey: '#555555',\n  black: '#222222',\n}\n","import {\n  IoElement,\n  Register,\n  ReactiveProperty,\n  IoElementProps,\n  canvas,\n} from '@io-gui/core'\nimport { Game } from './game/game.js'\nimport { COLORS } from './game/colors.js'\nimport type { Pad } from './game/pad.js'\nimport type { Terminal } from './game/terminal.js'\nimport type { Line } from './game/line.js'\n/**\n * Scene — manages layered HTML5 canvases and renders the game state.\n *\n * Layer stack (bottom -> top):\n *   grid   – static grid lines (redrawn on initGrid)\n *   layer0 – grey \"underlines\"\n *   layer1 – coloured lines + pads\n *   top    – touch marker overlay\n */\n\ninterface CanvasLayer {\n  canvas: HTMLCanvasElement\n  ctx: CanvasRenderingContext2D\n}\n\nexport class Scene {\n  layers: Record<string, CanvasLayer> = {}\n  canvasWidth = 0\n  canvasHeight = 0\n  gridWidth = 0\n  gridHeight = 0\n  gridUnit = 0\n  gridOffsetX = 0\n  gridOffsetY = 0\n  markerRadius = 0\n\n  /** Set up layers from externally provided canvases. */\n  init(canvases: Record<string, HTMLCanvasElement>): void {\n    this.layers = {}\n    for (const name in canvases) {\n      const canvas = canvases[name]\n      const ctx = canvas.getContext('2d')!\n      this.layers[name] = { canvas, ctx }\n    }\n  }\n\n  /** Recalculate grid geometry and draw the static grid. */\n  initGrid(\n    gameWidth: number,\n    gameHeight: number,\n    containerWidth: number,\n    containerHeight: number,\n  ): void {\n    this.canvasWidth = containerWidth\n    this.canvasHeight = containerHeight\n    const dpr = window.devicePixelRatio || 1\n\n    for (const name in this.layers) {\n      const { canvas } = this.layers[name]\n      canvas.width = this.canvasWidth * dpr\n      canvas.height = this.canvasHeight * dpr\n      canvas.style.width = this.canvasWidth + 'px'\n      canvas.style.height = this.canvasHeight + 'px'\n      this.layers[name].ctx.setTransform(dpr, 0, 0, dpr, 0, 0)\n    }\n\n    this.gridWidth = gameWidth\n    this.gridHeight = gameHeight\n\n    // Calculate unit size so the grid fits with a half-unit margin\n    if (\n      this.canvasHeight / this.gridHeight >\n      this.canvasWidth / this.gridWidth\n    ) {\n      this.gridUnit = this.canvasWidth / (this.gridWidth + 1)\n    } else {\n      this.gridUnit = this.canvasHeight / (this.gridHeight + 1)\n    }\n\n    this.gridOffsetX = (this.canvasWidth - this.gridUnit * this.gridWidth) / 2\n    this.gridOffsetY =\n      (this.canvasHeight - this.gridUnit * this.gridHeight) / 2\n\n    // --- Draw static grid ---\n    const ctx = this.layers.grid.ctx\n    ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n\n    ctx.fillStyle = 'rgba(255,255,255,0.2)'\n    ctx.fillRect(\n      this.gridOffsetX,\n      this.gridOffsetY,\n      this.gridWidth * this.gridUnit,\n      this.gridHeight * this.gridUnit,\n    )\n\n    ctx.strokeStyle = 'rgba(255,255,255,0.5)'\n    ctx.lineWidth = 1\n\n    for (let i = 0; i <= gameWidth; i++) {\n      const x = i * this.gridUnit + this.gridOffsetX\n      ctx.beginPath()\n      ctx.moveTo(x, this.gridOffsetY)\n      ctx.lineTo(x, this.gridHeight * this.gridUnit + this.gridOffsetY)\n      ctx.stroke()\n    }\n\n    for (let j = 0; j <= gameHeight; j++) {\n      const y = j * this.gridUnit + this.gridOffsetY\n      ctx.beginPath()\n      ctx.moveTo(this.gridOffsetX, y)\n      ctx.lineTo(this.gridWidth * this.gridUnit + this.gridOffsetX, y)\n      ctx.stroke()\n    }\n\n    this.markerRadius = this.canvasWidth * 0.1\n  }\n\n  // -- Rendering --\n\n  /** Full re-render of lines, pads and terminals on the dynamic layers. */\n  render(\n    pads: Record<number, Pad>,\n    terminals: Record<number, Terminal>,\n    lines: Record<number, Line>,\n    padColors: Record<number, string> = {},\n    terminalColors: Record<number, string> = {},\n    lineColors: Record<number, string> = {},\n  ): void {\n    const ctx0 = this.layers.layer0?.ctx\n    const ctx1 = this.layers.layer1?.ctx\n    if (!ctx0 || !ctx1) return\n\n    ctx0.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n    ctx1.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n\n    for (const id in lines) this._drawLineStroke(lines[id])\n    for (const id in pads) this._drawPadStroke(pads[id])\n    for (const id in terminals) this._drawTerminalStroke(terminals[id])\n\n    for (const id in lines)\n      this._drawLineFill(\n        lines[id],\n        lineColors[lines[id].ID] ?? lines[id].color,\n      )\n    for (const id in pads)\n      this._drawPadFill(pads[id], padColors[pads[id].ID] ?? 'white')\n    for (const id in terminals)\n      this._drawTerminalFill(\n        terminals[id],\n        terminalColors[terminals[id].ID] ?? terminals[id].color,\n      )\n  }\n\n  // -- Line drawing helpers --\n\n  private _lineParams(line: Line) {\n    const isGrey = line.color === 'grey'\n    let radius = this.gridUnit / 4\n    let strokeW = 3\n    let strokeColor = 'rgba(0,0,0,1)'\n    let opacity = 1\n\n    if (isGrey) {\n      radius *= 1.4\n      strokeW *= 4\n      strokeColor = 'rgba(128,128,128,0.25)'\n      opacity = 0.25\n    }\n\n    return {\n      ctx: isGrey ? this.layers.layer0.ctx : this.layers.layer1.ctx,\n      radius,\n      strokeW,\n      strokeColor,\n      opacity,\n    }\n  }\n\n  private _buildLinePath(\n    ctx: CanvasRenderingContext2D,\n    positions: [number, number][],\n  ): void {\n    ctx.beginPath()\n    for (let i = 0; i < positions.length; i++) {\n      const x = positions[i][0] * this.gridUnit + this.gridOffsetX\n      const y = positions[i][1] * this.gridUnit + this.gridOffsetY\n      if (i === 0) ctx.moveTo(x, y)\n      else ctx.lineTo(x, y)\n    }\n  }\n\n  private _drawLineStroke(line: Line): void {\n    if (line.pos.length < 2) return\n    const p = this._lineParams(line)\n    p.ctx.save()\n    p.ctx.globalAlpha = p.opacity\n    p.ctx.lineCap = 'round'\n    p.ctx.lineJoin = 'round'\n    this._buildLinePath(p.ctx, line.pos)\n    p.ctx.strokeStyle = p.strokeColor\n    p.ctx.lineWidth = p.radius + p.strokeW * 2\n    p.ctx.stroke()\n    p.ctx.restore()\n  }\n\n  private _drawLineFill(line: Line, color: string): void {\n    if (line.pos.length < 2) return\n    const p = this._lineParams(line)\n    p.ctx.save()\n    p.ctx.globalAlpha = p.opacity\n    p.ctx.lineCap = 'round'\n    p.ctx.lineJoin = 'round'\n    this._buildLinePath(p.ctx, line.pos)\n    p.ctx.strokeStyle = COLORS[color] ?? '#fff'\n    p.ctx.lineWidth = p.radius\n    p.ctx.stroke()\n    p.ctx.restore()\n  }\n\n  // -- Pad drawing helpers (pads are always white circles) --\n\n  private _drawPadStroke(pad: Pad): void {\n    const ctx = this.layers.layer1.ctx\n    const xx = pad.pos[0] * this.gridUnit + this.gridOffsetX\n    const yy = pad.pos[1] * this.gridUnit + this.gridOffsetY\n    const r = this.gridUnit / 3\n    const sw = 3\n    ctx.beginPath()\n    ctx.arc(xx, yy, r + sw, 0, Math.PI * 2)\n    ctx.fillStyle = 'rgba(0,0,0,1)'\n    ctx.fill()\n  }\n\n  private _drawPadFill(pad: Pad, color: string): void {\n    const ctx = this.layers.layer1.ctx\n    const xx = pad.pos[0] * this.gridUnit + this.gridOffsetX\n    const yy = pad.pos[1] * this.gridUnit + this.gridOffsetY\n    const r = this.gridUnit / 3\n    ctx.beginPath()\n    ctx.arc(xx, yy, r, 0, Math.PI * 2)\n    ctx.fillStyle = COLORS[color] ?? '#fff'\n    ctx.fill()\n  }\n\n  // -- Terminal drawing helpers (terminals are colored squares) --\n\n  private _drawTerminalStroke(terminal: Terminal): void {\n    const ctx = this.layers.layer1.ctx\n    const xx = terminal.pos[0] * this.gridUnit + this.gridOffsetX\n    const yy = terminal.pos[1] * this.gridUnit + this.gridOffsetY\n    const r = this.gridUnit / 3\n    const sw = 3\n    ctx.fillStyle = 'rgba(0,0,0,1)'\n    ctx.fillRect(xx - r - sw, yy - r - sw, (r + sw) * 2, (r + sw) * 2)\n  }\n\n  private _drawTerminalFill(terminal: Terminal, color: string): void {\n    const ctx = this.layers.layer1.ctx\n    const xx = terminal.pos[0] * this.gridUnit + this.gridOffsetX\n    const yy = terminal.pos[1] * this.gridUnit + this.gridOffsetY\n    const r = this.gridUnit / 3\n    ctx.fillStyle = COLORS[color] ?? '#fff'\n    ctx.fillRect(xx - r, yy - r, r * 2, r * 2)\n  }\n\n  // -- Touch marker --\n\n  drawMarker(touchX: number, touchY: number): void {\n    const ctx = this.layers.top?.ctx\n    if (!ctx) return\n    ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n    const xx = touchX * this.gridUnit + this.gridOffsetX\n    const yy = touchY * this.gridUnit + this.gridOffsetY\n    ctx.beginPath()\n    ctx.arc(xx, yy, this.markerRadius, 0, Math.PI * 2)\n    ctx.fillStyle = 'rgba(255,255,255,0.05)'\n    ctx.fill()\n  }\n\n  hideMarker(): void {\n    const ctx = this.layers.top?.ctx\n    if (!ctx) return\n    ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n  }\n}\n\ntype CircuitsBoardProps = IoElementProps & {\n  game?: Game\n}\n\n/**\n * CircuitsBoard — canvas-based game board IoElement.\n * Owns the Scene, creates 4 layered canvases, handles pointer events,\n * and translates screen coordinates to grid positions (plotter logic).\n */\nexport class CircuitsBoard extends IoElement {\n  static get Style() {\n    return /* css */ `\n      :host {\n        flex: 1;\n        position: relative;\n        background: rgba(0, 0, 0, 0.8);\n        border: 1px solid #99f;\n        border-radius: 12px;\n        margin: 2px;\n        overflow: hidden;\n        touch-action: none;\n      }\n      :host > canvas {\n        position: absolute;\n        top: 0;\n        left: 0;\n      }\n    `\n  }\n\n  static get Listeners(): Record<string, string> {\n    return {\n      pointerdown: 'onPointerdown',\n    }\n  }\n\n  @ReactiveProperty({ type: Game })\n  declare game: Game\n\n  @ReactiveProperty({ type: Scene, init: null })\n  declare scene: Scene\n\n  // Plotter state\n  private _touchX = 0\n  private _touchY = 0\n  private _gridX = 0\n  private _gridY = 0\n  private _gridXOld = 0\n  private _gridYOld = 0\n  private _drag = false\n  private _randomID = 0\n\n  constructor(args: CircuitsBoardProps = {}) {\n    super(args)\n  }\n\n  ready() {\n    this.changed()\n  }\n\n  changed() {\n    this.render([\n      canvas({ id: 'grid', style: { zIndex: '100' } }),\n      canvas({ id: 'layer0', style: { zIndex: '101' } }),\n      canvas({ id: 'layer1', style: { zIndex: '102' } }),\n      canvas({ id: 'top', style: { zIndex: '105' } }),\n    ])\n    this._initScene()\n  }\n\n  onResized() {\n    this._initScene()\n  }\n\n  private _initScene(): void {\n    const grid = this.querySelector('#grid') as HTMLCanvasElement\n    const layer0 = this.querySelector('#layer0') as HTMLCanvasElement\n    const layer1 = this.querySelector('#layer1') as HTMLCanvasElement\n    const top = this.querySelector('#top') as HTMLCanvasElement\n    if (!grid || !layer0 || !layer1 || !top) return\n\n    this.scene.init({ grid, layer0, layer1, top })\n\n    const rect = this.getBoundingClientRect()\n    if (rect.width === 0 || rect.height === 0) return\n\n    if (this.game) {\n      this._wireGameCallbacks()\n      this.scene.initGrid(\n        this.game.width,\n        this.game.height,\n        rect.width,\n        rect.height,\n      )\n      this.scene.render(\n        this.game.pads,\n        this.game.terminals,\n        this.game.lines,\n        this.game.padColors,\n        this.game.terminalColors,\n        this.game.lineColors,\n      )\n    }\n  }\n\n  gameChanged() {\n    this._wireGameCallbacks()\n    this._initScene()\n  }\n\n  private _wireGameCallbacks(): void {\n    if (!this.game) return\n    this.game.onInitScene = () => {\n      const rect = this.getBoundingClientRect()\n      if (rect.width === 0 || rect.height === 0) return\n      this.scene.initGrid(\n        this.game.width,\n        this.game.height,\n        rect.width,\n        rect.height,\n      )\n      this.scene.render(\n        this.game.pads,\n        this.game.terminals,\n        this.game.lines,\n        this.game.padColors,\n        this.game.terminalColors,\n        this.game.lineColors,\n      )\n    }\n    this.game.onRender = () => {\n      this.scene.render(\n        this.game.pads,\n        this.game.terminals,\n        this.game.lines,\n        this.game.padColors,\n        this.game.terminalColors,\n        this.game.lineColors,\n      )\n    }\n  }\n\n  onPointerdown(event: PointerEvent) {\n    event.preventDefault()\n    this.setPointerCapture(event.pointerId)\n    this.addEventListener('pointermove', this.onPointermove)\n    this.addEventListener('pointerup', this.onPointerup)\n\n    this._randomID = Math.floor(Math.random() * 100000)\n    this._drag = true\n    this._initPosition(event)\n    this.scene.drawMarker(this._touchX, this._touchY)\n\n    if (!this.game) return\n\n    if (this.game.drawMode === 'pad') {\n      this.game.addPad(this._randomID, this._gridX, this._gridY)\n    }\n    if (this.game.drawMode === 'terminal') {\n      this.game.addTerminal(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawColor,\n      )\n    }\n    if (this.game.drawMode === 'line') {\n      this.game.addLine(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawColor,\n      )\n    }\n    if (this.game.drawMode === 'delete') {\n      this.game.deletePad(this._gridX, this._gridY)\n      this.game.deleteTerminal(this._gridX, this._gridY)\n      this.game.deleteLine(this._gridX, this._gridY)\n    }\n  }\n\n  onPointermove(event: PointerEvent) {\n    event.preventDefault()\n    this._updatePosition(event)\n    this.scene.drawMarker(this._touchX, this._touchY)\n\n    if (!this.game) return\n\n    if (\n      this.game.drawMode === 'line' &&\n      this._drag &&\n      (this._gridX !== this._gridXOld || this._gridY !== this._gridYOld)\n    ) {\n      const endDrag = this.game.addLine(\n        this._randomID,\n        this._gridX,\n        this._gridY,\n        this.game.drawColor,\n      )\n      if (endDrag) this._drag = false\n    }\n  }\n\n  onPointerup(event: PointerEvent) {\n    event.preventDefault()\n    this.releasePointerCapture(event.pointerId)\n    this.removeEventListener('pointermove', this.onPointermove)\n    this.removeEventListener('pointerup', this.onPointerup)\n\n    this._drag = false\n    this.scene.hideMarker()\n\n    if (!this.game) return\n\n    this.game.finalizeMove(this._randomID)\n  }\n\n  private _initPosition(event: PointerEvent): void {\n    const rect = this.getBoundingClientRect()\n\n    this._touchX =\n      (event.clientX - rect.left - this.scene.gridOffsetX) /\n      this.scene.gridUnit\n    this._touchY =\n      (event.clientY - rect.top - this.scene.gridOffsetY) / this.scene.gridUnit\n\n    this._gridX = Math.round(this._touchX)\n    this._gridY = Math.round(this._touchY)\n    this._gridXOld = this._gridX\n    this._gridYOld = this._gridY\n  }\n\n  private _updatePosition(event: PointerEvent): void {\n    const rect = this.getBoundingClientRect()\n\n    this._touchX =\n      (event.clientX - rect.left - this.scene.gridOffsetX) /\n      this.scene.gridUnit\n    this._touchY =\n      (event.clientY - rect.top - this.scene.gridOffsetY) / this.scene.gridUnit\n\n    const distance = Math.sqrt(\n      Math.pow(this._touchX - Math.round(this._touchX), 2) +\n        Math.pow(this._touchY - Math.round(this._touchY), 2),\n    )\n\n    if (!this.game) return\n\n    if (\n      distance < 0.5 &&\n      this._touchX <= this.game.width + 0.5 &&\n      this._touchY <= this.game.height + 0.5 &&\n      this._touchX >= -0.5 &&\n      this._touchY >= -0.5\n    ) {\n      this._gridXOld = this._gridX\n      this._gridYOld = this._gridY\n\n      this._gridX = Math.round(this._touchX)\n      this._gridY = Math.round(this._touchY)\n\n      if (this._gridX > this._gridXOld) this._gridX = this._gridXOld + 1\n      if (this._gridX < this._gridXOld) this._gridX = this._gridXOld - 1\n      if (this._gridY > this._gridYOld) this._gridY = this._gridYOld + 1\n      if (this._gridY < this._gridYOld) this._gridY = this._gridYOld - 1\n    }\n  }\n}\nRegister(CircuitsBoard)\nexport const circuitsBoard = function (arg0: CircuitsBoardProps) {\n  return CircuitsBoard.vConstructor(arg0)\n}\n","import { IoElement, Register, ReactiveProperty, IoElementProps, div, WithBinding } from '@io-gui/core'\nimport { ioButton } from '@io-gui/inputs'\nimport { Game } from './game/game.js'\nimport { circuitsBoard } from './CircuitsBoard.js'\n\ntype CircuitsGameProps = IoElementProps & {\n  level: WithBinding<string>\n  game: Game\n}\n\nexport class CircuitsGame extends IoElement {\n  static get Style() {\n    return /* css */`\n      :host {\n        display: flex;\n        flex-direction: column;\n        height: 100%;\n      }\n      :host > .game-toolbar {\n        display: flex;\n        gap: 2px;\n        padding: 2px;\n        flex-shrink: 0;\n      }\n    `\n  }\n\n  @ReactiveProperty({value: '', type: String})\n  declare level: string\n\n  @ReactiveProperty({type: Game, init: null})\n  declare game: Game\n\n  saveFn: ((level: string, json: string) => void) | null = null\n  completeFn: ((level: string, completed: boolean) => void) | null = null\n\n  constructor(args: CircuitsGameProps) { super(args) }\n\n  ready() {\n    this.game.onSave = (level: string, json: string) => {\n      if (this.saveFn) this.saveFn(level, json)\n    }\n    this.game.onComplete = (level: string, completed: boolean) => {\n      if (this.completeFn) this.completeFn(level, completed)\n    }\n    this.changed()\n  }\n\n  changed() {\n    this.render([\n      div({class: 'game-toolbar'}, [\n        ioButton({label: 'Undo', action: this.onUndo}),\n        ioButton({label: 'Edit', action: this.onEdit}),\n        ioButton({label: 'Reset', action: this.onReset}),\n        ioButton({label: 'Redo', action: this.onRedo}),\n        ioButton({label: 'Back', action: this.onBack}),\n      ]),\n      circuitsBoard({id: 'board', game: this.game}),\n    ])\n  }\n\n  levelChanged() {\n    if (!this.level) {\n      this.game.clear()\n      return\n    }\n    const savedState = localStorage.getItem(this.level) || undefined\n    this.game.load(this.level, savedState)\n    const board = this.querySelector('circuits-board') as IoElement | null\n    if (board) (board as any).gameChanged()\n  }\n\n  onUndo() {\n    this.game.undo()\n  }\n\n  onRedo() {\n    this.game.redo()\n  }\n\n  onReset() {\n    void this.game.reset(this.level)\n  }\n\n  onEdit() {\n    this.changed()\n  }\n\n  onBack() {\n    this.dispatch('back-to-levels', undefined, true)\n  }\n}\n\nRegister(CircuitsGame)\n\nexport const circuitsGame = function(arg0: CircuitsGameProps) {\n  return CircuitsGame.vConstructor(arg0)\n}\n","import { IoElement, Register } from '@io-gui/core'\nimport { ioButton } from '@io-gui/inputs'\nimport type { DrawMode } from './game/game.js'\n\nconst TERMINAL_COLORS = [\n  'red',\n  'green',\n  'blue',\n  'pink',\n  'yellow',\n  'orange',\n  'purple',\n  'brown',\n  'grey',\n  'black',\n] as const\n\n@Register\nexport class CircuitsEditor extends IoElement {\n  static get Style() {\n    return /* css */ `\n      :host {\n        display: flex;\n        flex-direction: column;\n        background: rgba(0, 0, 0, 0.85);\n        align-items: center;\n        justify-content: center;\n        flex: 1 1 auto;\n        gap: 4px;\n        padding: 8px;\n      }\n      :host > io-button {\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: center;\n        width: 100%;\n      }\n    `\n  }\n\n  ready() {\n    this.changed()\n  }\n\n  changed() {\n    this.render([\n      ioButton({ label: 'Pad', action: () => this._select('pad', 'white') }),\n      ...TERMINAL_COLORS.map((c) =>\n        ioButton({ label: c, action: () => this._select('terminal', c) }),\n      ),\n      this._modeButton('Line W', 'line', 'white'),\n      this._modeButton('Line G', 'line', 'grey'),\n      this._modeButton('Delete', 'delete', 'red'),\n    ])\n  }\n\n  private _modeButton(label: string, mode: DrawMode, color: string) {\n    return ioButton({ label, action: () => this._select(mode, color) })\n  }\n\n  private _select(mode: DrawMode, color: string) {\n    this.dispatch('editor-select', { mode, color }, true)\n  }\n}\n\nexport const circuitsEditor = CircuitsEditor.vConstructor\n","import {\n  Register,\n  IoElement,\n  ReactiveProperty,\n  Storage as $,\n  ListenerDefinitions,\n} from '@io-gui/core'\nimport { ioSplit, Split } from '@io-gui/layout'\n\nimport { circuitsLevels } from './CircuitsLevels.js'\nimport { circuitsGame } from './CircuitsGame.js'\nimport { circuitsEditor } from './CircuitsEditor.js'\nimport { Game } from './game/game.js'\n\n$.permit()\nconst $level = $({ key: 'level', storage: 'hash', value: '' })\n\n@Register\nexport class CircuitsApp extends IoElement {\n  static get Style() {\n    return /* css */ `\n      :host {\n        display: flex;\n        position: fixed;\n        inset: 0;\n        background-color: var(--io_bgColor);\n        color: var(--io_color);\n        user-select: none;\n        -webkit-user-select: none;\n        -webkit-text-size-adjust: none;\n        -webkit-touch-callout: none;\n      }\n    `\n  }\n\n  @ReactiveProperty({ type: Game, init: null })\n  declare game: Game\n\n  static get Listeners(): ListenerDefinitions {\n    return {\n      'level-select': 'onLevelSelect',\n      'editor-select': 'onEditorSelect',\n    }\n  }\n\n  ready() {\n    this.render([\n      ioSplit({\n        split: new Split({\n          type: 'split',\n          children: [\n            { type: 'panel', flex: '0 0 110px', tabs: [{ id: 'levels' }] },\n            { type: 'panel', flex: '1 1 auto', tabs: [{ id: 'game' }] },\n            { type: 'panel', flex: '0 0 120px', tabs: [{ id: 'editor' }] },\n          ],\n        }),\n        elements: [\n          circuitsLevels({ id: 'levels' }),\n          circuitsGame({ id: 'game', level: $level, game: this.game }),\n          circuitsEditor({ id: 'editor' }),\n        ],\n      }),\n    ])\n  }\n\n  onEditorSelect(event: CustomEvent) {\n    event.stopPropagation()\n    const { mode, color } = event.detail\n    this.game.drawMode = mode\n    this.game.drawColor = color\n    this.changed()\n  }\n\n  onLevelSelect(event: CustomEvent) {\n    event.stopPropagation()\n    const { level } = event.detail\n    $level.value = level\n  }\n}\n"],"names":["CircuitsLevels","IoElement","Style","_option","MenuOption","id","options","ready","this","_loadLevels","changed","response","fetch","levelIds","json","map","action","dispatch","level","render","ioMenuTree","option","__decorateClass","Register","circuitsLevels","vConstructor","Pad","ID","pos","constructor","toJSON","fromJSON","data","Terminal","color","Line","readonly","addSegment","x","y","_checkErase","_checkDirection","push","removeLast","pop","line","j","length","ln","Math","abs","last","Game","width","height","pads","terminals","lines","padColors","terminalColors","lineColors","drawMode","drawColor","undoStack","redoStack","currentLevel","onSave","onComplete","onInitScene","onRender","init","_renderScene","load","savedState","save","updateUndoStack","propagateColors","reset","clear","resp","ok","Error","text","i","e","console","warn","jsonText","state","JSON","parse","legacyPads","p","t","l","initScene","stringify","_cleanPads","_cleanTerminals","_cleanLines","Object","values","undo","checkCompletion","redo","getPointAt","isTerminal","addPad","addTerminal","deletePad","deleteTerminal","addLine","point","pointColor","lineCount","getLineCount","connectionLimit","_checkCrossing","lineColor","endDrag","getLineColor","count","getUnderlineCount","checkLine","first","p1","p2","deleteLine","mx","my","other","resetColors","iter","c1","c2","completed","term","pad","nConn","nUnder","pc","finalizeMove","lineID","COLORS","white","red","green","blue","pink","yellow","orange","purple","brown","grey","black","CircuitsBoard","Listeners","pointerdown","_touchX","_touchY","_gridX","_gridY","_gridXOld","_gridYOld","_drag","_randomID","args","super","canvas","style","zIndex","_initScene","onResized","grid","querySelector","layer0","layer1","top","scene","rect","getBoundingClientRect","game","_wireGameCallbacks","initGrid","gameChanged","onPointerdown","event","preventDefault","setPointerCapture","pointerId","addEventListener","onPointermove","onPointerup","floor","random","_initPosition","drawMarker","_updatePosition","releasePointerCapture","removeEventListener","hideMarker","clientX","left","gridOffsetX","gridUnit","clientY","gridOffsetY","round","distance","sqrt","pow","ReactiveProperty","type","prototype","Scene","layers","canvasWidth","canvasHeight","gridWidth","gridHeight","markerRadius","canvases","name","ctx","getContext","gameWidth","gameHeight","containerWidth","containerHeight","dpr","window","devicePixelRatio","setTransform","clearRect","fillStyle","fillRect","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","ctx0","ctx1","_drawLineStroke","_drawPadStroke","_drawTerminalStroke","_drawLineFill","_drawPadFill","_drawTerminalFill","_lineParams","isGrey","radius","strokeW","strokeColor","opacity","_buildLinePath","positions","globalAlpha","lineCap","lineJoin","restore","xx","yy","r","arc","PI","fill","terminal","touchX","touchY","CircuitsGame","saveFn","completeFn","arg0","div","class","ioButton","label","onUndo","onEdit","onReset","onRedo","onBack","levelChanged","localStorage","getItem","board","value","String","TERMINAL_COLORS","CircuitsEditor","_select","c","_modeButton","mode","circuitsEditor","$","permit","$level","key","storage","CircuitsApp","ioSplit","split","Split","children","flex","tabs","elements","onEditorSelect","stopPropagation","detail","onLevelSelect"],"mappings":"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"}