import{ReactiveProperty,Register,ReactiveNode,NodeArray,IoElement,input,li,div,label,button,section,ul,span,a,Storage,header,h1,p}from"@io-gui/core";var __defProp$6=Object.defineProperty,__decorateClass$6=(decorators,target,key,kind)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);return result&&__defProp$6(target,key,result),result};class TodoItemModel extends ReactiveNode{toggle=()=>{this.completed=!this.completed};delete=()=>{this.dispatch("delete-item",{item:this},!0)};toJSON(){return{title:this.title,completed:this.completed}}fromJSON(json){return this.setProperties({title:json.title??"",completed:json.completed??!1}),this}}__decorateClass$6([ReactiveProperty({type:String})],TodoItemModel.prototype,"title"),__decorateClass$6([ReactiveProperty({type:Boolean})],TodoItemModel.prototype,"completed"),Register(TodoItemModel);var __defProp$5=Object.defineProperty;class TodoListModel extends ReactiveNode{static get Listeners(){return{"delete-item":"onDeleteItem"}}onDeleteItem(event){const item=event.path[0],index=this.items.indexOf(item);this.items.splice(index,1)}get filters(){return{all:()=>!0,active:item=>!item.completed,completed:item=>item.completed}}get count(){return this.items.length}get completedCount(){return this.items.filter(item=>item.completed).length}get activeCount(){return this.items.filter(item=>!item.completed).length}get allCompleted(){return this.items.every(item=>item.completed)}constructor(args){(args={...args}).items=args.items.map(item=>new TodoItemModel({...item})),super(args)}completeAll=()=>{this.items.forEach(item=>item.completed=!0)};clearCompleted=()=>{this.items=this.items.filter(item=>!item.completed)};itemsMutated(){this.dispatchMutation()}toJSON(){return{items:this.items.map(item=>item.toJSON())}}fromJSON(json){return this.setProperties({items:json.items.map(item=>new TodoItemModel(item))}),this}}((decorators,target,key)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);result&&__defProp$5(target,key,result)})([ReactiveProperty({type:NodeArray,init:"this"})],TodoListModel.prototype,"items"),Register(TodoListModel);var __defProp$4=Object.defineProperty;class TodoInput extends IoElement{static get Style(){return"\n    :host {\n      display: contents;\n    }\n    "}constructor(args={}){super(args)}onInputKey(event){if("Enter"===event.key){const inputElement=this.$.input,title=String(inputElement.value).trim();title&&this.model.items.push(new TodoItemModel({title:title,completed:!1})),inputElement.value="",inputElement.focus()}if("Escape"===event.key){const inputElement=this.$.input;inputElement.value="",inputElement.focus()}}changed(){this.render([input({id:"input",class:"new-todo",placeholder:"What needs to be done?","@keyup":this.onInputKey,autofocus:!0})])}}((decorators,target,key)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);result&&__defProp$4(target,key,result)})([ReactiveProperty({type:TodoListModel})],TodoInput.prototype,"model"),Register(TodoInput);var __defProp$3=Object.defineProperty,__decorateClass$3=(decorators,target,key,kind)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);return result&&__defProp$3(target,key,result),result};class TodoItem extends IoElement{static get Style(){return"\n    :host {\n      display: contents;\n    }\n    "}$input;_originalTitle;constructor(args={}){super(args)}itemMutated(){this.changed()}changed(){this.render([li({class:"todo "+(this.item.completed?"completed ":"")+(this.editing?"editing":"")},[div({class:"view"},[input({type:"checkbox",class:"toggle",checked:this.item.completed,"@click":this.item.toggle}),label({"@dblclick":this.onStartEdit},this.item.title),button({class:"destroy","@click":this.item.delete})]),input({id:"input-"+this.item.title,class:"edit",value:this.item.title,"@blur":this.onBlur,"@keyup":this.onInputKey})])]),this.$input=this.querySelector("input.edit")}onStartEdit(){this.editing=!0,this._originalTitle=this.item.title,this.$input.focus()}onBlur(){const title=String(this.$input.value).trim();this.item.title=title||this._originalTitle,this.editing=!1}onInputKey(event){const keyboardEvent=event.detail;["Enter","Escape"].includes(keyboardEvent.key)&&this.$input.blur()}}__decorateClass$3([ReactiveProperty({type:TodoItemModel})],TodoItem.prototype,"item"),__decorateClass$3([ReactiveProperty({type:TodoListModel})],TodoItem.prototype,"model"),__decorateClass$3([ReactiveProperty({value:!1})],TodoItem.prototype,"editing"),Register(TodoItem);var __defProp$2=Object.defineProperty,__decorateClass$2=(decorators,target,key,kind)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);return result&&__defProp$2(target,key,result),result};class TodoList extends IoElement{static get Style(){return"\n      :host {\n        flex-direction: column;\n      }\n    "}constructor(args={}){super(args)}modelMutated(){this.changed()}changed(){const itemsInRoute=this.model.items.filter(this.model.filters[this.route]);this.render([section({class:"main"},[input({type:"checkbox",id:"toggle-all",class:"toggle-all",checked:this.model.allCompleted}),this.model.items.length&&!this.model.allCompleted?label({for:"toggle-all","@click":this.model.completeAll},"Mark all as complete"):null,ul({class:"todo-list"},itemsInRoute.map(item=>{return arg0={item:item,model:this.model},TodoItem.vConstructor(arg0);var arg0}))])])}}__decorateClass$2([ReactiveProperty({type:TodoListModel})],TodoList.prototype,"model"),__decorateClass$2([ReactiveProperty({value:"all"})],TodoList.prototype,"route"),Register(TodoList);const todoList=function(arg0){return TodoList.vConstructor(arg0)};var __defProp$1=Object.defineProperty,__decorateClass$1=(decorators,target,key,kind)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);return result&&__defProp$1(target,key,result),result};class TodoFooter extends IoElement{static get Style(){return"\n      :host a {\n        cursor: pointer;\n      }\n    "}constructor(args={}){super(args)}onRouteClicked(event){const target=event.target;this.route=target.innerText.toLowerCase()}modelMutated(){this.changed()}changed(){this.render([span({class:"todo-count"},String(this.model.activeCount)+(1===this.model.activeCount?" item":" items")+" left"),ul({class:"filters"},[li([a({"@click":this.onRouteClicked,class:"all"===this.route?"selected":""},"All")]),li([a({"@click":this.onRouteClicked,class:"active"===this.route?"selected":""},"Active")]),li([a({"@click":this.onRouteClicked,class:"completed"===this.route?"selected":""},"Completed")])]),this.model.completedCount?button({class:"clear-completed","@click":this.model.clearCompleted},"Clear completed"):null])}}__decorateClass$1([ReactiveProperty({type:TodoListModel})],TodoFooter.prototype,"model"),__decorateClass$1([ReactiveProperty({value:"all"})],TodoFooter.prototype,"route"),Register(TodoFooter);const todoFooter=function(arg0){return TodoFooter.vConstructor(arg0)};var __defProp=Object.defineProperty,__decorateClass=(decorators,target,key,kind)=>{for(var decorator,result=void 0,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=decorator(target,key,result)||result);return result&&__defProp(target,key,result),result};Storage.permit();const $route=Storage({key:"route",storage:"hash",value:"all"}),$model=Storage({key:"model",storage:"local",value:new TodoListModel({items:[]})});class TodoApp extends IoElement{ready(){this.changed()}modelMutated(){this.changed()}changed(){var arg0;this.render([section({class:"todoapp"},[header({class:"header"},[h1("todos"),(arg0={model:this.model},TodoInput.vConstructor(arg0))]),todoList({class:"todo-list",model:this.model,route:this.route}),this.model.count?todoFooter({class:"footer",model:this.model,route:this.bind("route")}):null]),div({class:"info"},[p("Double-click to edit a todo"),p([span("Created with "),a({href:"https://iogui.dev",target:"_blank"},"Io-Gui")]),p([span("Part of "),a({href:"http://todomvc.com/",target:"_blank"},"TodoMVC")])])])}}__decorateClass([ReactiveProperty($model)],TodoApp.prototype,"model"),__decorateClass([ReactiveProperty($route)],TodoApp.prototype,"route"),Register(TodoApp);
//# sourceMappingURL=index.js.map
