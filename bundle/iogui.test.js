import{IoNodeMixin,ProtoChain as ProtoChain$1,IoNode,IoElement,RegisterIoNode,PropertyDefinition,Property as Property$1,Binding as Binding$1,EventDispatcher as EventDispatcher$1,ChangeQueue as ChangeQueue$1,RegisterIoElement}from"./iogui.js";class Array1 extends Array{}class Array2 extends Array1{}class Array3 extends Array2{}class Object1$1{}class Object2 extends Object1$1{}class Object3 extends Object2{}class HTMLElement1 extends HTMLElement{}class HTMLElement2 extends HTMLElement1{}class HTMLElement3 extends HTMLElement2{}class IoNode1$1 extends IoNode{}class IoElement1 extends IoElement{}class IoNode2$1 extends IoNodeMixin(Object3){}class FakeIoNode1{static get Properties(){return{prop1:{notify:!1}}}static get Listeners(){return{listener1:"function1",listener2:"",listener3:["_function1",{capture:!0}],listener4:()=>{}}}static get Style(){return"a"}function1(){}onFunction1(){}_function1(){}}class FakeIoNode2 extends FakeIoNode1{function2(){}onFunction2(){}_function2(){}static get Properties(){return{prop1:{observe:!0},prop2:{}}}static get Listeners(){return{listener1:"_function2",listener2:["function2",{capture:!0,passive:!0}],listener3:["_function1",{passive:!0}]}}static get Style(){return"b"}}class FakeIoNode3 extends FakeIoNode2{}class ProtoChain{run(){describe("ProtoChain",()=>{it("Should include an array of all inherited constructors",()=>{var e=new ProtoChain$1(Array3).constructors;chai.expect(e[0]).to.be.equal(Array3),chai.expect(e[1]).to.be.equal(Array2),chai.expect(e[2]).to.be.equal(Array1),e=new ProtoChain$1(Object3).constructors,chai.expect(e[0]).to.be.equal(Object3),chai.expect(e[1]).to.be.equal(Object2),chai.expect(e[2]).to.be.equal(Object1$1),e=new ProtoChain$1(HTMLElement3).constructors,chai.expect(e[0]).to.be.equal(HTMLElement3),chai.expect(e[1]).to.be.equal(HTMLElement2),chai.expect(e[2]).to.be.equal(HTMLElement1),e=new ProtoChain$1(IoNode1$1).constructors,chai.expect(e[0]).to.be.equal(IoNode1$1),chai.expect(e[1]).to.be.equal(IoNode),e=new ProtoChain$1(IoElement1).constructors,chai.expect(e[0]).to.be.equal(IoElement1),chai.expect(e[1]).to.be.equal(IoElement),e=new ProtoChain$1(IoNode2$1).constructors,chai.expect(e[0]).to.be.equal(IoNode2$1)}),it("Should end constructor array at `IoNode.__proto__`, `HTMLElement`, `Object` or `Array`",()=>{var e=new ProtoChain$1(Array3).constructors;chai.expect(e[3]).to.be.equal(void 0),e=new ProtoChain$1(Object3).constructors,chai.expect(e[3]).to.be.equal(void 0),e=new ProtoChain$1(HTMLElement3).constructors,chai.expect(e[3]).to.be.equal(void 0),e=new ProtoChain$1(IoNode1$1).constructors,chai.expect(e[2]).to.be.equal(void 0),e=new ProtoChain$1(IoElement1).constructors,chai.expect(e[4]).to.be.equal(void 0),e=new ProtoChain$1(IoNode2$1).constructors,chai.expect(e[1]).to.be.equal(void 0)}),it('Should include an array of auto-binding functions starting with "on" or "_"',()=>{var e=new ProtoChain$1(FakeIoNode2);chai.expect(e.functions).to.be.eql(["onFunction2","_function2","onFunction1","_function1"])}),it("Should bind the auto-binding functions to specified instance with `.bindFunctions(node)` function",()=>{const e=new ProtoChain$1(FakeIoNode2);var t=new FakeIoNode2;e.bindFunctions(t),chai.expect(t.function1.name).to.be.equal("function1"),chai.expect(t.onFunction1.name).to.be.equal("bound onFunction1"),chai.expect(t._function1.name).to.be.equal("bound _function1"),chai.expect(t.function2.name).to.be.equal("function2"),chai.expect(t.onFunction2.name).to.be.equal("bound onFunction2"),chai.expect(t._function2.name).to.be.equal("bound _function2")}),it("Should include all declared properties correctly",()=>{var e=new ProtoChain$1(FakeIoNode2);chai.expect(Object.keys(e.properties)).to.be.eql(["prop1","prop2"]),chai.expect(e.properties).to.be.eql({prop1:{value:void 0,type:void 0,binding:void 0,notify:!1,reflect:0,observe:!0,readonly:!1,strict:!1,enumerable:!0},prop2:{value:void 0,type:void 0,binding:void 0,notify:!0,reflect:0,observe:!1,readonly:!1,strict:!1,enumerable:!0}})}),it("Should include all declared listeners correctly",()=>{var e=new ProtoChain$1(FakeIoNode2);chai.expect(Object.keys(e.listeners)).to.be.eql(["listener1","listener3","listener4","listener2"]),chai.expect(e.listeners.listener1).to.be.eql([["function1"],["_function2"]]),chai.expect(e.listeners.listener2).to.be.eql([["function2",{capture:!0,passive:!0}]]),chai.expect(e.listeners.listener3).to.be.eql([["_function1",{capture:!0,passive:!0}]])}),it("Should include all declared style strings correctly",()=>{var e=new ProtoChain$1(FakeIoNode3);chai.expect(e.style).to.be.equal("a\nb\n")}),it("Should include names of all observed object properties",()=>{var e=new ProtoChain$1(FakeIoNode2);chai.expect(e.observedObjects).to.be.eql(["prop1"])})})}}class Object1{prop=!0}class TestIoNode$1 extends IoNode{static get Properties(){return{label:""}}}RegisterIoNode(TestIoNode$1);class Property{run(){describe("Property",()=>{it("Should initialize correct values from weakly typed property definition",()=>{var e=new PropertyDefinition({}),t=new Property$1(e),o=(chai.expect(e).to.be.eql(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(null),t=new Property$1(e),chai.expect(e).to.be.eql(t).to.be.eql({value:null,type:void 0,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(void 0),t=new Property$1(e),chai.expect(e).to.be.eql(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(Number),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:0,type:Number,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({type:Number}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:0,type:Number,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(1),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:1,type:Number,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({value:2}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:2,type:Number,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(String),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:"",type:String,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({type:String}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:"",type:String,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition("test"),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:"test",type:String,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({value:"test"}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:"test",type:String,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(Boolean),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:!1,type:Boolean,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({type:Boolean}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:!1,type:Boolean,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(!0),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({value:!0}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(Object),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:{},type:Object,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({type:Object}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:{},type:Object,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),{prop:!0}),o=(e=new PropertyDefinition({value:o}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:{prop:!0},type:Object,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),chai.expect(e.value).to.equal(o),chai.expect(t.value).not.to.equal(o),e=new PropertyDefinition(Array),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:[],type:Array,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({type:Array}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:[],type:Array,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition(Object1),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:new Object1,type:Object1,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),[1,2,3]),o=(e=new PropertyDefinition({value:o}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:[1,2,3],type:Array,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),chai.expect(e.value).to.equal(o),chai.expect(t.value).not.to.equal(o),new Object1);e=new PropertyDefinition({value:o}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:new Object1,type:Object1,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),chai.expect(e.value).to.equal(o),chai.expect(t.value).not.to.equal(o),e=new PropertyDefinition({type:Object1}),t=new Property$1(e),chai.expect(t).to.be.eql(e).to.be.eql({value:{prop:!0},type:Object1,binding:void 0,reflect:0,notify:!0,observe:!1,readonly:!1,strict:!1,enumerable:!0}),e=new PropertyDefinition({reflect:-1,notify:!1,observe:!0,readonly:!0,strict:!0,enumerable:!1}),t=new Property$1(e),chai.expect(e).to.be.eql(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:-1,notify:!1,observe:!0,readonly:!0,strict:!0,enumerable:!1})}),it("Should initialize binding properly",()=>{var e=new Binding$1(new TestIoNode$1({label:"lorem"}),"label"),t=new PropertyDefinition(e),o=new Property$1(t),n=(chai.expect(t.binding).to.be.equal(o.binding).to.be.equal(e),chai.expect(t.value).to.be.equal("lorem"),chai.expect(o.value).to.be.equal("lorem"),new TestIoNode$1({label:"lorem"})),e=new Binding$1(n,"label");t=new PropertyDefinition({binding:e,value:"ipsum"}),o=new Property$1(t),chai.expect(t.binding).to.be.equal(o.binding).to.be.equal(e),chai.expect(t.value).to.be.equal("ipsum"),chai.expect(o.value).to.be.equal("lorem")})})}}class TestIoNode extends IoNode{static get Properties(){return{prop1:0,prop2:0}}}RegisterIoNode(TestIoNode);class Binding{run(){describe("Binding",()=>{it("Should initialize with correct default values",()=>{var e=new TestIoNode,t=new Binding$1(e,"prop1");chai.expect(t.node).to.be.equal(e),chai.expect(t.property).to.be.equal("prop1"),chai.expect(t.targets instanceof Array).to.be.equal(!0),chai.expect(t.targets.length).to.be.equal(0),chai.expect(t.targetProperties instanceof WeakMap).to.be.equal(!0)}),it("Should get and set property value on source node with `value` getter/setter",()=>{const e=new TestIoNode,t=new Binding$1(e,"prop1");e.prop1=1,chai.expect(t.value).to.be.equal(1),e.prop1=2,chai.expect(t.value).to.be.equal(2),t.value=3,chai.expect(e.prop1).to.be.equal(3)}),it("Should add/remove target nodes and properties with `.addTarget()` and `removeTarget()`",()=>{var e=new TestIoNode;const t=new Binding$1(e,"prop1"),o=new Binding$1(e,"prop2");var e=new TestIoNode,n=new TestIoNode,a=(t.addTarget(e,"prop1"),o.addTarget(e,"prop2"),o.addTarget(n,"prop1"),o.addTarget(n,"prop2"),chai.expect(t.targets[0]).to.be.equal(e),chai.expect(t.targets[1]).to.be.equal(void 0),chai.expect(o.targets[0]).to.be.equal(e),chai.expect(o.targets[1]).to.be.equal(n),chai.expect(o.targets[2]).to.be.equal(void 0),t.getTargetProperties(e)),i=t.getTargetProperties(n),a=(chai.expect(a[0]).to.be.equal("prop1"),chai.expect(a.length).to.be.equal(1),chai.expect(i.length).to.be.equal(0),o.getTargetProperties(e)),i=o.getTargetProperties(n);chai.expect(a[0]).to.be.equal("prop2"),chai.expect(a.length).to.be.equal(1),chai.expect(i[0]).to.be.equal("prop1"),chai.expect(i[1]).to.be.equal("prop2"),chai.expect(i.length).to.be.equal(2),o.removeTarget(n,"prop1"),chai.expect(i[0]).to.be.equal("prop2"),chai.expect(i.length).to.be.equal(1),o.addTarget(n,"prop1"),o.removeTarget(n),chai.expect(i.length).to.be.equal(0)}),it("Should dispose correctly",()=>{var e=new TestIoNode;const t=new Binding$1(e,"prop1");t.dispose(),chai.expect(t.node).to.be.equal(void 0),chai.expect(t.property).to.be.equal(void 0),chai.expect(t.targets).to.be.equal(void 0),chai.expect(t.targetProperties).to.be.equal(void 0)})})}}const handlerFunction=()=>{};class IoNode1 extends IoNode{handler1Count=0;handler1Detail;static get Listeners(){return{event1:"handler1"}}handler1(e){this.handler1Count++,this.handler1Detail=e.detail}}RegisterIoNode(IoNode1);class IoNode2 extends IoNode1{handler2Count=0;handler3Count=0;handler2Detail;handler3Detail;static get Listeners(){return{event2:["handler2",{capture:!0}]}}handler2(e){this.handler2Count++,this.handler2Detail=e.detail}handler3(e){this.handler3Count++,this.handler3Detail=e.detail}}RegisterIoNode(IoNode2);class IoNode3 extends IoNode2{static get Listeners(){return{event1:"handler3",event2:[handlerFunction,{passive:!0}],event3:handlerFunction}}}RegisterIoNode(IoNode3);class TestDivEventDispatchElement extends HTMLElement{handler3Count=0;handler3Detail;handler3(e){this.handler3Count++,this.handler3Detail=e.detail}}window.customElements.define("test-div-event-dispatch",TestDivEventDispatchElement);class EventDispatcher{run(){describe("EventDispatcher",()=>{it("Should initialize with correct default values",()=>{var e={},t=new EventDispatcher$1(e);chai.expect(t.node).to.be.equal(e),chai.expect(t.protoListeners).to.be.eql({}),chai.expect(t.propListeners).to.be.eql({}),chai.expect(t.addedListeners).to.be.eql({})}),it("Should initialize listeners from ProtoChain",()=>{var e=new IoNode1,t=new EventDispatcher$1(e);chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler1]]}),e=new IoNode2,t=new EventDispatcher$1(e),chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler1]],event2:[[e.handler2,{capture:!0}]]}),e=new IoNode3,t=new EventDispatcher$1(e),chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler1],[e.handler3]],event2:[[e.handler2,{capture:!0}],[handlerFunction,{passive:!0}]],event3:[[handlerFunction]]})}),it("Should set property listeners correctly",()=>{var e=new IoNode2;const t=new EventDispatcher$1(e);var o=()=>{},n=()=>{};t.setPropListeners({"on-event3":"handler3","on-event4":o}),chai.expect(t.propListeners).to.be.eql({event3:[[e.handler3]],event4:[[o]]}),t.setPropListeners({"on-event5":["handler3"],"on-event6":[o]}),chai.expect(t.propListeners).to.be.eql({event5:[[e.handler3]],event6:[[o]]}),t.setPropListeners({"on-event7":[e.handler3,{capture:!0}],"on-event8":[n,{capture:!0}]}),chai.expect(t.propListeners).to.be.eql({event7:[[e.handler3,{capture:!0}]],event8:[[n,{capture:!0}]]}),t.setPropListeners({}),chai.expect(t.propListeners).to.be.eql({})}),it("Should add/remove listeners correctly",()=>{var e=new IoNode2;const t=new EventDispatcher$1(e);var e=()=>{},o=()=>{};t.addEventListener("event1",e),t.addEventListener("event1",o,{capture:!0}),chai.expect(t.addedListeners).to.be.eql({event1:[[e],[o,{capture:!0}]]}),t.removeEventListener("event1",e),chai.expect(t.addedListeners).to.be.eql({event1:[[o,{capture:!0}]]}),t.removeEventListener("event1"),chai.expect(t.addedListeners).to.be.eql({})}),it("Should dispatch added events",()=>{var e=new IoNode2;const t=new EventDispatcher$1(e);let o=0;var n=()=>{o++};let a=0;var i=()=>{a++};t.setPropListeners({"on-event3":"handler3","on-event4":n}),t.addEventListener("event5",i),t.dispatchEvent("event1"),t.dispatchEvent("event2"),t.dispatchEvent("event3"),t.dispatchEvent("event4"),t.dispatchEvent("event5"),chai.expect(e.handler1Count).to.be.equal(1),chai.expect(e.handler2Count).to.be.equal(1),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(o).to.be.equal(1),chai.expect(a).to.be.equal(1),t.setPropListeners({"on-event4":n}),t.removeEventListener("event5",i),t.dispatchEvent("event1"),t.dispatchEvent("event2"),t.dispatchEvent("event3"),t.dispatchEvent("event4"),t.dispatchEvent("event5"),chai.expect(e.handler1Count).to.be.equal(2),chai.expect(e.handler2Count).to.be.equal(2),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(o).to.be.equal(2),chai.expect(a).to.be.equal(1)}),it("Should dispatch events with correct event detail",()=>{var e=new IoNode2;const t=new EventDispatcher$1(e);let o;let n;t.setPropListeners({"on-event3":"handler3","on-event4":e=>{o=e.detail}}),t.addEventListener("event5",e=>{n=e.detail}),t.dispatchEvent("event1","detail1"),t.dispatchEvent("event2","detail2"),t.dispatchEvent("event3","detail3"),t.dispatchEvent("event4","detail4"),t.dispatchEvent("event5","detail5"),chai.expect(e.handler1Detail).to.be.equal("detail1"),chai.expect(e.handler2Detail).to.be.equal("detail2"),chai.expect(e.handler3Detail).to.be.equal("detail3"),chai.expect(o).to.be.equal("detail4"),chai.expect(n).to.be.equal("detail5")}),it("Should add/remove/dispatch events on HTML elements",()=>{const e=document.createElement("test-div-event-dispatch"),t=new EventDispatcher$1(e);let o=0,n;let a=0,i;t.setPropListeners({"on-event3":"handler3","on-event4":e=>{o++,n=e.detail}}),t.addEventListener("event5",e=>{a++,i=e.detail}),e.dispatchEvent(new CustomEvent("event3",{detail:"detail3"})),e.dispatchEvent(new CustomEvent("event4",{detail:"detail4"})),e.dispatchEvent(new CustomEvent("event5",{detail:"detail5"})),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(o).to.be.equal(1),chai.expect(a).to.be.equal(1),chai.expect(e.handler3Detail).to.be.equal("detail3"),chai.expect(n).to.be.equal("detail4"),chai.expect(i).to.be.equal("detail5")}),it("Should dispose correctly",()=>{var e=new IoNode2;const t=new EventDispatcher$1(e);t.dispose(),chai.expect(t.node).to.be.equal(void 0),chai.expect(t.protoListeners).to.be.equal(void 0),chai.expect(t.propListeners).to.be.equal(void 0),chai.expect(t.addedListeners).to.be.equal(void 0)})})}}class FakeIoNode{connected=!0;prop1ChangeCounter=0;prop1Change;prop2ChangeCounter=0;prop2Change;changeCounter=0;applyComposeCounter=0;eventDispatchCounter=0;eventName;eventChange;eventRegister=[];changeRegister=[];prop1Changed(e){this.prop1Change=e,this.prop1ChangeCounter++,this.changeRegister.push("prop1Changed")}prop2Changed(e){this.prop2Change=e,this.prop2ChangeCounter++,this.changeRegister.push("prop2Changed")}dispatchEvent(e,t){this.eventDispatchCounter++,this.eventName=e,this.eventChange=t,this.eventRegister.push(e)}changed(){this.changeCounter++}applyCompose(){this.applyComposeCounter++}}class ChangeQueue{run(){describe("ChangeQueue",()=>{it("Should initialize with correct default values",()=>{var e=new FakeIoNode,t=new ChangeQueue$1(e);chai.expect(t.node).to.be.equal(e),chai.expect(JSON.stringify(t.changes)).to.be.equal("[]"),chai.expect(t.changes.length).to.be.equal(0),chai.expect(t.dispatching).to.be.equal(!1)}),it("Should dispatch change events with correct payloads",()=>{var e=new FakeIoNode;const t=new ChangeQueue$1(e);t.queue("test",1,0),t.queue("test",2,1),chai.expect(t.changes.length).to.be.equal(1),t.dispatch(),chai.expect(t.changes.length).to.be.equal(0),chai.expect(e.eventName).to.be.equal("test-changed"),chai.expect(e.eventChange?.property).to.be.equal("test"),chai.expect(e.eventChange?.value).to.be.equal(2),chai.expect(e.eventChange?.oldValue).to.be.equal(0),chai.expect(e.eventDispatchCounter).to.be.equal(1),chai.expect(e.changeCounter).to.be.equal(1),chai.expect(e.applyComposeCounter).to.be.equal(1),t.queue("test2",0,-1),t.queue("test3",2,1),chai.expect(t.changes.length).to.be.equal(2),t.dispatch(),chai.expect(t.changes.length).to.be.equal(0),chai.expect(e.eventName).to.be.equal("test2-changed"),chai.expect(e.eventChange?.property).to.be.equal("test2"),chai.expect(e.eventChange?.value).to.be.equal(0),chai.expect(e.eventChange?.oldValue).to.be.equal(-1),chai.expect(e.eventDispatchCounter).to.be.equal(3),chai.expect(e.prop1ChangeCounter).to.be.equal(0),chai.expect(e.changeCounter).to.be.equal(2),chai.expect(e.applyComposeCounter).to.be.equal(2)}),it("Should invoke handler functions with correct payloads",()=>{var e=new FakeIoNode;const t=new ChangeQueue$1(e);t.queue("prop1",1,0),t.queue("prop1",2,1),t.dispatch(),chai.expect(e.prop1ChangeCounter).to.be.equal(1),chai.expect(e.changeCounter).to.be.equal(1),chai.expect(e.applyComposeCounter).to.be.equal(1),chai.expect(e.prop1Change?.property).to.be.equal("prop1"),chai.expect(e.prop1Change?.value).to.be.equal(2),chai.expect(e.prop1Change?.oldValue).to.be.equal(0)}),it("Should handle changes in first-in, first-out (FIFO) order",()=>{var e=new FakeIoNode;const t=new ChangeQueue$1(e);t.queue("prop1",1,0),t.queue("prop1",3,0),t.queue("prop2",2,0),t.dispatch(),chai.expect(JSON.stringify(e.changeRegister)).to.be.equal('["prop2Changed","prop1Changed"]'),chai.expect(JSON.stringify(e.eventRegister)).to.be.equal('["prop2-changed","prop1-changed"]')}),it("Should skip dispatch if value is same as oldValue",()=>{var e=new FakeIoNode;const t=new ChangeQueue$1(e);t.queue("prop1",0,0),t.dispatch(),chai.expect(e.prop1ChangeCounter).to.be.equal(0)}),it("Should dispose correctly",()=>{var e=new FakeIoNode;const t=new ChangeQueue$1(e);t.dispose(),chai.expect(t.node).to.be.equal(void 0),chai.expect(t.changes).to.be.equal(void 0)})})}}mocha.setup("bdd");const mochaDiv=document.createElement("div");mochaDiv.setAttribute("id","mocha"),document.body.appendChild(mochaDiv);let testCompleted=!(mochaDiv.style.display="none");function runTests(){testCompleted||((new ProtoChain).run(),(new Property).run(),(new Binding).run(),(new EventDispatcher).run(),(new ChangeQueue).run(),mocha.checkLeaks(),mocha.run(),testCompleted=!0)}class IoTest extends IoElement{static get Style(){return`
      :host #mocha {
        margin: 0;
        position: relative;
      }
      :host #mocha-report {
        margin: 2em 1em;
      }
      :host #mocha-stats {
        position: absolute;
        top: -2em;
        right: 2em;
        font-size: 12px;
        margin: 0;
      }
      :host #mocha-stats em {
        color: var(--io-color);
      }
      :host #mocha-stats li {
        padding: 0;
      }
      :host #mocha-stats .progress {
        display: none;
      }
      :host #mocha-stats .passes {
        color: #0c0;
      }
      :host #mocha-stats .failures {
        color: #f00;
        font-weight: bold;
      }
      :host h2 {
        padding-right: 2em;
      }
      :host .replay {
        display: none !important;
      }
    `}connectedCallback(){super.connectedCallback(),runTests(),this.appendChild(mochaDiv),mochaDiv.style.display="block"}disconnectedCallback(){super.disconnectedCallback(),document.body.appendChild(mochaDiv),mochaDiv.style.display="none"}}RegisterIoElement(IoTest);export{IoTest};
