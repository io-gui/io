class ChangeQueue{hasChanged=!1;dispatching=!1;constructor(e){this.changes=[],this.node=e,this.dispatch=this.dispatch.bind(this)}queue(e,t,o){t===o&&console.warn("ChangeQueue: queuing change with same value and oldValue!");const n=this.changes.findIndex((t=>t.property===e));-1===n?this.changes.push({property:e,value:t,oldValue:o}):t===this.changes[n].oldValue?this.changes.splice(n,1):this.changes[n].value=t}dispatch(){if(!0!==this.dispatching){for(this.dispatching=!0,this.hasChanged=!1;this.changes.length;){const e=this.changes[0];this.changes.splice(0,1);const t=e.property;e.value!==e.oldValue&&(this.hasChanged=!0,this.node[t+"Changed"]&&this.node[t+"Changed"](e),this.node.dispatchEvent(t+"-changed",e))}this.hasChanged&&(this.node.changed(),this.node.dispatchEvent("object-mutated",{object:this.node})),this.dispatching=!1}else console.error("ChangeQueue: dispatching already in progress!")}dispose(){this.changes.length=0,delete this.node,delete this.changes}}const hardenListenerDefinition=e=>Array.isArray(e)?e:[e],e=["capture","passive"],listenerFromDefinition=(t,o)=>{const n=o[0],i=o[1];if("string"!=typeof n&&"function"!=typeof n&&console.error("listenerFromDefinition: Listener must be a function or method name"),i)if("object"!=typeof i)console.error("listenerFromDefinition: Listener options must be an object");else{const t=Object.keys(i).filter((t=>!e.includes(t)));t.length>0&&console.error(`listenerFromDefinition: Invalid listener options: ${t.join(", ")}`)}"string"!=typeof n||n in t||console.error(`listenerFromDefinition: Method "${n}" not found on node`);const r="string"==typeof n?t[n]:n;return i?[r,i]:[r]};class EventDispatcher{node;isEventTarget;protoListeners={};propListeners={};addedListeners={};constructor(e){this.node=e,this.isEventTarget=e instanceof EventTarget,this.setProtoListeners(e)}setProtoListeners(e){for(const t in e._protochain?.listeners){for(let o=0;o<e._protochain.listeners[t].length;o++){const n=listenerFromDefinition(e,e._protochain.listeners[t][o]);this.protoListeners[t]=[n]}if(this.isEventTarget&&this.protoListeners[t]){const e=this.protoListeners[t][0];EventTarget.prototype.addEventListener.call(this.node,t,e[0],e[1])}}}applyPropListeners(e){const t={};for(const o in e){if(!o.startsWith("@"))continue;const n=o.slice(1),i=hardenListenerDefinition(e[o]),r=listenerFromDefinition(this.node,i);t[n]=[r]}const o=this.propListeners;for(const e in o)if(!t[e]){if(this.isEventTarget){const t=o[e][0];EventTarget.prototype.removeEventListener.call(this.node,e,t[0],t[1])}delete o[e]}for(const e in t){if(this.isEventTarget){const n=t[e][0];if(o[e]){const t=o[e][0];(t!==n||n[1]&&JSON.stringify(t[1])!==JSON.stringify(n[1]))&&EventTarget.prototype.removeEventListener.call(this.node,e,t[0],t[1])}EventTarget.prototype.addEventListener.call(this.node,e,n[0],n[1])}o[e]=t[e]}}addEventListener(t,o,n){if("function"!=typeof o&&console.error("EventDispatcher.addEventListener: Invalid listener type - must be a function"),n)if("object"!=typeof n)console.error("EventDispatcher.addEventListener: Invalid listener options type - must be an object");else{const t=Object.keys(n).filter((t=>!e.includes(t)));t.length>0&&console.warn(`EventDispatcher.addEventListener: Invalid listener options: ${t.join(", ")}`)}this.addedListeners[t]||(this.addedListeners[t]=[]);if(-1!==this.addedListeners[t].findIndex((e=>e[0]===o)))return void console.warn(`EventDispatcher.addEventListener: Listener for '${t}' event already added`);const i=n?[o,n]:[o];this.addedListeners[t].push(i),this.isEventTarget&&EventTarget.prototype.addEventListener.call(this.node,t,o,n)}removeEventListener(t,o,n){if(o&&"function"!=typeof o&&console.error("EventDispatcher.removeEventListener: Invalid listener type!"),n)if("object"!=typeof n)console.error("EventDispatcher.removeEventListener: Invalid listener options type - must be an object");else{const t=Object.keys(n).filter((t=>!e.includes(t)));t.length>0&&console.warn(`EventDispatcher.removeEventListener: Invalid listener options: ${t.join(", ")}`)}if(this.addedListeners[t]||console.error(`EventDispatcher.removeEventListener: Listener ${t} not found!`),this.addedListeners[t]){if(o){const e=this.addedListeners[t].findIndex((e=>e[0]===o));-1===e&&console.error(`EventDispatcher.removeEventListener: Listener ${t} not found!`),-1!==e&&(this.addedListeners[t].splice(e,1),this.isEventTarget&&EventTarget.prototype.removeEventListener.call(this.node,t,o,n))}else{for(let e=0;e<this.addedListeners[t].length;e++)if(this.isEventTarget){const o=this.addedListeners[t][e];EventTarget.prototype.removeEventListener.call(this.node,t,o[0],o[1])}this.addedListeners[t].length=0}0===this.addedListeners[t].length&&delete this.addedListeners[t]}}dispatchEvent(e,t,o=!0,n=this.node){if(n instanceof EventTarget)EventTarget.prototype.dispatchEvent.call(n,new CustomEvent(e,{detail:t,bubbles:o,composed:!0,cancelable:!0}));else{const o={detail:t,target:n,path:[n]};if(this.protoListeners[e])for(let t=0;t<this.protoListeners[e].length;t++){this.protoListeners[e][t][0].call(n,o)}if(this.propListeners[e]){this.propListeners[e].length>1&&console.error(`EventDispatcher.dispathEvent: PropListeners[${e}] array too long!`);this.propListeners[e][0][0].call(n,o)}if(this.addedListeners[e])for(let t=0;t<this.addedListeners[e].length;t++){this.addedListeners[e][t][0].call(n,o)}}}dispose(){for(const e in this.protoListeners){if(this.isEventTarget)for(let t=0;t<this.protoListeners[e].length;t++){const o=this.protoListeners[e][t];EventTarget.prototype.removeEventListener.call(this.node,e,o[0],o[1])}this.protoListeners[e].length=0,delete this.protoListeners[e]}for(const e in this.propListeners){if(this.isEventTarget){const t=this.propListeners[e][0];EventTarget.prototype.removeEventListener.call(this.node,e,t[0],t[1])}this.propListeners[e].length=0,delete this.propListeners[e]}for(const e in this.addedListeners){if(this.isEventTarget)for(let t=this.addedListeners[e].length;t--;){const o=this.addedListeners[e][t];EventTarget.prototype.removeEventListener.call(this.node,e,o[0],o[1])}this.addedListeners[e].length=0,delete this.addedListeners[e]}delete this.node,delete this.protoListeners,delete this.propListeners,delete this.addedListeners}}const bothAreNaNs=function(e,t){return"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)};class Binding{node;property="";targets=[];targetProperties=new WeakMap;constructor(e,t){this.node=e,this.property=t,this.onSourceChanged=this.onSourceChanged.bind(this),this.onTargetChanged=this.onTargetChanged.bind(this),this.node.addEventListener(`${this.property}-changed`,this.onSourceChanged)}set value(e){this.node[this.property]=e}get value(){return this.node[this.property]}toJSON(){const e={};for(let t=0;t<this.targets.length;t++){const o=this.targets[t],n=this.getTargetProperties(o);e[o.constructor.name]=n}return{node:this.node.constructor.name,property:this.property,targets:this.targets.map((e=>e.constructor.name)),targetProperties:e}}getTargetProperties(e){return this.targetProperties.has(e)||this.targetProperties.set(e,[]),this.targetProperties.get(e)}addTarget(e,t){-1===this.targets.indexOf(e)&&this.targets.push(e);const o=this.getTargetProperties(e);if(-1===o.indexOf(t)){o.push(t);const n=e._properties.get(t);n.binding&&n.binding!==this&&(console.warn("Binding: improper usage detected!"),console.info("Binding: target property is already a target of another binding. Undinding previous binding!"),n.binding.removeTarget(e,t)),n.binding=this,e.addEventListener(`${t}-changed`,this.onTargetChanged),e.setProperty(t,this.node[this.property],!0)}else console.error("Binding: target property already added!")}removeTarget(e,t){const o=this.getTargetProperties(e);if(t){const n=o.indexOf(t);-1===n&&console.error("Binding: target property not found!"),o.splice(n,1);const i=e._properties.get(t);i.binding!==this&&console.error("Binding: target property has a different binding!"),i.binding=void 0,e.removeEventListener(`${t}-changed`,this.onTargetChanged)}else{for(let t=o.length;t--;){const n=o[t],i=e._properties.get(n);i.binding!==this&&console.error("Binding: target property has a different binding!"),i.binding=void 0,e.removeEventListener(`${n}-changed`,this.onTargetChanged)}o.length=0}0===o.length&&this.targets.splice(this.targets.indexOf(e),1)}onTargetChanged(e){-1===this.targets.indexOf(e.target)&&console.error("onTargetChanged() should never fire if target is not accounted for");const t=this.node[this.property],o=e.detail.value;if(t!==o){if(bothAreNaNs(o,t))return;this.node.setProperty(this.property,o)}}onSourceChanged(e){e.target!==this.node&&console.error("onSourceChanged() should always originate form source node.");const t=e.detail.value;for(let e=this.targets.length;e--;){const o=this.targets[e],n=this.getTargetProperties(o);for(let e=n.length;e--;){const i=n[e],r=o[i];if(r!==t){if(bothAreNaNs(t,r))continue;o.setProperty(i,t)}}}}dispose(){this.node.removeEventListener(`${this.property}-changed`,this.onSourceChanged);for(let e=this.targets.length;e--;)this.removeTarget(this.targets[e]);this.targets.length=0,delete this.node,delete this.property,delete this.targets,delete this.targetProperties}}class ProtoProperty{value;type;binding;reflect;init;constructor(e){if(null==e)this.value=e;else if("function"==typeof e)this.type=e;else if(e instanceof Binding)this.value=e.value,this.binding=e;else if(e&&e.constructor===Object){const t=e;this.value=void 0!==t.value?t.value:void 0,this.type=void 0!==t.type?t.type:void 0,t.binding instanceof Binding&&(this.binding=t.binding,this.value=this.binding.value),void 0!==t.reflect&&(this.reflect=t.reflect),void 0!==t.init&&(this.init=t.init)}else e&&e.constructor===Object||(this.value=e)}assign(e){void 0!==e.value&&(this.value=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.reflect&&(this.reflect=e.reflect),void 0!==e.init&&(this.init=e.init),void 0!==e.binding&&(this.binding=e.binding)}toJSON(){const e={value:this.value,type:this.type,reflect:this.reflect,init:this.init,binding:this.binding};return e.value&&"object"==typeof e.value&&(e.value=e.value.constructor.name),e.type&&"function"==typeof e.type&&(e.type=e.type.name),e}}function decodeInitArgument(e,t){if("this"===e)return t;if("string"!=typeof e||!e.startsWith("this."))return e;{const o=e.split(".");let n=t;for(let e=1;e<o.length;e++)n=n[o[e]];if(n)return n;console.warn(`PropertyInstance: Invalid path ${e}`)}}class PropertyInstance{value=void 0;type;binding;reflect=!1;init=void 0;constructor(e,t){if(Object.keys(t).forEach((e=>{-1===["value","type","reflect","init","binding"].indexOf(e)&&console.warn(`ProtoProperty: Invalid field ${e}`)})),void 0!==t.type&&"function"!=typeof t.type&&console.warn('Incorrect type for "type" field'),void 0!==t.binding&&t.binding.constructor!==Binding&&console.warn('Incorrect type for "binding" field'),void 0!==t.reflect&&"boolean"!=typeof t.reflect&&console.error(`Invalid reflect field ${t.reflect}!`),this.value=t.value,this.type=t.type,this.binding=t.binding,void 0!==t.reflect&&(this.reflect=t.reflect),void 0!==t.init&&(this.init=t.init),this.binding instanceof Binding)this.value=this.binding.value;else if((void 0===this.value||null===this.value)&&null!==this.init)if(this.type===Boolean)this.value=!1;else if(this.type===String)this.value="";else if(this.type===Number)this.value=0;else if("function"==typeof this.type)if(void 0!==this.init)if(this.init instanceof Array){const t=this.init.map((t=>decodeInitArgument(t,e)));this.value=new this.type(...t)}else if(this.init instanceof Object){const t={};Object.keys(this.init).forEach((o=>{t[o]=decodeInitArgument(this.init[o],e)})),this.value=new this.type(t)}else{const t=decodeInitArgument(this.init,e);this.value=new this.type(t)}else this.value=new this.type;void 0!==this.value&&null!==this.value&&(-1!==[String,Number,Boolean].indexOf(this.type)?(this.type===Boolean&&"boolean"!=typeof this.value||this.type===Number&&"number"!=typeof this.value||this.type===String&&"string"!=typeof this.value)&&console.warn(`Property: Incorrect value ${this.value} type for property ${name}!`):"function"!=typeof this.type||this.value instanceof this.type||console.warn(`Property: Incorrect value ${this.value} type for property ${name}!`))}}const t=new WeakMap,o=[String,Number,Boolean,Date,RegExp,Map,Set,WeakMap,WeakSet];function isNonIoNodeConstructor(e){if("function"!=typeof e)return!1;let t=e.prototype;for(;t;){if(o.includes(e))return!1;if("IoNodeMixinConstructor"===t.constructor.name)return!1;if(t===Object.prototype)return!0;t=Object.getPrototypeOf(t)}return!1}function isNonIoNodeObject(e){return"object"==typeof e&&null!==e&&!e._isIoNode}function isIoNodeObjectConstructor(e){if("function"!=typeof e)return!1;let t=e.prototype;for(;t;){if("IoNodeMixinConstructor"===t.constructor.name)return!0;t=Object.getPrototypeOf(t)}return!1}class ProtoChain{constructors=[];properties={};listeners={};styles="";handlers=[];observedObjectProperties=[];observedIoNodeProperties=[];constructor(e){let t=e.prototype;for(;t&&e!==HTMLElement&&e!==Object&&e!==Array;)this.constructors.push(e),this.addHandlers(t),this.addStyles(e.Style),t=Object.getPrototypeOf(t),e=t.constructor;let o="";for(let t=this.constructors.length;t--;)e=this.constructors[t],this.addPropertiesFromDecorators(e),o=this.addStaticProperties(e.Properties,o),this.addListeners(e.Listeners);this.observedObjectProperties=this.getObservedObjectProperties(),this.observedIoNodeProperties=this.getObservedIoNodeProperties(),this.validateProperties()}addPropertiesFromDecorators(e){const o=t.get(e);if(o)for(const e in o){const t=new ProtoProperty(o[e]);this.properties[e]||(this.properties[e]=t),this.properties[e].assign(t)}}addStaticProperties(e={},t=""){const o={};for(const t in e)o[t]=new ProtoProperty(e[t]);const n=JSON.stringify(o);if(n!==t)for(const i in e)this.properties[i]?this.properties[i].assign(o[i]):this.properties[i]=o[i],t=n;return t}addListeners(e){for(const t in e)if(e[t]){const o=hardenListenerDefinition(e[t]),n=this.listeners[t]=this.listeners[t]||[],i=n.findIndex((e=>e[0]===o[0]));-1!==i?n[i][1]?n[i][1]=Object.assign(n[i][1],o[1]):o[1]&&(n[i][1]=o[1]):n.push(o)}}addStyles(e){e&&-1===this.styles.indexOf(e)&&(this.styles=e+"\n"+this.styles)}addHandlers(e){const t=Object.getOwnPropertyNames(e);for(let o=0;o<t.length;o++){const n=t[o];if(/^on[A-Z]/.test(n)||/^_on[A-Z]/.test(n)||n.endsWith("Changed")||n.endsWith("Mutated")){const t=Object.getOwnPropertyDescriptor(e,n);if(void 0===t||t.get||t.set)continue;"function"==typeof e[n]&&-1===this.handlers.indexOf(n)&&this.handlers.push(n)}}}getObservedObjectProperties(){const e=[];for(const t in this.properties){const o=this.properties[t].value,n=this.properties[t].type;(isNonIoNodeObject(o)||isNonIoNodeConstructor(n))&&e.push(t)}return e}getObservedIoNodeProperties(){const e=[];for(const t in this.properties){const o=this.properties[t].value,n=this.properties[t].type;(o?._isIoNode||isIoNodeObjectConstructor(n))&&e.push(t)}return e}validateProperties(){for(const e in this.properties){const t=this.properties[e];if(-1!==[String,Number,Boolean].indexOf(t.type))(t.type===Boolean&&"boolean"!=typeof t.value||t.type===Number&&"number"!=typeof t.value||t.type===String&&"string"!=typeof t.value)&&console.warn(`Property "${e}" in ProtoChain: Incorrect value type for ${t.type} property!`);else{const o=null===t.value,n=void 0===t.value;"function"!=typeof t.type||t.value instanceof t.type||o||n||console.warn(`Property "${e}" in ProtoChain: Incorrect value type for ${t.type} property!`)}}}autobindHandlers(e){e.constructor!==this.constructors[0]&&console.warn("`autobindHandlers` should be used on",this.constructors[0].name,"instance");for(let t=this.handlers.length;t--;)Object.defineProperty(e,this.handlers[t],{value:e[this.handlers[t]].bind(e),writable:!0,configurable:!0})}}const Autobind=function(e,t,o){const n=o.value;return{configurable:!0,enumerable:!1,get(){if(this===e.prototype||Object.prototype.hasOwnProperty.call(this,t))return n;const o=n.bind(this);return Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!1,value:o}),o},set(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e})}}};function Register(e){e.prototype.Register(e)}const Property=function(e){return(o,n)=>{const i=o.constructor,r=t.get(i)||{};t.set(i,r),r[n]=e}},n={saturate:"\n  #ifndef saturate\n    #define saturate(v) clamp(v, 0., 1.)\n  #endif\n",translate:"\n  vec2 translate(vec2 samplePosition, vec2 xy){\n    return samplePosition - vec2(xy.x, xy.y);\n  }\n  vec2 translate(vec2 samplePosition, float x, float y){\n    return samplePosition - vec2(x, y);\n  }\n",circle:"\n  float circle(vec2 samplePosition, float radius){\n    return saturate((length(samplePosition) - radius) * uPxRatio);\n  }\n",rectangle:"\n  float rectangle(vec2 samplePosition, vec2 halfSize){\n    vec2 edgeDistance = abs(samplePosition) - halfSize;\n    float outside = length(max(edgeDistance, 0.));\n    float inside = min(max(edgeDistance.x, edgeDistance.y), 0.);\n    return 1.0 - saturate((outside + inside) * 1000000.0);\n  }\n",paintDerivativeGrid2D:"\n  float paintDerivativeGrid2D(vec2 samplePosition, vec2 gridWidth, float lineWidth) {\n    vec2 sp = samplePosition / gridWidth;\n    float fractx = abs(fract(sp.x - 0.5) - 0.5) * 2.0;\n    float fracty = abs(fract(sp.y - 0.5) - 0.5) * 2.0;\n\n    float sx = ((sp.x - 0.5) - 0.5) * 2.0;\n    float sy = ((sp.y - 0.5) - 0.5) * 2.0;\n    \n    float absx = abs(max(dFdx(sx), dFdy(sx)));\n    float absy = abs(max(dFdy(sy), dFdx(sy)));\n\n    float fadeX = 1.0 - dFdx(sx);\n    float fadeY = 1.0 - dFdy(sx);\n    if (fadeX <= 0.0 || fadeY <= 0.0) return 1.0;\n\n    float linex = fractx / absx - (0.5 * max(uPxRatio, 2.0) * lineWidth - 1.0) - 0.5;\n    float liney = fracty / absy - (0.5 * max(uPxRatio, 2.0) * lineWidth - 1.0) - 0.5;\n\n    return (1.0 - saturate(min(linex, liney)));\n  }\n",lineVertical:"\n  float lineVertical(vec2 samplePosition, float lineWidth) {\n    return (abs(samplePosition.x) * 2.0 > lineWidth) ? 0.0 : 1.0;\n  }\n",lineHorizontal:"\n  float lineHorizontal(vec2 samplePosition, float lineWidth) {\n    return (abs(samplePosition.y) * 2.0 > lineWidth) ? 0.0 : 1.0;\n  }\n",lineCross2d:"\n  float lineCross2d(vec2 samplePosition, float lineWidth) {\n    return (min(abs(samplePosition.x), abs(samplePosition.y)) * 2.0 > lineWidth) ? 0.0 : 1.0;\n  }\n",checker:"\n  float checker(vec2 samplePosition, float size) {\n    vec2 checkerPos = floor(samplePosition / size);\n    float checkerMask = mod(checkerPos.x + mod(checkerPos.y, 2.0), 2.0);\n    return checkerMask;\n  }\n",checkerX:"\n  float checkerX(vec2 samplePosition, float size) {\n    vec2 checkerPos = floor(samplePosition / size);\n    float checkerMask = mod(checkerPos.x, 2.0);\n    return checkerMask;\n  }\n",checkerY:"\n  float checkerY(vec2 samplePosition, float size) {\n    vec2 checkerPos = floor(samplePosition / size);\n    float checkerMask = mod(checkerPos.y, 2.0);\n    return checkerMask;\n  }\n",compose:"\n  vec3 compose(vec3 dst, vec4 src) {\n    return mix(dst, src.rgb, src.a);\n  }\n",paintHorizontalLine:"\n  vec3 paintHorizontalLine(vec3 dstCol, vec2 p, vec3 color) {\n    float lineShape = lineHorizontal(p, io_borderWidth);\n    return compose(dstCol, vec4(color, lineShape));\n  }\n",hue2rgb:"\n  vec3 hue2rgb(float hue) {\n    hue = fract(hue);\n    float R = abs(hue * 6. - 3.) - 1.;\n    float G = 2. - abs(hue * 6. - 2.);\n    float B = 2. - abs(hue * 6. - 4.);\n    return saturate(vec3(R,G,B));\n  }\n",hsv2rgb:"\n  vec3 hsv2rgb(vec3 hsv) {\n    vec3 rgb = hue2rgb(hsv.r);\n    return ((rgb - 1.) * hsv.g + 1.) * hsv.b;\n  }\n",hsl2rgb:"\n  vec3 hsl2rgb(vec3 hsl) {\n    vec3 rgb = hue2rgb(hsl.x);\n    float C = (1. - abs(2. * hsl.z - 1.)) * hsl.y;\n    return (rgb - 0.5) * C + hsl.z;\n  }\n"};var __decorate$G=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};function IoNodeMixin(e){return class IoNodeMixinConstructor extends e{static get Properties(){return{reactivity:{value:"immediate",type:String}}}constructor(e={},...t){super(...t);{const e=Object.getPrototypeOf(this).constructor;this._protochain.constructors[0]!==e&&console.error(`${e.name} not registered! Call "Register([ClassName])" of @Register decorator before using ${e.name} class!`)}this._protochain.autobindHandlers(this),Object.defineProperty(this,"_changeQueue",{enumerable:!1,configurable:!0,value:new ChangeQueue(this)}),Object.defineProperty(this,"_properties",{enumerable:!1,configurable:!0,value:new Map}),Object.defineProperty(this,"_bindings",{enumerable:!1,configurable:!0,value:new Map}),Object.defineProperty(this,"_eventDispatcher",{enumerable:!1,configurable:!0,value:new EventDispatcher(this)});for(const e in this._protochain.properties)Object.defineProperty(this,e,{get:function(){return this._properties.get(e).value},set:function(t){this.setProperty(e,t)},configurable:!0,enumerable:!0});for(const e in this._protochain.properties){const t=new PropertyInstance(this,this._protochain.properties[e]);this._properties.set(e,t),t.binding&&t.binding.addTarget(this,e),t.value?._isIoNode&&t.value.addEventListener("object-mutated",this.onPropertyMutated)}this.applyProperties(e),this._protochain.observedObjectProperties.length&&window.addEventListener("object-mutated",this.onPropertyMutated),this.init()}applyProperties(e){for(const t in e)this._properties.has(t)?this.setProperty(t,e[t],!0):t.startsWith("@")||"style"===t||"config"===t||"$"===t||console.warn(`Property "${t}" is not defined`,this);this._eventDispatcher.applyPropListeners(e),this.dispatchQueue()}setProperties(e){for(const t in e)this._properties.has(t)?this.setProperty(t,e[t],!0):console.warn(`Property "${t}" is not defined`,this);this.dispatchQueue()}setProperty(e,t,o=!1){const n=this._properties.get(e),i=n.value;if(t!==i){const r=t instanceof Binding?t:null;if(r){const t=n.binding;return r!==t?(t&&t.removeTarget(this,e),void r.addTarget(this,e)):void 0}n.value=t,t!==i&&(t?._isIoNode&&t.addEventListener("object-mutated",this.onPropertyMutated),i?._isIoNode&&i.removeEventListener("object-mutated",this.onPropertyMutated)),n.type===String?"string"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${n.type.name}`,this):n.type===Number?"number"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${n.type.name}`,this):n.type===Boolean?"boolean"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${n.type.name}`,this):n.type===Array?t instanceof Array||console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${n.type.name}`,this):n.type===Object?t instanceof Array&&console.warn(`Wrong type of property "${e}". Value: "${JSON.stringify(t)}". Expected type: ${n.type.name}`,this):"function"==typeof n.type&&(t instanceof n.type||console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${n.type.name}`,this)),i!==t&&(this.queue(e,t,i),this.dispatchQueue(o))}}inputValue(e){if(this.value!==e||"object"==typeof this.value){const t=this.value;this.setProperty("value",e),this.dispatchEvent("value-input",{value:e,oldValue:t},!1)}}changed(){}init(){}queue(e,t,o){"none"!==this.reactivity&&this._changeQueue.queue(e,t,o)}dispatchQueue(e=!1){"debounced"===this.reactivity||e||this._changeQueue.dispatching?this.debounce(this._changeQueue.dispatch):"immediate"===this.reactivity&&this._changeQueue.dispatch(),-1===["none","immediate","debounced"].indexOf(this.reactivity)&&console.warn(`IoNode.dispatchQueue(): Invalid reactivity property value: "${this.reactivity}". Expected one of: "none", "immediate", "debounced".`)}throttle(e,t=void 0){throttle(this,e,t,0)}debounce(e,t=void 0,o=1){throttle(this,e,t,o)}onPropertyMutated(e){const t=e.detail.object,o=e.target===window?this._protochain.observedObjectProperties:this._protochain.observedIoNodeProperties;for(let e=0;e<o.length;e++){const n=o[e];if(this._properties.get(n).value===t)return void("function"==typeof this[n+"Mutated"]&&this.throttle(this[n+"Mutated"]))}}bind(e){return this._properties.has(e)||console.warn(`IoGUI Node: cannot bind to ${e} property. Does not exist!`),this._bindings.has(e)||this._bindings.set(e,new Binding(this,e)),this._bindings.get(e)}unbind(e){const t=this._bindings.get(e);t&&(t.dispose(),this._bindings.delete(e));const o=this._properties.get(e);o?.binding?.removeTarget(this,e)}addEventListener(e,t,o){"function"==typeof t?this._eventDispatcher.addEventListener(e,t,o):console.warn(`${this.constructor.name}incorrect listener type.`,this)}removeEventListener(e,t,o){this._eventDispatcher.removeEventListener(e,t,o)}dispatchEvent(e,t=void 0,o=!1,n){this._eventDispatcher.dispatchEvent(e,t,o,n)}dispose(){this._disposed,this._disposed||(this._bindings.forEach(((e,t)=>{e.dispose(),this._bindings.delete(t)})),delete this._bindings,this._protochain.observedObjectProperties.length&&window.removeEventListener("object-mutated",this.onPropertyMutated),delete this._protochain,this._changeQueue.dispose(),delete this._changeQueue,this._properties.forEach(((e,t)=>{e.binding?.removeTarget(this,t),e.value?._isIoNode&&e.value.removeEventListener("object-mutated",this.onPropertyMutated)})),this._eventDispatcher.dispose(),delete this._eventDispatcher,delete this._properties,Object.defineProperty(this,"_disposed",{value:!0}))}Register(e){Object.defineProperty(e,"_isIoNode",{enumerable:!1,value:!0}),Object.defineProperty(e.prototype,"_isIoNode",{enumerable:!1,value:!0}),Object.defineProperty(e.prototype,"_protochain",{value:new ProtoChain(e)})}}}let i=class IoNode extends(IoNodeMixin(Object)){};i=__decorate$G([Register],i);const r=[],s=[],a=[],l=new WeakMap,h=new WeakMap;let c=s,d=l;async function nextQueue(){return new Promise((e=>{c.push(e),d.set(e,{arg:void 0,timeout:Date.now()+1,node:void 0})}))}function throttle(e,t,o=void 0,n=1){if(0===n){if(-1===r.indexOf(t)){r.push(t);try{t(o)}catch(e){console.error(e)}return}n=1}-1===c.indexOf(t)&&c.push(t),d.has(t)?d.get(t).arg=o:d.set(t,{node:e,arg:o,timeout:Date.now()+n})}requestAnimationFrame((function animate(){r.length=0;const e=c,t=d;c=c===s?a:s,d=d===l?h:l;const o=Date.now();for(let n=0;n<e.length;n++){const i=e[n],r=t.get(i);if(t.delete(i),void 0===r&&console.warn(i),r.timeout>o)-1===c.indexOf(i)&&c.push(i),d.set(i,r);else if(!r.node?._disposed)try{void 0!==r.arg?i(r.arg):i()}catch(e){console.error(e)}}e.length=0,requestAnimationFrame(animate)}));var __decorate$F=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const p={},u=new RegExp("(\\/\\*[\\s\\S]*?\\*\\/)","gi"),v=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi"),g=new RegExp("((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi"),f=new RegExp("(( --[\\s\\S]*?): {([\\s\\S]*?)})","gi"),b=new RegExp("(@apply\\s.*?;)","gi"),m=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi"),y=new ResizeObserver((e=>{for(const t of e)t.target.onResized()})),_=Array.isArray,clense=(e,t)=>t?"string"==typeof t[0]?[...e,t]:[...e,...t]:e,buildTree=()=>e=>{return"object"!=typeof(t=e[1])||_(t)?buildTree()([e[0],{},e[1]]):{name:e[0],props:e[1],children:_(e[2])?e[2].reduce(clense,[]).map(buildTree()):e[2]};var t},constructElement=function(e){const t=window.customElements?window.customElements.get(e.name):null;if(t&&t._isIoElement)return new t(e.props);const o=document.createElement(e.name);return applyNativeElementProps(o,e.props),o},disposeElementDeep=function(e){requestAnimationFrame((()=>{const t=[...e.querySelectorAll("*"),e];for(let e=t.length;e--;)"function"==typeof t[e].dispose?t[e].dispose():t[e]._eventDispatcher&&(t[e]._eventDispatcher.dispose(),delete t[e]._eventDispatcher)}))},x=document.createElement;document.createElement=function(e,t){if(e.startsWith("io-")){const o=customElements.get(e);return o?new o:x.apply(this,[e,t])}return x.apply(this,[e,t])};const applyNativeElementProps=function(e,t){for(const o in t){const n=t[o];if("style"===o)for(const t in n)e.style.setProperty(t,n[t]);else"class"===o?e.className=n:e[o]=n;"name"===o&&e.setAttribute("name",n),"src"===o&&e.setAttribute("src",n)}e._eventDispatcher||Object.defineProperty(e,"_eventDispatcher",{enumerable:!1,configurable:!0,value:new EventDispatcher(e)}),e._eventDispatcher.applyPropListeners(t)};let C=class IoElement extends(IoNodeMixin(HTMLElement)){static get Style(){return"\n      :host {\n        box-sizing: border-box;\n        display: block;\n      }\n      :host[hidden] {\n        display: none;\n      }\n      :host[disabled] {\n        pointer-events: none;\n        opacity: 0.5;\n      }\n      :host:focus {\n        border-color: var(--io_colorBlue);\n        outline: 1px auto var(--io_colorBlue);\n        outline: 1px auto -webkit-focus-ring-color;\n      }\n      :host[aria-invalid] {\n        border: var(--io_borderFail);\n      }\n    "}constructor(...e){super(...e);for(const e in this._protochain.properties){const t=this._properties.get(e),o=t.value;null!=o&&t.reflect&&this.setAttribute(e,o)}}connectedCallback(){"function"==typeof this.onResized&&y.observe(this)}disconnectedCallback(){"function"==typeof this.onResized&&y.unobserve(this)}setProperty(e,t,o=!1){super.setProperty(e,t,o);this._properties.get(e).reflect&&this._isIoElement&&this.setAttribute(e,t)}template(e,t,o){const n=buildTree()(["first",e]).children;(t=t||this)===this&&(this.$={}),this.traverse(n,t,o)}traverse(e,t,o){const n=t.children;for(;n.length>e.length;){const e=n[n.length-1];t.removeChild(e),o||disposeElementDeep(e)}for(let i=0;i<n.length;i++){const r=n[i];if(r.localName!==e[i].name||o){const n=r,s=constructElement(e[i]);t.insertBefore(s,n),t.removeChild(n),o||disposeElementDeep(n)}else r.removeAttribute("className"),r._isIoElement?r.applyProperties(e[i].props):applyNativeElementProps(r,e[i].props)}if(n.length<e.length){const o=document.createDocumentFragment();for(let t=n.length;t<e.length;t++){const n=constructElement(e[t]);o.appendChild(n)}t.appendChild(o)}for(let t=0;t<e.length;t++){const i=n[t];e[t].props.$&&(this.$[e[t].props.$]=i),void 0!==e[t].children&&("string"==typeof e[t].children?(this._flattenTextNode(i),i._textNode.nodeValue=String(e[t].children)):"object"==typeof e[t].children&&this.traverse(e[t].children,i,o))}}Register(e){super.Register(e);const t=e.name.replace(/([a-z])([A-Z,0-9])/g,"$1-$2").toLowerCase();Object.defineProperty(e,"localName",{value:t}),Object.defineProperty(e.prototype,"localName",{value:t}),Object.defineProperty(e,"_isIoElement",{enumerable:!1,value:!0}),Object.defineProperty(e.prototype,"_isIoElement",{enumerable:!1,value:!0}),Object.defineProperty(window,e.name,{value:e}),window.customElements.define(t,e);let o="";const n=e.prototype._protochain.styles.match(f);if(n)for(let e=0;e<n.length;e++){const t=n[e].split(": {"),i=t[0].replace(" --","--"),r=t[1].replace(/}/g,"").trim().replace(/^ +/gm,"");p[i]=r,o+=n[e].replace(" --",".").replace(": {"," {")}let i=e.prototype._protochain.styles.replace(f,"");const r=i.match(b);if(r)for(let e=0;e<r.length;e++){const t=r[e].split("@apply ")[1].replace(";","");p[t]?i=i.replace(r[e],p[t]):console.warn("IoElement: cound not find mixin:",t)}{let e=i;e=e.replace(u,""),e=e.replace(v,""),e=e.replace(g,"");const o=e.match(m);o&&o.map((e=>{(e=e.trim()).startsWith(":host")||(console.warn(t+': CSS Selector not prefixed with ":host"! This will cause style leakage!'),console.warn(e))}))}i=o+i.replace(new RegExp(":host","g"),t);const s=document.createElement("style");s.innerHTML=i,s.setAttribute("id","io-style-"+t.replace("io-","")),document.head.appendChild(s)}_flattenTextNode(e){if(0===e.childNodes.length&&e.appendChild(document.createTextNode("")),"#text"!==e.childNodes[0].nodeName&&(e.innerHTML="",e.appendChild(document.createTextNode(""))),e._textNode=e.childNodes[0],e.childNodes.length>1){const t=e.textContent;for(let t=e.childNodes.length;t--;)0!==t&&e.removeChild(e.childNodes[t]);e._textNode.nodeValue=t}}get textNode(){return this._flattenTextNode(this),this._textNode.nodeValue}set textNode(e){this._flattenTextNode(this),this._textNode.nodeValue=String(e)}applyProperties(e){if(super.applyProperties(e),e.style)for(const t in e.style)this.style[t]=e.style[t]}setAttribute(e,t){!0===t?HTMLElement.prototype.setAttribute.call(this,e,""):!1===t||""===t?this.removeAttribute(e):"string"!=typeof t&&"number"!=typeof t||this.getAttribute(e)!==String(t)&&HTMLElement.prototype.setAttribute.call(this,e,String(t))}labelChanged(){this.label?this.setAttribute("aria-label",this.label):this.removeAttribute("aria-label")}disabledChanged(){this.disabled?this.setAttribute("aria-disabled",this.disabled):this.removeAttribute("aria-disabled")}};__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"tabindex",void 0),__decorate$F([Property({value:!1,type:Boolean,reflect:!0})],C.prototype,"contenteditable",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"class",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"role",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"label",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"name",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"title",void 0),__decorate$F([Property({value:"",type:String,reflect:!0})],C.prototype,"id",void 0),__decorate$F([Property({value:!1,type:Boolean,reflect:!0})],C.prototype,"hidden",void 0),__decorate$F([Property({value:!1,type:Boolean,reflect:!0})],C.prototype,"disabled",void 0),C=__decorate$F([Register],C);var __decorate$E=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const w=new class EmulatedLocalStorage{constructor(){Object.defineProperty(this,"store",{value:new Map}),Object.defineProperty(this,"warned",{value:!1,writable:!0})}get permitted(){try{return"true"===self.localStorage.getItem("IoStorage:user-permitted")}catch(e){console.warn("IoStorage: Cannot access localStorage. Check browser privacy settings!")}return!1}set permitted(e){try{e?(console.log("IoStorage: localStorage permission granted."),this.store.set("IoStorage:user-permitted",String(e)),this.store.forEach(((e,t)=>{self.localStorage.setItem(t,String(e)),this.store.delete(t)}))):(console.log("IoStorage: localStorage permission revoked."),self.localStorage.setItem("IoStorage:user-permitted",String(e)),new Map(Object.entries(self.localStorage)).forEach(((e,t)=>{this.store.set(t,e)})),self.localStorage.clear())}catch(e){console.warn("IoStorage: Cannot access localStorage. Check browser privacy settings!")}}setItem(e,t){const o="object"==typeof t?JSON.stringify(t):String(t);"IoStorage:user-permitted"!==e?this.permitted?self.localStorage.setItem(e,o):(this.store.set(e,o),this.warned||this.permitted||(console.warn("IoStorage: localStorage permission not set."),this.warned=!0)):this.permitted="true"===t}getItem(e){return this.permitted?self.localStorage.getItem(e):this.store.has(e)?this.store.get(e):null}removeItem(e){if(this.permitted)return self.localStorage.removeItem(e);this.store.delete(e)}clear(){if(this.permitted)return self.localStorage.clear();this.store.clear()}},S={local:new Map,hash:new Map,none:new Map};let P={};function genObjectStorageID(e){const t=JSON.stringify(e);let o=0;for(let e=0;e<t.length;e++)o=Math.imul(31,o)+t.charCodeAt(e)|0;return"io-local-state-"+String(o)}let O=class IoStorageNode extends i{constructor(e){"object"!=typeof e?console.warn("Ivalid IoStorage arguments!"):("string"==typeof e.key&&e.key||console.warn("Ivalid IoStorage key!"),e.storage&&-1===["hash","local","none"].indexOf(e.storage)&&console.warn("Ivalid IoStorage storage!"));const t=e.storage||"none";if(S[t].has(e.key))return S[t].get(e.key);{const o=e.default||e.value;switch(e.storage){case"hash":{const t=function getValueFromHash(e){if(P=parseHash(self.location.hash),P[e])try{return JSON.parse(P[e])}catch(t){return P[e]}}(e.key);if(void 0!==t)try{e.value=JSON.parse(t)}catch(o){e.value=t}break}case"local":{const t=w.getItem("IoStorage:"+e.key);t&&(e.value=JSON.parse(t));break}}return void 0===e.value&&(e.value=o),super(Object.assign({default:o},e)),"__proto__"!==e.key&&S[t].set(e.key,this),this.binding=this.bind("value"),this.binding.dispose=()=>{this._clearStorage()},this}}dispose(){this._clearStorage(),super.dispose()}_clearStorage(){switch(this.storage){case"hash":this.removeValueToHash();break;case"local":w.removeItem("IoStorage:"+this.key)}const e=this.storage;S[e].delete(this.key)}valueChanged(){switch(this.storage){case"hash":this.saveValueToHash();break;case"local":null===this.value||void 0===this.value||this.value===this.default?w.removeItem("IoStorage:"+this.key):w.setItem("IoStorage:"+this.key,JSON.stringify(this.value))}}removeValueToHash(){P=parseHash(self.location.hash),delete P[this.key];let e="";for(const t in P)e+=t+"="+P[t]+"&";e?(e=e.slice(0,-1),self.location.hash=e):history.replaceState("",document.title,self.location.pathname+self.location.search)}saveValueToHash(){P=parseHash(self.location.hash);const e=this.value;void 0!==e&&""!==e&&e!==this.default?"string"==typeof e?isNaN(e)?P[this.key]=e:P[this.key]='"'+e+'"':P[this.key]=JSON.stringify(e):delete P[this.key];let t="";for(const e in P)t+=e+"="+P[e]+"&";t?(t=t.slice(0,-1),self.location.hash=t):history.replaceState("",document.title,self.location.pathname+self.location.search)}};__decorate$E([Property({value:"",type:String})],O.prototype,"key",void 0),__decorate$E([Property({value:void 0})],O.prototype,"value",void 0),__decorate$E([Property({value:void 0})],O.prototype,"default",void 0),__decorate$E([Property({value:"none",type:String})],O.prototype,"storage",void 0),O=__decorate$E([Register],O);const R=Object.assign((e=>new O(e).binding),{permit(){w.permitted=!0},unpermit(){w.permitted=!1}});function parseHash(e){return e.substring(1).split("&").reduce((function(e,t){const o=t.split("=");return o[0]&&o[1]&&(e[o[0]]=o[1].replace(/%22/g,'"').replace(/%20/g," ")),e}),{})}function updateAllFromHash(){P=parseHash(self.location.hash);for(const e in P)if(S.hash.has(e)){const t=S.hash.get(e);try{t.value=JSON.parse(P[e])}catch(o){t.value=P[e]}}}self.addEventListener("hashchange",updateAllFromHash,!1),updateAllFromHash();var __decorate$D=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const I="v0.10",k=document.createElement("style");k.setAttribute("id","io-theme-variables-"+I),document.head.appendChild(k);class Color{r;g;b;a;constructor(e,t,o,n){this.r=e,this.g=t,this.b=o,this.a=n}toCss(){const e=Math.floor(255*this.r),t=Math.floor(255*this.g),o=Math.floor(255*this.b);return void 0!==this.a&&1!==this.a?`rgba(${e}, ${t}, ${o}, ${this.a})`:`rgb(${e}, ${t}, ${o})`}}const E={spacing:2,spacing2:0,spacing3:0,spacing5:0,spacing8:0,lineHeight:20,fontSize:14,fieldHeight:0,fieldHeight2:0,fieldHeight3:0,fieldHeight4:0,fieldHeight5:0,fieldHeight6:0,fieldHeight7:0,fieldHeight8:0,fieldHeight9:0,fieldHeight10:0,fieldHeight11:0,fieldHeight12:0,borderRadius:2,borderRadius2:0,borderWidth:1,borderColor:new Color(0,0,0,.2),borderColorLight:new Color(1,1,1,.8),borderColorDark:new Color(0,0,0,.4),bgColor:new Color(.85,.85,.85,1),bgColorStrong:new Color(.9,.9,.9,1),bgColorDimmed:new Color(.8,.8,.8,1),bgColorRed:new Color(1,.5,.3,1),bgColorGreen:new Color(.2,.9,.3,1),bgColorBlue:new Color(.2,.5,.9,1),bgColorField:new Color(.95,.96,.95,1),color:new Color(.25,.25,.2,1),colorStrong:new Color(0,0,0,1),colorDimmed:new Color(.6,.6,.6,1),colorRed:new Color(1,.2,0,1),colorGreen:new Color(0,.6,.1,1),colorBlue:new Color(.2,.3,1,1),colorWhite:new Color(1,1,1,1),colorField:new Color(0,.05,.02,1),gradientColorStart:new Color(.9,.9,.9,1),gradientColorEnd:new Color(.75,.75,.75,1),shadowColor:new Color(0,0,0,.2)},j={spacing:2,spacing2:0,spacing3:0,spacing5:0,spacing8:0,lineHeight:20,fontSize:14,fieldHeight:0,fieldHeight2:0,fieldHeight3:0,fieldHeight4:0,fieldHeight5:0,fieldHeight6:0,fieldHeight7:0,fieldHeight8:0,fieldHeight9:0,fieldHeight10:0,fieldHeight11:0,fieldHeight12:0,borderRadius:2,borderRadius2:0,borderWidth:1,borderColor:new Color(1,1,1,.5),borderColorLight:new Color(1,1,1,.3),borderColorDark:new Color(0,0,0,1),bgColor:new Color(.2,.2,.2,1),bgColorStrong:new Color(.15,.15,.15,1),bgColorDimmed:new Color(.25,.25,.25,1),bgColorRed:new Color(.7,.2,.1,1),bgColorGreen:new Color(.1,.5,.2,1),bgColorBlue:new Color(0,.3,.65,1),bgColorField:new Color(.02,.02,.02,1),color:new Color(.6,.6,.6,1),colorStrong:new Color(.86,.86,.86,1),colorDimmed:new Color(.3,.3,.3,1),colorRed:new Color(1,.4,.4,1),colorGreen:new Color(.4,.95,.3,1),colorBlue:new Color(.6,.9,1,1),colorWhite:new Color(1,1,1,1),colorField:new Color(.65,.7,.68,1),gradientColorStart:new Color(.45,.45,.45,1),gradientColorEnd:new Color(.2,.2,.2,1),shadowColor:new Color(0,0,0,.2)},M=R({value:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",storage:"local",key:"theme-"+I}),L=R({value:{},storage:"local",key:"io-themes-"+I});let N=class IoTheme extends i{static get Properties(){const e={};for(const t in E){const o=E[t];e[t]=o instanceof Object?{value:o,type:Color}:o}return e}init(){this.registerTheme("light",E),this.registerTheme("dark",j),this.saveTheme=this.saveTheme.bind(this),this.themeIDChanged()}registerTheme(e,t){this.themeDefaults[e]=t,this.setProperty("themeDefaults",JSON.parse(JSON.stringify(this.themeDefaults)),!0),L.value[e]=L.value[e]||t,L.value=JSON.parse(JSON.stringify(L.value))}reset(){L.value=JSON.parse(JSON.stringify(this.themeDefaults)),this.themeIDChanged()}themeIDChanged(){const e=L.value[this.themeID];for(const t in e)e[t]instanceof Object&&'["r","g","b","a"]'===JSON.stringify(Object.keys(e[t]))&&(e[t]=new Color(e[t].r,e[t].g,e[t].b,e[t].a));this.setProperties(e)}onPropertyMutated(e){super.onPropertyMutated(e),this.changed(),this.dispatchEvent("object-mutated",{object:this})}changed(){this.fieldHeight=this.lineHeight+2*(this.spacing+this.borderWidth),this.fieldHeight2=2*this.fieldHeight,this.fieldHeight3=3*this.fieldHeight,this.fieldHeight4=4*this.fieldHeight,this.fieldHeight5=5*this.fieldHeight,this.fieldHeight6=6*this.fieldHeight,this.fieldHeight7=7*this.fieldHeight,this.fieldHeight8=8*this.fieldHeight,this.fieldHeight9=9*this.fieldHeight,this.fieldHeight10=10*this.fieldHeight,this.fieldHeight11=11*this.fieldHeight,this.fieldHeight12=12*this.fieldHeight,this.spacing2=2*this.spacing,this.spacing3=3*this.spacing,this.spacing5=5*this.spacing,this.spacing8=8*this.spacing,this.borderRadius2=this.borderRadius+this.spacing;const e=Array.from(Object.keys(E)).reduce(((e,t)=>(L.value[this.themeID][t]=this[t],"object"==typeof this[t]?`${e}--io_${t}: ${this[t].toCss()};\n    `:`${e}--io_${t}: ${this[t]}px;\n    `)),"");k.innerHTML=`body {\n  ${e}\n}\n\n  body {\n    --io_border: var(--io_borderWidth) solid var(--io_borderColor);\n    --io_borderColorInset: var(--io_borderColorDark) var(--io_borderColorLight) var(--io_borderColorLight) var(--io_borderColorDark);\n    --io_borderColorOutset: var(--io_borderColorLight) var(--io_borderColorDark) var(--io_borderColorDark) var(--io_borderColorLight);\n    --io_gradientOutset: linear-gradient(180deg, var(--io_gradientColorStart), var(--io_gradientColorEnd) 100%);\n    --io_gradientInset: linear-gradient(0deg, var(--io_gradientColorStart), var(--io_gradientColorEnd) 150%);\n    --io_shadow: 2px 2px 6px var(--io_shadowColor), 1px 1px 1px var(--io_shadowColor);\n    --io_shadowInset: 1px 1px 1px inset var(--io_shadowColor);\n    --io_shadowOutset: 1px 1px 2px var(--io_shadowColor);\n  }\n`,this.debounce(this.saveTheme,void 0,100)}saveTheme(){L.value=JSON.parse(JSON.stringify(L.value))}};__decorate$D([Property({type:Object})],N.prototype,"themeDefaults",void 0),__decorate$D([Property({type:String,binding:M})],N.prototype,"themeID",void 0),__decorate$D([Property("debounced")],N.prototype,"reactivity",void 0),N=__decorate$D([Register],N);const A=new N;var __decorate$C=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const D=document.createElement("canvas"),H=D.getContext("webgl",{antialias:!1,premultipliedAlpha:!1});H.getExtension("OES_standard_derivatives"),H.enable(H.BLEND),H.blendFunc(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA),H.disable(H.DEPTH_TEST);const T=H.createBuffer();H.bindBuffer(H.ARRAY_BUFFER,T),H.bufferData(H.ARRAY_BUFFER,new Float32Array([-1,1,0,-1,-1,0,1,-1,0,1,1,0]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null);const $=H.createBuffer();H.bindBuffer(H.ARRAY_BUFFER,$),H.bufferData(H.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null);const B=H.createBuffer();H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,B),H.bufferData(H.ELEMENT_ARRAY_BUFFER,new Uint16Array([3,2,1,3,1,0]),H.STATIC_DRAW),H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,null),H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,B);const z=new WeakMap;let F,V=class IoGl extends C{static get Style(){return"\n      :host {\n        position: relative;\n        overflow: hidden !important;\n        user-select: none;\n      }\n      :host > canvas {\n        position: absolute;\n        pointer-events: none;\n        image-rendering: pixelated;\n      }\n    "}needsResize=!1;canvas;ctx;static get Vert(){return"\n      attribute vec3 position;\n      attribute vec2 uv;\n      varying vec2 vUv;\n\n      void main(void) {\n        vUv = uv;\n        gl_Position = vec4(position, 1.0);\n      }\n\n"}static get GlUtils(){return`\n      ${n.saturate}\n      ${n.translate}\n      ${n.circle}\n      ${n.rectangle}\n      ${n.paintDerivativeGrid2D}\n      ${n.lineVertical}\n      ${n.lineHorizontal}\n      ${n.lineCross2d}\n      ${n.checker}\n      ${n.checkerX}\n      ${n.checkerY}\n      ${n.compose}\n      ${n.paintHorizontalLine}\n    `}static get Frag(){return"\n      void main(void) {\n        gl_FragColor = uColor;\n      }\n\n"}initPropertyUniform(e,t){switch(t.value.constructor){case Boolean:return"uniform int "+e+";\n";case Number:return"uniform float "+e+";\n";case Array:return this._vecLengths[e]=t.value.length,"uniform vec"+t.value.length+" "+e+";\n";case Color:return this._vecLengths[e]=4,"uniform vec4 "+e+";\n"}return""}initShader(){let e="\n    #extension GL_OES_standard_derivatives : enable\n    precision highp float;\n";this.theme._properties.forEach(((t,o)=>{e+=this.initPropertyUniform("io_"+o,t)})),e+="\n",this._properties.forEach(((t,o)=>{const n="u"+o.charAt(0).toUpperCase()+o.slice(1);e+=this.initPropertyUniform(n,t)})),e+=this.constructor.prototype._glUtils;const t=H.createShader(H.VERTEX_SHADER);if(H.shaderSource(t,this.constructor.Vert),H.compileShader(t),!H.getShaderParameter(t,H.COMPILE_STATUS)){const e=H.getShaderInfoLog(t);console.error("IoGl [Vertex Shader] "+this.localName+" error:"),console.warn(e)}const o=H.createShader(H.FRAGMENT_SHADER);if(H.shaderSource(o,e+this.constructor.Frag),H.compileShader(o),!H.getShaderParameter(o,H.COMPILE_STATUS)){const e=H.getShaderInfoLog(o);console.error("IoGl [Frament Shader] "+this.localName+" error:"),console.warn(e)}const n=H.createProgram();return H.attachShader(n,t),H.attachShader(n,o),n}constructor(e={}){super(e),this.canvas=document.createElement("canvas"),this.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d",{alpha:!0}),this._vecLengths={},this.theme._properties.forEach(((e,t)=>{e.type===Color&&(this._vecLengths["io_"+t]=4)})),this._properties.forEach(((e,t)=>{const o="u"+t.charAt(0).toUpperCase()+t.slice(1);e.type===Array&&(this._vecLengths[o]=e.value.length)})),z.has(this.constructor)?this._shader=z.get(this.constructor):(this._shader=this.initShader(),z.set(this.constructor,this._shader)),H.linkProgram(this._shader);const t=H.getAttribLocation(this._shader,"position");H.bindBuffer(H.ARRAY_BUFFER,T),H.vertexAttribPointer(t,3,H.FLOAT,!1,0,0),H.enableVertexAttribArray(t);const o=H.getAttribLocation(this._shader,"uv");H.bindBuffer(H.ARRAY_BUFFER,$),H.vertexAttribPointer(o,2,H.FLOAT,!1,0,0),H.enableVertexAttribArray(o),this.updateThemeUniforms()}onResized(){const e=window.devicePixelRatio,t=this.getBoundingClientRect(),o=window.getComputedStyle(this),n=parseInt(o.borderRightWidth)+parseInt(o.borderLeftWidth),i=parseInt(o.borderTopWidth)+parseInt(o.borderBottomWidth),r=Math.max(0,Math.floor(t.width-n)),s=Math.max(0,Math.floor(t.height-i));(r!==this.size[0]||s!==this.size[1]||e!==this.pxRatio)&&(this.canvas.style.width=Math.floor(r)+"px",this.canvas.style.height=Math.floor(s)+"px",this.needsResize=!0,this.setProperties({size:[r,s],pxRatio:e}))}themeMutated(){this.updateThemeUniforms(),this.throttle(this._onRender)}changed(){this.throttle(this._onRender)}_onRender(){const e=Math.floor(this.size[0]*this.pxRatio),t=Math.floor(this.size[1]*this.pxRatio);e&&t&&(this.setShaderProgram(),this._properties.forEach(((e,t)=>{const o="u"+t.charAt(0).toUpperCase()+t.slice(1);this.updatePropertyUniform(o,e)})),this.needsResize&&(this.canvas.width=e,this.canvas.height=t,this.needsResize=!1),D.width=e,D.height=t,H.viewport(0,0,e,t),this.transparent&&(H.clearColor(0,0,0,0),H.clear(H.COLOR_BUFFER_BIT),this.ctx.clearRect(0,0,e,t)),H.drawElements(H.TRIANGLES,6,H.UNSIGNED_SHORT,0),this.ctx.drawImage(D,0,0))}setShaderProgram(){F!==this._shader&&(F=this._shader,H.useProgram(this._shader))}updatePropertyUniform(e,t){this.setShaderProgram(),this.setUniform(e,t.value)}updateThemeUniforms(){this.theme._properties.forEach(((e,t)=>{this.updatePropertyUniform("io_"+t,e)}))}setUniform(e,t){const o=H.getUniformLocation(this._shader,e);if(null===o)return;let n,i=typeof t;switch(t instanceof Array&&(i="array"),i){case"boolean":H.uniform1i(o,t?1:0);break;case"number":H.uniform1f(o,t??1);break;case"object":case"array":switch(n=[0,1,2,3],"object"==typeof t&&(void 0!==t.x?n=["x","y","z","w"]:void 0!==t.r?n=["r","g","b","a"]:void 0!==t.h?n=["h","s","v","a"]:void 0!==t.c&&(n=["c","m","y","k"])),this._vecLengths[e]){case 2:if(void 0===t){H.uniform2f(o,0,0);break}H.uniform2f(o,t[n[0]]??1,t[n[1]]??1);break;case 3:if(void 0===t){H.uniform3f(o,0,0,0);break}H.uniform3f(o,t[n[0]]??1,t[n[1]]??1,t[n[2]]??1);break;case 4:if(void 0===t){H.uniform4f(o,0,0,0,0);break}H.uniform4f(o,t[n[0]]??1,t[n[1]]??1,t[n[2]]??1,t[n[3]]??1)}}}Register(e){super.Register(e);let t="";const o=e.prototype._protochain.constructors;for(let e=o.length;e--;){const n=o[e],i=Object.getOwnPropertyDescriptor(n,"GlUtils");i&&i.get&&(t+=n.GlUtils)}Object.defineProperty(e.prototype,"_glUtils",{enumerable:!1,value:t})}};__decorate$C([Property({type:Boolean,value:!1})],V.prototype,"transparent",void 0),__decorate$C([Property({type:Array,init:[0,0]})],V.prototype,"size",void 0),__decorate$C([Property({type:Array,init:[1,1,1,1]})],V.prototype,"color",void 0),__decorate$C([Property({type:Number,value:1})],V.prototype,"pxRatio",void 0),__decorate$C([Property({type:i,value:A})],V.prototype,"theme",void 0),__decorate$C([Property("debounced")],V.prototype,"reactivity",void 0),V=__decorate$C([Register],V);var __decorate$B=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let W=null;window.addEventListener("focusin",(()=>{W=document.activeElement}),{capture:!1}),window.addEventListener("blur",(()=>{setTimeout((()=>{document.activeElement===document.body&&(W=null)}))}),{capture:!0});let U=class IoOverlay extends C{static get Style(){return"\n      :host {\n        display: block;\n        position: fixed;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        right: 0;\n        z-index: 100000;\n        user-select: none;\n        overflow: hidden;\n        pointer-events: none;\n        touch-action: none;\n        background: transparent;\n      }\n      :host[expanded] {\n        pointer-events: all;\n      }\n      :host > * {\n        position: absolute !important;\n        touch-action: none;\n        box-shadow: var(--io_shadow);\n      }\n    "}static get Listeners(){return{pointerdown:["stopPropagation",{passive:!1}],pointermove:["stopPropagation",{passive:!1}],pointerup:"_onPointerup",contextmenu:"_onContextmenu",focusin:"_onFocusIn",scroll:"_onScroll",wheel:["_onScroll",{passive:!1}],mousedown:["stopPropagation",{passive:!1}],mousemove:["stopPropagation",{passive:!1}],mouseup:["stopPropagation",{passive:!1}],touchstart:["stopPropagation",{passive:!1}],touchmove:["stopPropagation",{passive:!1}],touchend:["stopPropagation",{passive:!1}],keydown:["stopPropagation",{passive:!1}],keyup:["stopPropagation",{passive:!1}]}}constructor(e={}){super(e),Object.defineProperty(this,"x",{value:0,writable:!0}),Object.defineProperty(this,"y",{value:0,writable:!0})}stopPropagation(e){e.stopPropagation()}onResized(){this.expanded=!1}_onPointerup(e){e.composedPath()[0]===this&&this.throttle(this._onCollapse)}_onCollapse(){this.expanded=!1}_onContextmenu(e){e.preventDefault()}_onFocusIn(e){e.stopPropagation()}_onScroll(e){e.composedPath()[0]===this&&this.throttle(this._onCollapse)}nudgeDown(e,t,o,n,i){t=Math.max(0,Math.min(t,window.innerWidth-n.width));const r=o+n.height<window.innerHeight;return!(!r&&!i)&&(r||(o=window.innerHeight-n.height),e.style.left=t+"px",e.style.top=o+"px",!0)}nudgeUp(e,t,o,n,i){t=Math.max(0,Math.min(t,window.innerWidth-n.width));const r=o-n.height>0;return!(!r&&!i)&&(r||(o=0),e.style.left=t+"px",e.style.top=o-n.height+"px",!0)}nudgeRight(e,t,o,n,i){const r=t+n.width<window.innerWidth;return!(!r&&!i)&&(r||(t=window.innerWidth-n.width),e.style.left=t+"px",e.style.top=Math.min(o,window.innerHeight-n.height)+"px",!0)}nudgeLeft(e,t,o,n,i){const r=t-n.width>0;return!(!r&&!i)&&(r||(t=0),e.style.left=t-n.width+"px",e.style.top=Math.min(o,window.innerHeight-n.height)+"px",!0)}nudgePointer(e,t,o,n){return e.style.left=Math.max(0,Math.min(t,window.innerWidth-n.width))+"px",e.style.top=Math.max(0,Math.min(o,window.innerHeight-n.height))+"px",!0}setElementPosition(e,t,o){const n=e.getBoundingClientRect(),i=o.left,r=o.top,s=o.right,a=o.bottom,l=window.innerHeight-a,h=window.innerWidth-s;switch(t){case"pointer":this.nudgePointer(e,this.x+5,this.y+5,n);break;case"up":this.nudgeUp(e,i,r,n)||this.nudgeDown(e,i,a,n)||this.nudgeUp(e,i,r,n,r>l)||this.nudgeDown(e,i,a,n,r<=l);break;case"left":this.nudgeLeft(e,i,r,n)||this.nudgeRight(e,s,r,n)||this.nudgeLeft(e,i,r,n,i>h)||this.nudgeRight(e,s,r,n,i<=h);break;case"down":this.nudgeDown(e,i,a,n)||this.nudgeUp(e,i,r,n)||this.nudgeDown(e,i,a,n,l>r)||this.nudgeUp(e,i,r,n,l<=r);break;default:this.nudgeRight(e,s,r,n)||this.nudgeLeft(e,i,r,n)||this.nudgeRight(e,s,r,n,h>i)||this.nudgeLeft(e,i,r,n,h<=i)}}appendChild(e){super.appendChild(e),e.addEventListener("expanded-changed",this.onChildExpanded),this.onChildExpanded()}removeChild(e){super.removeChild(e),e.removeEventListener("expanded-changed",this.onChildExpanded),this.onChildExpanded()}onChildExpanded(){this.throttle(this.onChildExpandedDelayed)}onChildExpandedDelayed(){for(let e=this.children.length;e--;)if(this.children[e].expanded)return void(this.expanded=!0);this.throttle(this._onCollapse)}expandedChanged(){if(!this.expanded){for(let e=this.children.length;e--;)this.children[e].expanded=!1;W&&W.focus()}}};__decorate$B([Property({value:!1,type:Boolean,reflect:!0})],U.prototype,"expanded",void 0),U=__decorate$B([Register],U);const G=new U;document.body.appendChild(G);var __decorate$A=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let K=class IoLabel extends C{static get Style(){return"\n      --ioLabel: {\n        display: inline-block;\n        height: var(--io_lineHeight);\n        line-height: var(--io_lineHeight);\n        font-size: var(--io_fontSize);\n        padding: 0 var(--io_spacing);\n      }\n      :host {\n        @apply --ioLabel;\n      }\n      :host:not([label]) {\n        display: none;\n      }\n    "}labelChanged(){super.labelChanged(),this.textNode=this.label}};K=__decorate$A([Register],K);var __decorate$z=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Y=class IoField extends C{static get Style(){return"\n      --ioField: {\n        display: flex;\n\n        cursor: pointer;\n        user-select: none;\n        -webkit-touch-callout: none;\n\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n\n        height: var(--io_fieldHeight);\n        line-height: var(--io_lineHeight);\n\n        font-size: var(--io_fontSize);\n        border: var(--io_border);\n        border-radius: var(--io_borderRadius);\n        border-color: transparent;\n        color: var(--io_colorField);\n        background-color: var(--io_bgColorField);\n        padding-top: var(--io_spacing);\n        padding-bottom: var(--io_spacing);\n        padding-left: var(--io_spacing);\n        padding-right: var(--io_spacing);\n        transition: background-color 0.25s;\n      }\n      :host {\n        @apply --ioField;\n      }\n      :host[appearance=neutral] {\n        color: var(--io_color);\n        background-color: transparent;\n      }\n      :host[appearance=inset] {\n        border-color: var(--io_borderColorInset);\n        padding-top: calc(var(--io_spacing) + 0.05em);\n        padding-bottom: calc(var(--io_spacing) - 0.05em);\n      }\n      :host[appearance=outset] {\n        border-color: var(--io_borderColorOutset);\n        background-image: var(--io_gradientOutset);\n      }\n      :host.red,\n      :host[invalid] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorRed);\n        border-color: var(--io_colorRed);\n      }\n      :host.green {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorGreen);\n        border-color: var(--io_colorGreen);\n      }\n\n      :host.blue,\n      :host[selected] {\n        color: var(--io_colorWhite);\n        background-color: var(--io_bgColorBlue);\n        border-color: var(--io_colorBlue);\n      }\n      :host:focus {\n        text-overflow: inherit;\n      }\n      :host[placeholder]:empty:before {\n        content: attr(placeholder);\n        visibility: visible;\n        color: var(--io_colorField);\n        padding: 0 calc(var(--io_spacing) + var(--io_borderWidth));\n        opacity: 0.5;\n      }\n      :host[appearance=inset] io-icon {\n        margin-top: -0.05em;\n        margin-bottom: 0.05em;\n      }\n    "}static get Listeners(){return{"focus-to":"_onFocusTo",focus:"_onFocus",pointerdown:"_onPointerdown",click:"_onClick"}}_onFocus(e){this.addEventListener("blur",this._onBlur),this.addEventListener("keydown",this._onKeydown),this.addEventListener("keyup",this._onKeyup)}_onBlur(e){this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown),this.removeEventListener("keyup",this._onKeyup)}_onPointerdown(e){this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerleave",this._onPointerleave),this.addEventListener("pointerup",this._onPointerup)}_onPointermove(e){}_onPointerleave(e){this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerleave",this._onPointerleave),this.removeEventListener("pointerup",this._onPointerup)}_onPointerup(e){this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerleave",this._onPointerleave),this.removeEventListener("pointerup",this._onPointerup),this.focus()}_onClick(){this.dispatchEvent("io-field-clicked",{value:this.value},!0)}_onKeydown(e){"Enter"===e.key||" "===e.key?(e.preventDefault(),this._onClick()):"ArrowLeft"===e.key?(e.preventDefault(),this.focusTo("left")):"ArrowUp"===e.key?(e.preventDefault(),this.focusTo("up")):"ArrowRight"===e.key?(e.preventDefault(),this.focusTo("right")):"ArrowDown"===e.key&&(e.preventDefault(),this.focusTo("down"))}_onKeyup(e){}_onFocusTo(e){const t=e.composedPath()[0],o=e.detail.dir,n=e.detail.rect;if(n.center={x:n.x+n.width/2,y:n.y+n.height/2},t!==this){let i=t,r=Infinity,s=Infinity;const a=this.querySelectorAll('[tabindex="0"]:not([disabled])');for(let e=a.length;e--;){if(!a[e].offsetParent)continue;if("visible"!==window.getComputedStyle(a[e]).visibility)continue;const t=a[e].getBoundingClientRect();switch(t.center={x:t.x+t.width/2,y:t.y+t.height/2},o){case"right":if(t.left>=n.right-1){const o=Math.abs(t.left-n.right),l=Math.abs(t.center.y-n.center.y);o<r||l<s/3?(i=a[e],r=o,s=l):o===r&&l<s&&(i=a[e],s=l)}break;case"left":if(t.right<=n.left+1){const o=Math.abs(t.right-n.left),l=Math.abs(t.center.y-n.center.y);o<r||l<s/3?(i=a[e],r=o,s=l):o===r&&l<s&&(i=a[e],s=l)}break;case"down":if(t.top>=n.bottom-1){const o=Math.abs(t.center.x-n.center.x),l=Math.abs(t.top-n.bottom);l<s||o<r/3?(i=a[e],r=o,s=l):l===s&&o<r&&(i=a[e],r=o)}break;case"up":if(t.bottom<=n.top+1){const o=Math.abs(t.center.x-n.center.x),l=Math.abs(t.bottom-n.top);l<s||o<r/3?(i=a[e],r=o,s=l):l===s&&o<r&&(i=a[e],r=o)}}}i!==t&&(i.focus(),e.stopPropagation())}}focusTo(e){const t=this.getBoundingClientRect();this.dispatchEvent("focus-to",{dir:e,rect:t},!0)}getCaretPosition(){let e=0;const t=window.getSelection();if(t&&t.rangeCount){const o=t.getRangeAt(0),n=o.toString().length,i=o.cloneRange();i.selectNodeContents(this),i.setEnd(o.endContainer,o.endOffset),e=i.toString().length-n}return e}setCaretPosition(e){if(!e)return;const t=window.getSelection();if(t){const o=document.createRange();o.setStart(this.firstChild,e),o.collapse(!0),t.removeAllRanges(),t.addRange(o)}}changed(){let e="";this.label?e=this.label:this.value&&"object"==typeof this.value?e=`${this.value.constructor.name}`+(this.value instanceof Array?`(${this.value.length})`:""):void 0!==this.value&&(e=String(this.value)),this.template([this.icon?["io-icon",{icon:this.icon,stroke:this.stroke}]:null,["io-label",{label:e}]])}};__decorate$z([Property("0")],Y.prototype,"tabindex",void 0),__decorate$z([Property(void 0)],Y.prototype,"value",void 0),__decorate$z([Property({value:"",reflect:!0})],Y.prototype,"icon",void 0),__decorate$z([Property({value:"flush",reflect:!0})],Y.prototype,"appearance",void 0),__decorate$z([Property({value:!1,type:Boolean,reflect:!0})],Y.prototype,"stroke",void 0),__decorate$z([Property({value:!1,type:Boolean,reflect:!0})],Y.prototype,"selected",void 0),__decorate$z([Property({value:!1,type:Boolean,reflect:!0})],Y.prototype,"invalid",void 0),__decorate$z([Property({value:"",type:String,reflect:!0})],Y.prototype,"placeholder",void 0),Y=__decorate$z([Register],Y);var __decorate$y=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let J=class IoButton extends Y{static get Style(){return"\n      :host {\n        text-align: center;\n        padding-left: calc(2 * var(--io_spacing));\n        padding-right: calc(2 * var(--io_spacing));\n        color: var(--io_colorStrong);\n      }\n      :host[pressed] {\n        border-color: var(--io_borderColorInset);\n      }\n    "}_onPointerdown(e){super._onPointerdown(e),this.pressed=!0}_onPointerleave(e){super._onPointerleave(e),this.pressed=!1}_onPointerup(e){super._onPointerup(e),this.pressed=!1}_onKeydown(e){super._onKeydown(e),"Enter"!==e.key&&" "!==e.key||(this.pressed=!0)}_onKeyup(e){super._onKeyup(e),this.pressed=!1}_onClick(){"function"==typeof this.action&&this.action(this.value),this.dispatchEvent("io-button-clicked",{value:this.value},!0)}init(){this.changed()}changed(){this.setAttribute("aria-pressed",String(this.pressed)),this.template([this.icon?["io-icon",{icon:this.icon}]:null,this.label?["io-label",{label:this.label}]:null])}};__decorate$y([Property(void 0)],J.prototype,"action",void 0),__decorate$y([Property(void 0)],J.prototype,"value",void 0),__decorate$y([Property({value:"outset",type:String,reflect:!0})],J.prototype,"appearance",void 0),__decorate$y([Property({value:!1,type:Boolean,reflect:!0})],J.prototype,"pressed",void 0),__decorate$y([Property("button")],J.prototype,"role",void 0),J=__decorate$y([Register],J);var __decorate$x=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let X=class IoBoolean extends Y{static get Style(){return"\n      :host {\n        background-color: transparent;\n        padding: var(--io_spacing) var(--io_spacing);\n      }\n    "}_onClick(){this.toggle(),this.dispatchEvent("io-boolean-clicked",{value:this.value},!0)}toggle(){this.inputValue(!this.value)}init(){this.changed()}changed(){this.setAttribute("value",Boolean(this.value)),this.setAttribute("aria-checked",String(!!this.value)),this.setAttribute("aria-invalid","boolean"!=typeof this.value&&"true");const e=this.value?this.true:this.false;this.template([this.icon?["io-icon",{icon:this.icon,stroke:this.stroke}]:null,e?["io-label",{label:e}]:null])}};__decorate$x([Property({value:!1,type:Boolean,reflect:!0})],X.prototype,"value",void 0),__decorate$x([Property({value:"true",type:String})],X.prototype,"true",void 0),__decorate$x([Property({value:"false",type:String})],X.prototype,"false",void 0),__decorate$x([Property({value:"switch",type:String})],X.prototype,"role",void 0),X=__decorate$x([Register],X);var __decorate$w=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let q=class IoBoolicon extends X{changed(){this.setAttribute("value",Boolean(this.value)),this.setAttribute("aria-checked",String(!!this.value)),this.setAttribute("aria-invalid","boolean"!=typeof this.value&&"true");const e=this.value?this.true:this.false;this.template([this.icon?["io-icon",{icon:this.icon,stroke:this.stroke}]:null,["io-icon",{icon:e,stroke:this.stroke}]])}};q=__decorate$w([Register],q);var __decorate$v=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Q=class IoSwitch extends X{static get Style(){return"\n      :host {\n        position: relative;\n        width: calc(1.5 * var(--io_fieldHeight));\n        overflow: visible;\n      }\n      :host:before {\n        content: '';\n        box-sizing: border-box;\n        position: absolute;\n        visibility: visible;\n        top: var(--io_spacing);\n        left: 0;\n        width: 100%;\n        height: var(--io_lineHeight);\n        border-radius: var(--io_lineHeight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorInset);\n        background-color: var(--io_bgColorField);\n        box-shadow: var(--io_shadowInset);\n        transition: background-color 0.4s;\n      }\n      :host:after {\n        content: '';\n        box-sizing: border-box;\n        position: absolute;\n        visibility: visible;\n        top: calc(var(--io_borderWidth) + var(--io_spacing));\n        left: var(--io_borderWidth);\n        height: calc(var(--io_lineHeight) - calc(2 * var(--io_borderWidth)));\n        width: calc(var(--io_lineHeight) - calc(2 * var(--io_borderWidth)));\n        background-color: var(--io_bgColorDimmed);\n        box-shadow: var(--io_shadowOutset);\n        border: var(--io_border);\n        border-color: var(--io_borderColorOutset);\n        border-radius: var(--io_lineHeight);\n        transition-timing-function: ease-in-out;\n        transition: left 0.25s;\n      }\n      :host[value]:after {\n        background-color: var(--io_bgColorBlue);\n        left: calc(100% - calc(var(--io_lineHeight) - var(--io_borderWidth)));\n      }\n      :host:focus:before {\n        border-color: var(--io_colorBlue);\n        outline: 1px auto var(--io_colorBlue);\n        outline: 1px auto -webkit-focus-ring-color;\n      }\n      :host:focus {\n        outline: 0;\n        border-color: transparent;\n      }\n    "}init(){this.setAttribute("aria-checked",String(!!this.value))}changed(){this.title=this.label}valueChanged(){this.setAttribute("aria-checked",String(!!this.value)),"boolean"!=typeof this.value?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")}};Q=__decorate$v([Register],Q);var __decorate$u=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Z=class IoString extends Y{static get Style(){return"\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        padding-left: var(--io_spacing3);\n        padding-right: var(--io_spacing3);\n      }\n    "}_setFromTextNode(){const e=this.textNode;"string"==typeof this.value&&e!==String(this.value)&&this.inputValue(e)}_tryParseFromTextNode(){const e=this.textNode;try{const t=JSON.parse(e.replace(/[\t\n\r ]+/g," "));this.inputValue(t)}catch(t){console.warn("IoString: Cannot parse value",e),console.error(t),this._setFromTextNode()}}_onBlur(e){super._onBlur(e),this._setFromTextNode(),this.scrollTop=0,this.scrollLeft=0}_onPointerdown(e){this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerup",this._onPointerup)}_onPointermove(e){}_onPointerup(e){this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerup",this._onPointerup),document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length))}_onKeydown(e){const t=window.getSelection().getRangeAt(0),o=t.startOffset,n=t.endOffset,i=this.childNodes[0]?this.childNodes[0].length:0,r=t.startContainer===t.endContainer&&(t.startContainer===this.childNodes[0]||t.startContainer===this);"Enter"===e.key?(e.preventDefault(),e.shiftKey?this._tryParseFromTextNode():this._setFromTextNode()):"ArrowLeft"===e.key?(e.ctrlKey||r&&o===n&&0===o)&&(e.preventDefault(),this.focusTo("left")):"ArrowUp"===e.key?(e.ctrlKey||r&&o===n&&0===o)&&(e.preventDefault(),this.focusTo("up")):"ArrowRight"===e.key?(e.ctrlKey||r&&o===n&&o===i)&&(e.preventDefault(),this.focusTo("right")):"ArrowDown"===e.key&&(e.ctrlKey||r&&o===n&&o===i)&&(e.preventDefault(),this.focusTo("down"))}_onKeyup(e){if(super._onKeyup(e),this.live){const e=this.getCaretPosition();this._setFromTextNode(),this.setCaretPosition(e)}}changed(){this.title=this.label,this.textNode=String(this.value).replace(new RegExp(" ","g"),"")}valueChanged(){"string"!=typeof this.value?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")}};__decorate$u([Property(!1)],Z.prototype,"live",void 0),__decorate$u([Property("")],Z.prototype,"value",void 0),__decorate$u([Property(!0)],Z.prototype,"contenteditable",void 0),__decorate$u([Property("textbox")],Z.prototype,"role",void 0),__decorate$u([Property({value:"inset",reflect:!0})],Z.prototype,"appearance",void 0),Z=__decorate$u([Register],Z);var __decorate$t=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let ee=class IoNumber extends Y{static get Style(){return"\n      :host {\n        cursor: text;\n        user-select: text;\n        -webkit-user-select: text;\n        -webkit-touch-callout: default;\n        font-family: monospace;\n        padding-left: var(--io_spacing3);\n        padding-right: var(--io_spacing3);\n      }\n    "}_pointer="";_onBlur(e){super._onBlur(e),this._setFromTextNode(),this.scrollTop=0,this.scrollLeft=0,setTimeout((()=>{document.activeElement.parentElement!==ie&&(ie.expanded=!1)}))}_onPointerdown(e){"touch"===this._pointer&&e.preventDefault(),this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerup",this._onPointerup),document.activeElement===this&&0===e.button||(this._pointer=e.pointerType)}_onPointerup(e){this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerup",this._onPointerup),this.ladder||1===e.button?("touch"===this._pointer?(e.preventDefault(),document.activeElement.blur()):document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length)),this._expandLadder()):document.activeElement!==this&&(this.focus(),this.setCaretPosition(this.textNode.length))}_onFocus(e){super._onFocus(e),"touch"===this._pointer&&(ie.expanded=!1)}_expandLadder(){ie.src=this,ie.expanded=!0}_onKeydown(e){const t=window.getSelection().getRangeAt(0),o=t.startOffset,n=t.endOffset,i=this.childNodes[0]?this.childNodes[0].length:0,r=t.startContainer===t.endContainer&&(t.startContainer===this.childNodes[0]||t.startContainer===this);if(27===e.which||13===e.which||32===e.which)e.preventDefault(),this._setFromTextNode();else if(36===e.which)this.textNode=this.min,this._setFromTextNode();else if(35===e.which)this.textNode=this.max,this._setFromTextNode();else if(33===e.which){const e=Number(this.textNode);!isNaN(e)&&Math.abs(e)<Infinity?this.textNode=Number(this.textNode)+this.step:this.textNode=this.step,this._setFromTextNode()}else if(34===e.which){const e=Number(this.textNode);!isNaN(e)&&Math.abs(e)<Infinity?this.textNode=Number(this.textNode)-this.step:this.textNode=-this.step,this._setFromTextNode()}else if(37===e.which)(e.ctrlKey||r&&o===n&&0===o)&&(e.preventDefault(),this.focusTo("left"));else if(38===e.which)if(ie.expanded){const e=ie.querySelector(".io-up1");e&&e.focus()}else(e.ctrlKey||r&&o===n&&0===o)&&(e.preventDefault(),this.focusTo("up"));else if(39===e.which)(e.ctrlKey||r&&o===n&&o===i)&&(e.preventDefault(),this.focusTo("right"));else if(40===e.which)if(ie.expanded){const e=ie.querySelector(".io-down1");e&&e.focus()}else(e.ctrlKey||r&&o===n&&o===i)&&(e.preventDefault(),this.focusTo("down"))}_onKeyup(e){17===e.which?this._expandLadder():27!==e.which&&13!==e.which&&32!==e.which||(G.expanded=!1)}_setFromTextNode(){const e=this.textNode;let t=Number(e)/this.conversion;t=Math.min(this.max,Math.max(this.min,t)),t=Math.round(t/this.step)*this.step;const o=Math.max(0,Math.min(100,-Math.floor(Math.log(this.step)/Math.LN10)));t=Number(t.toFixed(o)),isNaN(t)?this.textNode="NaN":this.inputValue(t)}init(){this.changed()}changed(){this.setAttribute("value",this.value),this.setAttribute("aria-valuenow",this.value),this.setAttribute("aria-valuemin",this.min),this.setAttribute("aria-valuemax",this.max),this.setAttribute("aria-valuestep",this.step),"number"!=typeof this.value||isNaN(this.value)?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid");let e,t=this.value;if("number"!=typeof t||isNaN(t))e="NaN";else{t*=this.conversion;let o=-Math.floor(Math.log(this.step*this.conversion)/Math.LN10);o=Math.max(0,Math.min(100,o)),t=Number(t.toFixed(o)),e=String(t)}this.setAttribute("value",e),this.setAttribute("positive",this.value>=0),this.textNode=e}};__decorate$t([Property("textbox")],ee.prototype,"role",void 0),__decorate$t([Property({value:0,type:Number})],ee.prototype,"value",void 0),__decorate$t([Property({value:1,type:Number})],ee.prototype,"conversion",void 0),__decorate$t([Property({value:1e-4,type:Number})],ee.prototype,"step",void 0),__decorate$t([Property({value:-Infinity,type:Number})],ee.prototype,"min",void 0),__decorate$t([Property({value:Infinity,type:Number})],ee.prototype,"max",void 0),__decorate$t([Property({value:!1,type:Boolean})],ee.prototype,"ladder",void 0),__decorate$t([Property({value:!0,type:Boolean})],ee.prototype,"contenteditable",void 0),__decorate$t([Property({value:"number",type:String,reflect:!0})],ee.prototype,"type",void 0),__decorate$t([Property({value:'pattern="[0-9]*"',type:String,reflect:!0})],ee.prototype,"pattern",void 0),__decorate$t([Property({value:"numeric",type:String,reflect:!0})],ee.prototype,"inputmode",void 0),__decorate$t([Property({value:"false",type:String,reflect:!0})],ee.prototype,"spellcheck",void 0),__decorate$t([Property({value:"inset",type:String,reflect:!0})],ee.prototype,"appearance",void 0),ee=__decorate$t([Register],ee);let te=null;window.addEventListener("focusin",(()=>{te=document.activeElement}),{capture:!1}),window.addEventListener("blur",(()=>{setTimeout((()=>{document.activeElement===document.body&&(te=null)}))}),{capture:!0});let oe=class IoNumberLadderStep extends Y{static get Style(){return"\n      :host {\n        pointer-events: all;\n        display: inline-block;\n        cursor: ew-resize;\n        text-align: center;\n        background-color: var(--io_bgColorStrong);\n        color: var(--io_color);\n        align-self: stretch;\n        touch-action: none;\n        width: 6em;\n      }\n      :host:before {\n        float: left;\n        content: '<';\n        opacity: 0.25;\n      }\n      :host:after {\n        float: right;\n        content: '>';\n        opacity: 0.25;\n      }\n    "}_onKeydown(e){let t=0;"Escape"===e.key||" "===e.key?this.dispatchEvent("ladder-step-collapse",{},!0):"ArrowLeft"===e.key||"Backspace"===e.key?(e.preventDefault(),t=-1*this.value):"ArrowUp"===e.key?(e.preventDefault(),this.focusTo("up")):"ArrowRight"===e.key||"Enter"===e.key?(e.preventDefault(),t=1*this.value):"ArrowDown"===e.key&&(e.preventDefault(),this.focusTo("down")),0!==t&&this.dispatchEvent("ladder-step-change",{step:Number(t.toFixed(5)),round:e.shiftKey},!0)}_onPointerdown(e){this.setPointerCapture(e.pointerId),this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerup",this._onPointerup),this._startX=e.clientX}_onPointermove(e){const t=e.clientX-this._startX;if(Math.abs(t)>5){const o=Math.pow(t/5,2)*t<0?-1:1,n=t>0?Math.floor(o):Math.ceil(o),i=this.value*n;this._startX=e.clientX,this.dispatchEvent("ladder-step-change",{step:Number(i.toFixed(5)),round:e.shiftKey},!0)}}_onPointerup(e){this.releasePointerCapture(e.pointerId),this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerup",this._onPointerup),this.dispatchEvent("ladder-step-collapse",{},!0)}init(){this.changed()}changed(){super.changed(),this.setAttribute("aria-valuestep",this.value)}};__decorate$t([Property({value:1,type:Number})],oe.prototype,"value",void 0),__decorate$t([Property({value:"number",type:String,reflect:!0})],oe.prototype,"type",void 0),__decorate$t([Property({value:"spinbutton",type:String})],oe.prototype,"role",void 0),oe=__decorate$t([Register],oe);let ne=class IoNumberLadder extends C{static get Style(){return"\n      :host {\n        display: flex;\n        flex-direction: column;\n        position: absolute;\n        pointer-events: none;\n        user-select: none;\n        -webkit-tap-highlight-color: transparent;\n        -webkit-user-select: none;\n        -webkit-touch-callout: none;\n      }\n      :host:not([expanded]) {\n        visibility: hidden;\n      }\n      :host:not([expanded]) > io-number-ladder-step {\n        opacity: 0.5;\n      }\n      :host > io-number-ladder-step:nth-child(-n+5) {\n        box-shadow: 0 -1px 4px rgba(0,0,0,0.2);\n      }\n      :host > io-number-ladder-step:nth-child(n+6) {\n        box-shadow: 0 1px 4px rgba(0,0,0,0.2);\n      }\n      :host > .io-up1,\n      :host > .io-down1{\n        z-index: 4;\n        transition: opacity 0.1s, transform 0.1s;\n      }\n      :host > .io-up2,\n      :host > .io-down2 {\n        z-index: 3;\n        opacity: 0.8;\n        transition: opacity 0.2s, transform 0.2s;\n      }\n      :host:not([expanded]) > .io-up4 {\n        transform: translateY(calc(3 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-up3 {\n        transform: translateY(calc(2 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-up2 {\n        transform: translateY(calc(1 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down2 {\n        transform: translateY(calc(-1 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down3 {\n        transform: translateY(calc(-2 * var(--io_fieldHeight)));\n      }\n      :host:not([expanded]) > .io-down4 {\n        transform: translateY(calc(-3 * var(--io_fieldHeight)));\n      }\n      :host > .io-up3,\n      :host > .io-down3 {\n        z-index: 2;\n        opacity: 0.6;\n        transition: opacity 0.4s, transform 0.4s;\n      }\n      :host > .io-up4,\n      :host > .io-down4 {\n        z-index: 1;\n        opacity: 0.4;\n        transition: opacity 0.8s, transform 0.8s;\n      }\n      :host > io-number-ladder-step:hover,\n      :host > io-number-ladder-step:focus {\n        background-color: var(--io_bgColorStrong);\n        border-color: var(--io_colorBlue);\n        transition: opacity 0.2s;\n        opacity: 1;\n      }\n      :host > .io-number-ladder-empty {\n        height: var(--io_fieldHeight);\n      }\n      :host > .io-number-ladder-center {\n        height: calc(1.5 * var(--io_fieldHeight));\n      }\n    "}static get Listeners(){return{"ladder-step-change":"_onLadderStepChange","ladder-step-collapse":"_onLadderStepCollapse",focusin:"_onFocusIn"}}get value(){return this.src?this.src.value:0}get min(){return this.src?this.src.min:-Infinity}get max(){return this.src?this.src.max:Infinity}get step(){return this.src?this.src.step:1e-4}get conversion(){return this.src?this.src.conversion:1}_onFocusIn(e){e.stopPropagation()}_onFocusTo(e){e.stopPropagation();const t=e.composedPath()[0],o=this.src,n=e.detail.dir;if(o&&(t===this.querySelector(".io-up1")&&"down"===n||t===this.querySelector(".io-down1")&&"up"===n))return o.focus(),void(o.selectionStart=o.selectionEnd=o.textNode.length);super._onFocusTo(e)}_onLadderStepChange(e){const t=this.src;if(t){const o=e.detail.step,n=e.detail.round?Math.round(this.value/o)*o:this.value;let i=Math.min(this.max,Math.max(this.min,n+o));i=Number(i.toFixed(5)),t.inputValue(i)}}_onLadderStepCollapse(){this.setProperty("expanded",!1)}expandedChanged(){const e=this.src;if(this.expanded)if(e){const t=e.getBoundingClientRect(),o=this.getBoundingClientRect(),n=G.getBoundingClientRect();this.style.top=t.bottom-n.top+"px",this.style.left=t.left-n.left+"px",this.style.marginTop=-(o.height/2+A.lineHeight/2+A.spacing)+"px"}else this.removeAttribute("style");else e&&"touch"!==e._pointerType?e.focus():te&&te.focus();this.dispatchEvent("expanded",{value:this.expanded},!0)}changed(){const e=this.max-this.min,t=["span",{class:"io-number-ladder-empty"}];let o=this.step/1e4;for(;o<.1;)o*=10;const n=1e4*o,i=1e3*o,r=100*o,s=10*o,a=1*o,l=.1*o,h=.01*o,c=.001*o,d=Number((n*this.conversion).toFixed(6)),p=Number((i*this.conversion).toFixed(6)),u=Number((r*this.conversion).toFixed(6)),v=Number((s*this.conversion).toFixed(6)),g=Number((a*this.conversion).toFixed(6)),f=Number((l*this.conversion).toFixed(6)),b=Number((h*this.conversion).toFixed(6)),m=Number((c*this.conversion).toFixed(6));this.template([e>=n?["io-number-ladder-step",{class:"io-up4",value:n,label:String(d)}]:t,e>=i?["io-number-ladder-step",{class:"io-up3",value:i,label:String(p)}]:t,e>=r?["io-number-ladder-step",{class:"io-up2",value:r,label:String(u)}]:t,e>=s?["io-number-ladder-step",{class:"io-up1",value:s,label:String(v)}]:t,["span",{class:"io-number-ladder-center"}],this.step<=a?["io-number-ladder-step",{class:"io-down1",value:a,label:String(g)}]:t,this.step<=l?["io-number-ladder-step",{class:"io-down2",value:l,label:String(f)}]:t,this.step<=h?["io-number-ladder-step",{class:"io-down3",value:h,label:String(b)}]:t,this.step<=c?["io-number-ladder-step",{class:"io-down4",value:c,label:String(m)}]:t]),this.setAttribute("aria-valuemin",this.min),this.setAttribute("aria-valuemax",this.max),this.setAttribute("aria-valuenow",this.value),this.setAttribute("aria-valuestep",this.step),this.setAttribute("aria-invalid",!("number"==typeof this.value&&!isNaN(this.value))&&"true");const y=this.querySelectorAll("io-number-ladder-step");for(let e=y.length;e--;)y[e].setAttribute("aria-valuemin",this.min),y[e].setAttribute("aria-valuemax",this.max),y[e].setAttribute("aria-valuenow",this.value),y[e].changed()}};__decorate$t([Property({value:"list",type:String})],ne.prototype,"role",void 0),__decorate$t([Property({value:void 0,type:ee})],ne.prototype,"src",void 0),__decorate$t([Property({value:!1,type:Boolean,reflect:!0})],ne.prototype,"expanded",void 0),ne=__decorate$t([Register],ne);const ie=new ne;G.appendChild(ie);var __decorate$s=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const re={};let se=class IoIconset extends i{registerIcons(e,t){const o=document.createElement("div");o.innerHTML=t,o.querySelectorAll("[id]").forEach((t=>{re[e]=re[e]||{},re[e][t.id]=t.outerHTML}))}getIcon(e){const t=re[e.split(":")[0]];if(t){const o=e.split(":")[1];if(t[o]){return`<svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet">${t[o].replace(' id="',' class="icon-id-')}</svg>`}}return'<svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"></svg>'}};se=__decorate$s([Register],se);const ae=new se;ae.registerIcons("icons",'\n<svg>\n<g id="io">\n  <ellipse fill="#83A61E" cx="5.4" cy="12.1" rx="3.4" ry="3.4"/>\n  <path fill="#646464" d="M16.3,17.7c-3.1,0-5.6-2.6-5.6-5.6s2.6-5.6,5.6-5.6s5.6,2.6,5.6,5.6S19.3,17.7,16.3,17.7z M16.3,8.8\n    c-1.8,0-3.3,1.5-3.3,3.2s1.5,3.2,3.3,3.2s3.3-1.5,3.3-3.2S18.1,8.8,16.3,8.8z"/>\n</g>\n<g id="io_logo">\n  <path fill="#646464" d="M19.5,12.7c0.3-0.3,0.3-0.9,0-1.2l-0.7-0.7l-2.6-2.6c-0.3-0.3-0.3-0.9,0-1.2c0.3-0.3,0.9-0.3,1.2,0l3.8,3.8\n    c0.7,0.7,0.7,1.8,0,2.6l-3.8,3.8c-0.3,0.3-0.9,0.3-1.2,0c-0.3-0.3-0.3-0.9,0-1.2"/>\n  <path fill="#646464" d="M4.3,12.7c-0.3-0.3-0.3-0.9,0-1.2L5,10.8l2.6-2.6c0.3-0.3,0.3-0.9,0-1.2C7.3,6.7,6.7,6.7,6.4,7l-3.8,3.8\n    c-0.7,0.7-0.7,1.8,0,2.6l3.8,3.8c0.3,0.3,0.9,0.3,1.2,0s0.3-0.9,0-1.2"/>\n  <ellipse fill="#83A61E" cx="8.4" cy="12.1" rx="1.7" ry="1.7"/>\n  <path fill="#646464" d="M13.9,14.9c-1.6,0-2.8-1.2-2.8-2.8s1.2-2.8,2.8-2.8s2.8,1.2,2.8,2.8S15.4,14.9,13.9,14.9z M13.9,10.4\n    c-0.9,0-1.7,0.7-1.7,1.7c0,0.9,0.7,1.7,1.7,1.7c0.9,0,1.7-0.7,1.7-1.7C15.5,11.2,14.8,10.4,13.9,10.4z"/>\n</g>\n</svg>');var __decorate$r=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let le=class IoIcon extends C{static get Style(){return"\n      --ioIcon: {\n        display: inline-block;\n        width: var(--io_lineHeight);\n        height: var(--io_lineHeight);\n        min-width: var(--io_lineHeight);\n        line-height: var(--io_lineHeight);\n        font-size: var(--io_fontSize);\n        text-align: center;\n        fill: var(--io_color);\n      }\n      :host {\n        @apply --ioIcon;\n      }\n      :host:not([icon]) {\n        display: none;\n      }\n      :host[stroke] {\n        stroke: var(--io_colorStrong);\n        stroke-width: var(--io_borderWidth);\n      }\n      :host > svg {\n        height: 100%;\n      }\n      :host > svg > g {\n        transform-origin: 0px 0px;\n      }\n    "}iconChanged(){-1!==this.icon.search(":")?this.innerHTML=ae.getIcon(this.icon):this.textNode=this.icon}};__decorate$r([Property({value:"",type:String,reflect:!0})],le.prototype,"icon",void 0),__decorate$r([Property({value:!1,type:Boolean,reflect:!0})],le.prototype,"stroke",void 0),le=__decorate$r([Register],le);
/**@License
 * Copyright (c) 2011-2016 Heather Arthur <fayearthur@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
const he={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(const e of Object.keys(he)){if(!("channels"in he[e]))throw new Error("missing channels property: "+e);if(!("labels"in he[e]))throw new Error("missing channel labels property: "+e);if(he[e].labels.length!==he[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:o}=he[e];delete he[e].channels,delete he[e].labels,Object.defineProperty(he[e],"channels",{value:t}),Object.defineProperty(he[e],"labels",{value:o})}he.rgb.hsl=function(e){const t=e[0]/255,o=e[1]/255,n=e[2]/255,i=Math.min(t,o,n),r=Math.max(t,o,n),s=r-i;let a,l=0;r===i?l=0:t===r?l=(o-n)/s:o===r?l=2+(n-t)/s:n===r&&(l=4+(t-o)/s),l=Math.min(60*l,360),l<0&&(l+=360);const h=(i+r)/2;return a=r===i?0:h<=.5?s/(r+i):s/(2-r-i),[l,100*a,100*h]},he.rgb.hsv=function(e){let t,o,n,i,r=0;const s=e[0]/255,a=e[1]/255,l=e[2]/255,h=Math.max(s,a,l),c=h-Math.min(s,a,l),diffc=function(e){return(h-e)/6/c+.5};return 0===c?(r=0,i=0):(i=c/h,t=diffc(s),o=diffc(a),n=diffc(l),s===h?r=n-o:a===h?r=1/3+t-n:l===h&&(r=2/3+o-t),r<0?r+=1:r>1&&(r-=1)),[360*r,100*i,100*h]},he.rgb.hwb=function(e){const t=e[0],o=e[1];let n=e[2];const i=he.rgb.hsl(e)[0],r=1/255*Math.min(t,Math.min(o,n));return n=1-1/255*Math.max(t,Math.max(o,n)),[i,100*r,100*n]},he.rgb.xyz=function(e){let t=e[0]/255,o=e[1]/255,n=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;return[100*(.4124*t+.3576*o+.1805*n),100*(.2126*t+.7152*o+.0722*n),100*(.0193*t+.1192*o+.9505*n)]},he.rgb.lab=function(e){const t=he.rgb.xyz(e);let o=t[0],n=t[1],i=t[2];o/=95.047,n/=100,i/=108.883,o=o>.008856?o**(1/3):7.787*o+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;return[116*n-16,500*(o-n),200*(n-i)]},he.hsl.rgb=function(e){const t=e[0]/360,o=e[1]/100,n=e[2]/100;let i,r,s;if(0===o)return s=255*n,[s,s,s];i=n<.5?n*(1+o):n+o-n*o;const a=2*n-i,l=[0,0,0];for(let e=0;e<3;e++)r=t+1/3*-(e-1),r<0&&r++,r>1&&r--,s=6*r<1?a+6*(i-a)*r:2*r<1?i:3*r<2?a+(i-a)*(2/3-r)*6:a,l[e]=255*s;return l},he.hsl.hsv=function(e){const t=e[0];let o=e[1]/100,n=e[2]/100,i=o;const r=Math.max(n,.01);n*=2,o*=n<=1?n:2-n,i*=r<=1?r:2-r;return[t,100*(0===n?2*i/(r+i):2*o/(n+o)),100*((n+o)/2)]},he.hsv.rgb=function(e){const t=e[0]/60,o=e[1]/100;let n=e[2]/100;const i=Math.floor(t)%6,r=t-Math.floor(t),s=255*n*(1-o),a=255*n*(1-o*r),l=255*n*(1-o*(1-r));switch(n*=255,i){case 0:return[n,l,s];case 1:return[a,n,s];case 2:return[s,n,l];case 3:return[s,a,n];case 4:return[l,s,n];default:return[n,s,a]}},he.hsv.hsl=function(e){const t=e[0],o=e[1]/100,n=e[2]/100,i=Math.max(n,.01);let r,s;s=(2-o)*n;const a=(2-o)*i;return r=o*i,r/=a<=1?a:2-a,r=r||0,s/=2,[t,100*r,100*s]},he.hwb.rgb=function(e){const t=e[0]/360;let o=e[1]/100,n=e[2]/100;const i=o+n;let r;i>1&&(o/=i,n/=i);const s=Math.floor(6*t),a=1-n;r=6*t-s,1&s&&(r=1-r);const l=o+r*(a-o);let h,c,d;switch(s){default:case 6:case 0:h=a,c=l,d=o;break;case 1:h=l,c=a,d=o;break;case 2:h=o,c=a,d=l;break;case 3:h=o,c=l,d=a;break;case 4:h=l,c=o,d=a;break;case 5:h=a,c=o,d=l}return[255*h,255*c,255*d]},he.xyz.rgb=function(e){const t=e[0]/100,o=e[1]/100,n=e[2]/100;let i,r,s;return i=3.2406*t+-1.5372*o+-.4986*n,r=-.9689*t+1.8758*o+.0415*n,s=.0557*t+-.204*o+1.057*n,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i=Math.min(Math.max(0,i),1),r=Math.min(Math.max(0,r),1),s=Math.min(Math.max(0,s),1),[255*i,255*r,255*s]},he.xyz.lab=function(e){let t=e[0],o=e[1],n=e[2];t/=95.047,o/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;return[116*o-16,500*(t-o),200*(o-n)]},he.lab.xyz=function(e){let t,o,n;o=(e[0]+16)/116,t=e[1]/500+o,n=o-e[2]/200;const i=o**3,r=t**3,s=n**3;return o=i>.008856?i:(o-16/116)/7.787,t=r>.008856?r:(t-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,t*=95.047,o*=100,n*=108.883,[t,o,n]},he.lab.lch=function(e){const t=e[0],o=e[1],n=e[2];let i;i=360*Math.atan2(n,o)/2/Math.PI,i<0&&(i+=360);return[t,Math.sqrt(o*o+n*n),i]},he.lch.lab=function(e){const t=e[0],o=e[1],n=e[2]/360*2*Math.PI;return[t,o*Math.cos(n),o*Math.sin(n)]},he.rgb.ansi16=function(e,t=null){const[o,n,i]=e;let r=null===t?he.rgb.hsv(e)[2]:t;if(r=Math.round(r/50),0===r)return 30;let s=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(o/255));return 2===r&&(s+=60),s},he.hsv.ansi16=function(e){return he.rgb.ansi16(he.hsv.rgb(e),e[2])},he.rgb.ansi256=function(e){const t=e[0],o=e[1],n=e[2];if(t===o&&o===n)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(o/255*5)+Math.round(n/255*5)},he.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const o=.5*(1+~~(e>50));return[(1&t)*o*255,(t>>1&1)*o*255,(t>>2&1)*o*255]},he.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},he.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},he.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let o=t[0];3===t[0].length&&(o=o.split("").map((e=>e+e)).join(""));const n=parseInt(o,16);return[n>>16&255,n>>8&255,255&n]},he.rgb.hcg=function(e){const t=e[0]/255,o=e[1]/255,n=e[2]/255,i=Math.max(Math.max(t,o),n),r=Math.min(Math.min(t,o),n),s=i-r;let a,l;return a=s<1?r/(1-s):0,l=s<=0?0:i===t?(o-n)/s%6:i===o?2+(n-t)/s:4+(t-o)/s+4,l/=6,l%=1,[360*l,100*s,100*a]},he.hsl.hcg=function(e){const t=e[1]/100,o=e[2]/100,n=o<.5?2*t*o:2*t*(1-o);let i=0;return n<1&&(i=(o-.5*n)/(1-n)),[e[0],100*n,100*i]},he.hsv.hcg=function(e){const t=e[1]/100,o=e[2]/100,n=t*o;let i=0;return n<1&&(i=(o-n)/(1-n)),[e[0],100*n,100*i]},he.hcg.rgb=function(e){const t=e[0]/360,o=e[1]/100,n=e[2]/100;if(0===o)return[255*n,255*n,255*n];const i=[0,0,0],r=t%1*6,s=r%1,a=1-s;let l=0;switch(Math.floor(r)){case 0:i[0]=1,i[1]=s,i[2]=0;break;case 1:i[0]=a,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=s;break;case 3:i[0]=0,i[1]=a,i[2]=1;break;case 4:i[0]=s,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=a}return l=(1-o)*n,[255*(o*i[0]+l),255*(o*i[1]+l),255*(o*i[2]+l)]},he.hcg.hsv=function(e){const t=e[1]/100,o=t+e[2]/100*(1-t);let n=0;return o>0&&(n=t/o),[e[0],100*n,100*o]},he.hcg.hsl=function(e){const t=e[1]/100,o=e[2]/100*(1-t)+.5*t;let n=0;return o>0&&o<.5?n=t/(2*o):o>=.5&&o<1&&(n=t/(2*(1-o))),[e[0],100*n,100*o]},he.hcg.hwb=function(e){const t=e[1]/100,o=t+e[2]/100*(1-t);return[e[0],100*(o-t),100*(1-o)]},he.hwb.hcg=function(e){const t=e[1]/100,o=1-e[2]/100,n=o-t;let i=0;return n<1&&(i=(o-n)/(1-n)),[e[0],100*n,100*i]},he.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},he.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},he.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},he.gray.hsl=function(e){return[0,0,e[0]]},he.gray.hsv=he.gray.hsl,he.gray.hwb=function(e){return[0,100,e[0]]},he.gray.lab=function(e){return[e[0],0,0]},he.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),o=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(o.length)+o},he.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};var __decorate$q=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};class IoColorBase extends C{init(){this.valueChanged()}valueMutated(){this.valueChanged()}rgbFromHsv(){const e=he.hsv.rgb([360*this.hsv[0],100*this.hsv[1],100*this.hsv[2]]);this.rgba[0]=e[0]/255,this.rgba[1]=e[1]/255,this.rgba[2]=e[2]/255}rgbFromHsl(){const e=he.hsl.rgb([360*this.hsl[0],100*this.hsl[1],100*this.hsl[2]]);this.rgba[0]=e[0]/255,this.rgba[1]=e[1]/255,this.rgba[2]=e[2]/255}valueFromRgb(){this.value.r=this.rgba[0],this.value.g=this.rgba[1],this.value.b=this.rgba[2]}valueChanged(){{const e=Object.keys(this.value);-1!==e.indexOf("r")&&-1!==e.indexOf("g")&&-1!==e.indexOf("b")||console.warn("IoColor: Incorrect value type!")}const e=[255*this.value.r,255*this.value.g,255*this.value.b],t=he.rgb.hsv(e),o=he.rgb.hsl(e);0!==t[0]&&360!==t[0]||(t[0]=360*this.hsv[0]),0!==o[1]&&0!==o[1]||(o[0]=360*this.hsl[0]),0===t[1]&&(t[0]=360*this.hsv[0]),0===o[1]&&(o[0]=360*this.hsl[0]),0===t[2]&&(t[1]=100*this.hsv[1]),0!==o[2]&&100!==o[2]||(o[0]=360*this.hsl[0],o[1]=100*this.hsl[1]),this.setProperties({rgba:[e[0]/255,e[1]/255,e[2]/255,this.value.a??1],hsv:[t[0]/360,t[1]/100,t[2]/100],hsl:[o[0]/360,o[1]/100,o[2]/100]})}}__decorate$q([Property({type:Object,init:{r:1,g:1,b:1,a:1}})],IoColorBase.prototype,"value",void 0),__decorate$q([Property({type:Array,init:[1,1,1,1]})],IoColorBase.prototype,"rgba",void 0),__decorate$q([Property({type:Array,init:[1,1,1]})],IoColorBase.prototype,"hsv",void 0),__decorate$q([Property({type:Array,init:[1,1,1]})],IoColorBase.prototype,"hsl",void 0);var __decorate$p=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const clamp=(e,t,o)=>o>t?Math.min(Math.max(e,t),o):Math.min(Math.max(e,o),t);class IoSliderBase extends V{static get Style(){return"\n      :host {\n        display: flex;\n        cursor: ew-resize;\n        border: var(--io_border);\n        border-radius: var(--io_borderRadius);\n        border-color: var(--io_borderColorInset);\n        min-height: var(--io_fieldHeight);\n        min-width: var(--io_fieldHeight);\n      }\n      :host:not([vertical]) {\n        width: var(--io_fieldHeight10);\n      }\n      :host[vertical] {\n        cursor: ns-resize;\n        height: var(--io_fieldHeight5);\n        min-height: var(--io_fieldHeight5);\n        flex-basis: var(--io_fieldHeight);\n        flex-grow: 0;\n      }\n    "}_startX=0;_startY=0;_active=-1;_rect=null;get _min(){return"number"==typeof this.min?[this.min,this.min]:this.min instanceof Array?[...this.min]:"object"==typeof this.min?[this.min.x,this.min.y]:[-Infinity,-Infinity]}get _max(){return"number"==typeof this.max?[this.max,this.max]:this.max instanceof Array?[...this.max]:"object"==typeof this.max?[this.max.x,this.max.y]:[Infinity,Infinity]}get _step(){return"number"==typeof this.step?[this.step,this.step]:this.step instanceof Array?[...this.step]:"object"==typeof this.step?[this.step.x,this.step.y]:[.01,.01]}get _value(){return"number"==typeof this.value?[this.value,this.value]:this.value instanceof Array?[...this.value]:"object"==typeof this.value?[this.value.x,this.value.y]:[NaN,NaN]}static get Listeners(){return{focus:"_onFocus",contextmenu:"_onContextmenu",pointerdown:"_onPointerdown",touchstart:["_onTouchstart",{passive:!1}]}}_onFocus(){this.addEventListener("blur",this._onBlur),this.addEventListener("keydown",this._onKeydown)}_onBlur(){this.removeEventListener("blur",this._onBlur),this.removeEventListener("keydown",this._onKeydown)}_onContextmenu(e){e.preventDefault()}_onTouchstart(e){this._rect=this.getBoundingClientRect(),this.addEventListener("touchmove",this._onTouchmove,{passive:!1}),this.addEventListener("touchend",this._onTouchend),this._startX=e.changedTouches[0].clientX,this._startY=e.changedTouches[0].clientY,this._active=this.noscroll?1:-1}_onTouchmove(e){const t=Math.abs(this._startX-e.changedTouches[0].clientX),o=Math.abs(this._startY-e.changedTouches[0].clientY);-1===this._active&&(this.vertical?o>5&&o>t&&(this._active=o>t&&t<5?1:0):t>5&&t>o&&(this._active=t>o&&o<5?1:0)),1===this._active&&e.cancelable&&e.preventDefault()}_onTouchend(){this.removeEventListener("touchmove",this._onTouchmove),this.removeEventListener("touchend",this._onTouchend)}_onPointerdown(e){this._rect=this.getBoundingClientRect(),this.setPointerCapture(e.pointerId),this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerup",this._onPointerup),this.addEventListener("pointercancel",this._onPointerup)}_onPointermove(e){"touch"!==e.pointerType&&(this._active=1),this.throttle(this._onPointermoveThrottled,e)}_onPointerup(e){this.releasePointerCapture(e.pointerId),this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerup",this._onPointerup),this.removeEventListener("pointercancel",this._onPointerup),this._active=-1}_getPointerCoord(e){const t=this._rect||this.getBoundingClientRect();let o=Math.max(0,Math.min(1,(e.clientX-t.x)/t.width)),n=Math.max(0,Math.min(1,1-(e.clientY-t.y)/t.height));return o=Math.pow(o,this.exponent),n=Math.pow(n,this.exponent),this.vertical?[n,o]:[o,n]}_getValueFromCoord(e){const t=[0,0],o=this._min,n=this._max;return t[0]=o[0]*(1-e[0])+n[0]*e[0],t[1]=o[1]*(1-e[1])+n[1]*e[1],t}_onPointermoveThrottled(e){if(1===this._active){document.activeElement!==this&&this.focus();const t=this._getPointerCoord(e),o=this._getValueFromCoord(t);this._inputValue(o)}}_inputValue(e){const t=this._min,o=this._max,n=this._step;if(e[0]=clamp(e[0],o[0],t[0]),e[1]=clamp(e[1],o[1],t[1]),e[0]=Math.round(e[0]/n[0])*n[0],e[1]=Math.round(e[1]/n[1])*n[1],e[0]=Number(e[0].toFixed(5)),e[1]=Number(e[1].toFixed(5)),"number"==typeof this.value)this.inputValue(e[0]);else if(this.value instanceof Array)this.value[0]=e[0],this.value[1]=e[1],this.inputValue(this.value),this.dispatchEvent("object-mutated",{object:this.value},!1,window);else if("object"==typeof this.value){const t=this.value;t.x=e[0],t.y=e[1],this.inputValue(this.value),this.dispatchEvent("object-mutated",{object:this.value},!1,window)}}_onKeydown(e){const t="number"==typeof this.value;switch(e.key){case"ArrowLeft":e.preventDefault(),e.shiftKey?t?this._setDecrease():this._setLeft():this.focusTo("left");break;case"ArrowUp":e.preventDefault(),e.shiftKey?t?this._setIncrease():this._setUp():this.focusTo("up");break;case"ArrowRight":e.preventDefault(),e.shiftKey?t?this._setIncrease():this._setRight():this.focusTo("right");break;case"ArrowDown":e.preventDefault(),e.shiftKey?t?this._setDecrease():this._setDown():this.focusTo("down")}}_setIncrease(){const e=this._value,t=this._step;e[0]=e[0]+t[0],e[1]=e[1]+t[1],this._inputValue(e)}_setDecrease(){const e=this._value,t=this._step;e[0]=e[0]-t[0],e[1]=e[1]-t[1],this._inputValue(e)}_setMin(){const e=this._min;this._inputValue(e)}_setMax(){const e=this._max;this._inputValue(e)}_setUp(){const e=this._value,t=this._step;e[0]=e[0]+t[0],this._inputValue(e)}_setDown(){const e=this._value,t=this._step;e[0]=e[0]-t[0],this._inputValue(e)}_setLeft(){const e=this._value,t=this._step;e[1]=e[1]-t[1],this._inputValue(e)}_setRight(){const e=this._value,t=this._step;e[1]=e[1]+t[1],this._inputValue(e)}init(){this.changed()}changed(){super.changed(),this.setAttribute("aria-valuemin",JSON.stringify(this.min)),this.setAttribute("aria-valuemax",JSON.stringify(this.max)),this.setAttribute("aria-valuestep",JSON.stringify(this.step));const e=this._value;"number"!=typeof e[0]||isNaN(e[0])?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid"),this.setAttribute("aria-valuenow",JSON.stringify(this.value))}}__decorate$p([Property({value:0})],IoSliderBase.prototype,"value",void 0),__decorate$p([Property(.01)],IoSliderBase.prototype,"step",void 0),__decorate$p([Property(0)],IoSliderBase.prototype,"min",void 0),__decorate$p([Property(1)],IoSliderBase.prototype,"max",void 0),__decorate$p([Property(1)],IoSliderBase.prototype,"exponent",void 0),__decorate$p([Property({value:!1,reflect:!0})],IoSliderBase.prototype,"vertical",void 0),__decorate$p([Property(!1)],IoSliderBase.prototype,"noscroll",void 0),__decorate$p([Property("slider")],IoSliderBase.prototype,"role",void 0),__decorate$p([Property("0")],IoSliderBase.prototype,"tabindex",void 0);var __decorate$o=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let ce=class IoSlider extends IoSliderBase{static get Frag(){return"\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * vec2(uv.x, uv.y - 0.5);\n      vec2 expPosition = size * vec2(pow(uv.x, uExponent), uv.y - 0.5);\n      float valueInRange = (uValue - uMin) / (uMax - uMin);\n      float valueSign = sign(valueInRange);\n      float expValueInRange = pow(abs(valueInRange), 1./uExponent) * valueSign;\n\n      // Colors\n      vec3 finalCol = io_bgColorField.rgb;\n      vec3 gridCol = io_bgColorDimmed.rgb;\n      vec3 sliderCol = io_bgColorBlue.rgb;\n      vec3 lineCol1 = io_color.rgb;\n      vec3 lineCol2 = io_bgColor.rgb;\n\n      // Grid\n      float gridSize = size.x / abs((uMax - uMin) / uStep);\n      float gridOffset = mod(uStep - uMin, uStep) / (uMax - uMin) * size.x;\n      float gridShape = paintDerivativeGrid2D(translate(expPosition, gridOffset, 0.0), vec2(gridSize, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(gridCol, gridShape * 0.5));\n\n      // Slider\n      float sliderShape = rectangle(expPosition, vec2(size.x * valueInRange, size.y));\n      finalCol = compose(finalCol, vec4(sliderCol, sliderShape));\n      finalCol = compose(finalCol, vec4(io_bgColorField.rgb, gridShape * sliderShape * 0.125));\n\n      // Lines\n      float lineShape1 = lineVertical(translate(position, expValueInRange * size.x, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol1, lineShape1));\n      float lineShape2 = lineVertical(translate(position, expValueInRange * size.x - io_borderWidth, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol2, lineShape2));\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }"}};__decorate$o([Property(0)],ce.prototype,"value",void 0),__decorate$o([Property(.01)],ce.prototype,"step",void 0),__decorate$o([Property(0)],ce.prototype,"min",void 0),__decorate$o([Property(1)],ce.prototype,"max",void 0),ce=__decorate$o([Register],ce);var __decorate$n=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let de=class IoSlider2d extends IoSliderBase{static get Style(){return"\n      :host {\n        cursor: crosshair;\n        border: var(--io_border);\n        border-radius: var(--io_borderRadius);\n        border-color: var(--io_borderColorInset);\n        flex-grow: 0;\n      }\n      :host:not([vertical]),\n      :host[vertical] {\n        width: var(--io_fieldHeight5);\n        height: var(--io_fieldHeight5);\n        min-width: var(--io_fieldHeight5);\n        min-height: var(--io_fieldHeight5);\n        cursor: crosshair;\n      }\n    "}static get GlUtils(){return"\n      vec3 paintKnob(vec3 dstCol, vec2 p, vec2 center, vec3 color) {\n        vec4 finalCol = vec4(0.0);\n        vec2 pCenter = translate(p, center);\n        float radius = io_fieldHeight * 0.25;\n        float stroke = io_borderWidth;\n        float strokeShape = circle(pCenter, radius + stroke + stroke);\n        float fillShape   = circle(pCenter, radius + stroke);\n        float colorShape  = circle(pCenter, radius);\n        finalCol = mix(io_colorStrong, finalCol, strokeShape);\n        finalCol = mix(vec4(io_bgColor.rgb, 1.0), finalCol, fillShape);\n        finalCol = mix(vec4(color, 1.0), finalCol, colorShape);\n        return compose(dstCol, finalCol);\n      }\n    "}static get Frag(){return"\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * (uv - vec2(0.5));\n\n      // Colors\n      vec3 finalCol = io_bgColorField.rgb;\n      vec3 gridCol = io_bgColorDimmed.rgb;\n      vec3 sliderCol = io_bgColorBlue.rgb;\n      vec3 lineCol1 = io_color.rgb;\n      vec3 lineCol2 = io_bgColor.rgb;\n\n      // Grid\n      vec2 gridSize = size / abs((uMax - uMin) / uStep);\n      vec2 gridOffset = (uMax + uMin) / (uMax - uMin) * size / 2.;\n      vec2 gridPosition = translate(position, -gridOffset);\n      float gridShape = paintDerivativeGrid2D(gridPosition, gridSize, io_borderWidth);\n      finalCol = compose(finalCol, vec4(gridCol, gridShape * 0.5));\n\n      // Axis\n      float axisShape = lineCross2d(gridPosition, io_borderWidth);\n      finalCol = compose(finalCol, vec4(gridCol, axisShape));\n\n      // Knob\n      vec2 knobPos = uValue / (uMax - uMin) * size;\n      finalCol = paintKnob(finalCol, gridPosition, knobPos, sliderCol);\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }"}};__decorate$n([Property({value:null,type:Array,init:[0,0]})],de.prototype,"value",void 0),__decorate$n([Property({value:null,type:Array,init:[.01,.01]})],de.prototype,"step",void 0),__decorate$n([Property({value:null,type:Array,init:[-1,-1]})],de.prototype,"min",void 0),__decorate$n([Property({value:null,type:Array,init:[1,1]})],de.prototype,"max",void 0),__decorate$n([Property(!0)],de.prototype,"noscroll",void 0),de=__decorate$n([Register],de);var __decorate$m=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let pe=class IoColorSlider extends IoColorBase{static get Style(){return"\n      :host {\n        display: flex;\n      }\n    "}_onValueInput(e){const t=e.detail.value;switch(this.channel){case"r":this.value.r=t;break;case"g":this.value.g=t;break;case"b":this.value.b=t;break;case"a":this.value.a=t;break;case"h":this.hsv[0]=t,this.rgbFromHsv(),this.valueFromRgb();break;case"s":this.hsv[1]=t,this.rgbFromHsv(),this.valueFromRgb();break;case"v":this.hsv[2]=t,this.rgbFromHsv(),this.valueFromRgb();break;case"l":this.hsl[2]=t,this.rgbFromHsl(),this.valueFromRgb();break;case"hs":this.hsv[0]=t[0],this.hsv[1]=t[1],this.rgbFromHsv(),this.valueFromRgb();break;case"sv":this.hsv[1]=t[0],this.hsv[2]=t[1],this.rgbFromHsv(),this.valueFromRgb();break;case"sl":this.hsl[1]=t[0],this.hsl[2]=t[1],this.rgbFromHsl(),this.valueFromRgb()}this.dispatchEvent("object-mutated",{object:this.value},!1,window),this.dispatchEvent("value-input",{property:"value",value:this.value},!1)}changed(){const e=this.channel;-1===["r","g","b","a","h","s","v","l","c","m","y","k","hs","sv","sl"].indexOf(e)&&console.warn("IoColorSlider: Incorrect channel value!",e);const t=`io-color-slider-${e}`;let o=0,n=[0,0,0,0],i=0,r=1,s=this.step;switch(this.channel){case"r":o=this.value.r,n=[...this.rgba];break;case"g":o=this.value.g,n=[...this.rgba];break;case"b":o=this.value.b,n=[...this.rgba];break;case"a":o=this.value.a||0,n=[...this.rgba];break;case"h":o=this.hsv[0],n=[...this.hsv,1];break;case"s":o=this.hsv[1],n=[...this.hsv,1];break;case"v":o=this.hsv[2],n=[...this.hsv,1];break;case"l":o=this.hsl[2],n=[...this.hsl,1];break;case"hs":o=[this.hsv[0],this.hsv[1]],n=[...this.hsv,1],i=[i,i],r=[r,r],s=[s,s];break;case"sv":o=[this.hsv[1],this.hsv[2]],n=[...this.hsv,1],i=[i,i],r=[r,r],s=[s,s];break;case"sl":o=[this.hsl[1],this.hsl[2]],n=[...this.hsl,1],i=[i,i],r=[r,r],s=[s,s]}this.template([[t,{id:e,value:o,min:i,max:r,step:s,vertical:this.vertical,color:n,"@value-input":this._onValueInput}]])}};__decorate$m([Property({type:Array,init:[0,0,0,0]})],pe.prototype,"color",void 0),__decorate$m([Property(.01)],pe.prototype,"step",void 0),__decorate$m([Property("")],pe.prototype,"channel",void 0),__decorate$m([Property({value:!1,reflect:!0})],pe.prototype,"vertical",void 0),pe=__decorate$m([Register],pe);class IoColorSliderBase extends ce{static get GlUtils(){return`\n      // Note: Implement in subclass!\n      // TODO: Allow GlUtils to rewrite inherited functions!\n      // vec3 getStartColor(vec2 uv) {}\n      // vec3 getEndColor(vec2 uv) {}\n      ${n.hue2rgb}\n      ${n.hsv2rgb}\n      ${n.hsl2rgb}\n    `}static get Frag(){return"\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * vec2(uv.x, uv.y - 0.5);\n      float valueInRange = (uValue - uMin) / (uMax - uMin);\n\n      // Colors\n      vec3 finalCol = io_bgColorField.rgb;\n      vec3 startCol = getStartColor(uv);\n      vec3 gridCol = io_bgColorDimmed.rgb;\n      vec3 endCol = getEndColor(uv);\n      vec3 sliderCol = mix(startCol, endCol, uv.x);\n\n      vec2 linePos = translate(size * uv, 0.0, size.y / 2.);\n      finalCol = paintHorizontalLine(finalCol, linePos, sliderCol);\n\n      // Grid\n      float gridSize = size.x / abs((uMax - uMin) / uStep);\n      float gridOffset = mod(uStep - uMin, uStep) / (uMax - uMin) * size.x;\n      float gridShape = paintDerivativeGrid2D(translate(position, gridOffset, 0.0), vec2(gridSize, 0.0), io_borderWidth);\n      if (size.x * uStep < 4.0) gridShape = 0.0;\n      finalCol = compose(finalCol, vec4(sliderCol, gridShape * 0.25));\n\n      // Slider\n      float sliderShape = rectangle(position, vec2(size.x * valueInRange, size.y));\n      finalCol = compose(finalCol, vec4(sliderCol, sliderShape));\n      finalCol = compose(finalCol, vec4(io_bgColorField.rgb, gridShape * sliderShape * 0.125));\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }"}}class IoColorSlider2dBase extends de{static get GlUtils(){return`\n      // Note: Implement in subclass!\n      // TODO: Allow GlUtils to rewrite inherited functions!\n      // vec3 getColor(vec2 uv) {}\n      ${n.hue2rgb}\n      ${n.hsv2rgb}\n      ${n.hsl2rgb}\n    `}static get Frag(){return"\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * (uv - vec2(0.5));\n\n      // Colors\n      vec3 finalCol = geio_color(uv);\n      vec3 gridCol = io_bgColorDimmed.rgb;\n      vec3 sliderCol = geio_color(uValue);\n\n      // Grid\n      vec2 gridSize = size / abs((uMax - uMin) / uStep);\n      vec2 gridOffset = (uMax + uMin) / (uMax - uMin) * size / 2.;\n      vec2 gridPosition = translate(position, -gridOffset);\n      float gridShape = paintDerivativeGrid2D(gridPosition, gridSize, io_borderWidth);\n      if (min(size.x * uStep.x, size.y * uStep.y) < 2.0) gridShape = 0.0;\n      finalCol = compose(finalCol, vec4(gridCol, gridShape * 0.5));\n\n      vec2 knobPos = uValue / (uMax - uMin) * size;\n      finalCol = paintKnob(finalCol, gridPosition, knobPos, sliderCol);\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }"}}let ue=class IoColorSliderR extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uv.x, uColor[1], uColor[2]);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uv.x, uColor[1], uColor[2]);\n      }\n    "}};ue=__decorate$m([Register],ue);let ve=class IoColorSliderG extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uColor[0], uv.x, uColor[2]);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uColor[0], uv.x, uColor[2]);\n      }\n    "}};ve=__decorate$m([Register],ve);let ge=class IoColorSliderB extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return vec3(uColor[0], uColor[1], uv.x);\n      }\n      vec3 getEndColor(vec2 uv) {\n        return vec3(uColor[0], uColor[1], uv.x);\n      }\n    "}};ge=__decorate$m([Register],ge);let fe=class IoColorSliderA extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        vec2 size = uVertical == 1 ? uSize.yx : uSize;\n        vec2 position = size * (uv - vec2(0.0, 0.5));\n        return mix(vec3(0.5), vec3(1.0), checkerX(position, io_fieldHeight / 4.0));\n      }\n      vec3 getEndColor(vec2 uv) {\n        vec2 size = uVertical == 1 ? uSize.yx : uSize;\n        vec2 position = size * (uv - vec2(0.0, 0.5));\n        vec3 chkCol = mix(vec3(0.5), vec3(1.0), checkerX(position, io_fieldHeight / 4.0));\n        return mix(chkCol, uColor.rgb, 1.0);\n      }\n    "}};fe=__decorate$m([Register],fe);let be=class IoColorSliderH extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uv.x, uColor[1], uColor[2]));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uv.x, uColor[1], uColor[2]));\n      }\n    "}};be=__decorate$m([Register],be);let me=class IoColorSliderS extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv.x, uColor[2]));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv.x, uColor[2]));\n      }\n    "}};me=__decorate$m([Register],me);let ye=class IoColorSliderV extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n    "}};ye=__decorate$m([Register],ye);let _e=class IoColorSliderL extends IoColorSliderBase{static get GlUtils(){return"\n      vec3 getStartColor(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n      vec3 getEndColor(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uColor[1], uv.x));\n      }\n    "}};_e=__decorate$m([Register],_e);let xe=class IoColorSliderHs extends IoColorSlider2dBase{static get GlUtils(){return"\n      vec3 geio_color(vec2 uv) {\n        return hsv2rgb(vec3(uv, uColor[2]));\n      }\n    "}};xe=__decorate$m([Register],xe);let Ce=class IoColorSliderSv extends IoColorSlider2dBase{static get GlUtils(){return"\n      vec3 geio_color(vec2 uv) {\n        return hsv2rgb(vec3(uColor[0], uv));\n      }\n    "}};Ce=__decorate$m([Register],Ce);let we=class IoColorSliderSL extends IoColorSlider2dBase{static get GlUtils(){return"\n      vec3 geio_color(vec2 uv) {\n        return hsl2rgb(vec3(uColor[0], uv));\n      }\n    "}};we=__decorate$m([Register],we);var __decorate$l=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Se=class IoColorPanel extends IoColorBase{static get Style(){return"\n    :host {\n      display: flex;\n      /* Panel */\n      flex: 1 1 auto;\n      flex-direction: column;\n      flex-wrap: nowrap;\n      align-self: stretch;\n      align-items: stretch;\n      justify-self: stretch;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorOutset);\n      color: var(--io_colorField);\n      background-color: var(--io_bgColorDimmed);\n      padding: var(--io_spacing);\n      /*  */\n      cursor: move;\n      align-items: stretch;\n      flex-grow: 0;\n      min-width: var(--io_lineHeight);\n      min-height: calc(var(--io_lineHeight) * 5.5);\n      flex-direction: row;\n    }\n    :host:not([expanded]) {\n      display: none;\n    }\n    :host[vertical] {\n      flex-direction: column;\n    }\n    :host > * {\n      border-radius: calc(var(--io_borderRadius) - var(--io_borderWidth));\n    }\n    :host > :first-child {\n      flex: 1 0 auto;\n    }\n    :host > *:not(:first-child) {\n      flex: 0 0 auto;\n    }\n    :host > *:not(:last-child) {\n      margin: 0 0 var(--io_spacing) 0;\n    }\n    :host:not([vertical]) > * {\n      margin: 0 var(--io_spacing) 0 0;\n    }\n    "}static get Listeners(){return{keydown:"_onKeydown"}}_onKeydown(e){"Escape"!==e.key&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.expanded=!1)}onValueSet(){this.dispatchEvent("value-input",{property:"value",value:this.value},!0)}changed(){this.template([["io-color-slider",{value:this.value,channel:"sv",vertical:this.vertical,"@value-input":this.onValueSet}],["io-color-slider",{value:this.value,channel:"h",vertical:!this.vertical,"@value-input":this.onValueSet}],void 0!==this.value.a?["io-color-slider",{value:this.value,channel:"a","@value-input":this.onValueSet,vertical:!this.vertical}]:null])}};__decorate$l([Property({value:!1,reflect:!0})],Se.prototype,"expanded",void 0),__decorate$l([Property({value:!1,reflect:!0})],Se.prototype,"vertical",void 0),__decorate$l([Property({value:!1,reflect:!0})],Se.prototype,"inlayer",void 0),Se=__decorate$l([Register],Se);const Pe=new Se({inlayer:!0});G.appendChild(Pe);var __decorate$k=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Oe=class IoColorSwatch extends IoColorBase{static get Style(){return"\n      :host {\n        display: inline-block;\n        min-width: var(--io_fieldHeight);\n        height: var(--io_fieldHeight);\n        background-color: white;\n        background-image: linear-gradient(45deg, #808080 25%, transparent 25%), linear-gradient(-45deg, #808080 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #808080 75%), linear-gradient(-45deg, transparent 75%, #808080 75%);\n        background-size: 12px 12px;\n        background-position: 0 0, 0 6px, 6px -6px, -6px 0px;\n        overflow: visible;\n      }\n      :host > div { \n        width: 100%;\n        height: 100%;\n      }\n    "}valueChanged(){super.valueChanged(),this.template([["div",{style:{"background-color":`rgba(${255*this.rgba[0]},${255*this.rgba[1]}, ${255*this.rgba[2]}, ${this.rgba[3]})`}}]])}};Oe=__decorate$k([Register],Oe);var __decorate$j=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Re=class IoColorPicker extends C{static get Style(){return"\n      :host {\n        height: var(--io_fieldHeight);\n        border: var(--io_border);\n        border-color: var(--io_borderColorInset);\n        border-radius: var(--io_borderRadius);\n        overflow: hidden;\n      }\n    "}static get Listeners(){return{click:"_onClick",keydown:"_onKeydown"}}_onClick(e){this.toggle()}get expanded(){return Pe.expanded&&Pe.value===this.value}_onKeydown(e){const t=this.getBoundingClientRect(),o=Pe.getBoundingClientRect();"Enter"===e.key||" "===e.key?(e.preventDefault(),this.toggle(),this.expanded&&Pe.firstChild.focus()):this.expanded&&o.top>=t.bottom&&"ArrowDown"===e.key||this.expanded&&o.bottom<=t.top&&"ArrowUp"===e.key?(e.preventDefault(),Pe.firstChild.focus()):(this.collapse(),super._onKeydown(e))}_onValueSet(){this.dispatchEvent("value-input",{property:"value",value:this.value},!0)}toggle(){this.expanded?this.collapse():this.expand()}expand(){Pe.value=this.value,Pe.expanded=!0,G.setElementPosition(Pe,"down",this.getBoundingClientRect()),Pe.addEventListener("value-input",this._onValueSet),Pe._targetValueSetHandler=this._onValueSet}collapse(){Pe.removeEventListener("value-input",Pe._targetValueSetHandler),Pe.expanded=!1}changed(){this.template([["io-color-swatch",{$:"swatch",value:this.value}]])}};__decorate$j([Property({value:{r:1,g:1,b:1,a:1}})],Re.prototype,"value",void 0),__decorate$j([Property("0")],Re.prototype,"tabindex",void 0),Re=__decorate$j([Register],Re);var __decorate$i=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Ie=class IoColorRgba extends IoColorBase{static get Style(){return"\n      :host {\n        display: flex;\n        flex: 0 1 auto;\n        min-width: var(--io_fieldHeight5);\n        width: var(--io_fieldHeight10);\n      }\n      :host > io-number {\n        flex: 1 0 0;\n      }\n      :host > io-number#r {\n        border-bottom-color: var(--io_bgColorRed);\n      }\n      :host > io-number#g {\n        border-bottom-color: var(--io_bgColorGreen);\n      }\n      :host > io-number#b {\n        border-bottom-color: var(--io_bgColorBlue);\n      }\n      :host > io-number#a {\n        border-bottom-color: var(--io_color);\n      }\n      :host > io-color-picker {\n        flex-shrink: 0;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n    "}_onNumberValueInput(e){const t=e.composedPath()[0].id,o=e.detail.value,n=e.detail.oldValue,i=this.value;i[t]=o;const r={object:this.value,property:t,value:i,oldValue:n};this.dispatchEvent("object-mutated",r,!1,window)}changed(){this.template([["io-number",{$:"r",id:"r",value:this.value.r,min:0,max:1,step:.001,ladder:!0,"@value-input":this._onNumberValueInput}],["io-number",{$:"g",id:"g",value:this.value.g,min:0,max:1,step:.001,ladder:!0,"@value-input":this._onNumberValueInput}],["io-number",{$:"b",id:"b",value:this.value.b,min:0,max:1,step:.001,ladder:!0,"@value-input":this._onNumberValueInput}],void 0!==this.value.a?["io-number",{$:"a",id:"a",value:this.value.a,min:0,max:1,step:1e-4,ladder:!0,"@value-input":this._onNumberValueInput}]:null,["io-color-picker",{$:"swatch",value:this.value}]])}};Ie=__decorate$i([Register],Ie);var __decorate$h=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let ke=class IoVector extends C{static get Style(){return"\n      :host {\n        display: flex;\n        flex: 0 1 auto;\n        min-width: var(--io_fieldHeight5);\n        width: var(--io_fieldHeight8);\n      }\n      :host > io-number {\n        flex: 1 1 100%;\n      }\n      :host > *:not(:last-child) {\n        margin-right: var(--io_spacing);\n      }\n      :host > io-boolicon {\n        flex-shrink: 0;\n        padding: var(--io_spacing);\n      }\n    "}_ratios={};_onNumberPointerDown(e){const t=e.composedPath()[0].id;if(this._ratios={},this.linked&&0!==this.value[t])for(const e of this.keys)this._ratios[e]=this.value[e]/this.value[t]}_onNumberValueInput(e){const t=e.composedPath()[0].id,o=e.detail.value,n=e.detail.oldValue,i=this.value;if(i[t]=o,this.linked)for(const e of this.keys)e!==t&&this._ratios[e]&&(i[e]=i[t]*this._ratios[e]);const r=this.linked?{object:this.value}:{object:this.value,property:t,value:i,oldValue:n};this.dispatchEvent("object-mutated",r,!1,window)}valueChanged(){this.keys=Object.keys(this.value).filter((e=>"number"==typeof this.value[e])),this.keys.find((e=>-1===["0","1","2","3","x","y","z","w","r","g","b","a","u","v"].indexOf(e)))&&console.warn("IoVector: Unrecognized vector type!")}changed(){const e=[];for(const t of this.keys)void 0!==this.value[t]&&e.push(["io-number",{id:t,value:this.value[t],conversion:this.conversion,step:this.step,min:this.min,max:this.max,ladder:this.ladder,"@pointerdown":this._onNumberPointerDown,"@value-input":this._onNumberValueInput}]);e.push(this.getSlotted()),this.template(e)}getSlotted(){return this.linkable?["io-boolicon",{value:this.bind("linked"),true:"vectors:link",false:"vectors:unlink"}]:null}};__decorate$h([Property({})],ke.prototype,"value",void 0),__decorate$h([Property(1)],ke.prototype,"conversion",void 0),__decorate$h([Property(.001)],ke.prototype,"step",void 0),__decorate$h([Property(-Infinity)],ke.prototype,"min",void 0),__decorate$h([Property(Infinity)],ke.prototype,"max",void 0),__decorate$h([Property(!1)],ke.prototype,"linkable",void 0),__decorate$h([Property(!1)],ke.prototype,"linked",void 0),__decorate$h([Property(!0)],ke.prototype,"ladder",void 0),__decorate$h([Property({})],ke.prototype,"keys",void 0),ke=__decorate$h([Register],ke);var __decorate$g=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Ee=class IoMatrix extends ke{static get Style(){return'\n      :host {\n        display: grid;\n        align-self: stretch;\n        justify-self: stretch;\n        grid-gap: var(--io_spacing);\n      }\n      :host > *:not(:last-child) {\n        margin-right: 0;\n      }\n      :host[columns="4"] {\n        grid-template-columns: repeat(4, 1fr);\n      }\n      :host[columns="3"] {\n        grid-template-columns: repeat(3, 1fr);\n      }\n      :host[columns="2"] {\n        grid-template-columns: repeat(2, 1fr);\n      }\n    '}_onNumberValueInput(e){const t=e.composedPath()[0].id,o=e.detail.value,n=e.detail.oldValue;this.value[t]=o;const i={object:this.value,property:t,value:o,oldValue:n};this.dispatchEvent("object-mutated",i,!1,window)}valueChanged(){4===this.value.length&&this.setProperties({keys:["0","1","2","3"],columns:2}),9===this.value.length&&this.setProperties({keys:["0","1","2","3","4","5","6","7","8"],columns:3}),16===this.value.length&&this.setProperties({keys:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],columns:4}),-1===[4,9,16].indexOf(this.value.length)&&console.warn("IoMatrix: Unrecognized matrix type!"),this.value.find((e=>"number"!=typeof e))&&console.warn("IoMatrix: Unrecognized matrix type!"),this.keys.find((e=>-1===["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"].indexOf(e)))&&console.warn("IoMatrix: Unrecognized matrix type!")}};__decorate$g([Property({type:Array,init:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]})],Ee.prototype,"value",void 0),__decorate$g([Property({value:4,reflect:!0})],Ee.prototype,"columns",void 0),Ee=__decorate$g([Register],Ee);ae.registerIcons("vectors",'\n<svg>\n  <g id="unlink">\n    <path d="M3.9,12c0-1.7,1.4-3.2,3.2-3.2h4V7H7c-2.7,0-5,2.2-5,5s2.2,5,5,5h4v-1.9H7C5.2,15.1,3.9,13.7,3.9,12z M17,7h-4.1v1.9H17\n      c1.7,0,3.2,1.4,3.2,3.2s-1.4,3.2-3.2,3.2h-4.1v1.9H17c2.7,0,5-2.2,5-5S19.8,7,17,7z"/>\n  </g>\n  <g id="link">\n    <path d="M3.9,12c0-1.7,1.4-3.2,3.2-3.2h4V7H7c-2.7,0-5,2.2-5,5s2.2,5,5,5h4v-1.9H7C5.2,15.1,3.9,13.7,3.9,12z M8,13h8.1v-2H8V13z\n      M17,7h-4.1v1.9H17c1.7,0,3.2,1.4,3.2,3.2s-1.4,3.2-3.2,3.2h-4.1v1.9H17c2.7,0,5-2.2,5-5S19.8,7,17,7z"/>\n  </g>\n</svg>');var __decorate$f=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};function _isNaN(e){return"number"==typeof e&&isNaN(e)}function _isSelectable(e){return"select"===e||"scroll"===e}let je=class MenuOptions extends(IoNodeMixin(Array)){push(...e){for(let t=0;t<e.length;t++){const o=e[t];o instanceof Me||console.warn("MenuOptions.push: item is not a MenuItem!"),o instanceof Me&&(this.find((e=>e.label===o.label))&&console.warn(`MenuOptions.addItems: duplicate label "${o.label}"`),o.addEventListener("selected-changed",this._onItemSelectedChanged),o.addEventListener("path-changed",this._onSubOptionsPathChanged),super.push(o))}}getItem(e,t=!1){for(let o=0;o<this.length;o++){if(this[o].value===e)return this[o];if(t&&this[o].options){const n=this[o].options.getItem(e,t);if(n)return n}}return null}constructor(e=[],t={}){const o=[];for(let t=0;t<e.length;t++)e[t]instanceof Me?o.push(e[t]):o.push(new Me(e[t]));super(t,...o),""!==this.path&&this.pathChanged(),void 0!==this.first&&this.firstChanged();for(let e=0;e<this.length;e++){const t=this[e];t instanceof Me||console.warn("MenuOptions.constructor: item is not a MenuItem!"),this.find((e=>e!==t&&e.label===t.label))&&console.warn(`MenuOptions.addItems: duplicate label "${t.label}"`),t.addEventListener("selected-changed",this._onItemSelectedChanged),t.addEventListener("path-changed",this._onSubOptionsPathChanged),t.selected&&"select"===t.mode&&this.updatePaths(t)}}addItems(e){for(let t=0;t<e.length;t++){let o;o=e[t]instanceof Me?e[t]:new Me(e[t]),this.find((e=>e.label===o.label))&&console.warn(`MenuOptions.addItems: duplicate label "${o.label}"`),this.push(o),o.addEventListener("selected-changed",this._onItemSelectedChanged),o.addEventListener("path-changed",this._onSubOptionsPathChanged)}}pathChanged(){const e=this.path?[...this.path.split(this.delimiter)]:[];if(this.length&&e.length){const t=e.shift(),o=this.find((e=>e.label===t));if(o)_isSelectable(o.mode)||console.warn("MenuOptions.pathChanged: Path set to non-selectable MenuItem!"),_isSelectable(o.mode)&&(o.options&&(o.options.path=e.join(this.delimiter)),o.selected=!0);else{console.warn(`MenuOptions.pathChanged: cannot find item for specified path "${this.path}"!`);for(let e=0;e<this.length;e++)_isSelectable(this[e].mode)&&(this[e].selected=!1)}}else for(let e=0;e<this.length;e++)_isSelectable(this[e].mode)&&(this[e].selected=!1)}firstChanged(){if(void 0!==this.first){const e=this.find((e=>e.value===this.first&&"select"===e.mode||_isNaN(e.value)&&_isNaN(this.first)));e&&(e.selected=!0),void 0===e&&console.warn(`MenuOptions.firstChanged: cannot find pickable item for specified first value "${this.first}"!`)}else for(let e=0;e<this.length;e++)"select"===this[e].mode&&(this[e].selected=!1)}lastChanged(){if(void 0!==this.last){const e=this.path?[...this.path.split(this.delimiter)]:[];if(e.length){let t=e.shift(),o=this.find((e=>!0===e.selected&&e.label===t&&("select"===e.mode||"scroll"===e.mode))),n=o?.options||void 0;for(;e.length&&n;)t=e.shift(),o=n.find((e=>!0===e.selected&&e.label===t&&("select"===e.mode||"scroll"===e.mode))),n=o?.options||void 0;void 0===o?console.warn(`MenuOptions.lastChanged: cannot find item for specified last value "${this.last}"!`):o.value===this.last||_isNaN(o.value)&&_isNaN(this.last)||o.value===this.scroll||_isNaN(o.value)&&_isNaN(this.scroll)||(console.warn(`MenuOptions.lastChanged: last property value "${this.last}" diverged from item specified by path!`),console.log(this.path,this.last))}else console.warn(`MenuOptions.lastChanged: last property value set "${this.last}" but path is empty!`)}}updatePaths(e){const t=[];let o="select"===e?.mode||"scroll"===e?.mode?e:void 0,n="select"===e?.mode?e:void 0,i="scroll"===e?.mode?e:void 0;const r=this.find((e=>"select"===e.mode&&e.selected)),s=this.find((e=>"scroll"===e.mode&&e.selected));if(o||!r&&!s){for(;o;)t.push(o.label),"select"===o.mode&&(n=o),"scroll"===o.mode&&(i=o),o=o.options?.find((e=>("select"===e.mode||"scroll"===e.mode)&&e.selected));this.setProperties({path:t.join(this.delimiter),first:"select"===e?.mode?e.value:void 0,last:void 0!==n?n.value:void 0,scroll:void 0!==i?i.value:void 0})}}_onItemSelectedChanged(e){const t=e.target;if(_isSelectable(t.mode))if(t.selected){for(let e=0;e<this.length;e++)this[e]!==t&&_isSelectable(this[e].mode)&&(this[e].selected=!1);this.updatePaths(t),this.dispatchEvent("item-selected",{item:t})}else this.updatePaths()}_onSubOptionsPathChanged(e){const t=e.target;t.selected?this.updatePaths(t):this.updatePaths()}selectDefault(){for(let e=0;e<this.length;e++)if(_isSelectable(this[e].mode)){if(!this[e].hasmore)return this[e].selected=!0,!0;if(this[e].options.selectDefault())return!0}return!1}bind(e){return"last"!==e&&"scroll"!==e||console.warn("MenuPath: Binding to `last` or `scroll` property is not recommended!"),super.bind(e)}dispose(){for(let e=0;e<this.length;e++)this[e].removeEventListener("selected-changed",this._onItemSelectedChanged),this[e].removeEventListener("path-changed",this._onSubOptionsPathChanged);super.dispose()}};__decorate$f([Property(void 0)],je.prototype,"first",void 0),__decorate$f([Property(void 0)],je.prototype,"last",void 0),__decorate$f([Property(void 0)],je.prototype,"scroll",void 0),__decorate$f([Property("")],je.prototype,"path",void 0),__decorate$f([Property(",")],je.prototype,"delimiter",void 0),je=__decorate$f([Register],je);var __decorate$e=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Me=class MenuItem extends i{get hasmore(){return!!this.options?.length}getSubitem(e){return this.options?.getItem(e)}constructor(e){const t={value:"",label:""};"object"!=typeof e||null===e?(t.value=e,t.label=String(e)):(t.value=e.value,void 0===e.label?"object"==typeof t.value?null===t.value?t.label="null":t.label=`${t.value.constructor.name}`+(t.value instanceof Array?`(${t.value.length})`:""):t.label=String(t.value):t.label=e.label,void 0!==e.icon&&(t.icon=e.icon),void 0!==e.hint&&(t.hint=e.hint),void 0!==e.hidden&&(t.hidden=e.hidden),void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.action&&(t.action=e.action),void 0!==e.mode&&(t.mode=e.mode),void 0!==e.selected&&(t.selected=e.selected),void 0!==e.options&&(e.options instanceof je?t.options=e.options:t.options=new je(e.options)),void 0!==t.selected||"select"!==e.mode&&void 0!==e.mode||!t.options||(t.selected=!!t.options.find((e=>e.selected&&"select"===e.mode)))),t.mode&&"toggle"===t.mode&&t.options&&console.warn('MenuItem: cannot have suboptions when `mode === "toggle"`'),t.mode&&"scroll"===t.mode&&t.options&&console.warn('MenuItem: cannot have suboptions when `mode === "scroll"`'),t.mode&&-1===["select","toggle","scroll","link","none"].indexOf(t.mode)&&console.warn("MenuItem: unknown `mode` property!",t.mode),t.action&&"function"!=typeof t.action&&console.warn("MenuItem: invalid type of `action` property!",typeof t.action),super(t),this.options&&(this.options.addEventListener("item-selected",this._onSubItemSelected),this.options.addEventListener("path-changed",this._onOptionsPathChanged))}toJSON(){const e={value:this.value,label:this.label,icon:this.icon,hint:this.hint,hidden:this.hidden,disabled:this.disabled};return this.options&&(e.options=this.options),e}_onSubItemSelected(){this.selected=!0}_onOptionsPathChanged(e){this.dispatchEvent("path-changed",e.detail)}optionsChanged(){void 0===this.options?.first&&void 0===this.options?.scroll||"select"!==this.mode||(this.selected=!0)}selectedChanged(){if("select"===this.mode&&!1===this.selected&&this.options){for(let e=0;e<this.options.length;e++)"select"!==this.options[e].mode&&"scroll"!==this.options[e].mode||(this.options[e].selected=!1);this.options.updatePaths()}}dispose(){this.options&&(this.options.removeEventListener("item-selected",this._onSubItemSelected),this.options.removeEventListener("path-changed",this._onOptionsPathChanged)),super.dispose()}};__decorate$e([Property(void 0)],Me.prototype,"value",void 0),__decorate$e([Property("")],Me.prototype,"label",void 0),__decorate$e([Property("")],Me.prototype,"icon",void 0),__decorate$e([Property("")],Me.prototype,"hint",void 0),__decorate$e([Property(!1)],Me.prototype,"hidden",void 0),__decorate$e([Property(!1)],Me.prototype,"disabled",void 0),__decorate$e([Property(void 0)],Me.prototype,"action",void 0),__decorate$e([Property("select")],Me.prototype,"mode",void 0),__decorate$e([Property(!1)],Me.prototype,"selected",void 0),__decorate$e([Property(void 0)],Me.prototype,"options",void 0),Me=__decorate$e([Register],Me);var __decorate$d=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};function addMenuOptions(e,t,o=0){const n=[];if(o<=t)for(let i=0;i<e.length;i++){const r=e[i];if(r.options?.length){const e=R({value:r.selected,storage:"local",key:genObjectStorageID(r)});!0===r.selected&&(e.value=!0),n.push(["io-collapsable",{label:r.label,icon:r.icon,expanded:e,elements:[...addMenuOptions(r.options,t,o+1)]}])}else n.push(["io-menu-item",{item:r,depth:o}])}return n}function matchItem(e,t){return void 0!==e.value&&-1!==String(e.value).toLowerCase().indexOf(t)||(!(!e.label||-1===e.label.toLowerCase().indexOf(t))||!(!e.hint||-1===e.hint.toLowerCase().indexOf(t)))}function filterOptions(e,t,o=5,n=[],i=0){if(t=t.toLowerCase(),i<=o)for(let r=0;r<e.length;r++)matchItem(e[r],t)&&n.push(["io-menu-item",{item:e[r],depth:0}]),e[r].options&&filterOptions(e[r].options,t,o,n,i+1)}let Le=class IoMenuTree extends C{static get Style(){return'\n    :host {\n      display: flex;\n      flex: 0 0 auto;\n      flex-direction: column;\n      flex-wrap: nowrap;\n      align-self: stretch;\n      align-items: stretch;\n      justify-self: stretch;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorOutset);\n      color: var(--io_colorField);\n      background-color: var(--io_bgColorDimmed);\n      padding: var(--io_spacing) 0;\n      align-self: flex-start;\n      user-select: none;\n      transition: opacity 0.25s;\n      overflow: auto;\n    }\n\n    :host io-collapsable {\n      flex: 0 0 auto;\n      border-color: transparent;\n      border: 0;\n      overflow: visible;\n    }\n    :host io-collapsable > div.io-collapsable-content {\n      background-color: transparent;\n      flex: 0 0 auto;\n      border-radius: 0 !important;\n      margin: 0 !important;\n      padding: 0 !important;\n      background: var(--io_bgColorDimmed);\n    }\n    \n    :host io-menu-item:first-of-type {\n      margin-top: var(--io_borderWidth);\n    }\n    :host io-menu-item {\n      background-color: var(--io_bgColorDimmed);\n      flex: 0 0 auto;\n      align-self: stretch;\n      border-radius: 0;\n      margin-left: var(--io_borderWidth);\n      margin-right: var(--io_borderWidth);\n    }\n    :host io-menu-item[depth="1"] {\n      padding-left: calc(var(--io_lineHeight) * 1);\n    }\n    :host io-menu-item[depth="2"] {\n      padding-left: calc(var(--io_lineHeight) * 2);\n    }\n    :host io-menu-item[depth="3"] {\n      padding-left: calc(var(--io_lineHeight) * 3);\n    }\n    :host io-menu-item[depth="4"] {\n      padding-left: calc(var(--io_lineHeight) * 4);\n    }\n    :host io-menu-item[depth="5"] {\n      padding-left: calc(var(--io_lineHeight) * 5);\n    }\n    :host io-menu-item[depth="6"] {\n      padding-left: calc(var(--io_lineHeight) * 6);\n    }\n    /* Item spacing */\n    :host io-menu-item {\n      margin-bottom: var(--io_borderWidth);\n    }\n    :host io-menu-item:first-of-type {\n      /* margin-top: var(--io_spacing); */\n    }\n\n    /* Item dividers */\n    :host io-collapsable > io-boolean {\n      margin: 0;\n      margin-left: var(--io_borderWidth);\n      margin-right: var(--io_borderWidth);\n      z-index: 1;\n      overflow: visible;\n    }\n\n    /* Search field */\n    :host > .search {\n      border-radius: 0;\n      flex: 0 0 auto;\n    }\n    '}static get Listeners(){return{"item-clicked":"_onItemClicked"}}_onItemClicked(e){const t=e.composedPath()[0],o=e.detail;t!==this&&(e.stopImmediatePropagation(),this.dispatchEvent("item-clicked",o,!0),this.throttle(this._onCollapse))}_onCollapse(){const e=this.searchable&&this.search;this.search="",e&&this.$.search.focus()}changed(){const e=[...this.slotted];if(this.searchable&&e.push(["io-string",{$:"search",role:"search",class:"search",value:this.bind("search"),placeholder:"Search",live:!0}]),this.search){const t=e.length;filterOptions(this.options,this.search,this.depth,e),t===e.length&&e.push(["io-menu-item",{item:new Me({label:"No matches",mode:"none"})}])}else e.push(...addMenuOptions(this.options,this.depth));this.template(e)}};__decorate$d([Property({type:je,reflect:!0})],Le.prototype,"options",void 0),__decorate$d([Property(!1)],Le.prototype,"searchable",void 0),__decorate$d([Property("")],Le.prototype,"search",void 0),__decorate$d([Property(Infinity)],Le.prototype,"depth",void 0),__decorate$d([Property({type:Array})],Le.prototype,"slotted",void 0),__decorate$d([Property("listbox")],Le.prototype,"role",void 0),__decorate$d([Property(void 0)],Le.prototype,"$parent",void 0),Le=__decorate$d([Register],Le);var __decorate$c=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const Ne=new WeakMap;let Ae=class IoMenuOptions extends C{static get Style(){return'\n    :host {\n      display: flex;\n      border-radius: var(--io_borderRadius);\n      background-color: var(--io_bgColorDimmed);\n      position: relative;\n    }\n    :host[horizontal] {\n      flex-direction: row;\n      align-self: stretch;\n      padding: 0 var(--io_spacing);\n    }\n    :host:not([horizontal]) {\n      flex-direction: column;\n      padding: var(--io_spacing) 0;\n    }\n    :host[inlayer] {\n      min-width: 8em;\n    }\n    :host[inlayer]:not([expanded]) {\n      visibility: hidden;\n      opacity: 0;\n    }\n\n    /* Menu Items */\n    :host > io-menu-item {\n      background-color: transparent;\n      border-radius: 0;\n    }\n    :host[horizontal] > io-menu-item {\n      height: calc(var(--io_fieldHeight) + var(--io_spacing2));\n      border-left: none;\n      border-right: none;\n      border-width: calc(var(--io_spacing) + var(--io_borderWidth)) var(--io_borderWidth);\n    }\n    :host:not([horizontal]) > io-menu-item {\n      border-top: none;\n      border-bottom: none;\n      border-width: var(--io_borderWidth) var(--io_spacing);\n    }\n    :host > io-menu-item[selected][direction="up"] {\n      border-color: var(--io_colorBlue) transparent transparent transparent;\n    }\n    :host > io-menu-item[selected][direction="down"] {\n      border-color: transparent transparent var(--io_colorBlue) transparent;\n    }\n    :host > io-menu-item[selected][direction="right"] {\n      border-color: transparent var(--io_colorBlue) transparent transparent;\n    }\n    :host > io-menu-item[selected][direction="left"] {\n      border-color: transparent transparent transparent var(--io_colorBlue);\n    }\n\n    /* Item divider */\n    :host > [hidden] ~ span.divider {\n      border-color: red;\n      display: none;\n    }\n    :host > span.divider {\n      flex: 0 0 0;\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      margin: var(--io_spacing);\n      opacity: 0.5;\n    }\n\n    /* Remove hints from horizontal menu */\n    :host[horizontal] > io-menu-item > .hint {\n      display: none;\n    }\n\n    /* Search field */\n    :host:not([horizontal]) > .search {\n      margin: var(--io_spacing);\n      margin-top: 0;\n    }\n    :host[horizontal] > .search {\n      margin-right: var(--io_borderWidth);\n      flex: 0 0 10em;\n    }\n\n    /* Hamburger menu for overflow items */\n    :host > io-menu-hamburger {\n      border-color: transparent !important;\n      background-color: transparent !important;\n    }\n    :host[horizontal] > io-menu-hamburger {\n      position: absolute;\n      right: var(--io_spacing);\n      padding: var(--io_spacing);\n    }\n    '}static get Listeners(){return{"item-clicked":"_onItemClicked",touchstart:["_stopPropagation",{passive:!1}]}}_onItemClicked(e){const t=e.composedPath()[0],o=e.detail;"io-string"!==t.localName?t!==this&&(e.stopImmediatePropagation(),this.dispatchEvent("item-clicked",o,!0),this.throttle(this._onCollapse)):e.stopImmediatePropagation()}_stopPropagation(e){e.stopPropagation()}init(){this.throttle(this._onSetOverflow)}onResized(){this.throttle(this._onSetOverflow)}_onSetOverflow(){if(this._disposed)return;const e=this.querySelectorAll(".item");if(this._overflownItems.length=0,this.horizontal){const t=this.querySelector("io-menu-hamburger"),o=t?.getBoundingClientRect().width||0,n=this.getBoundingClientRect().right-(A.borderWidth+A.spacing);let i=Infinity,r=!1;for(let t=e.length;t--;){const s=e[t].getBoundingClientRect(),a=Ne.get(e[t].item)||{right:0,width:0};0!==s.right&&0!==s.width&&(a.right=s.right,a.width=s.width,Ne.set(e[t].item,a)),i=Math.min(i,a.right),this.noPartialCollapse&&r?(e[t].hidden=!0,this._overflownItems.unshift(e[t].item)):t===e.length-1&&i<n||i<n-1.5*o?e[t].hidden=!1:(r=!0,e[t].hidden=!0,this._overflownItems.unshift(e[t].item))}this._overflownItems.length?this.overflow=JSON.stringify(this._overflownItems.map((e=>e.label))):this.overflow=""}else this.overflow=""}_onCollapse(){const e=this.selectable&&!!this.search&&!this.inlayer;this.setProperties({search:"",expanded:!1}),e&&this.$.search.focus()}expandedChanged(){this.expanded?this.inlayer&&this.throttle(this._onExpandInOverlay):(this.style.top=null,this.style.height=null,this.style.touchAction=null,this.scrollTop=0,this.search="")}searchChanged(){this.inlayer&&this.$parent&&this.throttle(this._onClipHeight),this.throttle(this._onSetOverflow)}_onExpandInOverlay(){if(this.$parent||console.warn("IoMenuOptions: $parent property mandatory when expanding inside `IoOverlaySingleton`."),this.$parent){const e=this.$parent.getBoundingClientRect();G.setElementPosition(this,this.direction,e),this._onClipHeight()}}_onClipHeight(){if(this.scrollTop=0,!this.firstChild)return;const e=this.firstChild.getBoundingClientRect().top,t=this.lastChild.getBoundingClientRect().bottom,o=t-e;e<0?(this.style.top="0px",this.style.height=o+e+"px",this.style.touchAction="pan-y"):t>window.innerHeight?(this.style.height=window.innerHeight-e+"px",this.style.touchAction="pan-y"):(this.style.height=null,this.style.touchAction=null)}changed(){const e=[...this.slotted];if(this.searchable&&e.push(["io-string",{$:"search",role:"search",class:"search",value:this.bind("search"),placeholder:"Search",live:!0}]),this.search){const t=e.length;filterOptions(this.options,this.search,this.depth,e),t===e.length&&e.push(["io-menu-item",{item:new Me({label:"No matches",mode:"none"})}])}else{let t=this.horizontal?"down":"right";this.horizontal&&"up"===this.direction&&(t="up");for(let o=0;o<this.options.length;o++)e.push(["io-menu-item",{class:"item",item:this.options[o],direction:t,depth:this.depth}]),o<this.options.length-1&&e.push(["span",{class:"divider"}])}this.overflow&&e.push(["io-menu-hamburger",{depth:this.depth+1,role:"navigation",direction:"down",item:new Me({options:new je(this._overflownItems)})}]),this.template(e)}};__decorate$c([Property({type:je})],Ae.prototype,"options",void 0),__decorate$c([Property({value:!1,reflect:!0})],Ae.prototype,"expanded",void 0),__decorate$c([Property({value:!1,reflect:!0})],Ae.prototype,"horizontal",void 0),__decorate$c([Property(!1)],Ae.prototype,"searchable",void 0),__decorate$c([Property("")],Ae.prototype,"search",void 0),__decorate$c([Property({value:"none",reflect:!0})],Ae.prototype,"direction",void 0),__decorate$c([Property(100)],Ae.prototype,"depth",void 0),__decorate$c([Property(!1)],Ae.prototype,"noPartialCollapse",void 0),__decorate$c([Property({value:"",reflect:!0})],Ae.prototype,"overflow",void 0),__decorate$c([Property({value:!1,reflect:!0})],Ae.prototype,"inlayer",void 0),__decorate$c([Property({type:Array})],Ae.prototype,"slotted",void 0),__decorate$c([Property("listbox")],Ae.prototype,"role",void 0),__decorate$c([Property(void 0)],Ae.prototype,"$parent",void 0),__decorate$c([Property({type:Array})],Ae.prototype,"_overflownItems",void 0),Ae=__decorate$c([Register],Ae);var __decorate$b=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const De=["io-menu-item","io-menu-hamburger","io-option-menu"],He=De.join(", ");let Te,$e,Be=class IoMenuItem extends Y{static get Style(){return"\n      :host {\n        display: flex;\n        user-select: none;\n      }\n      :host > * {\n        pointer-events: none;\n        text-overflow: ellipsis;\n      }\n      :host > .label {\n        flex: 1 1 auto;\n        padding: 0 var(--io_spacing2);\n      }\n      :host > .hint {\n        flex: 0 1 auto;\n        opacity: 0.25;\n        padding: 0 var(--io_spacing2);\n      }\n      :host > .hasmore {\n        opacity: 0.5;\n      }\n    "}static get Listeners(){return{click:"preventDefault"}}preventDefault(e){e.stopPropagation(),e.preventDefault()}get hasmore(){return this.item.hasmore&&this.depth>0}get inlayer(){return!!this.$parent&&!!this.$parent.inlayer}get $parent(){return this.parentElement}connectedCallback(){super.connectedCallback(),G.addEventListener("pointermove",this._onOverlayPointermove),G.addEventListener("pointerup",this._onOverlayPointerup),this.$options&&G.appendChild(this.$options)}disconnectedCallback(){super.disconnectedCallback(),G.removeEventListener("pointermove",this._onOverlayPointermove),G.removeEventListener("pointerup",this._onOverlayPointerup),this.$options&&this.$options.inlayer&&G.removeChild(this.$options)}_onOverlayPointermove(e){!this.inlayer&&this.expanded&&this._onPointermove(e)}_onOverlayPointerup(e){!this.inlayer&&this.expanded&&this._onPointerupAction(e)}_onClick(){const e=this.item;this.hasmore?this.expanded||(this.expanded=!0):"toggle"===e.mode?e.selected=!e.selected:(e.action&&e.action.apply(null,[e.value]),"select"===e.mode?e.hasmore&&e.options&&this.depth<=0?e.options.selectDefault():e.selected=!0:"scroll"===e.mode?e.selected=!0:"link"===e.mode&&window.open(e.value,"_blank"),this.dispatchEvent("item-clicked",e,!0),this.throttle(this._onCollapse))}_onItemClicked(e){e.composedPath()[0]!==this&&(e.stopImmediatePropagation(),this.dispatchEvent("item-clicked",e.detail,!0)),this.expanded&&this.throttle(this._onCollapse)}_onPointerdown(e){e.stopPropagation(),e.preventDefault(),this.setPointerCapture(e.pointerId),this.addEventListener("pointermove",this._onPointermove),this.addEventListener("pointerup",this._onPointerup),this._onPointerdownAction(e)}_onPointerdownAction(e){(this.expanded||"mouse"===e.pointerType||this.inlayer)&&(this.focus(),this.item.options&&(this.expanded=!0)),this._x=e.clientX,this._y=e.clientY}_onPointermove(e){e.stopPropagation(),this._onPointermoveAction(e)}_onPointermoveAction(e){if(!this.expanded&&"touch"===e.pointerType&&!this.inlayer)return;const t=!!this.$parent&&!!this.$parent.style.height;if("touch"===e.pointerType&&t)return;const o=e.clientX-this._x,n=e.clientY-this._y;if(this._x=e.clientX,this._y=e.clientY,G.x=e.clientX,G.y=e.clientY,clearTimeout(this._timeoutOpen),Te=this._gethovered(e),Te){const e=Math.abs(n)-Math.abs(o),t=Te.parentElement.horizontal;$e?.parentElement!==Te.parentElement||(t?e<-.25:e>.25)?this._expandHovered():this._timeoutOpen=setTimeout((()=>{this._expandHovered()}),100),$e=Te}}_onPointerup(e){e.stopPropagation(),this.removeEventListener("pointermove",this._onPointermove),this.removeEventListener("pointerup",this._onPointerup),this._onPointerupAction(e)}_onPointerupAction(e,t=!1){const o=this._gethovered(e);o?(o.focus(),o._onClick(e)):t||this.throttle(this._onCollapseRoot),Te=void 0,$e=void 0}_gethovered(e){const t=getMenuDescendants(getMenuRoot(this)),o=[];for(let n=t.length;n--;)isPointerAboveIoMenuItem(e,t[n])&&o.push(t[n]);if(o.length)return o.sort(((e,t)=>e.depth<t.depth?1:e.depth>t.depth?-1:0)),o[o.length-1]}_expandHovered(){if(Te){if(Te.focus(),Te.hasmore){if(Te.$options){const e=getMenuDescendants(Te.$options);for(let t=e.length;t--;)e[t].expanded=!1}Te.expanded=!0}if(Te.$parent){const e=Te.$parent.querySelectorAll(He);for(let t=e.length;t--;)e[t]!==Te&&(e[t].expanded=!1)}}}_onKeydown(e){if("Enter"===e.key||" "===e.key)return e.preventDefault(),void this._onClick();if("Escape"===e.key)return e.preventDefault(),void this.throttle(this._onCollapseRoot);let t="";"left"===this.direction||"right"===this.direction?("ArrowUp"===e.key&&(t="prev"),"ArrowRight"===e.key&&(t="in"),"ArrowDown"===e.key&&(t="next"),"ArrowLeft"===e.key&&(t="out")):("ArrowUp"===e.key&&(t="out"),"ArrowRight"===e.key&&(t="next"),"ArrowDown"===e.key&&(t="in"),"ArrowLeft"===e.key&&(t="prev")),this.inlayer&&"Tab"===e.key&&(t="next");const o=this.$parent?[...this.$parent.children]:[],n=o.indexOf(this);if(t)switch(e.preventDefault(),t){case"prev":{const e=o[(n+o.length-1)%o.length];this.expanded=!1,e&&(e.hasmore&&(e.expanded=!0),e.focus());break}case"next":{const e=o[(n+1)%o.length];this.expanded=!1,e&&(e.hasmore&&(e.expanded=!0),e.focus());break}case"in":this.$options&&this.$options.children.length&&this.$options.children[0].focus();break;case"out":this.expanded=!1,this.$parent&&this.$parent.$parent&&this.$parent.$parent.focus()}else super._onKeydown(e)}_onCollapse(){this.expanded=!1}_onCollapseRoot(){getMenuRoot(this).expanded=!1}expandedChanged(){if(this.expanded&&this.depth>0){this.item.options&&void 0===this.$options&&(this.$options=new Ae({expanded:this.bind("expanded"),inlayer:!0,depth:this.depth-1,options:this.item.options,direction:this.direction,$parent:this}));const e=getMenuDescendants(getMenuRoot(this)),t=getMenuAncestors(this),o=getMenuDescendants(this);for(let n=e.length;n--;)e[n]!==this&&-1===t.indexOf(e[n])&&-1===o.indexOf(e[n])&&(e[n].expanded=!1)}if(this.$options){this.expanded?(this.$options.parentElement!==G&&G.appendChild(this.$options),this.$options.addEventListener("item-clicked",this._onItemClicked)):this.$options.removeEventListener("item-clicked",this._onItemClicked);const e=getMenuDescendants(this.$options);for(let t=e.length;t--;)e[t].expanded=!1}}itemChanged(){this.setProperties({selected:this.item.bind("selected"),disabled:this.item.bind("disabled")})}changed(){void 0!==this.$options&&this.item.options&&(this.$options.options=this.item.options);const e=this.icon||this.item.icon;this.setAttribute("hidden",this.item.hidden),this.setAttribute("hasmore",this.hasmore),this.template([this.hasmore&&"left"===this.direction?["io-icon",{class:"hasmore",icon:"menu:triangle_left"}]:null,this.hasmore&&"up"===this.direction?["io-icon",{class:"hasmore",icon:"menu:triangle_up"}]:null,e?["io-icon",{icon:e}]:null,this.item.label?["span",{class:"label"},this.item.label]:null,this.item.hint?["span",{class:"hint"},this.item.hint]:null,this.hasmore&&"right"===this.direction?["io-icon",{class:"hasmore",icon:"menu:triangle_right"}]:null,this.hasmore&&"down"===this.direction?["io-icon",{class:"hasmore",icon:"menu:triangle_down"}]:null])}};function getMenuDescendants(e){const t=[];if(e.$options){if(e.expanded){t.push(e.$options);const o=e.$options.querySelectorAll(He);for(let e=o.length;e--;)t.push(o[e]),o[e].expanded&&t.push(...getMenuDescendants(o[e]))}}else{const o=e.querySelectorAll(He);for(let e=o.length;e--;)t.push(o[e]),o[e].expanded&&t.push(...getMenuDescendants(o[e]))}return t}function getMenuAncestors(e){const t=[];let o=e;for(;o&&o.$parent;)o=o.$parent,o&&t.push(o);return t}function getMenuRoot(e){let t=e;for(;t&&t.$parent;)t=t.$parent;return t}function isPointerAboveIoMenuItem(e,t){if(-1!==De.indexOf(t.localName)&&!t.disabled&&!t.hidden&&(!t.inlayer||t.parentElement.expanded&&G.expanded)){const o=1,n=t.getBoundingClientRect(),i=e.clientX,r=e.clientY;return n.top<=r+o&&n.bottom>=r-o&&n.left<=i+o&&n.right>=i-o}return null}__decorate$b([Property({type:Me})],Be.prototype,"item",void 0),__decorate$b([Property({value:!1,reflect:!0})],Be.prototype,"expanded",void 0),__decorate$b([Property({value:"right",reflect:!0})],Be.prototype,"direction",void 0),__decorate$b([Property({value:1e3,reflect:!0})],Be.prototype,"depth",void 0),Be=__decorate$b([Register],Be);var __decorate$a=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let ze=class IoMenuHamburger extends Be{static get Style(){return"\n      :host {\n        display: flex;\n        user-select: none;\n      }\n      :host > * {\n        pointer-events: none;\n        text-overflow: ellipsis;\n      }\n    "}changed(){void 0!==this.$options&&this.item.options&&(this.$options.options=this.item.options),this.setAttribute("selected",this.item.selected),this.setAttribute("hidden",this.item.hidden),this.disabled=this.item.disabled,this.template([["io-icon",{icon:"menu:hamburger"}]])}};ze=__decorate$a([Register],ze);var __decorate$9=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};const Fe=new je;let Ve=class IoOptionMenu extends C{static get Style(){return"\n    :host {\n      display: inline-block;\n      text-align: center;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorOutset);\n      background-color: var(--io_bgColorDimmed);\n      background-image: var(--io_gradientOutset);\n      /* padding-left: calc(2 * var(--io_spacing)); */\n      /* padding-right: calc(2 * var(--io_spacing)); */\n      text-align: left;\n    }\n    :host > io-menu-item {\n      margin: calc(-1 * var(--io_borderWidth));\n      background-color: transparent !important;\n      border-color: transparent !important;\n    }\n    :host > io-menu-item[selected] {\n      color: var(--io_colorStrong);\n    }\n    "}_item;_onLeafChanged(e){this.inputValue(e.detail.value)}optionsChanged(e){e.oldValue&&e.oldValue!==Fe&&e.oldValue.removeEventListener("last-changed",this._onLeafChanged),e.value&&e.value.addEventListener("last-changed",this._onLeafChanged);const t=this.options.getItem(this.value);t&&(t.selected=!0)}changed(){const e=this.options.getItem(this.value);this._item=this._item||new Me({}),this._item.label=e?.label||String(this.value),this._item.options=this.options,this._item.icon=this.icon||"",this.template([["io-menu-item",{item:this._item,direction:"down"}]])}};__decorate$9([Property({value:void 0,reflect:!0})],Ve.prototype,"value",void 0),__decorate$9([Property({value:Fe,type:je,reflect:!0})],Ve.prototype,"options",void 0),__decorate$9([Property("button")],Ve.prototype,"role",void 0),Ve=__decorate$9([Register],Ve);var __decorate$8=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let We=class IoContextMenu extends C{static get Properties(){return{$options:null}}connectedCallback(){super.connectedCallback(),G.addEventListener("pointermove",this._onOverlayPointermove),this._parent=this.parentElement,this._parent.addEventListener("pointerdown",this._onPointerdown),this._parent.addEventListener("click",this._onClick),this._parent.addEventListener("contextmenu",this._onContextmenu)}disconnectedCallback(){super.disconnectedCallback(),this.$options&&this.$options.parentElement&&G.removeChild(this.$options),G.removeEventListener("pointermove",this._onOverlayPointermove),this._parent.removeEventListener("pointerdown",this._onPointerdown),this._parent.removeEventListener("contextmenu",this._onContextmenu),this._parent.removeEventListener("pointermove",this._onPointermove),this._parent.removeEventListener("pointerup",this._onPointerup),this._parent.removeEventListener("click",this._onClick),delete this._parent}getBoundingClientRect(){return this._parent.getBoundingClientRect()}_onItemClicked(e){const t=e.composedPath()[0],o=e.detail;t!==this&&(e.stopImmediatePropagation(),this.dispatchEvent("item-clicked",o,!0),this.throttle(this._onCollapse))}_onContextmenu(e){2===this.button&&e.preventDefault()}_onPointerdown(e){G.x=e.clientX,G.y=e.clientY,this._parent.addEventListener("pointermove",this._onPointermove),this._parent.addEventListener("pointerup",this._onPointerup),clearTimeout(this._contextTimeout),"touch"!==e.pointerType?e.button===this.button&&(this.setPointerCapture(e.pointerId),this.expanded=!0):(e.preventDefault(),this._contextTimeout=setTimeout((()=>{this.setPointerCapture(e.pointerId),this.expanded=!0}),150))}_onPointermove(e){clearTimeout(this._contextTimeout),this.expanded&&this.$options?.querySelector("io-menu-item")?._onPointermoveAction(e)}_onPointerup(e){clearTimeout(this._contextTimeout),this.releasePointerCapture(e.pointerId),this.expanded&&this.$options?.querySelector("io-menu-item")?._onPointerupAction(e,!0),this._parent.removeEventListener("pointermove",this._onPointermove),this._parent.removeEventListener("pointerup",this._onPointerup)}_onOverlayPointermove(e){this.expanded&&this._onPointermove(e)}_onClick(e){e.button===this.button&&2!==e.button&&(this.expanded=!0)}_onCollapse(){this.expanded=!1}optionsChanged(){this.$options&&(G.removeChild(this.$options),this.$options.template([]),this.$options.dispose()),this.$options=new Ae({expanded:this.bind("expanded"),inlayer:!0,options:this.options,direction:"pointer",$parent:this,"@item-clicked":this._onItemClicked}),G.appendChild(this.$options)}};__decorate$8([Property({type:je})],We.prototype,"options",void 0),__decorate$8([Property({value:!1,reflect:!0})],We.prototype,"expanded",void 0),__decorate$8([Property(0)],We.prototype,"button",void 0),We=__decorate$8([Register],We);ae.registerIcons("menu",'\n<svg>\n  <g id="hamburger">\n    <path d="M20.9,9.1H3.2c-0.6,0-1.1,0.3-1.1,0.7V14c0,0.4,0.5,0.8,1.1,0.8h17.9c0.6,0,1.1-0.3,1.1-0.7V9.9C22,9.4,21.5,9.1,20.9,9.1z\n      M20.9,2.1H3.2c-0.6,0-1.1,0.3-1.1,0.7V7c0,0.4,0.5,0.7,1.1,0.7h17.9c0.6,0,1.1-0.3,1.1-0.7V2.8C22,2.4,21.5,2.1,20.9,2.1z\n      M20.9,16.5H3.2c-0.6,0-1.1,0.3-1.1,0.7v4.2c0,0.4,0.5,0.7,1.1,0.7h17.9c0.6,0,1.1-0.3,1.1-0.7v-4.2C22,16.8,21.5,16.5,20.9,16.5z"\n      />\n  </g>\n  <g id="triangle_right">\n    <polygon points="9.1,16.5 14.9,12 9.1,7.5   "/>\n  </g>\n  <g id="triangle_down">\n    <polygon points="7.6,9 11.9,15 16.5,9   "/>\n  </g>\n  <g id="triangle_left">\n    <polygon points="14.9,7.5 9.1,12 14.9,16.5   "/>\n  </g>\n  <g id="triangle_up">\n    <polygon points="16.5,15 11.9,9 7.6,15   "/>\n  </g>\n</svg>');var __decorate$7=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Ue=class IoNotify extends C{static get Style(){return"\n    :host {\n      display: flex;\n      position: fixed;\n      top: 0;\n      left: 0;\n      box-sizing: border-box;\n      background-color: var(--io_bgColorDimmed);\n      border: var(--io_border);\n      border-color: var(--io_colorRed);\n      width: 100%;\n      opacity: 1;\n      font-weight: bold;\n      align-items: center;\n      justify-content: center;\n      padding: 0 var(--io_spacing);\n    }\n    :host > span {\n      cursor: default;\n      box-sizing: border-box;\n      line-height: var(--io_lineHeight);\n      font-size: var(--io_fontSize);\n      color: var(--io_color);\n      padding: 0 var(--io_spacing);\n    }\n    :host > :nth-child(n+2) {\n      flex-shrink: 0;\n      align-self: center;\n      white-space: nowrap;\n    }\n    @keyframes io-notification-fade {\n      to {\n        opacity: 0;\n      }\n    }\n    :host:not([expanded]) {\n      animation: io-notification-fade .6s linear forwards;\n      pointer-events: none;\n    }\n    "}static get Properties(){return{expanded:{value:!0,reflect:!0}}}static get Listeners(){return{}}constructor(e){super(e),this.template([["span","This app uses cookies for user interface customization."],["span","Agree"],["io-boolean",{"@value-input":this._onAgree}],["span","Disagree"],["io-boolean",{"@value-input":this._onDisgree}]])}_onAgree(e){e.detail.value?R.permitted=!0:R.permitted=!1,this.expanded=!1}_onDisgree(){R.permitted=!1,this.expanded=!1}};Ue=__decorate$7([Register],Ue),null===R.permitted&&document.body.appendChild(new Ue);class ObjectConfig{constructor(e){for(let t=0;t<e.length;t++)this.registerObjectConfig(e[t].ObjectConfig||{})}registerObjectConfig(e){for(const t in e){const o=this;o[t]=o[t]||[],o[t]=[e[t][0]||o[t][0],Object.assign(o[t][1]||{},e[t][1]||{})]}}getObjectConfig(e,t){const o=Object.keys(e),n=[];let i=e.__proto__;for(;i;)n.push(i.constructor.name),o.push(...Object.keys(i)),i=i.__proto__;const r={};for(const e in this){const t=e.split("|");1===t.length&&t.splice(0,0,"Object"),-1!==n.indexOf(t[0])&&(r[t[1]]=this[e])}for(const e in t){const o=e.split("|");1===o.length&&o.splice(0,0,"Object"),-1!==n.indexOf(o[0])&&(r[o[1]]=t[e])}const s={};for(let t=0;t<o.length;t++){const n=o[t],i=e[n]instanceof Binding?e[n].value:e[n],a=null===i?"null":typeof i,l=null!=i&&i.constructor?i.constructor.name:"null";if("function"===a)continue;const h="type:"+a,c="constructor:"+l,d=n.replace("type:","").replace("constructor:","");s[n]=null,r[h]&&(s[n]=r[h]),r[c]&&(s[n]=r[c]),r[d]&&(s[n]=r[d])}return s}}class ObjectGroups{constructor(e){for(let t=0;t<e.length;t++)this.registerObjectGroups(e[t].ObjectGroups||{})}registerObjectGroups(e){for(const t in e){const o=this;o[t]=o[t]||[],o[t]=[...o[t],...e[t]]}}getObjectGroups(e,t,o){const n=[];let i=e.__proto__;for(;i;)n.push(i.constructor.name),i=i.__proto__;const r={},s=this;for(const t in s){const i=t.split("|");if(1===i.length&&i.splice(0,0,"Object"),i[1]=i[1].split(":"),-1!==n.indexOf(i[0])){if(!("properties"===i[1][1])){r[i[1][0]]=r[i[1][0]]||[];for(let n=0;n<s[t].length;n++){const a=s[t][n];if("string"==typeof a&&a.startsWith("constructor:")){const t=a.replace("constructor:","");for(let n=0;n<o.length;n++)e[o[n]]&&e[o[n]].name===t&&r[i[1][0]].push(o[n])}else if("string"==typeof a&&a.startsWith("type:")){const t=a.replace("type:","");for(let n=0;n<o.length;n++)e[o[n]]&&typeof e[o[n]]===t&&r[i[1][0]].push(o[n])}else r[i[1][0]].push(a)}}}}for(const e in t){const o=e.split("|");if(1===o.length&&o.splice(0,0,"Object"),o[1]=o[1].split(":"),-1!==n.indexOf(o[0])){"properties"===o[1][1]||(r[o[1][0]]=r[o[1][0]]||[],r[o[1][0]].push(...t[e]))}}const a={},l=[];for(const e in r){a[e]=a[e]||[];for(const t in r[e]){const n=r[e][t],i=new RegExp(n);for(let t=0;t<o.length;t++){const r=o[t];"string"==typeof n?r===n&&-1===l.indexOf(r)&&(a[e].push(r),l.push(r)):"object"==typeof n&&i.exec(r)&&-1===l.indexOf(r)&&(a[e].push(r),l.push(r))}}}if(0===l.length)a.properties=o;else{a.properties=a.properties||[];for(let e=0;e<o.length;e++)-1===l.indexOf(o[e])&&a.properties.push(o[e])}for(const e in a)0===a[e].length&&delete a[e];return delete a.hidden,a}}class ObjectWidgets{constructor(e){for(let t=0;t<e.length;t++)this.registerObjectWidgets(e[t].ObjectWidgets||{})}registerObjectWidgets(e){for(const t in e){const o=this;o[t]=o[t]||[],o[t]=[...o[t],...e[t]]}}getObjectWidgets(e){const t=[];let o=e.__proto__;for(;o;)t.push(o.constructor.name),o=o.__proto__;let n=null;const i={};for(const o in this){const r=o.split("|"),s=r[0],a=r[1];if(-1!==t.indexOf(s)){const t=this[o];t[1]=t[1]||{},t[1].$value?t[1].value=e[t[1].$value]:t[1].value=e,a?i[a]=t:n=t}}return{main:n,groups:i}}}var __decorate$6=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Ge=class IoBreadcrumbs extends C{static get Style(){return"\n    :host {\n      display: flex;\n      flex: 0 0 auto;\n      flex-direction: row;\n      align-self: stretch;\n      justify-self: stretch;\n      border-radius: var(--io_borderRadius);\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      padding: var(--io_spacing);\n      background-color: var(--io_bgColorField);\n      overflow-x: hidden;\n    }\n    :host > io-field {\n      padding-left: var(--io_spacing);\n      padding-right: var(--io_spacing);\n      color: var(--io_colorBlue);\n    }\n    :host > io-field:hover {\n      text-decoration: underline;\n    }\n    :host > io-field:first-of-type {\n      overflow: visible;\n      text-overflow: clip;\n      margin-left: var(--io_spacing);\n    }\n    :host > io-field:last-of-type {\n      overflow: visible;\n      text-overflow: clip;\n      margin-right: var(--io_spacing);\n    }\n    :host > io-field:not(:first-of-type):before {\n      content: '>';\n      margin: 0 var(--io_spacing);\n      padding: 0 var(--io_spacing) 0 0;\n      opacity: 0.25;\n    }\n    "}static get Properties(){return{value:Object,selected:null,options:{type:Array}}}_onClick(e){this.setProperty("selected",this.options[e.detail.value])}valueChanged(){this.options.length=0,this.options.push(this.value)}selectedChanged(){const e=this.options.indexOf(this.selected);-1!==e?this.options.length=e+1:this.options.push(this.selected)}changed(){const e=[];for(let t=0;t<this.options.length;t++)e.push(["io-field",{class:"select",value:this.options[t],label:getLabel(this.options[t]),"@item-clicked":this._onClick}]);this.template(e)}};function getLabel(e){return String(e instanceof Array?`${e.constructor.name} (${e.length})`:"object"==typeof e?`${e.constructor.name}`:e)}Ge=__decorate$6([Register],Ge);var __decorate$5=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};class ProtoObjectConfig extends Map{constructor(e){super();for(let t=0;t<e.length;t++){const o=e[t].Config;if(o)for(let e=0;e<o.length;e++){const t=o[e],n=t[0],i=t[1];let r;this.has(n)?r=this.get(n):(r=new Map,this.set(n,r));for(let e=0;e<i.length;e++){const t=i[e][0],o=[...i[e][1]];r.set(t,o)}}}}getObjectConfig(e){if(!(e instanceof Object))return void console.warn("`getObjectConfig` should be used on Object instance");const t=new Map;for(const[o,n]of this)if(e instanceof o)for(const[e,o]of n)t.set(e,o);const o={};for(const[n,i]of Object.entries(e)){const e=i instanceof Binding?i.value:i;for(const[i,r]of t){let t;("function"==typeof i&&e instanceof i||"function"==typeof i&&e.constructor===i||"string"==typeof i&&n===i||null===i&&null===e||void 0===i&&void 0===e)&&(t=r),t&&(o[n]=t)}}for(const[t,n]of Object.entries(e))o[t]||(console.warn("No config found for",t,n),console.log(o,e));return o}}let Ke=class IoProperties extends C{static get Style(){return"\n    :host {\n      display: flex;\n      flex-direction: column;\n      color: var(--io_colorField);\n      background-color: var(--io_bgColor);\n    }\n    :host > .io-row {\n      display: flex;\n      flex-direction: row;\n    }\n    :host > .io-row > io-label {\n      margin-top: calc(var(--io_spacing) + var(--io_borderWidth));\n    }\n    :host > .io-row > io-label:after {\n      display: inline-block;\n      content: ':';\n    }\n    :host io-object > io-properties {\n      padding-left: var(--io_lineHeight);\n    }\n    "}static get Config(){return[[Object,[[null,["io-string",{appearance:"neutral"}]],[void 0,["io-string",{appearance:"neutral"}]],[String,["io-string",{appearance:"neutral"}]],[Number,["io-number",{appearance:"neutral",step:1e-4}]],[Boolean,["io-boolean"]],[Object,["io-object"]]]],[Array,[[Number,["io-number",{appearance:"neutral",step:1e-4}]]]]]}_onValueInput(e){if(e.detail.object)return;const t=e.composedPath()[0];if(t===this)return;e.stopImmediatePropagation(),this.dispatchEvent("property-set",e.detail,!1);const o=t.id;if(null!==o){const t=e.detail.value,n=e.detail.oldValue;this.value[o]=t;const i={object:this.value,property:o,value:t,oldValue:n};this.dispatchEvent("object-mutated",i,!1,window)}}valueMutated(){this._changedThrottled()}changed(){this._changedThrottled()}_changedThrottled(){this.throttle(this._onChange,void 0)}_onChange(){const e=this.__proto__._protoConfig.getObjectConfig(this.value);Object.assign(e,this.config);const t=[],o=this.properties.length?this.properties:Object.keys(this.value);this.widget.length?t.push(this.widget):t.push(["widget-dummy"]);for(let n=0;n<o.length;n++){const i=o[n],r=this.value[i],s=e[i][0],a=e[i][1]||{},l=a.label||i,h={title:l,id:i,config:e,value:r,"@value-input":this._onValueInput};Object.assign(h,a),"io-object"===s?(h.label=l+": "+r.constructor.name,t.push([s,h])):t.push(["div",{class:"io-row"},[this.labeled?["io-label",{label:l}]:null,[s,h]]])}this.template(t)}Register(e){super.Register(e),Object.defineProperty(e.prototype,"_protoConfig",{writable:!0,value:new ProtoObjectConfig(e.prototype._protochain.constructors)})}};__decorate$5([Property({type:Object})],Ke.prototype,"value",void 0),__decorate$5([Property({type:Array})],Ke.prototype,"properties",void 0),__decorate$5([Property({type:Object})],Ke.prototype,"config",void 0),__decorate$5([Property({type:Array})],Ke.prototype,"widget",void 0),__decorate$5([Property(!0)],Ke.prototype,"labeled",void 0),Ke=__decorate$5([Register],Ke);var __decorate$4=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Ye=class IoInspector extends C{static get Style(){return"\n    :host {\n      display: flex;\n      flex: 1 1 auto;\n      flex-direction: column;\n      flex-wrap: nowrap;\n      align-self: stretch;\n      align-items: stretch;\n      justify-self: stretch;\n      flex: 0 1 calc(var(--io_lineHeight) * 17.5);\n    }\n    :host > * {\n      flex-shrink: 0;\n    }\n    :host > .inspector-header {\n      display: flex;\n      flex-direction: row;\n      margin-bottom: var(--io_spacing);\n      flex-grow: 0;\n    }\n    :host > .inspector-header > io-breadcrumbs {\n      flex: 1 1;\n    }\n    :host > .inspector-header > io-boolean {\n      width: calc(var(--io_spacing) + var(--io_lineHeight));\n      align-self: stretch;\n      height: auto;\n    }\n    :host > .inspector-header > io-boolean:not([value]) {\n      opacity: 0.25;\n    }\n    :host > .inspector-header > io-string {\n      margin: 0 var(--io_spacing);\n      padding: calc(2 * var(--io_spacing));\n      align-self: stretch;\n      height: auto;\n    }\n    :host > .inspector-header > io-string:focus {\n      width: 6em;\n    }\n    :host > .inspector-header > io-string:empty:before {\n      content: ' ';\n      white-space: pre;\n      visibility: visible;\n      opacity: 0.33;\n    }\n    :host > io-collapsable > io-boolean,\n    :host > io-object > io-boolean {\n      text-transform: capitalize;\n    }\n    :host > io-object {\n      flex-basis: auto !important;\n    }\n    :host > io-object > io-properties {\n      border-radius: var(--io_borderRadius);\n      background-color: var(--io_bgColor) !important;\n      border: var(--io_border);\n      border-color: var(--io_borderColorInset);\n      padding: var(--io_spacing);\n      overflow: hidden;\n    }\n    :host > io-object > io-properties:not([horizontal])[labeled] {\n      grid-template-columns: minmax(6em, min-content) minmax(12em, 1fr);\n    }\n    :host > io-object > io-properties:not([horizontal])[labeled] > span.io-field {\n      text-align: right;\n    }\n    :host io-properties io-field.select {\n      color: var(--io_colorBlue) !important;\n    }\n    :host io-properties io-field.select:hover {\n      text-decoration: underline;\n    }\n    "}static get Listeners(){return{"io-field-clicked":"_onItemClicked"}}_onItemClicked(e){e.stopPropagation();const t=e.detail.value,o=e.composedPath()[0];t&&"object"==typeof t&&o.classList.contains("select")&&this.setProperty("selected",t)}valueChanged(){this.selected=this.value}advancedChanged(){delete this._currentCfgLen}selectedMutated(){clearTimeout(this._cfgTimeout),this._cfgTimeout=setTimeout((()=>{this._onChange()}),100)}changed(){this._onChangedThrottled()}_onChangedThrottled(){this.throttle(this._onChange)}_onChange(){const e=this.__proto__._protoConfig.getObjectConfig(this.selected);Object.assign(e,this.config),this._groups=this.__proto__._groups.getObjectGroups(this.selected,this.groups,Object.getOwnPropertyNames(e)),this._widgets=this.__proto__._widgets.getObjectWidgets(this.selected,this.widgets);const t=this.uuid||function genUUID(e){let t="io-object-collapse-state-"+e.constructor.name;t+="-"+(e.guid||e.uuid||e.id||"");const o=JSON.stringify(Object.keys(e));let n=0;for(let e=0;e<o.length;e++)n=(n<<5)-n+o.charCodeAt(e),n|=0;return n=(-n).toString(16),t+="-"+n,t}(this.selected),o=[["div",{class:"inspector-header"},[["io-breadcrumbs",{value:this.value,selected:this.bind("selected")}]]],this._widgets.main?this._widgets.main:null];for(const e in this._widgets.groups)this._groups[e]||o.push(["io-collapsable",{label:e,expanded:R({value:!0,storage:"local",key:t+"-"+e}),elements:[this._widgets.groups[e]]}]);for(const t in this._groups)o.push(["io-object",{label:t,expanded:R({value:!0,storage:"local",key:this.uuid+"-"+t}),value:this.selected,properties:this._groups[t],config:e,widget:this._widgets.groups[t]||[]}]);this.template(o)}static get Config(){return[[Object,[[null,["io-field",{appearance:"neutral",class:"select"}]],[void 0,["io-string",{appearance:"neutral"}]],[String,["io-string",{appearance:"neutral"}]],[Number,["io-number",{appearance:"neutral",step:1e-4}]],[Boolean,["io-boolean"]],[Object,["io-field",{appearance:"neutral",class:"select"}]]]]]}static get ObjectGroups(){return{"Object|hidden":[/^_/],"Array|main":[/^[0-9]+$/],"HTMLElement|main":["localName","tagName","nodeName",/class/i,/attribute/i],"HTMLElement|hidden":[/^on/,/^[A-Z0-9_]*$/,"childElementCount"],"HTMLElement|content":[/content/i,/inner/i,/outer/i],"HTMLElement|display":[/width/i,/height/i,/top/i,/left/i,/scroll/i,/style/i],"HTMLElement|hierarchy":[/parent/i,/child/i,/element/i,/root/i,/slot/i,/sibling/i,/document/i]}}static get ObjectWidgets(){return{}}Register(e){super.Register(e),Object.defineProperty(e.prototype,"_protoConfig",{writable:!0,value:new ProtoObjectConfig(e.prototype._protochain.constructors)}),Object.defineProperty(e.prototype,"_groups",{writable:!0,value:new ObjectGroups(e.prototype._protochain.constructors)}),Object.defineProperty(e.prototype,"_widgets",{writable:!0,value:new ObjectWidgets(e.prototype._protochain.constructors)})}};__decorate$4([Property({})],Ye.prototype,"value",void 0),__decorate$4([Property({})],Ye.prototype,"selected",void 0),__decorate$4([Property({type:Object})],Ye.prototype,"config",void 0),__decorate$4([Property("")],Ye.prototype,"uuid",void 0),__decorate$4([Property("")],Ye.prototype,"search",void 0),__decorate$4([Property({type:Object})],Ye.prototype,"groups",void 0),__decorate$4([Property({type:Object})],Ye.prototype,"widgets",void 0),Ye=__decorate$4([Register],Ye);var __decorate$3=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Je=class IoObject extends C{static get Style(){return'\n    :host {\n      /* Panel */\n      display: flex;\n      flex-direction: column; */\n      padding-left: var(--io_spacing);\n      padding-right: var(--io_spacing);\n      color: var(--io_colorField);\n      background-color: var(--io_bgColor);\n    }\n    :host > io-boolean {\n      padding-left: 0;\n      padding-right: 0;\n      align-self: stretch;\n    }\n    :host > io-boolean:before {\n      display: inline-block;\n      width: 0.75em;\n      content: ""\n    }\n    :host > io-boolean[value]:before {\n      content: "";\n    }\n    '}changed(){const e=this.label||this.value.constructor.name,t=[];t.push(["io-boolean",{appearance:"neutral",true:e,false:e,value:this.bind("expanded")}]),this.expanded&&t.push(["io-properties",{value:this.value,properties:this.properties,config:this.config,labeled:this.labeled,widget:this.widget}]),this.template(t),this.setAttribute("aria-expanded",String(this.expanded))}};__decorate$3([Property({})],Je.prototype,"value",void 0),__decorate$3([Property({type:Array})],Je.prototype,"properties",void 0),__decorate$3([Property({type:Object})],Je.prototype,"config",void 0),__decorate$3([Property({type:Array})],Je.prototype,"widget",void 0),__decorate$3([Property(!0)],Je.prototype,"labeled",void 0),__decorate$3([Property("")],Je.prototype,"label",void 0),__decorate$3([Property({value:!1,reflect:!0})],Je.prototype,"expanded",void 0),__decorate$3([Property("region")],Je.prototype,"role",void 0),Je=__decorate$3([Register],Je);var __decorate$2=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Xe=class IoSliderRange extends IoSliderBase{_index=0;_getCoordFromValue(e){const t=[0,0],o=this._min,n=this._max;return t[0]=(e[0]-o[0])/(n[0]-o[0]),t[1]=(e[1]-o[1])/(n[1]-o[1]),t}_onPointerdown(e){super._onPointerdown(e);const t=this._value,o=this._getPointerCoord(e),n=this._getCoordFromValue(t);this._index=Math.abs(n[0]-o[0])<Math.abs(n[1]-o[0])?0:1}_onPointermoveThrottled(e){if(1===this._active){document.activeElement!==this&&this.focus();const t=this._value,o=this._getPointerCoord(e),n=this._getValueFromCoord(o);0===this._index?this._inputValue([n[0],t[1]]):1===this._index&&this._inputValue([t[0],n[0]])}}static get Frag(){return"\n    varying vec2 vUv;\n\n    void main(void) {\n      // Dimensions\n      vec2 size = uVertical == 1 ? uSize.yx : uSize;\n      vec2 uv = uVertical == 1 ? vUv.yx : vUv;\n      vec2 position = size * vec2(uv.x, uv.y - 0.5);\n      vec2 expPosition = size * vec2(pow(uv.x, uExponent), uv.y - 0.5);\n\n      vec2 valueInRange = (uValue - vec2(uMin)) / (vec2(uMax) - vec2(uMin));\n\n      vec2 valueSign = sign(valueInRange);\n      vec2 expValueInRange = pow(abs(valueInRange), vec2(1./uExponent)) * valueSign;\n      float valueInRangeWidth = valueInRange[1] - valueInRange[0];\n      float valueInRangeCenter = (valueInRange[1] + valueInRange[0]) / 2.0;\n      float signRange = sign(valueInRangeWidth);\n\n      // Colors\n      vec3 finalCol = io_bgColorField.rgb;\n      vec3 gridCol = io_bgColorDimmed.rgb;\n      vec3 sliderCol = signRange > 0.0 ? io_bgColorBlue.rgb : io_bgColorRed.rgb;\n      vec3 lineCol1 = io_color.rgb;\n      vec3 lineCol2 = io_bgColor.rgb;\n\n      // Grid\n      float gridSize = size.x / abs((uMax - uMin) / uStep);\n      float gridOffset = mod(uStep - uMin, uStep) / (uMax - uMin) * size.x;\n      float gridShape = paintDerivativeGrid2D(translate(expPosition, gridOffset, 0.0), vec2(gridSize, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(gridCol, gridShape * 0.5));\n\n      // Slider\n      float sliderShape = rectangle(translate(expPosition, size.x * valueInRangeCenter, 0.0), vec2(size.x * abs(valueInRangeWidth) * 0.5, size.y));\n      finalCol = compose(finalCol, vec4(sliderCol, sliderShape));\n      finalCol = compose(finalCol, vec4(io_bgColorField.rgb, gridShape * sliderShape * 0.125));\n\n      // Lines\n      float maxPos = expValueInRange[0];\n      float minPos = expValueInRange[1];\n\n      float lineMinShape1 = lineVertical(translate(position, maxPos * size.x, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol1, lineMinShape1));\n      float lineMinShape2 = lineVertical(translate(position, maxPos * size.x + io_borderWidth * signRange, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol2, lineMinShape2));\n      \n      float lineMaxShape1 = lineVertical(translate(position, minPos * size.x, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol1, lineMaxShape1));\n      float lineMaxShape2 = lineVertical(translate(position, minPos * size.x - io_borderWidth * signRange, 0.0), io_borderWidth);\n      finalCol = compose(finalCol, vec4(lineCol2, lineMaxShape2));\n\n      gl_FragColor = vec4(finalCol, 1.0);\n    }\n    "}};__decorate$2([Property({value:null,type:Array,init:[0,0]})],Xe.prototype,"value",void 0),__decorate$2([Property(.01)],Xe.prototype,"step",void 0),__decorate$2([Property(0)],Xe.prototype,"min",void 0),__decorate$2([Property(1)],Xe.prototype,"max",void 0),Xe=__decorate$2([Register],Xe);var __decorate$1=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let qe=class IoNumberSliderRange extends C{static get Style(){return"\n    :host {\n      display: flex;\n      min-width: var(--io_fieldHeight5);\n      width: var(--io_fieldHeight10);\n    }\n    :host > io-number {\n      flex: 0 0 3.25em;\n    }\n    :host > io-slider-range {\n      margin-left: var(--io_spacing);\n      margin-right: var(--io_spacing);\n      flex: 1 1 3.25em;\n      min-width: 3.25em;\n    }\n    "}_onNumberSet(e){const t=e.composedPath()[0];t===this.$.number0&&(this.value[0]=e.detail.value),t===this.$.number1&&(this.value[1]=e.detail.value),e.detail.value=this.value,this.dispatchEvent("object-mutated",{object:this.value},!1,window),this.dispatchEvent("value-input",e.detail,!1)}_onSliderSet(e){this.value=e.detail.value,this.dispatchEvent("object-mutated",{object:this.value},!1,window),this.dispatchEvent("value-input",e.detail,!1)}init(){this.changed()}changed(){this.template([["io-number",{$:"number0",value:this.value[0],step:this.step,conversion:this.conversion,label:this.label,"@value-input":this._onNumberSet}],["io-slider-range",{$:"slider",value:this.value,step:this.step,min:this.min,max:this.max,exponent:this.exponent,label:this.label,"@value-input":this._onSliderSet}],["io-number",{$:"number1",value:this.value[1],step:this.step,conversion:this.conversion,label:this.label,"@value-input":this._onNumberSet}]])}};__decorate$1([Property({type:Array,init:[0,0]})],qe.prototype,"value",void 0),__decorate$1([Property(.01)],qe.prototype,"step",void 0),__decorate$1([Property(0)],qe.prototype,"min",void 0),__decorate$1([Property(1)],qe.prototype,"max",void 0),__decorate$1([Property(1)],qe.prototype,"exponent",void 0),__decorate$1([Property(1)],qe.prototype,"conversion",void 0),qe=__decorate$1([Register],qe);var __decorate=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};let Qe=class IoNumberSlider extends C{static get Style(){return"\n    :host {\n      display: flex;\n      min-width: var(--io_fieldHeight5);\n      width: var(--io_fieldHeight10);\n    }\n    :host > io-number {\n      flex: 0 0 3.25em;\n      margin-right: var(--io_spacing);\n    }\n    :host > io-slider {\n      flex: 1 1 3em;\n      min-width: 3em;\n    }\n    "}_onNumberSet(e){this.value=e.detail.value,this.dispatchEvent("value-input",e.detail,!1)}_onSliderSet(e){e.detail.value=e.detail.value/this.conversion,this.value=e.detail.value,this.dispatchEvent("value-input",e.detail,!1)}init(){this.changed()}changed(){this.template([["io-number",{$:"number",value:this.value,step:this.step,conversion:this.conversion,label:this.label,"@value-input":this._onNumberSet}],["io-slider",{$:"slider",value:this.value*this.conversion,step:this.step*this.conversion,min:this.min*this.conversion,max:this.max*this.conversion,exponent:this.exponent,label:this.label,"@value-input":this._onSliderSet}]])}};__decorate([Property({value:0})],Qe.prototype,"value",void 0),__decorate([Property(.01)],Qe.prototype,"step",void 0),__decorate([Property(0)],Qe.prototype,"min",void 0),__decorate([Property(1)],Qe.prototype,"max",void 0),__decorate([Property(1)],Qe.prototype,"exponent",void 0),__decorate([Property(1)],Qe.prototype,"conversion",void 0),Qe=__decorate([Register],Qe);
/** @License
 * Copyright 2025 Aleksandar (Aki) Rodic
 *
 * The MIT License
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
const Ze="MIT";export{Autobind,Binding,ChangeQueue,Color,j as DARK_THEME,EventDispatcher,X as IoBoolean,q as IoBoolicon,Ge as IoBreadcrumbs,J as IoButton,IoColorBase,Se as IoColorPanel,Pe as IoColorPanelSingleton,Re as IoColorPicker,Ie as IoColorRgba,pe as IoColorSlider,IoColorSlider2dBase,fe as IoColorSliderA,ge as IoColorSliderB,IoColorSliderBase,ve as IoColorSliderG,be as IoColorSliderH,xe as IoColorSliderHs,_e as IoColorSliderL,ue as IoColorSliderR,me as IoColorSliderS,we as IoColorSliderSL,Ce as IoColorSliderSv,ye as IoColorSliderV,Oe as IoColorSwatch,We as IoContextMenu,C as IoElement,Y as IoField,V as IoGl,le as IoIcon,se as IoIconset,re as IoIconsetDB,ae as IoIconsetSingleton,Ye as IoInspector,K as IoLabel,Ee as IoMatrix,ze as IoMenuHamburger,Be as IoMenuItem,Ae as IoMenuOptions,Le as IoMenuTree,i as IoNode,IoNodeMixin,Ue as IoNotify,ee as IoNumber,ne as IoNumberLadder,ie as IoNumberLadderSingleton,oe as IoNumberLadderStep,Qe as IoNumberSlider,qe as IoNumberSliderRange,Je as IoObject,Ve as IoOptionMenu,U as IoOverlay,G as IoOverlaySingleton,Ke as IoProperties,ce as IoSlider,de as IoSlider2d,IoSliderBase,Xe as IoSliderRange,R as IoStorage,O as IoStorageNode,Z as IoString,Q as IoSwitch,A as IoThemeSingleton,ke as IoVector,Ze as LICENSE,E as LIGHT_THEME,Me as MenuItem,je as MenuOptions,ObjectConfig,ObjectGroups,ObjectWidgets,Property,PropertyInstance,ProtoChain,ProtoObjectConfig,ProtoProperty,Register,addMenuOptions,applyNativeElementProps,buildTree,disposeElementDeep,filterOptions,genObjectStorageID,getMenuAncestors,getMenuDescendants,getMenuRoot,n as glsl,hardenListenerDefinition,listenerFromDefinition,nextQueue,t as propertyDecorators};
