import{Binding as e,IoNode as t,Register as i,ChangeQueue as o,EventDispatcher as a,ProtoProperty as n,PropertyInstance as c,Property as l,PropertyDecorators as r,ProtoChain as s,IoElement as p,IoNodeMixin as h,IoThemeSingleton as u,IoGl as d,IoOverlaySingleton as b,IoStorageNode as v,IoStorage as x,IoIconsetSingleton as g,IoBoolean as q,IoButton as f,IoField as m,IoIcon as y,IoLabel as w,IoSwitch as C,IoString as T,IoNumber as _,IoNumberLadder as E,IoNumberLadderStep as S,IoColorPanel as I,IoColorPicker as N,IoColorRgba as P,IoColorSlider as L,IoColorSwatch as A,IoNumberSliderRange as O,IoNumberSlider as z,IoSliderRange as j,IoSlider as k}from"./iogui.js";var __decorate$8=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};let M=class TestIoNode extends t{static get Properties(){return{prop1:0,prop2:0}}};M=__decorate$8([i],M);class BindingTest{run(){describe("Binding",(()=>{it("Should initialize with correct default values",(()=>{const t=new M,i=new e(t,"prop1");chai.expect(i.node).to.be.equal(t),chai.expect(i.property).to.be.equal("prop1"),chai.expect(i.targets instanceof Array).to.be.equal(!0),chai.expect(i.targets.length).to.be.equal(0),chai.expect(i.targetProperties instanceof WeakMap).to.be.equal(!0)})),it("Should get and set property value on source node with `value` getter/setter",(()=>{const t=new M,i=new e(t,"prop1");t.prop1=1,chai.expect(i.value).to.be.equal(1),t.prop1=2,chai.expect(i.value).to.be.equal(2),i.value=3,chai.expect(t.prop1).to.be.equal(3)})),it("Should add/remove target nodes and properties with `.addTarget()` and `removeTarget()`",(()=>{const t=new M,i=new e(t,"prop1"),o=new e(t,"prop2"),a=new M,n=new M;i.addTarget(a,"prop1"),o.addTarget(a,"prop2"),o.addTarget(n,"prop1"),o.addTarget(n,"prop2"),chai.expect(t._eventDispatcher.addedListeners).to.be.eql({"prop1-changed":[[i.onSourceChanged]],"prop2-changed":[[o.onSourceChanged]]}),chai.expect(a._eventDispatcher.addedListeners).to.be.eql({"prop1-changed":[[i.onTargetChanged]],"prop2-changed":[[o.onTargetChanged]]}),chai.expect(n._eventDispatcher.addedListeners).to.be.eql({"prop1-changed":[[o.onTargetChanged]],"prop2-changed":[[o.onTargetChanged]]}),chai.expect(i.targets[0]).to.be.equal(a),chai.expect(i.targets[1]).to.be.equal(void 0),chai.expect(o.targets[0]).to.be.equal(a),chai.expect(o.targets[1]).to.be.equal(n),chai.expect(o.targets[2]).to.be.equal(void 0),chai.expect(a._properties.get("prop1").binding).to.be.equal(i),chai.expect(a._properties.get("prop2").binding).to.be.equal(o),chai.expect(n._properties.get("prop1").binding).to.be.equal(o),chai.expect(n._properties.get("prop2").binding).to.be.equal(o);const c=i.getTargetProperties(a),l=i.getTargetProperties(n);chai.expect(c[0]).to.be.equal("prop1"),chai.expect(c.length).to.be.equal(1),chai.expect(l.length).to.be.equal(0);const r=o.getTargetProperties(a),s=o.getTargetProperties(n);chai.expect(r[0]).to.be.equal("prop2"),chai.expect(r.length).to.be.equal(1),chai.expect(s[0]).to.be.equal("prop1"),chai.expect(s[1]).to.be.equal("prop2"),chai.expect(s.length).to.be.equal(2),o.removeTarget(n,"prop1"),chai.expect(s[0]).to.be.equal("prop2"),chai.expect(s.length).to.be.equal(1),chai.expect(n._properties.get("prop1").binding).to.be.equal(void 0),chai.expect(n._eventDispatcher.addedListeners).to.be.eql({"prop2-changed":[[o.onTargetChanged]]}),o.addTarget(n,"prop1"),chai.expect(s.length).to.be.equal(2),chai.expect(n._properties.get("prop1").binding).to.be.equal(o),o.removeTarget(n),chai.expect(s.length).to.be.equal(0),chai.expect(n._properties.get("prop1").binding).to.be.equal(void 0),chai.expect(n._properties.get("prop2").binding).to.be.equal(void 0),chai.expect(n._eventDispatcher.addedListeners).to.be.eql({})})),it("Should dispose correctly",(()=>{const t=new M,i=new M,o=new e(t,"prop1");o.addTarget(i,"prop1"),chai.expect(t._eventDispatcher.addedListeners).to.be.eql({"prop1-changed":[[o.onSourceChanged]]}),chai.expect(i._eventDispatcher.addedListeners).to.be.eql({"prop1-changed":[[o.onTargetChanged]]}),o.dispose(),chai.expect(o.node).to.be.equal(void 0),chai.expect(o.property).to.be.equal(void 0),chai.expect(o.targets).to.be.equal(void 0),chai.expect(o.targetProperties).to.be.equal(void 0),chai.expect(i._properties.get("prop1").binding).to.be.equal(void 0),chai.expect(t._eventDispatcher.addedListeners).to.be.eql({}),chai.expect(i._eventDispatcher.addedListeners).to.be.eql({})}))}))}}class FakeIoNode{prop1ChangeCounter=0;prop1Change;prop2ChangeCounter=0;prop2Change;changeCounter=0;eventDispatchCounter=0;eventName;eventChange;eventRegister=[];changeRegister=[];prop1Changed(e){this.prop1Change=e,this.prop1ChangeCounter++,this.changeRegister.push("prop1Changed")}prop2Changed(e){this.prop2Change=e,this.prop2ChangeCounter++,this.changeRegister.push("prop2Changed")}dispatchEvent(e,t){this.eventDispatchCounter++,this.eventRegister.push(e),"changed"!==e&&(this.eventName=e,this.eventChange=t)}dispatchMutationEvent(){}changed(){this.changeCounter++}}class ChangeQueueTest{run(){describe("ChangeQueue",(()=>{it("Should initialize with correct default values",(()=>{const e=new FakeIoNode,t=new o(e);chai.expect(t.node).to.be.equal(e),chai.expect(JSON.stringify(t.changes)).to.be.equal("[]"),chai.expect(t.changes.length).to.be.equal(0),chai.expect(t.dispatching).to.be.equal(!1)})),it("Should dispatch change events with correct payloads",(()=>{const e=new FakeIoNode,t=new o(e);t.queue("test",1,0),t.queue("test",2,1),chai.expect(t.changes.length).to.be.equal(1),t.dispatch(),chai.expect(t.changes.length).to.be.equal(0),chai.expect(e.eventName).to.be.equal("test-changed"),chai.expect(e.eventChange?.property).to.be.equal("test"),chai.expect(e.eventChange?.value).to.be.equal(2),chai.expect(e.eventChange?.oldValue).to.be.equal(0),chai.expect(e.eventDispatchCounter).to.be.equal(2),chai.expect(e.changeCounter).to.be.equal(1),t.queue("test2",0,-1),t.queue("test3",2,1),chai.expect(t.changes.length).to.be.equal(2),t.dispatch(),chai.expect(t.changes.length).to.be.equal(0),chai.expect(e.eventName).to.be.equal("test3-changed"),chai.expect(e.eventChange?.property).to.be.equal("test3"),chai.expect(e.eventChange?.value).to.be.equal(2),chai.expect(e.eventChange?.oldValue).to.be.equal(1),chai.expect(e.eventDispatchCounter).to.be.equal(5),chai.expect(e.prop1ChangeCounter).to.be.equal(0),chai.expect(e.changeCounter).to.be.equal(2)})),it("Should invoke handler functions with correct payloads",(()=>{const e=new FakeIoNode,t=new o(e);t.queue("prop1",1,0),t.queue("prop1",2,1),t.dispatch(),chai.expect(e.prop1ChangeCounter).to.be.equal(1),chai.expect(e.changeCounter).to.be.equal(1),chai.expect(e.prop1Change?.property).to.be.equal("prop1"),chai.expect(e.prop1Change?.value).to.be.equal(2),chai.expect(e.prop1Change?.oldValue).to.be.equal(0)})),it("Should handle changes in first-in, first-out (FIFO) order",(()=>{const e=new FakeIoNode,t=new o(e);t.queue("prop1",1,0),t.queue("prop1",3,0),t.queue("prop2",2,0),t.dispatch(),chai.expect(JSON.stringify(e.changeRegister)).to.be.equal('["prop1Changed","prop2Changed"]'),chai.expect(JSON.stringify(e.eventRegister)).to.be.equal('["prop1-changed","prop2-changed","changed"]')})),it("Should skip dispatch if value is same as oldValue",(()=>{const e=new FakeIoNode,t=new o(e);t.queue("prop1",0,0),t.dispatch(),chai.expect(e.prop1ChangeCounter).to.be.equal(0)})),it("Should dispose correctly",(()=>{const e=new FakeIoNode,t=new o(e);t.dispose(),chai.expect(t.node).to.be.equal(void 0),chai.expect(t.changes).to.be.equal(void 0)}))}))}}var __decorate$7=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};const handlerFunction=()=>{};let R=class IoNode1 extends t{handler1Count=0;handler1Detail;static get Listeners(){return{event1:"handler1"}}handler1(e){this.handler1Count++,this.handler1Detail=e.detail}};R=__decorate$7([i],R);let D=class IoNode2 extends R{handler2Count=0;handler3Count=0;handler2Detail;handler3Detail;static get Listeners(){return{event2:["handler2",{capture:!0}]}}handler2(e){this.handler2Count++,this.handler2Detail=e.detail}handler3(e){this.handler3Count++,this.handler3Detail=e.detail}};D=__decorate$7([i],D);let F=class IoNode3 extends D{static get Listeners(){return{event1:"handler3",event2:[handlerFunction,{passive:!0}],event3:handlerFunction}}};F=__decorate$7([i],F);class TestDivEventDispatchElement extends HTMLElement{handler3Count=0;handler3Detail;handler3(e){this.handler3Count++,this.handler3Detail=e.detail}}window.customElements.define("test-div-event-dispatch",TestDivEventDispatchElement);class EventDispatcherTest{run(){describe("EventDispatcher",(()=>{it("Should initialize with correct values",(()=>{const e={};let t=new a(e);chai.expect(t.node).to.be.equal(e),chai.expect(t.protoListeners).to.be.eql({}),chai.expect(t.propListeners).to.be.eql({}),chai.expect(t.addedListeners).to.be.eql({}),chai.expect(t.isEventTarget).to.be.eql(!1);const i=document.createElement("div");t=new a(i),chai.expect(t.node).to.be.equal(i),chai.expect(t.protoListeners).to.be.eql({}),chai.expect(t.propListeners).to.be.eql({}),chai.expect(t.addedListeners).to.be.eql({}),chai.expect(t.isEventTarget).to.be.equal(!0)})),it("Should initialize listeners from ProtoChain",(()=>{let e=new R,t=new a(e);chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler1]]}),e=new D,t=new a(e),chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler1]],event2:[[e.handler2,{capture:!0}]]}),e=new F,t=new a(e),chai.expect(t.protoListeners).to.be.eql({event1:[[e.handler3]],event2:[[handlerFunction,{passive:!0}]],event3:[[handlerFunction]]})})),it("Should set property listeners correctly",(()=>{const e=new D,t=new a(e),handler4=()=>{},handler5=()=>{};t.applyPropListeners({"@event3":"handler3","@event4":handler4}),chai.expect(t.propListeners).to.be.eql({event3:[[e.handler3]],event4:[[handler4]]}),t.applyPropListeners({"@event5":["handler3"],"@event6":[handler4]}),chai.expect(t.propListeners).to.be.eql({event5:[[e.handler3]],event6:[[handler4]]}),t.applyPropListeners({"@event7":[e.handler3,{capture:!0}],"@event8":[handler5,{capture:!0}]}),chai.expect(t.propListeners).to.be.eql({event7:[[e.handler3,{capture:!0}]],event8:[[handler5,{capture:!0}]]}),t.applyPropListeners({}),chai.expect(t.propListeners).to.be.eql({})})),it("Should add/remove listeners correctly",(()=>{const e=new D,t=new a(e),listener1=()=>{},listener2=()=>{};t.addEventListener("event1",listener1),t.addEventListener("event1",listener2,{capture:!0}),chai.expect(t.addedListeners).to.be.eql({event1:[[listener1],[listener2,{capture:!0}]]}),t.removeEventListener("event1",listener1),chai.expect(t.addedListeners).to.be.eql({event1:[[listener2,{capture:!0}]]}),t.removeEventListener("event1"),chai.expect(t.addedListeners).to.be.eql({})})),it("Should not add listeners if already added",(()=>{const e=new D,t=new a(e),listener1=()=>{},listener2=()=>{};t.addEventListener("event1",listener1),t.addEventListener("event1",listener1),t.addEventListener("event1",listener2,{capture:!0}),t.addEventListener("event1",listener2,{capture:!0}),chai.expect(t.addedListeners).to.be.eql({event1:[[listener1],[listener2,{capture:!0}]]})})),it("Should remove correct listener",(()=>{const e=new D,t=new a(e),listener1=()=>{},listener2=()=>{};t.addEventListener("event1",listener1),t.addEventListener("event1",listener2,{capture:!0}),t.removeEventListener("event1",listener2),chai.expect(t.addedListeners).to.be.eql({event1:[[listener1]]}),t.removeEventListener("event1",listener1),chai.expect(t.addedListeners).to.be.eql({})})),it("Should dispatch added events",(()=>{const e=new D,t=new a(e);let i=0;const handler4=()=>{i++};let o=0;const handler5=()=>{o++};t.applyPropListeners({"@event3":"handler3","@event4":handler4}),t.addEventListener("event5",handler5),t.dispatchEvent("event1"),t.dispatchEvent("event2"),t.dispatchEvent("event3"),t.dispatchEvent("event4"),t.dispatchEvent("event5"),chai.expect(e.handler1Count).to.be.equal(1),chai.expect(e.handler2Count).to.be.equal(1),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(i).to.be.equal(1),chai.expect(o).to.be.equal(1),t.applyPropListeners({"@event4":handler4}),t.removeEventListener("event5",handler5),t.dispatchEvent("event1"),t.dispatchEvent("event2"),t.dispatchEvent("event3"),t.dispatchEvent("event4"),t.dispatchEvent("event5"),chai.expect(e.handler1Count).to.be.equal(2),chai.expect(e.handler2Count).to.be.equal(2),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(i).to.be.equal(2),chai.expect(o).to.be.equal(1)})),it("Should dispatch events with correct event detail",(()=>{const e=new D,t=new a(e);let i;let o;t.applyPropListeners({"@event3":"handler3","@event4":e=>{i=e.detail}}),t.addEventListener("event5",(e=>{o=e.detail})),t.dispatchEvent("event1","detail1"),t.dispatchEvent("event2","detail2"),t.dispatchEvent("event3","detail3"),t.dispatchEvent("event4","detail4"),t.dispatchEvent("event5","detail5"),chai.expect(e.handler1Detail).to.be.equal("detail1"),chai.expect(e.handler2Detail).to.be.equal("detail2"),chai.expect(e.handler3Detail).to.be.equal("detail3"),chai.expect(i).to.be.equal("detail4"),chai.expect(o).to.be.equal("detail5")})),it("Should add/remove/dispatch events on HTML elements",(()=>{const e=document.createElement("test-div-event-dispatch"),t=new a(e);let i,o=0;let n,c=0;const handler5=e=>{c++,n=e.detail};t.applyPropListeners({"@event3":"handler3","@event4":e=>{o++,i=e.detail}}),t.addEventListener("event5",handler5),e.dispatchEvent(new CustomEvent("event3",{detail:"detail3"})),e.dispatchEvent(new CustomEvent("event4",{detail:"detail4"})),e.dispatchEvent(new CustomEvent("event5",{detail:"detail5"})),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(o).to.be.equal(1),chai.expect(c).to.be.equal(1),chai.expect(e.handler3Detail).to.be.equal("detail3"),chai.expect(i).to.be.equal("detail4"),chai.expect(n).to.be.equal("detail5"),t.applyPropListeners({}),t.removeEventListener("event5",handler5),e.dispatchEvent(new CustomEvent("event3",{detail:"detail3i"})),e.dispatchEvent(new CustomEvent("event4",{detail:"detail4i"})),e.dispatchEvent(new CustomEvent("event5",{detail:"detail5i"})),chai.expect(e.handler3Count).to.be.equal(1),chai.expect(o).to.be.equal(1),chai.expect(c).to.be.equal(1),chai.expect(e.handler3Detail).to.be.equal("detail3"),chai.expect(i).to.be.equal("detail4"),chai.expect(n).to.be.equal("detail5")})),it("Should bubble events if specified",(()=>{const e=document.createElement("test-div-event-dispatch"),t=document.createElement("test-div-event-dispatch");t.appendChild(e);const i=new a(e);let o=0;t.addEventListener("event",(()=>{o++})),i.dispatchEvent("event",null,!1),chai.expect(o).to.be.equal(0),i.dispatchEvent("event",null,!0),chai.expect(o).to.be.equal(1),i.dispatchEvent("event"),chai.expect(o).to.be.equal(2)})),it("Should emit event from specified target",(()=>{const e=document.createElement("div"),t=new a(e),i=document.createElement("test-div-event-dispatch"),o=new a(i);o.applyPropListeners({"@event3":"handler3"});let n=null,c=null;o.addEventListener("event3",(e=>{n=e.composedPath(),c=e.target})),t.dispatchEvent("event3","detail",!1,i),chai.expect(i.handler3Detail).to.be.equal("detail"),chai.expect(n).to.be.eql([i]),chai.expect(c).to.be.eql(c)})),it("Should dispose correctly",(()=>{const e=new D,t=new a(e);t.dispose(),chai.expect(t.node).to.be.equal(void 0),chai.expect(t.protoListeners).to.be.equal(void 0),chai.expect(t.propListeners).to.be.equal(void 0),chai.expect(t.addedListeners).to.be.equal(void 0)}))}))}}var __decorate$6=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};let B=class Object1{constructor(e){void 0!==e&&(this.prop=e)}prop=!0},H=class TestIoNode extends t{static get Properties(){return{label:"default"}}};H=__decorate$6([i],H);const V=new H;class PropertyTest{run(){describe("Property",(()=>{it("Should initialize correct property definitions and values from loosely typed property definitions",(()=>{let e,t;e=new n({}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(null),t=new c(V,e),chai.expect(e).to.be.eql({value:null,type:void 0,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:null,type:void 0,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(void 0),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(Number),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Number,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:0,type:Number,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:Number}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Number,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:0,type:Number,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(1),t=new c(V,e),chai.expect(e).to.be.eql({value:1,type:Number,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:1,type:Number,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({value:2}),t=new c(V,e),chai.expect(e).to.be.eql({value:2,type:Number,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:2,type:Number,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(String),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:String,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:"",type:String,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:String}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:String,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:"",type:String,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n("test"),t=new c(V,e),chai.expect(e).to.be.eql({value:"test",type:String,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:"test",type:String,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({value:"test"}),t=new c(V,e),chai.expect(e).to.be.eql({value:"test",type:String,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:"test",type:String,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(Boolean),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Boolean,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:!1,type:Boolean,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:Boolean}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Boolean,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:!1,type:Boolean,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(!0),t=new c(V,e),chai.expect(e).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({value:!0}),t=new c(V,e),chai.expect(e).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:!0,type:Boolean,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n(Object),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Object,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:{},type:Object,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:Object}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Object,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:{},type:Object,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0});const i={prop:!0};e=new n({value:i}),t=new c(V,e),chai.expect(e).to.be.eql({value:{prop:!0},type:Object,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:{prop:!0},type:Object,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),chai.expect(e.value).to.equal(i),chai.expect(t.value).to.equal(i),e=new n(Array),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Array,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:[],type:Array,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:Array}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:Array,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:[],type:Array,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0});const o=[1,2,3];e=new n({value:o}),t=new c(V,e),chai.expect(e).to.be.eql({value:[1,2,3],type:Array,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:[1,2,3],type:Array,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),chai.expect(e.value).to.equal(o),chai.expect(t.value).to.equal(o),e=new n({type:B,init:null}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:null}),chai.expect(t).to.be.eql({value:void 0,type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:null}),e=new n(B),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:new B,type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({type:B,init:"test"}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:"test"}),chai.expect(t).to.be.eql({value:new B("test"),type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:"test"}),e=new n({type:B,init:"this"}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:"this"}),chai.expect(t).to.be.eql({value:new B(V),type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:"this"}),e=new n({type:B,init:"this.label"}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:"this.label"}),chai.expect(t).to.be.eql({value:new B(V.label),type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:"this.label"});const a=new B;e=new n({value:a}),t=new c(V,e),chai.expect(e).to.be.eql({value:a,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(e.value).to.be.equal(a),chai.expect(t).to.be.eql({value:a,type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),chai.expect(t.value).to.be.equal(a),chai.expect(e.value).to.equal(a),chai.expect(t.value).to.equal(a),e=new n({type:B}),t=new c(V,e),chai.expect(e).to.be.eql({value:void 0,type:B,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(t).to.be.eql({value:new B,type:B,binding:void 0,reflect:!1,reactive:!0,observe:!1,init:void 0}),e=new n({reflect:!0,reactive:!1,observe:!0,init:!0}),t=new c(V,e),chai.expect(e).to.be.eql(t).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:!0,reactive:!1,observe:!0,init:!0})})),it("Should register property declarations from decorators.",(()=>{class TestClass extends t{}__decorate$6([l("value1")],TestClass.prototype,"prop1",void 0),__decorate$6([l({value:"value2",type:String})],TestClass.prototype,"prop2",void 0),i(TestClass);const e=r.get(TestClass);chai.expect(e).to.be.eql({prop1:"value1",prop2:{value:"value2",type:String}})})),it("Should initialize properties with binding correctly",(()=>{let t,i,o=new e(new H({label:"lorem"}),"label");t=new n(o),i=new c(V,t),chai.expect(t).to.be.eql({value:"lorem",type:String,binding:o,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(i).to.be.eql({value:"lorem",type:String,binding:o,reflect:!1,reactive:!0,observe:!1,init:void 0}),o=new e(new H({label:"lorem"}),"label"),t=new n({binding:o,value:"ipsum"}),i=new c(V,t),chai.expect(t).to.be.eql({value:"lorem",type:String,binding:o,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(i).to.be.eql({value:"lorem",type:String,binding:o,reflect:!1,reactive:!0,observe:!1,init:void 0})})),it("Should assign property definitions correctly",(()=>{const t=new e(new H({label:"lorem"}),"label");let i=new n({}),o=new n({value:"lorem",type:String,binding:t,reflect:!0,reactive:!1,observe:!0,init:void 0});i.assign(o),chai.expect(i).to.be.eql(o),i=new n({}),o=new n({value:"lorem",type:String,binding:t,reflect:!0,reactive:!1,observe:!0,init:!0}),o.assign(i),chai.expect(i).to.be.eql({value:void 0,type:void 0,binding:void 0,reflect:void 0,reactive:void 0,observe:void 0,init:void 0}),chai.expect(o).to.be.eql({value:"lorem",type:String,binding:t,reflect:!0,reactive:!1,observe:!0,init:!0}),i=new n({reflect:!0,reactive:!0,observe:!1,init:void 0}),o=new n({value:"lorem",type:String,reflect:!0}),o.assign(i),chai.expect(o).to.be.eql({value:"lorem",binding:void 0,type:String,reflect:!0,reactive:!0,observe:!1,init:void 0})}))}))}}var __decorate$5=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};class Array1 extends Array{}class Array2 extends Array1{}class Array3 extends Array2{}class Object1{}class Object2 extends Object1{}class Object3 extends Object2{}class HTMLElement1 extends HTMLElement{}class HTMLElement2 extends HTMLElement1{}class HTMLElement3 extends HTMLElement2{}let Q=class IoNode1 extends t{static get Properties(){return{prop1:{reactive:!1},prop2:{observe:!0}}}};__decorate$5([l({observe:!0})],Q.prototype,"prop2",void 0),Q=__decorate$5([i],Q);let W=class IoNode3 extends Q{static get Properties(){return{prop1:{reactive:!0,reflect:!0}}}};__decorate$5([l({reactive:!0,observe:!0,init:void 0})],W.prototype,"prop1",void 0),__decorate$5([l({value:"foo",reflect:!1})],W.prototype,"prop2",void 0),__decorate$5([l({reflect:!0})],W.prototype,"prop3",void 0),W=__decorate$5([i],W);let J=class IoNode4 extends Q{};__decorate$5([l({reactive:!0})],J.prototype,"prop1",void 0),__decorate$5([l({observe:!1})],J.prototype,"prop2",void 0),J=__decorate$5([i],J);class IoElement1 extends p{}class IoNode2 extends(h(Object3)){}class FakeIoNode1{static get Properties(){return{prop1:{reactive:!1}}}static get Listeners(){return{listener1:"function1",listener2:"",listener3:["_onFunction1",{capture:!0}],listener4:()=>{}}}static get Style(){return"a"}function1(){}onFunction1(){}_onFunction1(){}}class FakeIoNode2 extends FakeIoNode1{function2(){}onFunction2(){}_onFunction2(){}static get Properties(){return{prop1:{observe:!0},prop2:{}}}static get Listeners(){return{listener1:"_onFunction2",listener2:["function2",{capture:!0,passive:!0}],listener3:["_onFunction1",{passive:!0}]}}static get Style(){return"b"}}class FakeIoNode3 extends FakeIoNode2{}class ProtoChainTest{run(){describe("ProtoChain",(()=>{it("Should include an array of inherited class constructors",(()=>{let e=new s(Array3).constructors;chai.expect(e).to.be.eql([Array3,Array2,Array1]),e=new s(Object3).constructors,chai.expect(e).to.be.eql([Object3,Object2,Object1]),e=new s(HTMLElement3).constructors,chai.expect(e).to.be.eql([HTMLElement3,HTMLElement2,HTMLElement1]),e=new s(t).constructors,chai.expect(e).to.be.eql([t,Object.getPrototypeOf(t)]),e=new s(Q).constructors,chai.expect(e).to.be.eql([Q,t,Object.getPrototypeOf(t)]),e=new s(IoElement1).constructors,chai.expect(e).to.be.eql([IoElement1,p,Object.getPrototypeOf(p)]),e=new s(IoNode2).constructors,chai.expect(e).to.be.eql([IoNode2,Object.getPrototypeOf(IoNode2),Object3,Object2,Object1])})),it('Should include an array of function names that start with "on" or "_on" for auto-binding',(()=>{let e=new s(Q);chai.expect(e.functions).to.be.eql([]),e=new s(FakeIoNode1),chai.expect(e.functions).to.be.eql(["onFunction1","_onFunction1"]),e=new s(FakeIoNode2),chai.expect(e.functions).to.be.eql(["onFunction2","_onFunction2","onFunction1","_onFunction1"])})),it("Should bind auto-binding functions with `.autobindFunctions(node)` function",(()=>{const e=new s(FakeIoNode2),t=new FakeIoNode2;e.autobindFunctions(t),chai.expect(t.function1.name).to.be.equal("function1"),chai.expect(t.onFunction1.name).to.be.equal("bound onFunction1"),chai.expect(t._onFunction1.name).to.be.equal("bound _onFunction1"),chai.expect(t.function2.name).to.be.equal("function2"),chai.expect(t.onFunction2.name).to.be.equal("bound onFunction2"),chai.expect(t._onFunction2.name).to.be.equal("bound _onFunction2")})),it("Should include all properties declared in `static get Properties()` return oject",(()=>{let e=new s(FakeIoNode1);chai.expect(Object.keys(e.properties)).to.be.eql(["prop1"]),chai.expect(e.properties).to.be.eql({prop1:{value:void 0,type:void 0,binding:void 0,reactive:!1,reflect:void 0,observe:void 0,init:void 0}}),e=new s(FakeIoNode2),chai.expect(Object.keys(e.properties)).to.be.eql(["prop1","prop2"]),chai.expect(e.properties).to.be.eql({prop1:{value:void 0,type:void 0,binding:void 0,reactive:!1,reflect:void 0,observe:!0,init:void 0},prop2:{value:void 0,type:void 0,binding:void 0,reactive:void 0,reflect:void 0,observe:void 0,init:void 0}})})),it("Should include all properties declared in Property decorator",(()=>{let e=new s(Q);chai.expect(Object.keys(e.properties)).to.be.eql(["lazy","prop2","prop1"]),chai.expect(e.properties).to.be.eql({lazy:{value:!1,type:Boolean,binding:void 0,reactive:!1,reflect:!0,observe:void 0,init:void 0},prop1:{value:void 0,type:void 0,binding:void 0,reactive:!1,reflect:void 0,observe:void 0,init:void 0},prop2:{value:void 0,type:void 0,binding:void 0,reactive:void 0,reflect:void 0,observe:!0,init:void 0}}),e=new s(W),chai.expect(Object.keys(e.properties)).to.be.eql(["lazy","prop2","prop1","prop3"]),chai.expect(e.properties).to.be.eql({lazy:{value:!1,type:Boolean,binding:void 0,reactive:!1,reflect:!0,observe:void 0,init:void 0},prop1:{value:void 0,type:void 0,binding:void 0,reactive:!0,reflect:!0,observe:!0,init:void 0},prop2:{value:"foo",type:String,binding:void 0,reactive:void 0,reflect:!1,observe:!0,init:void 0},prop3:{value:void 0,type:void 0,binding:void 0,reactive:void 0,reflect:!0,observe:void 0,init:void 0}})})),it("Should not override properties declared in Property decorator with inherited `static get Properties()` return oject",(()=>{const e=new s(J);chai.expect(Object.keys(e.properties)).to.be.eql(["lazy","prop2","prop1"]),chai.expect(e.properties).to.be.eql({lazy:{value:!1,type:Boolean,binding:void 0,reactive:!1,reflect:!0,observe:void 0,init:void 0},prop1:{value:void 0,type:void 0,binding:void 0,reactive:!0,reflect:void 0,observe:void 0,init:void 0},prop2:{value:void 0,type:void 0,binding:void 0,reactive:void 0,reflect:void 0,observe:!1,init:void 0}})})),it("Should include all listners declared in `static get Listeners()` return oject",(()=>{let e=new s(FakeIoNode1);chai.expect(Object.keys(e.listeners)).to.be.eql(["listener1","listener3","listener4"]),chai.expect(e.listeners.listener1).to.be.eql([["function1"]]),chai.expect(e.listeners.listener3).to.be.eql([["_onFunction1",{capture:!0}]]),chai.expect(String(e.listeners.listener4)).to.be.eql(String([[()=>{}]])),e=new s(FakeIoNode2),chai.expect(Object.keys(e.listeners)).to.be.eql(["listener1","listener3","listener4","listener2"]),chai.expect(e.listeners.listener1).to.be.eql([["function1"],["_onFunction2"]]),chai.expect(e.listeners.listener2).to.be.eql([["function2",{capture:!0,passive:!0}]]),chai.expect(e.listeners.listener3).to.be.eql([["_onFunction1",{capture:!0,passive:!0}]]),chai.expect(String(e.listeners.listener4)).to.be.eql(String([[()=>{}]]))})),it("Should include all style strings declared in `static get Style()` return string",(()=>{let e=new s(FakeIoNode1);chai.expect(e.style).to.be.equal("a\n"),e=new s(FakeIoNode2),chai.expect(e.style).to.be.equal("a\nb\n"),e=new s(FakeIoNode3),chai.expect(e.style).to.be.equal("a\nb\n")})),it("Should include all property names of observed object properties",(()=>{let e=new s(FakeIoNode1);chai.expect(e.observedObjectProperties).to.be.eql([]),e=new s(FakeIoNode2),chai.expect(e.observedObjectProperties).to.be.eql(["prop1"])}))}))}}class InternalsTest{run(){(new BindingTest).run(),(new ChangeQueueTest).run(),(new EventDispatcherTest).run(),(new PropertyTest).run(),(new ProtoChainTest).run()}}const U=new p;U.style.display="none",document.body.appendChild(U);const G=[];class ElementTest{run(){describe("IoElement",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{chai.expect(U.template).to.be.a("function"),chai.expect(U.traverse).to.be.a("function"),chai.expect(U.setAttribute).to.be.a("function")})),it("Should initialize property definitions correctly",(()=>{chai.expect(U.$).to.be.a("object"),chai.expect(U.tabindex).to.be.equal(""),chai.expect(U.contenteditable).to.be.equal(!1),chai.expect(U.class).to.be.equal(""),chai.expect(U.role).to.be.equal(""),chai.expect(U.label).to.be.equal(""),chai.expect(U.name).to.be.equal(""),chai.expect(U.title).to.be.equal(""),chai.expect(U.id).to.be.equal(""),chai.expect(U.hidden).to.be.equal(!1),chai.expect(U.disabled).to.be.equal(!1),chai.expect(U._properties.get("$")).to.eql({binding:void 0,reactive:!1,observe:!1,init:void 0,reflect:!1,type:Object,value:{}}),chai.expect(U._properties.get("tabindex")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("contenteditable")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1}),chai.expect(U._properties.get("class")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("role")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("label")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("name")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("title")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("id")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(U._properties.get("hidden")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1}),chai.expect(U._properties.get("disabled")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})})),it("Has correct default attributes",(()=>{chai.expect(U.getAttribute("tabindex")).to.equal(null),chai.expect(U.getAttribute("contenteditable")).to.equal(null),chai.expect(U.getAttribute("class")).to.equal(null),chai.expect(U.getAttribute("role")).to.equal(null),chai.expect(U.getAttribute("label")).to.equal(null),chai.expect(U.getAttribute("name")).to.equal(null),chai.expect(U.getAttribute("title")).to.equal(null),chai.expect(U.getAttribute("id")).to.equal(null),chai.expect(U.getAttribute("hidden")).to.equal(null),chai.expect(U.getAttribute("disabled")).to.equal(null)}))})),describe("Reactivity",(()=>{it("Has reactive attributes",(()=>{U.tabindex="1",chai.expect(U.getAttribute("tabindex")).to.equal("1"),U.tabindex="",U.contenteditable=!0,chai.expect(U.getAttribute("contenteditable")).to.equal(""),U.contenteditable=!1,U.class="foo",chai.expect(U.getAttribute("class")).to.equal("foo"),U.class="",U.role="button",chai.expect(U.getAttribute("role")).to.equal("button"),U.role="",U.label="text",chai.expect(U.getAttribute("label")).to.equal("text"),U.label="",U.name="name",chai.expect(U.getAttribute("name")).to.equal("name"),U.name="",U.title="title",chai.expect(U.getAttribute("title")).to.equal("title"),U.title="",U.id="one",chai.expect(U.getAttribute("id")).to.equal("one"),U.id="",U.hidden=!0,chai.expect(U.getAttribute("hidden")).to.equal(""),U.hidden=!1,U.disabled=!0,chai.expect(U.getAttribute("disabled")).to.equal(""),U.disabled=!1})),it("Invokes change events and functions",(()=>{class TestNode extends t{static get Properties(){return{prop0:0,prop1:""}}prop0Changed(){G.push("TestNode: prop0Changed "+this.prop0)}prop1Changed(){G.push("TestNode: prop1Changed "+this.prop1)}changed(){G.push("TestNode: changed")}}i(TestNode);i(class TestSubelement extends p{static get Properties(){return{prop0:0,prop1:""}}});class TestElement1 extends p{static get Properties(){return{prop0:-1,prop1:{value:"default"},_counter:0,_prop0counter:0,_prop0Change:null,_prop1counter:0,_prop1Change:null}}constructor(...e){super(...e),this.template([["test-subelement",{$:"subelement",prop0:this.bind("prop0"),prop1:this.bind("prop1")}]]),this.subnode=new TestNode({prop0:this.bind("prop0"),prop1:this.bind("prop1")})}changed(){G.push("TestElement1: changed"),this._counter++}prop0Changed(e){G.push("TestElement1: prop0Changed "+this.prop0),this._prop0counter++,this._prop0Change=e}prop1Changed(e){G.push("TestElement1: prop1Changed "+this.prop1),this._prop1counter++,this._prop1Change=e}}i(TestElement1),G.length=0;const e=new TestElement1;chai.expect(e.prop0).to.equal(-1),chai.expect(e.subnode.prop0).to.equal(-1),chai.expect(e.$.subelement.prop0).to.equal(-1),chai.expect(e.$.subelement.prop1).to.equal("default"),chai.expect(e.subnode.prop0).to.equal(-1),chai.expect(e.subnode.prop1).to.equal("default"),chai.expect(e._counter).to.equal(0),chai.expect(e._prop0counter).to.equal(0),chai.expect(e._prop0Change).to.equal(null),chai.expect(e._prop1counter).to.equal(0),chai.expect(e._prop1Change).to.equal(null),e.subnode.prop0=1,chai.expect(e.prop0).to.equal(1),chai.expect(e.subnode.prop0).to.equal(1),chai.expect(e._counter).to.equal(1),chai.expect(e._prop0counter).to.equal(1),chai.expect(e._prop0Change).to.eql({property:"prop0",value:1,oldValue:-1}),chai.expect(e._prop1counter).to.equal(0),chai.expect(e._prop1Change).to.equal(null),e.setProperties({prop0:2,prop1:"foo"}),chai.expect(e.prop0).to.equal(2),chai.expect(e.subnode.prop0).to.equal(2),chai.expect(e.$.subelement.prop0).to.equal(2),chai.expect(e.prop1).to.equal("foo"),chai.expect(e.subnode.prop1).to.equal("foo"),chai.expect(e.$.subelement.prop1).to.equal("foo"),chai.expect(e._counter).to.equal(2),chai.expect(e._prop0counter).to.equal(2),chai.expect(e._prop0Change).to.eql({property:"prop0",value:2,oldValue:1}),chai.expect(e._prop1counter).to.equal(1),chai.expect(e._prop1Change).to.eql({property:"prop1",value:"foo",oldValue:"default"}),e.subnode.setProperties({prop0:3,prop1:"buzz"}),chai.expect(e.prop0).to.equal(3),chai.expect(e.subnode.prop0).to.equal(3),chai.expect(e.$.subelement.prop0).to.equal(3),chai.expect(e.$.subelement.prop0).to.equal(3),chai.expect(e.prop1).to.equal("buzz"),chai.expect(e.subnode.prop1).to.equal("buzz"),chai.expect(e.$.subelement.prop1).to.equal("buzz"),chai.expect(e._counter).to.equal(4),chai.expect(e._prop0counter).to.equal(3),chai.expect(e._prop0Change).to.eql({property:"prop0",value:3,oldValue:2}),chai.expect(e._prop1counter).to.equal(2),chai.expect(e._prop1Change).to.eql({property:"prop1",value:"buzz",oldValue:"foo"}),chai.expect(G).to.eql(["TestNode: prop0Changed -1","TestNode: prop1Changed default","TestNode: changed","TestNode: prop0Changed 1","TestElement1: prop0Changed 1","TestElement1: changed","TestNode: changed","TestElement1: prop0Changed 2","TestNode: prop0Changed 2","TestNode: changed","TestElement1: prop1Changed foo","TestNode: prop1Changed foo","TestNode: changed","TestElement1: changed","TestNode: prop0Changed 3","TestElement1: prop0Changed 3","TestElement1: changed","TestNode: prop1Changed buzz","TestElement1: prop1Changed buzz","TestElement1: changed","TestNode: changed"]),G.length=0;class TestElement2 extends p{static get Properties(){return{prop0:-1,prop1:{value:""}}}changed(){this.template([["test-subelement",{$:"subelement",prop0:this.bind("prop0"),prop1:this.bind("prop1")}]])}}i(TestElement2);const o=new TestElement2;o.prop0=1,o.prop1="default",chai.expect(o.prop0).to.equal(1),chai.expect(o.$.subelement.prop0).to.equal(1),chai.expect(o.prop1).to.equal("default"),chai.expect(o.$.subelement.prop1).to.equal("default"),o.setProperties({prop0:2,prop1:"foo"}),chai.expect(o.prop0).to.equal(2),chai.expect(o.$.subelement.prop0).to.equal(2),chai.expect(o.prop1).to.equal("foo"),chai.expect(o.$.subelement.prop1).to.equal("foo"),o.$.subelement.setProperties({prop0:3,prop1:"buzz"}),chai.expect(o.prop0).to.equal(3),chai.expect(o.$.subelement.prop0).to.equal(3),chai.expect(o.prop1).to.equal("buzz"),chai.expect(o.$.subelement.prop1).to.equal("buzz")}))})),describe("Accessibility",(()=>{it("Has a11y attributes",(()=>{chai.expect(U.getAttribute("aria-label")).to.equal(null),U.label="label",chai.expect(U.getAttribute("aria-label")).to.equal("label"),U.label="",chai.expect(U.getAttribute("aria-label")).to.equal(null),U.disabled=!0,chai.expect(U.getAttribute("aria-disabled")).to.equal(""),U.disabled=!1}))})),describe("Binding",(()=>{it("Should bind and unbind correctly",(()=>{const e=new p,t=new p;t.label=e.bind("label"),e.label="one",chai.expect(e.label).to.equal("one"),chai.expect(t.label).to.equal("one"),t.label="two",chai.expect(e.label).to.equal("two"),chai.expect(t.label).to.equal("two"),e.unbind("label"),e.label="three",chai.expect(e.label).to.equal("three"),chai.expect(t.label).to.equal("two"),t.label=e.bind("label"),chai.expect(t.label).to.equal("three"),e.label="four",chai.expect(e.label).to.equal("four"),chai.expect(t.label).to.equal("four"),t.unbind("label"),e.label="five",chai.expect(e.label).to.equal("five"),chai.expect(t.label).to.equal("four")})),it("Should bind from constructor",(()=>{const e=new p,t=new p({label:e.bind("label")});e.label="one",chai.expect(t.label).to.equal("one"),t.unbind("label"),e.label="two",chai.expect(e.label).to.equal("two"),chai.expect(t.label).to.equal("one")}))}))})),describe("Extended IoElement",(()=>{class TestIoNode1 extends t{static get Properties(){return{prop0:-1,prop1:{value:"default"}}}}i(TestIoNode1);class TestIoElement1 extends p{static get Properties(){return{prop0:-1,prop1:{value:"default"}}}}i(TestIoElement1);class TestIoElement2 extends p{static get Properties(){return{prop0:{value:0,reactive:!1,reflect:!0},prop1:0}}}i(TestIoElement2),describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{const e=new TestIoElement1,t=new TestIoElement2;chai.expect(e.prop0).to.equal(-1),chai.expect(e.prop1).to.equal("default"),chai.expect(t.prop0).to.equal(0),chai.expect(t.prop1).to.equal(0),chai.expect(e._properties.get("prop0")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:-1}),chai.expect(e._properties.get("prop1")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:String,value:"default"}),chai.expect(t._properties.get("prop0")).to.eql({binding:void 0,reactive:!1,observe:!1,init:void 0,reflect:!0,type:Number,value:0}),chai.expect(t._properties.get("prop1")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:0})}))})),describe("Reactivity",(()=>{class TestIoElement3 extends TestIoElement1{_changedCounter=0;_prop0ChangedCounter=0;_prop0ChangedChange;_prop1ChangedCounter=0;_prop1ChangedChange;_prop1ChangeEventCounter=0;_prop1ChangeEvent=null;_customEventCounter=0;_customEvent=null;static get Listeners(){return{"prop1-changed":"onProp1ChangeEvent","custom-event":"onCustomEvent"}}changed(){this._changedCounter++}prop0Changed(e){this._prop0ChangedCounter++,this._prop0ChangedChange=e}prop1Changed(e){this._prop1ChangedCounter++,this._prop1ChangedChange=e}onProp1ChangeEvent(e){this._prop1ChangeEventCounter++,this._prop1ChangeEvent=e}onCustomEvent(e){this._customEventCounter++,this._customEvent=e}}i(TestIoElement3);let e=0;function onChange(){e++}it("Should corectly invoke handler functions on change",(()=>{const t=new TestIoElement3({"@prop0-changed":onChange});t.dispatchEvent("custom-event"),t.prop0=1,t.prop1="test",chai.expect(e).to.equal(1),chai.expect(t._changedCounter).to.equal(2),chai.expect(t._prop0ChangedCounter).to.equal(1),chai.expect(t._prop1ChangedCounter).to.equal(1),chai.expect(t._prop1ChangeEventCounter).to.equal(1),chai.expect(t._customEventCounter).to.equal(1)})),it("Should dispatch correct event payloads to handlers",(()=>{const e=new TestIoElement3;e.dispatchEvent("custom-event",{asd:""}),e.prop0=1,e.prop1="foo",chai.expect(e._prop0ChangedChange).to.eql({oldValue:-1,property:"prop0",value:1}),chai.expect(e._prop1ChangedChange).to.eql({oldValue:"default",property:"prop1",value:"foo"}),chai.expect(e._prop1ChangedChange).to.eql({oldValue:"default",property:"prop1",value:"foo"}),chai.expect(e._prop1ChangeEvent.detail).to.eql({property:"prop1",value:"foo",oldValue:"default"})}))})),describe("Binding",(()=>{const e=new TestIoElement1,t=new TestIoNode1;e.template([["test-io-element-1",{$:"subelement",prop0:e.bind("prop0")}]]),it("Should update bound values correctly",(()=>{e.prop0=1/0,chai.expect(e.$.subelement.prop0).to.equal(1/0),e.$.subelement.prop0=-2,chai.expect(e.prop0).to.equal(-2)})),it("Should bind to Node node",(()=>{t.prop1=e.bind("prop1"),t.prop1="a",chai.expect(e.prop1).to.equal("a"),e.prop1="b",chai.expect(e.prop1).to.equal("b")}))}))}))}}const Y=new d;Y.size=[0,0],Y.color=[0,0,0,0],Y.pxRatio=1,Y.style.visibility="hidden",Y.style.position="fixed",document.body.appendChild(Y);class GLTest{run(){describe("IoGl",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{chai.expect(Y.initShader).to.be.a("function"),chai.expect(Y.onResized).to.be.a("function"),chai.expect(Y.themeMutated).to.be.a("function"),chai.expect(Y.setShaderProgram).to.be.a("function"),chai.expect(Y.updatePropertyUniform).to.be.a("function"),chai.expect(Y.updateThemeUniforms).to.be.a("function"),chai.expect(Y.setUniform).to.be.a("function")})),it("Should initialize property definitions correctly",(()=>{Y.onResized(),chai.expect(Y.size).to.be.eql([0,0]),chai.expect(Y.color).to.be.eql([0,0,0,0]),chai.expect(Y.pxRatio).to.be.equal(window.devicePixelRatio),chai.expect(Y.theme).to.be.equal(u),chai.expect(Y._properties.get("size")).to.eql({binding:void 0,reactive:!0,observe:!1,init:[0,0],reflect:!1,type:Array,value:[0,0]}),chai.expect(Y._properties.get("color")).to.eql({binding:void 0,reactive:!0,observe:!0,init:[1,1,1,1],reflect:!1,type:Array,value:[0,0,0,0]}),chai.expect(Y._properties.get("pxRatio")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:window.devicePixelRatio}),chai.expect(Y._properties.get("theme")).to.eql({binding:void 0,reactive:!0,observe:!0,init:void 0,reflect:!1,type:p,value:u})})),it("has <canvas> element",(()=>{chai.expect(Y.children[0].localName).to.equal("canvas"),chai.expect(Y._canvas.localName).to.equal("canvas")}))})),describe("Reactivity",(()=>{it("has correct size and pxRatio",(()=>{Y.style.border="none",Y.style.width="32px",Y.style.height="32px",Y.onResized(),chai.expect(Y.size[0]).to.equal(32),chai.expect(Y.size[1]).to.equal(32),chai.expect(Y.pxRatio).to.equal(window.devicePixelRatio)})),it("has correct color",(()=>{let e=Y._ctx.getImageData(0,0,1,1).data;chai.expect(e).to.eql(new Uint8ClampedArray([0,0,0,0])),Y.color=[1,.5,.25,1],Y._onRender(),e=Y._ctx.getImageData(0,0,1,1).data,chai.expect(e).to.eql(new Uint8ClampedArray([255,128,64,255]))}))}))}))}}class OverlayTest{run(){describe("IoOverlaySingleton",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{chai.expect(b.nudgeDown).to.be.a("function"),chai.expect(b.nudgeUp).to.be.a("function"),chai.expect(b.nudgeRight).to.be.a("function"),chai.expect(b.nudgeLeft).to.be.a("function"),chai.expect(b.nudgePointer).to.be.a("function"),chai.expect(b.setElementPosition).to.be.a("function"),chai.expect(b.onChildExpanded).to.be.a("function"),chai.expect(b.onChildExpandedDelayed).to.be.a("function")})),it("Should initialize property definitions correctly",(()=>{chai.expect(b.expanded).to.be.eql(!1),chai.expect(b._properties.get("expanded")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})}))}))}))}}var __decorate$4=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};class NodeTest{run(){describe("IoNode",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{const e=new t;chai.expect(e.setProperty).to.be.a("function"),chai.expect(e.applyProperties).to.be.a("function"),chai.expect(e.setProperties).to.be.a("function"),chai.expect(e.inputValue).to.be.a("function"),chai.expect(e.changed).to.be.a("function"),chai.expect(e.queue).to.be.a("function"),chai.expect(e.dispatchQueue).to.be.a("function"),chai.expect(e.dispatchQueueSync).to.be.a("function"),chai.expect(e.throttle).to.be.a("function"),chai.expect(e.onObjectMutated).to.be.a("function"),chai.expect(e.objectMutated).to.be.a("function"),chai.expect(e.bind).to.be.a("function"),chai.expect(e.unbind).to.be.a("function"),chai.expect(e.addEventListener).to.be.a("function"),chai.expect(e.removeEventListener).to.be.a("function"),chai.expect(e.dispatchEvent).to.be.a("function"),chai.expect(e.dispose).to.be.a("function"),e.dispose()})),it("Should register property definitions correctly",(()=>{let e=class TestNode extends t{static get Properties(){return{prop0:{type:String},prop1:{value:!1},prop2:-1,prop3:Number,prop4:Object,prop5:[0,1,2]}}};e=__decorate$4([i],e);const o=new e;chai.expect(o.prop0).to.be.equal(""),chai.expect(o.prop1).to.be.equal(!1),chai.expect(o.prop2).to.be.equal(-1),chai.expect(o.prop3).to.be.equal(0),chai.expect(o.prop4).to.be.deep.equal({}),chai.expect(o.prop5).to.be.deep.equal([0,1,2]),o.dispose()})),it("Should aggregate property definitions from protochain",(()=>{let e=class Object1 extends t{static get Properties(){return{prop1:{value:0},prop2:null}}};e=__decorate$4([i],e);let o=class Object2 extends e{static get Properties(){return{prop1:{value:{},reactive:!1,observe:!0},prop2:{reactive:!0},prop3:""}}};o=__decorate$4([i],o);const a=new e,n=new o,c=a._protochain.properties,l=n._protochain.properties;chai.expect(Array.from(a._properties.keys())).to.be.eql(["lazy","prop1","prop2"]),chai.expect(Array.from(n._properties.keys())).to.be.eql(["lazy","prop1","prop2","prop3"]),chai.expect(c.prop1.value).to.be.equal(0),chai.expect(a._properties.get("prop1")).to.be.eql({value:0,type:Number,binding:void 0,reactive:!0,reflect:!1,observe:!1,init:void 0}),chai.expect(l.prop1.value).to.be.eql({}),chai.expect(n._properties.get("prop1")).to.be.eql({value:{},type:Object,binding:void 0,reactive:!1,reflect:!1,observe:!0,init:void 0}),chai.expect(n._properties.get("prop2")).to.be.eql({value:null,type:void 0,binding:void 0,reactive:!0,reflect:!1,observe:!1,init:void 0})})),it("Should favor explicit property definitions over implicit",(()=>{class Object1{static get Properties(){return{prop1:{value:{},reactive:!1,reflect:!0,observe:!0}}}}const e=new s(class Object2 extends Object1{static get Properties(){return{prop1:[1,2,3]}}}).properties;chai.expect(e.prop1.value).to.be.eql([1,2,3]),chai.expect(e.prop1.type).to.be.equal(Array),chai.expect(e.prop1.reactive).to.be.equal(!1),chai.expect(e.prop1.reflect).to.be.equal(!0),chai.expect(e.prop1.observe).to.be.equal(!0)})),it("Should correctly register properties with bindigs",(()=>{let o=class TestNode extends t{static get Properties(){return{label:""}}};o=__decorate$4([i],o);const a=new e(new o({label:"binding1"}),"label"),n=new e(new o({label:"binding2"}),"label"),c=new e(new o({label:"binding3"}),"label");let l=class Object1 extends t{static get Properties(){return{prop1:a}}};l=__decorate$4([i],l);let r=class Object2 extends l{static get Properties(){return{prop1:{binding:n},prop3:c}}};r=__decorate$4([i],r);const s=new l,p=new r;chai.expect(s._properties.get("prop1").binding).to.be.equal(a),chai.expect(p._properties.get("prop1").binding).to.be.equal(n),chai.expect(p._properties.get("prop3").binding).to.be.equal(c),chai.expect(a.targets[0]).to.be.equal(s),chai.expect(n.targets[0]).to.be.equal(p),chai.expect(c.targets[0]).to.be.equal(p),chai.expect(s._properties.get("prop1").value).to.be.equal("binding1"),chai.expect(p._properties.get("prop1").value).to.be.equal("binding2"),chai.expect(p._properties.get("prop3").value).to.be.equal("binding3")}))})),describe("Construction",(()=>{})),describe("Properties",(()=>{it("Should correctly get/set properties",(()=>{let e=class TestNode extends t{static get Properties(){return{prop1:{value:1}}}};e=__decorate$4([i],e);const o=new e;chai.expect(o._properties.get("prop1").value).to.be.equal(1),chai.expect(o.prop1).to.be.equal(1),o.setProperty("prop1",0),chai.expect(o._properties.get("prop1").value).to.be.equal(0),chai.expect(o.prop1).to.be.equal(0)})),it("Should correctly get/set bound properties",(()=>{let o=class TestNode extends t{static get Properties(){return{label:""}}};o=__decorate$4([i],o);const a=new e(new o({label:"binding1"}),"label"),n=new e(new o({label:"binding2"}),"label");let c=class TestNode2 extends t{static get Properties(){return{prop1:a}}};c=__decorate$4([i],c);const l=new c;chai.expect(l._properties.get("prop1").value).to.be.equal("binding1"),chai.expect(l.prop1).to.be.equal("binding1"),chai.expect(l._properties.get("prop1").binding).to.be.equal(a),chai.expect(a.targets[0]).to.be.equal(l),a.removeTarget(l,"prop1");const r=l._properties.get("prop1");r&&(r.binding=void 0),l.setProperty("prop1",n),chai.expect(l._properties.get("prop1").value).to.be.equal("binding2"),chai.expect(l.prop1).to.be.equal("binding2"),chai.expect(a.targets[0]).to.be.equal(void 0),chai.expect(n.targets[0]).to.be.equal(l)})),it("Should execute attribute reflection on IoElement",(()=>{let e=class TestElementReflection extends p{static get Properties(){return{label:{value:"label1",reflect:!0}}}};e=__decorate$4([i],e);const t=new e;chai.expect(t.getAttribute("label")).to.be.equal("label1"),t.label="label2",chai.expect(t.getAttribute("label")).to.be.equal("label2"),t.setProperty("label","label3"),chai.expect(t.getAttribute("label")).to.be.equal("label3")})),it("Should dipatch queue on object value initialization and value set",(()=>{let e=class TestNode extends t{static get Properties(){return{prop:Object}}};e=__decorate$4([i],e);const o=new e;o.addEventListener("prop-changed",(e=>{chai.expect("This should not execute").to.be.eql(!0)})),o.removeEventListener("prop-changed"),o.addEventListener("prop-changed",(e=>{const t=e.detail.value,i=e.detail.oldValue;chai.expect(t).to.be.eql({}),chai.expect(i).to.be.eql({})})),o.prop={},o.addEventListener("prop-changed",(()=>{chai.expect("This should never happen!").to.be.equal(!0)})),o.setProperty("prop",{},!0),o.removeEventListener("prop-changed"),o.prop={}})),it("Should connect/disconnect IoNode-property-values on construction and value set",(()=>{let e=class TestSubNode extends t{static get Properties(){return{prop:0,propChangeCounter:0}}propChanged(){this.propChangeCounter++}};e=__decorate$4([i],e);let o=class TestNode extends t{static get Properties(){return{prop:e}}};o=__decorate$4([i],o);const a=new o,n=a.prop;chai.expect(n.propChangeCounter).to.be.equal(0),n.prop=1,n.prop=2,chai.expect(n.propChangeCounter).to.be.equal(2),n.prop=3,chai.expect(n.propChangeCounter).to.be.equal(3);const c=new e;a.prop=c,n.prop=4,chai.expect(n.propChangeCounter).to.be.equal(4),chai.expect(c.propChangeCounter).to.be.equal(0)}))})),describe("Reactivity",(()=>{it("Should corectly invoke handler functions on change",(()=>{let e=class TestNode extends t{_changedCounter=0;_prop1ChangedCounter=0;_prop1Change=null;_prop2ChangedCounter=0;_prop2Change=null;static get Properties(){return{prop1:String,prop2:String}}changed(){this._changedCounter++}prop1Changed(e){this._prop1ChangedCounter++,this._prop1Change=e}prop2Changed(e){this._prop2ChangedCounter++,this._prop2Change=e}};e=__decorate$4([i],e);const o=new e;chai.expect(o._changedCounter).to.equal(0),chai.expect(o._prop1ChangedCounter).to.equal(0),chai.expect(o._prop2ChangedCounter).to.equal(0),chai.expect(o._prop1Change?.property).to.equal(void 0),chai.expect(o._prop1Change?.oldValue).to.equal(void 0),chai.expect(o._prop1Change?.value).to.equal(void 0),chai.expect(o._prop2ChangedCounter).to.equal(0),chai.expect(o._prop2Change?.property).to.equal(void 0),chai.expect(o._prop2Change?.oldValue).to.equal(void 0),chai.expect(o._prop2Change?.value).to.equal(void 0),o.prop1="one",chai.expect(o._changedCounter).to.equal(1),chai.expect(o._prop1ChangedCounter).to.equal(1),chai.expect(o._prop2ChangedCounter).to.equal(0),chai.expect(o._prop1Change?.property).to.equal("prop1"),chai.expect(o._prop1Change?.oldValue).to.equal(""),chai.expect(o._prop1Change?.value).to.equal("one"),o.prop1="two",o.prop2="test",chai.expect(o._changedCounter).to.equal(3),chai.expect(o._prop1ChangedCounter).to.equal(2),chai.expect(o._prop1Change?.property).to.equal("prop1"),chai.expect(o._prop1Change?.oldValue).to.equal("one"),chai.expect(o._prop1Change?.value).to.equal("two"),chai.expect(o._prop2ChangedCounter).to.equal(1),chai.expect(o._prop2Change?.property).to.equal("prop2"),chai.expect(o._prop2Change?.oldValue).to.equal(""),chai.expect(o._prop2Change?.value).to.equal("test"),o.setProperties({prop1:"three",prop2:""}),chai.expect(o._changedCounter).to.equal(4),chai.expect(o._prop1ChangedCounter).to.equal(3),chai.expect(o._prop1Change?.property).to.equal("prop1"),chai.expect(o._prop1Change?.oldValue).to.equal("two"),chai.expect(o._prop1Change?.value).to.equal("three"),chai.expect(o._prop2ChangedCounter).to.equal(2),chai.expect(o._prop2Change?.property).to.equal("prop2"),chai.expect(o._prop2Change?.oldValue).to.equal("test"),chai.expect(o._prop2Change?.value).to.equal(""),o.dispose()})),it("should invoke property mutation handler functions on mutation event",(async()=>{let e=class TestNode extends t{_changedCounter=0;_obj1MutatedCounter=0;_obj2MutatedCounter=0;static get Properties(){return{obj1:{type:Object,observe:!0},obj2:{type:Object,observe:!0}}}changed(){this._changedCounter++}obj1Mutated(){this._obj1MutatedCounter++}obj2Mutated(){this._obj2MutatedCounter++}};e=__decorate$4([i],e);const o=new e;chai.expect(o._changedCounter).to.equal(0),chai.expect(o._obj1MutatedCounter).to.equal(0),o.dispatchEvent("object-mutated",{object:o.obj1},!1,window),await nextTick(),chai.expect(o._changedCounter).to.equal(1),chai.expect(o._obj1MutatedCounter).to.equal(1),chai.expect(o._obj2MutatedCounter).to.equal(0),o.dispatchEvent("object-mutated",{object:o.obj2},!1,window),await nextTick(),o.dispose()})),it("should fire change events",(()=>{let e=class TestNode extends t{static get Properties(){return{prop1:String,_onProp1ChangedCounter:0,_onProp1Change:null,_onCustomEventCounter:0,_onCustomEven:null}}static get Listeners(){return{"prop1-changed":"onProp1Changed","custom-event":"onCustomEvent"}}onProp1Changed(e){this._onProp1ChangedCounter++,this._onProp1Change=e}onCustomEvent(e){this._onCustomEventCounter++,this._onCustomEven=e}};e=__decorate$4([i],e);const o=new e;o.prop1="one",chai.expect(o._onProp1ChangedCounter).to.equal(1),chai.expect(o._onProp1Change.detail.property).to.equal("prop1"),chai.expect(o._onProp1Change.detail.oldValue).to.equal(""),chai.expect(o._onProp1Change.detail.value).to.equal("one"),o.dispatchEvent("custom-event",{value:"hello"}),chai.expect(o._onCustomEventCounter).to.equal(1),chai.expect(o._onCustomEven.path[0]).to.equal(o),chai.expect(o._onCustomEven.detail.value).to.equal("hello")}))})),describe("Binding",(()=>{it("should correctly bind properties",(()=>{let o=class TestNode extends t{static get Properties(){return{prop1:String,prop2:String}}};o=__decorate$4([i],o);const a=new o,n=a.bind("prop1");chai.expect(n).to.be.instanceof(e),chai.expect(n.node).to.be.equal(a),chai.expect(n.property).to.be.equal("prop1");const c=new o({prop1:n}),l=new o({prop1:n});l.prop2=n,chai.expect(n.targets[0]).to.be.equal(c),chai.expect(n.targets[1]).to.be.equal(l),chai.expect(n.targetProperties.get(c)[0]).to.be.equal("prop1"),chai.expect(n.targetProperties.get(c)[1]).to.be.equal(void 0),chai.expect(n.targetProperties.get(l)[0]).to.be.equal("prop1"),chai.expect(n.targetProperties.get(l)[1]).to.be.equal("prop2"),a.prop1="one",chai.expect(c.prop1).to.be.equal("one"),chai.expect(c.prop2).to.be.equal(""),chai.expect(l.prop1).to.be.equal("one"),chai.expect(l.prop2).to.be.equal("one"),c.prop1="two",chai.expect(a.prop1).to.be.equal("two"),chai.expect(l.prop1).to.be.equal("two"),chai.expect(n.targets.length).to.be.equal(2),c.dispose(),chai.expect(n.targets.length).to.be.equal(1),l.dispose(),chai.expect(n.targets.length).to.be.equal(0),a.dispose()})),it("Should add/remove targets and targetProperties when assigned to values",(()=>{let o=class TestNode extends t{static get Properties(){return{prop1:String,prop2:String}}};o=__decorate$4([i],o);const a=new o,n=new e(a,"prop1"),c=new e(a,"prop2"),l=new o;l.prop1=n,l.prop2=c;const r=new o({prop1:n}),s=new o({prop1:n,prop2:n});chai.expect(n.targets[0]).to.be.equal(l),chai.expect(n.targets[1]).to.be.equal(r),chai.expect(n.targets[2]).to.be.equal(s),chai.expect(n.targetProperties.get(l)).to.be.eql(["prop1"]),chai.expect(n.targetProperties.get(r)).to.be.eql(["prop1"]),chai.expect(n.targetProperties.get(s)).to.be.eql(["prop1","prop2"]),l.dispose(),r.unbind("prop1"),s.unbind("prop1"),chai.expect(n.targetProperties.get(l)).to.be.eql([]),chai.expect(n.targetProperties.get(r)).to.be.eql([]),chai.expect(n.targetProperties.get(s)).to.be.eql(["prop2"]),r.prop2=n,r.prop1=n,s.prop1=n,chai.expect(n.targetProperties.get(r)).to.be.eql(["prop2","prop1"]),chai.expect(n.targetProperties.get(s)).to.be.eql(["prop2","prop1"])})),it('Should return existing binding or create a new on "bind()"',(()=>{let e=class TestNode extends t{static get Properties(){return{prop1:String,prop2:String}}};e=__decorate$4([i],e);const o=new e,a=o.bind("prop1");chai.expect(a).to.be.equal(o._bindings.get("prop1")),chai.expect(a).to.be.equal(o.bind("prop1"))})),it("Should dispose bindings correctly",(()=>{let e=class TestNode extends t{static get Properties(){return{prop1:String,prop2:String}}};e=__decorate$4([i],e);const o=new e,a=o.bind("prop1");o.unbind("prop1"),chai.expect(o._bindings.get("prop1")).to.be.equal(void 0),chai.expect(a.prop1).to.be.equal(void 0);const n=new e,c=n.bind("prop1");n.dispose(),chai.expect(n._bindings).to.be.equal(void 0),chai.expect(c.prop1).to.be.equal(void 0)}))}))}))}}localStorage.removeItem("IoStorage:test2"),localStorage.removeItem("IoStorage:test3"),localStorage.removeItem("IoStorage:test4"),localStorage.removeItem("IoStorage:test5");const K=localStorage.getItem("IoStorage:user-permitted");localStorage.setItem("IoStorage:user-permitted","true");class StorageTest{run(){describe("IoStorageNode",(()=>{describe("Initialization",(()=>{it("Should register property definitions correctly",(()=>{const e=new v({key:"test",value:"foo"});chai.expect(e.key).to.be.equal("test"),chai.expect(e.value).to.be.equal("foo"),chai.expect(e.default).to.be.equal("foo"),chai.expect(e.storage).to.be.equal("none"),chai.expect(e._properties.get("key")).to.eql({binding:void 0,reactive:!0,observe:!1,reflect:!1,init:void 0,type:String,value:"test"}),chai.expect(e._properties.get("value")).to.eql({binding:void 0,reactive:!0,observe:!1,reflect:!1,init:void 0,type:void 0,value:"foo"}),chai.expect(e._properties.get("default")).to.eql({binding:void 0,reactive:!0,observe:!1,reflect:!1,init:void 0,type:void 0,value:"foo"}),chai.expect(e._properties.get("storage")).to.eql({binding:void 0,reactive:!0,observe:!1,reflect:!1,init:void 0,type:String,value:"none"}),e.dispose()})),it("Should initialize property value from localStorage store if exists",(()=>{localStorage.setItem("IoStorage:test2",'"asd"');const e=new v({key:"test2",value:"buzz",storage:"local"});chai.expect(e.key).to.be.equal("test2"),chai.expect(e.value).to.be.equal("asd"),chai.expect(e.default).to.be.equal("buzz"),chai.expect(e.storage).to.be.equal("local"),e.dispose()})),it("Should initialize property value from location.hash store if exists",(async()=>{self.location.hash=self.location.hash+"&testhash=foo";const e=new v({key:"testhash",value:"buzz",storage:"hash"});chai.expect(e.key).to.be.equal("testhash"),chai.expect(e.value).to.be.equal("foo"),chai.expect(e.default).to.be.equal("buzz"),chai.expect(e.storage).to.be.equal("hash"),e.dispose()})),it("Should return a new instance only if key and store are unique",(()=>{const e=new v({key:"test3",storage:"local"}),t=new v({key:"test3",storage:"local"}),i=new v({key:"test3",storage:"hash"}),o=new v({key:"test4",storage:"local"});chai.expect(e).to.be.equal(t),chai.expect(e).to.not.be.equal(i),chai.expect(e).to.not.be.equal(o),e.dispose(),i.dispose(),o.dispose()}))})),describe("Reactivity",(()=>{it("Should update localStorage store when value changes",(()=>{const e=new v({key:"test5",value:"one",storage:"local"});chai.expect(localStorage.getItem("IoStorage:test5")).to.be.equal(null),e.value="two",chai.expect(localStorage.getItem("IoStorage:test5")).to.be.equal('"two"'),e.value="2",chai.expect(localStorage.getItem("IoStorage:test5")).to.be.equal('"2"'),e.value=2,chai.expect(localStorage.getItem("IoStorage:test5")).to.be.equal("2"),e.value="one",chai.expect(localStorage.getItem("IoStorage:test5")).to.be.equal(null),e.dispose()})),it("Should update location.hash store when value changes to non-default",(async()=>{const e=new v({key:"test6",value:"one",storage:"hash"});e.value="two",chai.expect(self.location.hash).to.include("test6=two"),e.value="2",chai.expect(self.location.hash).to.include("test6=%222%22"),e.value=!0,chai.expect(self.location.hash).to.include("test6=true"),e.value=2,chai.expect(self.location.hash).to.include("test6=2"),self.location.hash=self.location.hash.replace("test6=2","test6=3"),await afterHashChange(),chai.expect(e.value).to.be.equal(3),self.location.hash=self.location.hash.replace("test6=3",'test6="3"'),await afterHashChange(),chai.expect(e.value).to.be.equal("3"),self.location.hash=self.location.hash.replace("test6=%223%22","test6=false"),await afterHashChange(),chai.expect(e.value).to.be.equal(!1),e.value=[0,1,2],chai.expect(self.location.hash).to.include("test6=[0,1,2]"),e.value=[0,1,"2"],chai.expect(self.location.hash).to.include("test6=[0,1,%222%22]"),e.value="2",chai.expect(self.location.hash).to.include("test6=%222%22"),e.dispose(),K&&"false"!==K||localStorage.setItem("IoStorage:user-permitted","false")}))}))})),describe("IoStorage",(()=>{describe("Initialization",(()=>{it("Should return binding to IoStorageNode Node",(()=>{const t=x({key:"test",storage:"hash"});t.value="foo",chai.expect(t).to.be.instanceOf(e),t.dispose(),chai.expect(self.location.hash).to.not.include("test=foo")}))}))}))}}const X=u,Z=X._properties.get("themeID").binding;class ThemeTest{run(){describe("IoThemeSingleton",(()=>{describe("Initialization",(()=>{it("Should register property definitions correctly",(()=>{chai.expect(X._properties.get("themeID")).to.eql({binding:Z,reactive:!0,observe:!1,init:void 0,reflect:!1,type:String,value:X.themeID})}))}))}))}}class CoreTests{run(){(new InternalsTest).run(),(new ElementTest).run(),(new GLTest).run(),(new OverlayTest).run(),(new NodeTest).run(),(new StorageTest).run(),(new ThemeTest).run()}}const ee=new q;ee.style.display="none",document.body.appendChild(ee);class BooleanElementTest{run(){describe("IoBoolean",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{chai.expect(ee.toggle).to.be.a("function")})),it("Should initialize property definitions correctly",(()=>{chai.expect(ee.value).to.equal(!1),chai.expect(ee.true).to.equal("true"),chai.expect(ee.false).to.equal("false"),chai.expect(ee.role).to.equal("switch"),chai.expect(ee._properties.get("value")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1}),chai.expect(ee._properties.get("true")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:String,value:"true"}),chai.expect(ee._properties.get("false")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:String,value:"false"})})),it("has correct default attributes",(()=>{chai.expect(ee.getAttribute("role")).to.equal("switch"),chai.expect(ee.getAttribute("value")).to.equal(null),chai.expect(ee.getAttribute("aria-checked")).to.equal("false")})),it("has correct default innerHTML",(()=>{chai.expect(ee.innerHTML).to.equal('<io-label label="false" aria-label="false">false</io-label>')}))})),describe("Reactivity",(()=>{it("should set innerText to match value property",(()=>{chai.expect(ee.innerText).to.equal(ee.false),ee.toggle(),chai.expect(ee.innerText).to.equal(ee.true),ee.true="yes",ee.false="no",chai.expect(ee.innerText).to.equal("yes"),ee.toggle(),chai.expect(ee.innerText).to.equal("no"),ee.value=!1,ee.true="true",ee.false="false"})),it("should set icon to match icon property",(()=>{ee.icon="icons:checkmark",chai.expect(ee.innerHTML).to.equal(`<io-icon icon="${ee.icon}">${g.getIcon(ee.icon)}</io-icon><io-label label="false" aria-label="false">${ee.false}</io-label>`),ee.icon="",chai.expect(ee.innerHTML).to.equal(`<io-label label="false" aria-label="false">${ee.false}</io-label>`)})),it("should not render innerHTML if no value string is computed",(()=>{ee.true="",ee.false="",chai.expect(ee.innerHTML).to.equal(""),ee.toggle(),chai.expect(ee.innerHTML).to.equal(""),ee.toggle(),ee.true="true",ee.false="false"})),it("has reactive attributes",(()=>{ee.value=!1,chai.expect(ee.getAttribute("value")).to.equal(null),ee.value=!0,chai.expect(ee.getAttribute("value")).to.equal(""),ee.value=!1}))})),describe("Accessibility",(()=>{it("has a11y attributes",(()=>{ee.value=!1,chai.expect(ee.getAttribute("aria-checked")).to.equal("false"),ee.value=!0,chai.expect(ee.getAttribute("aria-checked")).to.equal("true"),ee.value=!1}))}))}))}}const te=new f;te.style.display="none",document.body.appendChild(te);class ButtonElementTest{run(){describe("IoButton",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(te.action).to.equal(void 0),chai.expect(te.value).to.equal(void 0),chai.expect(te.pressed).to.equal(!1),chai.expect(te.role).to.equal("button"),chai.expect(te._properties.get("action")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:void 0,value:void 0}),chai.expect(te._properties.get("value")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:void 0,value:void 0}),chai.expect(te._properties.get("pressed")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})})),it("has correct default attributes",(()=>{chai.expect(te.getAttribute("role")).to.equal("button"),chai.expect(te.getAttribute("pressed")).to.equal(null),chai.expect(te.getAttribute("aria-pressed")).to.equal("false")})),it("has correct default innerHTML",(()=>{chai.expect(te.innerHTML).to.equal("")}))})),describe("Reactivity",(()=>{it("should set innerText to match label property",(()=>{chai.expect(te.innerText).to.equal(""),te.label="click me",chai.expect(te.innerText).to.equal("click me"),te.label=""})),it("should set icon to match icon property",(()=>{te.icon="icons:checkmark",chai.expect(te.innerHTML).to.equal(`<io-icon icon="${te.icon}">${g.getIcon(te.icon)}</io-icon>`),te.icon="",chai.expect(te.innerHTML).to.equal("")})),it("has reactive attributes",(()=>{te.pressed=!1,chai.expect(te.getAttribute("aria-pressed")).to.equal("false"),te.pressed=!0,chai.expect(te.getAttribute("aria-pressed")).to.equal("true"),te.pressed=!1}))}))}))}}const ie=new m;ie.style.display="none",document.body.appendChild(ie);class FieldElementTest{run(){describe("IoField",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{chai.expect(ie.getCaretPosition).to.be.a("function"),chai.expect(ie.setCaretPosition).to.be.a("function")})),it("Should initialize property definitions correctly",(()=>{chai.expect(ie.tabindex).to.equal("0"),chai.expect(ie.value).to.equal(void 0),chai.expect(ie.icon).to.equal(""),chai.expect(ie.stroke).to.equal(!1),chai.expect(ie.selected).to.equal(!1),chai.expect(ie._properties.get("value")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:void 0,value:void 0}),chai.expect(ie._properties.get("stroke")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1}),chai.expect(ie._properties.get("selected")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})})),it("has correct default attributes",(()=>{chai.expect(ie.getAttribute("tabindex")).to.equal("0"),chai.expect(ie.getAttribute("icon")).to.equal(null),chai.expect(ie.getAttribute("stroke")).to.equal(null),chai.expect(ie.getAttribute("value")).to.equal(null),chai.expect(ie.getAttribute("selected")).to.equal(null)})),it("has correct default innerHTML",(()=>{chai.expect(ie.innerHTML).to.equal("")}))})),describe("Reactivity",(()=>{it("should set innerText to match value and/or label property",(()=>{chai.expect(ie.innerText).to.equal(""),ie.value=!1,chai.expect(ie.innerText).to.equal("false"),ie.value={},chai.expect(ie.innerText).to.equal("Object"),ie.value=[0,1,2,3],chai.expect(ie.innerText).to.equal("Array(4)"),ie.label="label",chai.expect(ie.innerText).to.equal("label"),ie.value=void 0,chai.expect(ie.innerText).to.equal("label"),ie.label="",chai.expect(ie.innerText).to.equal("undefined")})),it("should set icon to match icon property",(()=>{ie.icon="icons:checkmark",chai.expect(ie.innerHTML).to.equal(`<io-icon icon="${ie.icon}">${g.getIcon(ie.icon)}</io-icon><io-label label="${ie.value}" aria-label="${ie.value}">${ie.value}</io-label>`),ie.icon="",chai.expect(ie.innerHTML).to.equal(`<io-label label="${ie.value}" aria-label="${ie.value}">${ie.value}</io-label>`)})),it("has reactive attributes",(()=>{chai.expect(ie.getAttribute("selected")).to.equal(null),ie.selected=!0,chai.expect(ie.getAttribute("selected")).to.equal(""),ie.selected=!1}))}))}))}}const oe=new y;oe.style.display="none",document.body.appendChild(oe);class IconElementTest{run(){describe("IoIcon",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(oe.icon).to.equal(""),chai.expect(oe.stroke).to.equal(!1),chai.expect(oe._properties.get("icon")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""}),chai.expect(oe._properties.get("stroke")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})})),it("has correct default attributes",(()=>{chai.expect(oe.getAttribute("icon")).to.equal(null),chai.expect(oe.getAttribute("stroke")).to.equal(null)})),it("has correct default innerHTML",(()=>{chai.expect(oe.innerHTML).to.equal("")}))})),describe("Reactivity",(()=>{it("should set innerHTML to match icon property",(()=>{oe.icon="icon:check",chai.expect(oe.innerHTML).to.equal(g.getIcon("icon:check")),oe.icon="iconcheck",chai.expect(oe.innerHTML).to.equal("iconcheck"),oe.icon=""})),it("has reactive attributes",(()=>{oe.icon="text",chai.expect(oe.getAttribute("icon")).to.equal("text"),oe.icon="",oe.stroke=!0,chai.expect(oe.getAttribute("stroke")).to.equal(""),oe.stroke=!1}))}))}))}}class IconsetElementTest{run(){describe("IoIconsetSingleton",(()=>{it("Should have core API functions defined",(()=>{chai.expect(g.registerIcons).to.be.a("function"),chai.expect(g.getIcon).to.be.a("function")})),it("registers icons",(()=>{g.registerIcons("test-please-ignore",'<svg><g id="dummy"><path></path></g></svg>'),chai.expect(g.getIcon("test-please-ignore:dummy")).to.equal('<svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet"><g class="icon-id-dummy"><path></path></g></svg>')}))}))}}const ae=new w;ae.style.display="none",document.body.appendChild(ae);class LabelElementTest{run(){describe("IoLabel",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(ae.label).to.equal(""),chai.expect(ae._properties.get("label")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:""})})),it("has correct default attributes",(()=>{chai.expect(ae.getAttribute("label")).to.equal(null)}))})),describe("Reactivity",(()=>{it("should set innerText to match label property",(()=>{ae.label="label",chai.expect(ae.innerText).to.equal("label"),ae.label="",chai.expect(ae.innerText).to.equal("")})),it("has reactive attributes",(()=>{ae.label="text",chai.expect(ae.getAttribute("label")).to.equal("text"),ae.label=""}))})),describe("Accessibility",(()=>{it("has a11y attributes",(()=>{chai.expect(ae.getAttribute("aria-label")).to.equal(null),ae.label="label",chai.expect(ae.getAttribute("aria-label")).to.equal("label"),ae.label="",chai.expect(ae.getAttribute("aria-label")).to.equal(null)}))}))}))}}class SwitchElementTest{element=new C;constructor(){this.element.style.display="none",document.body.appendChild(this.element)}run(){describe("IoSwitch",(()=>{describe("default values",(()=>{it("has default values",(()=>{chai.expect(this.element.value).to.equal(!1)}))})),describe("attributes",(()=>{it("has tabindex attribute",(()=>{chai.expect(this.element.getAttribute("tabindex")).to.equal("0")})),it("has a11y attributes",(()=>{chai.expect(this.element.getAttribute("role")).to.equal("switch"),chai.expect(this.element.getAttribute("aria-label")).to.equal(null),this.element.label="click here",chai.expect(this.element.getAttribute("aria-label")).to.equal("click here")})),it("has value attribute when value is true",(()=>{this.element.value=!1,chai.expect(this.element.hasAttribute("value")).to.equal(!1),chai.expect(this.element.getAttribute("value")).to.equal(null),chai.expect(this.element.getAttribute("aria-checked")).to.equal("false"),this.element.value=!0,chai.expect(this.element.hasAttribute("value")).to.equal(!0),chai.expect(this.element.getAttribute("value")).to.equal(""),chai.expect(this.element.getAttribute("aria-checked")).to.equal("true")})),it("has title attribute",(()=>{this.element.label="click here",chai.expect(this.element.getAttribute("title")).to.equal("click here"),this.element.label="Button"}))}))}))}}class StringElementTest{element=new T;constructor(){this.element.style.display="none",document.body.appendChild(this.element)}run(){describe("IoString",(()=>{describe("default values",(()=>{it("has default values",(()=>{chai.expect(this.element.value).to.equal("")}))})),describe("innerText",(()=>{it("matches values",(()=>{this.element.value="hello",chai.expect(this.element.textContent).to.equal("hello"),this.element.value=!1,chai.expect(this.element.textContent).to.equal("false"),this.element.value=null,chai.expect(this.element.textContent).to.equal("null"),this.element.value=void 0,chai.expect(this.element.textContent).to.equal("undefined"),this.element.value=NaN,chai.expect(this.element.textContent).to.equal("NaN"),this.element.value=123,chai.expect(this.element.textContent).to.equal("123"),this.element.value=""}))})),describe("attributes",(()=>{it("has tabindex attribute",(()=>{chai.expect(this.element.getAttribute("tabindex")).to.equal("0")})),it("has contenteditable attribute",(()=>{chai.expect(this.element.getAttribute("contenteditable")).to.equal("")})),it("has a11y attributes",(()=>{chai.expect(this.element.getAttribute("role")).to.equal("textbox"),this.element.value=0,chai.expect(this.element.getAttribute("aria-invalid")).to.equal("true"),this.element.value="",chai.expect(this.element.getAttribute("aria-invalid")).to.equal(null)})),it("has title attribute",(()=>{this.element.label="Enter text",chai.expect(this.element.getAttribute("title")).to.equal("Enter text"),this.element.label=""}))}))}))}}const ne=new _;ne.style.display="none",document.body.appendChild(ne);const ce=new E;ce.style.display="none",ce.src=ne,document.body.appendChild(ce);const le=new S;le.style.display="none",document.body.appendChild(le);class NumberElementTest{run(){describe("IoNumber",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(ne.role).to.equal("textbox"),chai.expect(ne.value).to.equal(0),chai.expect(ne.conversion).to.equal(1),chai.expect(ne.step).to.equal(1e-4),chai.expect(ne.min).to.equal(-1/0),chai.expect(ne.max).to.equal(1/0),chai.expect(ne.ladder).to.equal(!1),chai.expect(ne.type).to.equal("number"),chai.expect(ne.pattern).to.equal('pattern="[0-9]*"'),chai.expect(ne.inputmode).to.equal("numeric"),chai.expect(ne.spellcheck).to.equal("false"),chai.expect(ne._properties.get("conversion")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:1}),chai.expect(ne._properties.get("step")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:1e-4}),chai.expect(ne._properties.get("min")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:-1/0}),chai.expect(ne._properties.get("max")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:Number,value:1/0}),chai.expect(ne._properties.get("type")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:"number"}),chai.expect(ne._properties.get("pattern")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:'pattern="[0-9]*"'}),chai.expect(ne._properties.get("inputmode")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:"numeric"}),chai.expect(ne._properties.get("spellcheck")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:"false"})})),it("has correct default attributes",(()=>{chai.expect(ne.getAttribute("value")).to.equal("0"),chai.expect(ne.getAttribute("role")).to.equal("textbox"),chai.expect(ne.getAttribute("type")).to.equal("number"),chai.expect(ne.getAttribute("pattern")).to.equal('pattern="[0-9]*"'),chai.expect(ne.getAttribute("inputmode")).to.equal("numeric"),chai.expect(ne.getAttribute("spellcheck")).to.equal("false"),chai.expect(ne.getAttribute("positive")).to.equal(""),chai.expect(ne.getAttribute("aria-valuenow")).to.equal("0"),chai.expect(ne.getAttribute("aria-valuemin")).to.equal("-Infinity"),chai.expect(ne.getAttribute("aria-valuemax")).to.equal("Infinity"),chai.expect(ne.getAttribute("aria-valuestep")).to.equal("0.0001"),chai.expect(ne.getAttribute("aria-invalid")).to.equal(null)})),it("has correct default innerHTML",(()=>{chai.expect(ne.innerHTML).to.equal("0")}))})),describe("Reactivity",(()=>{it("should set innerText to match value property",(()=>{ne.value=0,ne.step=1,chai.expect(ne.innerText).to.equal("0"),ne.step=.1,chai.expect(ne.innerText).to.equal("0"),ne.value="hello",chai.expect(ne.innerText).to.equal("NaN"),ne.value=!1,chai.expect(ne.innerText).to.equal("NaN"),ne.value=null,chai.expect(ne.innerText).to.equal("NaN"),ne.value=void 0,chai.expect(ne.innerText).to.equal("NaN"),ne.value=NaN,chai.expect(ne.innerText).to.equal("NaN"),ne.value=123,chai.expect(ne.innerText).to.equal("123"),ne.step=1e-4,ne.value=0})),it("should set innerText to match value with custom step settings",(()=>{ne.step=1e-9,ne.value=.012345678,chai.expect(ne.innerText).to.equal("0.012345678"),ne.step=1e-6,chai.expect(ne.innerText).to.equal("0.012346"),ne.step=.01,chai.expect(ne.innerText).to.equal("0.01"),ne.step=1e-4,ne.value=0})),it("should set innerText to match value with custom min/max settings",(()=>{ne.step=1,ne.min=2,ne.max=5,ne.textNode=10,ne._setFromTextNode(),chai.expect(ne.value).to.equal(5),ne.textNode=0,ne._setFromTextNode(),chai.expect(ne.value).to.equal(2),ne.step=1e-4,ne.value=0,ne.min=-1/0,ne.max=1/0})),it("should set innerText to match value with conversion factor",(()=>{ne.conversion=.1,ne.value=1,chai.expect(ne.innerText).to.equal("0.1"),ne.conversion=.01,chai.expect(ne.innerText).to.equal("0.01"),ne.textNode=10,ne._setFromTextNode(),chai.expect(ne.value).to.equal(1e3),ne.value=0,ne.conversion=1})),it("has reactive attributes",(()=>{ne.value=1,chai.expect(ne.getAttribute("value")).to.equal("1"),chai.expect(ne.getAttribute("positive")).to.equal(""),ne.value=-2,chai.expect(ne.getAttribute("value")).to.equal("-2"),chai.expect(ne.getAttribute("positive")).to.equal(null),ne.value=0,chai.expect(ne.getAttribute("value")).to.equal("0"),chai.expect(ne.getAttribute("positive")).to.equal("")}))})),describe("Accessibility",(()=>{it("has a11y attributes",(()=>{ne.value="",chai.expect(ne.getAttribute("aria-invalid")).to.equal("true"),ne.value=0,chai.expect(ne.getAttribute("aria-invalid")).to.equal(null),ne.value=12,ne.min=0,ne.max=24,ne.step=2,chai.expect(ne.getAttribute("aria-valuenow")).to.equal("12"),chai.expect(ne.getAttribute("aria-valuemin")).to.equal("0"),chai.expect(ne.getAttribute("aria-valuemax")).to.equal("24"),chai.expect(ne.getAttribute("aria-valuestep")).to.equal("2"),ne.value=0,ne.min=-1/0,ne.max=1/0,ne.step=1e-4}))}))})),describe("IoNumberLadderStep",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(le.value).to.equal(1),chai.expect(le.role).to.equal("spinbutton"),chai.expect(le.type).to.equal("number"),chai.expect(le._properties.get("type")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:String,value:"number"})})),it("has correct default attributes",(()=>{chai.expect(le.getAttribute("value")).to.equal(null),chai.expect(le.getAttribute("role")).to.equal("spinbutton"),chai.expect(le.getAttribute("type")).to.equal("number")})),it("has correct default innerHTML",(()=>{chai.expect(le.innerHTML).to.equal('<io-label label="1" aria-label="1">1</io-label>')}))})),describe("Reactivity",(()=>{it("should set innerText to match value property",(()=>{le.value=0,chai.expect(le.textContent).to.equal("0"),le.value=1})),it("has no reactive attributes",(()=>{le.value=2,chai.expect(le.getAttribute("value")).to.equal(null),le.value=1}))}))})),describe("IoNumberLadder",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(ce.role).to.equal("list"),chai.expect(ce.src).to.equal(ne),chai.expect(ce.conversion).to.equal(1),chai.expect(ce.expanded).to.equal(!1),chai.expect(ce.min).to.equal(-1/0),chai.expect(ce.max).to.equal(1/0),chai.expect(ce.step).to.equal(1e-4),chai.expect(ce.value).to.equal(0),chai.expect(ce.conversion).to.equal(1),chai.expect(ce._properties.get("src")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!1,type:void 0,value:ne}),chai.expect(ce._properties.get("expanded")).to.eql({binding:void 0,reactive:!0,observe:!1,init:void 0,reflect:!0,type:Boolean,value:!1})})),it("has correct default attributes",(()=>{chai.expect(ce.getAttribute("role")).to.equal("list"),chai.expect(ce.getAttribute("expanded")).to.equal(null)})),it("has correct default innerHTML",(()=>{chai.expect(ce.innerHTML).to.equal('<io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-up4" label="1000" aria-label="1000" aria-valuestep="1000" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="1000" aria-label="1000">1000</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-up3" label="100" aria-label="100" aria-valuestep="100" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="100" aria-label="100">100</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-up2" label="10" aria-label="10" aria-valuestep="10" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="10" aria-label="10">10</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-up1" label="1" aria-label="1" aria-valuestep="1" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="1" aria-label="1">1</io-label></io-number-ladder-step><span class="io-number-ladder-center"></span><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-down1" label="0.1" aria-label="0.1" aria-valuestep="0.1" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="0.1" aria-label="0.1">0.1</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-down2" label="0.01" aria-label="0.01" aria-valuestep="0.010000000000000002" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="0.01" aria-label="0.01">0.01</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-down3" label="0.001" aria-label="0.001" aria-valuestep="0.001" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="0.001" aria-label="0.001">0.001</io-label></io-number-ladder-step><io-number-ladder-step tabindex="0" role="spinbutton" appearance="flush" type="number" class="io-down4" label="0.0001" aria-label="0.0001" aria-valuestep="0.0001" aria-valuemin="-Infinity" aria-valuemax="Infinity" aria-valuenow="0"><io-label label="0.0001" aria-label="0.0001">0.0001</io-label></io-number-ladder-step>')}))})),describe("Reactivity",(()=>{const $=e=>ce.querySelector(e);it("should set innerText to match value property",(()=>{chai.expect($(".io-up1").value).to.equal(1),chai.expect($(".io-up1").textContent).to.equal("1"),chai.expect($(".io-up2").textContent).to.equal("10"),chai.expect($(".io-up3").textContent).to.equal("100"),chai.expect($(".io-up4").textContent).to.equal("1000"),chai.expect($(".io-down1").value).to.equal(.1),chai.expect($(".io-down1").textContent).to.equal("0.1"),chai.expect($(".io-down2").textContent).to.equal("0.01"),chai.expect($(".io-down3").textContent).to.equal("0.001"),chai.expect($(".io-down4").textContent).to.equal("0.0001")})),it("should set innerText to match value with custom step settings",(()=>{ne.step=.2,ce.changed(),chai.expect($(".io-up1").value).to.equal(2),chai.expect($(".io-up1").textContent).to.equal("2"),chai.expect($(".io-up2").textContent).to.equal("20"),chai.expect($(".io-up3").textContent).to.equal("200"),chai.expect($(".io-up4").textContent).to.equal("2000"),chai.expect($(".io-down1").value).to.equal(.2),chai.expect($(".io-down1").textContent).to.equal("0.2"),chai.expect($(".io-down2")).to.equal(null),chai.expect($(".io-down3")).to.equal(null),chai.expect($(".io-down4")).to.equal(null),ne.step=.02,ce.changed(),chai.expect($(".io-down1").textContent).to.equal("0.2"),chai.expect($(".io-down2").textContent).to.equal("0.02"),chai.expect($(".io-down3")).to.equal(null),ne.step=1e-4,ce.changed()})),it("should set innerText to match value with custom min/max settings",(()=>{ne.min=0,ne.max=100,ce.changed(),chai.expect($(".io-up1").value).to.equal(1),chai.expect($(".io-up1").innerText).to.equal("1"),chai.expect($(".io-up2").innerText).to.equal("10"),chai.expect($(".io-up3").innerText).to.equal("100"),chai.expect($(".io-up4")).to.equal(null),ne.max=1e3,ce.changed(),chai.expect($(".io-up4").innerText).to.equal("1000"),ne.min=-1/0,ne.max=1/0,ce.changed()})),it("should set innerText to match value with conversion factor",(()=>{ne.conversion=20,ce.changed(),chai.expect($(".io-up2").value).to.equal(10),chai.expect($(".io-up2").innerText).to.equal("200"),ne.step=.2,ce.changed(),chai.expect($(".io-up2").value).to.equal(20),chai.expect($(".io-up2").innerText).to.equal("400"),ne.conversion=1,ne.step=1e-4,ce.changed()})),it("has reactive attributes",(()=>{const $=e=>ce.querySelector(e);it("steps have tabindex attribute",(()=>{chai.expect($(".io-up1").getAttribute("tabindex")).to.equal("0"),chai.expect($(".io-down1").getAttribute("tabindex")).to.equal("0")})),it("has a11y attributes",(()=>{chai.expect(ce.getAttribute("role")).to.equal("list")})),it("steps have a11y attributes",(()=>{chai.expect($(".io-up1").getAttribute("role")).to.equal("spinbutton"),chai.expect($(".io-up1").getAttribute("type")).to.equal("number"),chai.expect($(".io-up1").getAttribute("aria-label")).to.equal("1"),chai.expect($(".io-up1").getAttribute("aria-valuemax")).to.equal("Infinity"),chai.expect($(".io-up1").getAttribute("aria-valuemin")).to.equal("-Infinity"),chai.expect($(".io-up1").getAttribute("aria-valuenow")).to.equal("0"),ne.value=3,ce.changed(),chai.expect($(".io-up1").getAttribute("aria-valuenow")).to.equal("3"),ne.step=.5,ce.changed(),chai.expect($(".io-up1").getAttribute("aria-label")).to.equal("5"),ne.value=0,ne.step=1e-4,ce.changed()}))}))})),describe("Accessibility",(()=>{it("TODO",(()=>{chai.expect(ce.getAttribute("aria-valuemin")).to.equal("-Infinity"),chai.expect(ce.getAttribute("aria-valuemax")).to.equal("Infinity"),chai.expect(ce.getAttribute("aria-valuenow")).to.equal("0")})),it("has a11y attributes",(()=>{chai.expect(ce.getAttribute("aria-invalid")).to.equal(null),ne.value=NaN,ce.changed(),chai.expect(ce.getAttribute("aria-invalid")).to.equal("true"),ne.value=12,ce.changed(),ne.min=0,ne.max=24,ne.step=2,ce.changed(),chai.expect(ce.getAttribute("aria-valuenow")).to.equal("12"),chai.expect(ce.getAttribute("aria-valuemin")).to.equal("0"),chai.expect(ce.getAttribute("aria-valuemax")).to.equal("24"),chai.expect(ce.getAttribute("aria-valuestep")).to.equal("2"),ne.min=-1/0,ne.max=1/0,ne.step=1e-4,ce.changed()}))}))}))}}class BasicElementTest{run(){(new BooleanElementTest).run(),(new ButtonElementTest).run(),(new FieldElementTest).run(),(new IconElementTest).run(),(new IconsetElementTest).run(),(new LabelElementTest).run(),(new NumberElementTest).run(),(new StringElementTest).run(),(new SwitchElementTest).run()}}class ColorConvertTest{run(){describe("IoColorConvert",(()=>{describe("Initialization",(()=>{it("Should have core API functions defined",(()=>{})),it("Should initialize property definitions correctly",(()=>{})),it("has correct default attributes",(()=>{})),it("has correct default innerHTML",(()=>{}))})),describe("Reactivity",(()=>{it("should set innerText to match value property",(()=>{})),it("has reactive attributes",(()=>{}))})),describe("Accessibility",(()=>{it("has a11y attributes",(()=>{}))}))}))}}class ColorBaseTest{run(){describe("IoColor",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}const re=new I;re.style.display="none",document.body.appendChild(re);class ColorPanelTest{run(){describe("IoColorPanel",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}const se=new N;se.style.display="none",document.body.appendChild(se);class ColorPickerTest{run(){describe("IoColorPicker",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}const pe=new P;pe.style.display="none",document.body.appendChild(pe);class ColorRgbaTest{run(){describe("IoColorPicker",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}const he=new L;he.style.display="none",document.body.appendChild(he);class ColorSlidersTest{run(){describe("IoColorSlider",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}const ue=new A;ue.style.display="none",document.body.appendChild(ue);class ColorSwatchTest{run(){describe("IoColorSwatch",(()=>{describe("Initialization",(()=>{})),describe("Reactivity",(()=>{})),describe("Accessibility",(()=>{}))}))}}class ColorElementTest{run(){(new ColorConvertTest).run(),(new ColorBaseTest).run(),(new ColorPanelTest).run(),(new ColorPickerTest).run(),(new ColorRgbaTest).run(),(new ColorSlidersTest).run(),(new ColorSwatchTest).run()}}class Binding{node;property="";targets=[];targetProperties=new WeakMap;constructor(e,t){this.node=e,this.property=t,this.node.addEventListener(`${this.property}-changed`,this.onSourceChanged)}set value(e){this.node[this.property]=e}get value(){return this.node[this.property]}toJSON(){return JSON.stringify({property:this.property,targetProperties:this.targetProperties})}addTarget(e,t){const i=e._properties.get(t);i.binding&&i.binding!==this&&console.warn("Binding target alredy has a binding!"),i.binding=this,e.setProperty(t,this.node[this.property],!0);const o=e;-1===this.targets.indexOf(o)&&this.targets.push(o);const a=this.getTargetProperties(o);-1===a.indexOf(t)?(a.push(t),o.addEventListener(`${t}-changed`,this.onTargetChanged)):console.warn("Binding target alredy added!")}removeTarget(e,t){const i=this.getTargetProperties(e);if(t){const o=i.indexOf(t);-1!==o&&i.splice(o,1),e.removeEventListener(`${t}-changed`,this.onTargetChanged),e._properties.get(t).binding=void 0}else{for(let t=i.length;t--;)e.removeEventListener(`${i[t]}-changed`,this.onTargetChanged),e._properties.get(i[t]).binding=void 0;i.length=0}0===i.length&&this.targets.splice(this.targets.indexOf(e),1)}getTargetProperties(e){let t=this.targetProperties.get(e);return t||(t=[],this.targetProperties.set(e,t),t)}onTargetChanged=e=>{if(-1===this.targets.indexOf(e.target))return void console.error("onTargetChanged() should never fire when target is removed from binding. Please file an issue at https://github.com/arodic/iogui/issues.");const t=this.node[this.property],i=e.detail.value;if(t!==i){if("number"==typeof i&&isNaN(i)&&"number"==typeof t&&isNaN(t))return;this.node.setProperty(this.property,i)}};onSourceChanged=e=>{if(e.target!==this.node)return void console.error("onSourceChanged() should always originate form source node. Please file an issue at https://github.com/arodic/iogui/issues.");const t=e.detail.value;for(let e=this.targets.length;e--;){const i=this.targets[e],o=this.getTargetProperties(i);for(let e=o.length;e--;){const a=o[e],n=i[a];if(n!==t){if("number"==typeof t&&isNaN(t)&&"number"==typeof n&&isNaN(n))continue;i.setProperty(a,t)}}}};dispose(){this.node.removeEventListener(`${this.property}-changed`,this.onSourceChanged);for(let e=this.targets.length;e--;)this.removeTarget(this.targets[e]);this.targets.length=0,delete this.node,delete this.property,delete this.targets,delete this.targetProperties}}class ProtoProperty{value;type;binding;reflect;reactive;observe;init;constructor(e){if(null==e)this.value=e;else if("function"==typeof e)this.type=e;else if(e instanceof Binding)this.value=e.value,this.type=void 0!==e.value&&null!==e.value?e.value.constructor:void 0,this.binding=e;else if(e&&e.constructor===Object){const t=e;this.value=void 0!==t.value?t.value:void 0,this.type=void 0!==t.type?t.type:void 0!==t.value&&null!==t.value?t.value.constructor:void 0,t.binding instanceof Binding&&(this.binding=t.binding,this.value=this.binding.value),void 0!==t.reflect&&(this.reflect=t.reflect),void 0!==t.reactive&&(this.reactive=t.reactive),void 0!==t.observe&&(this.observe=t.observe),void 0!==t.init&&(this.init=t.init)}else e&&e.constructor===Object||(this.value=e,this.type=e.constructor)}assign(e){void 0!==e.value&&(this.value=e.value),void 0!==e.type&&(this.type=e.type),void 0!==e.reflect&&(this.reflect=e.reflect),void 0!==e.reactive&&(this.reactive=e.reactive),void 0!==e.observe&&(this.observe=e.observe),void 0!==e.init&&(this.init=e.init),void 0!==e.binding&&(this.binding=e.binding)}}function decodeInitArgument(e,t){if("this"===e)return t;if("string"!=typeof e||!e.startsWith("this."))return e;{const i=e.split(".");let o=t;for(let e=1;e<i.length;e++)o=o[i[e]];if(o)return o;console.warn(`PropertyInstance: Invalid path ${e}`)}}class PropertyInstance{value=void 0;type;binding;reflect=!1;reactive=!0;observe=!1;init=void 0;constructor(e,t){if(Object.keys(t).forEach((e=>{-1===["value","type","reflect","reactive","observe","init","binding"].indexOf(e)&&console.warn(`ProtoProperty: Invalid field ${e}`)})),void 0!==t.type&&"function"!=typeof t.type&&console.warn('Incorrect type for "type" field'),void 0!==t.binding&&t.binding.constructor!==Binding&&console.warn('Incorrect type for "binding" field'),void 0!==t.reflect&&"boolean"!=typeof t.reflect&&console.error(`Invalid reflect field ${t.reflect}!`),void 0!==t.reactive&&"boolean"!=typeof t.reactive&&console.warn('Incorrect type for "reactive" field'),void 0!==t.observe&&"boolean"!=typeof t.observe&&console.warn('Incorrect type for "observe" field'),this.value=t.value,this.type=t.type,this.binding=t.binding,void 0!==t.reflect&&(this.reflect=t.reflect),void 0!==t.reactive&&(this.reactive=t.reactive),void 0!==t.observe&&(this.observe=t.observe),void 0!==t.init&&(this.init=t.init),this.binding instanceof Binding)this.value=this.binding.value;else if((void 0===this.value||null===this.value)&&null!==this.init)if(this.type===Boolean)this.value=!1;else if(this.type===String)this.value="";else if(this.type===Number)this.value=0;else if("function"==typeof this.type)if(void 0!==this.init)if(this.init instanceof Array){const t=this.init.map((t=>decodeInitArgument(t,e)));this.value=new this.type(...t)}else if(this.init instanceof Object){const t={};Object.keys(this.init).forEach((i=>{t[i]=decodeInitArgument(this.init[i],e)})),this.value=new this.type(t)}else{const t=decodeInitArgument(this.init,e);this.value=new this.type(t)}else this.value=new this.type;void 0!==this.value&&null!==this.value&&(-1!==[String,Number,Boolean].indexOf(this.type)?(this.type===Boolean&&"boolean"!=typeof this.value||this.type===Number&&"number"!=typeof this.value||this.type===String&&"string"!=typeof this.value)&&console.warn(`Property: Incorrect value ${this.value} type for property ${name}!`):"function"!=typeof this.type||this.value instanceof this.type||console.warn(`Property: Incorrect value ${this.value} type for property ${name}!`))}}const de=new WeakMap,Property=function(e){return(t,i)=>{const o=t.constructor,a=de.get(o)||{};de.set(o,a),a[i]=e}},hardenListenerDeclaration=e=>e instanceof Array?e:[e],assignListenerDeclaration=(e,t)=>{const i=e.findIndex((e=>e[0]===t[0]));-1!==i?e[i][1]?e[i][1]=Object.assign(e[i][1],t[1]):t[1]&&(e[i][1]=t[1]):e.push(t)},be=["capture","passive"],listenerFromDefinition=(e,t)=>{"string"!=typeof t[0]&&"function"!=typeof t[0]&&console.warn("listenerFromDefinition: Invalid listener type"),t[1]&&("object"!=typeof t[1]||Object.keys(t[1]).some((e=>!be.includes(e))))&&console.warn("listenerFromDefinition: Invalid listener options type");const i=["string"==typeof t[0]?e[t[0]]:t[0]];return t[1]&&i.push(t[1]),i};class EventDispatcher{node;isEventTarget;protoListeners={};propListeners={};addedListeners={};constructor(e){this.node=e,this.isEventTarget=e instanceof EventTarget,this.setProtoListeners(e)}setProtoListeners(e){for(const t in e._protochain?.listeners){this.protoListeners[t]=[];for(let i=0;i<e._protochain.listeners[t].length;i++){const o=listenerFromDefinition(e,e._protochain.listeners[t][i]);this.protoListeners[t]=[o]}if(this.isEventTarget&&this.protoListeners[t].length){const e=this.protoListeners[t][0];EventTarget.prototype.addEventListener.call(this.node,t,e[0],e[1])}}}applyPropListeners(e){const t={};for(const i in e)if(i.startsWith("@")){const o=i.slice(1,i.length),a=hardenListenerDeclaration(e[i]),n=listenerFromDefinition(this.node,a);t[o]=[n]}const i=this.propListeners;for(const e in i)if(!t[e]){if(this.isEventTarget){const t=hardenListenerDeclaration(i[e][0]),o=listenerFromDefinition(this.node,t);EventTarget.prototype.removeEventListener.call(this.node,e,o[0],o[1])}delete i[e]}for(const e in t){if(this.isEventTarget){const o=hardenListenerDeclaration(t[e][0]),a=listenerFromDefinition(this.node,o);if(i[e]){const t=hardenListenerDeclaration(i[e][0]),o=listenerFromDefinition(this.node,t);(o!==a||a[1]&&JSON.stringify(o[1])!==JSON.stringify(a[1]))&&(EventTarget.prototype.removeEventListener.call(this.node,e,o[0],o[1]),EventTarget.prototype.addEventListener.call(this.node,e,a[0],a[1]))}else EventTarget.prototype.addEventListener.call(this.node,e,a[0],a[1])}i[e]=t[e]}}addEventListener(e,t,i){this.addedListeners[e]=this.addedListeners[e]||[];const o=this.addedListeners[e].findIndex((e=>e[0]===t));-1!==o&&console.warn(`EventDispatcher.addEventListener: Listener ${e} already added!`),"function"!=typeof t&&console.warn("EventDispatcher.addEventListener: Invalid listener type!"),i&&("object"!=typeof i||Object.keys(i).some((e=>!be.includes(e))))&&console.warn("EventDispatcher.addEventListener: Invalid listener options type"),-1===o&&(this.addedListeners[e].push(i?[t,i]:[t]),this.isEventTarget&&EventTarget.prototype.addEventListener.call(this.node,e,t,i))}removeEventListener(e,t,i){if(this.addedListeners[e]||console.warn(`EventDispatcher.removeEventListener: Listener ${e} not found!`),t&&"function"!=typeof t&&console.warn("EventDispatcher.removeEventListener: Invalid listener type!"),i&&("object"!=typeof i||Object.keys(i).some((e=>!be.includes(e))))&&console.warn("EventDispatcher.removeEventListener: Invalid listener options type"),this.addedListeners[e]){if(t){const o=this.addedListeners[e].findIndex((e=>e[0]===t));-1===o&&console.warn(`EventDispatcher.removeEventListener: Listener ${e} not found!`),-1!==o&&(this.addedListeners[e].splice(o,1),this.isEventTarget&&EventTarget.prototype.removeEventListener.call(this.node,e,t,i))}else{for(let t=0;t<this.addedListeners[e].length;t++)if(this.isEventTarget){const i=this.addedListeners[e][t];EventTarget.prototype.removeEventListener.call(this.node,e,i[0],i[1])}this.addedListeners[e].length=0}0===this.addedListeners[e].length&&delete this.addedListeners[e]}}dispatchEvent(e,t,i=!0,o=this.node){const a={detail:t,target:o,path:[o]};if(o instanceof EventTarget)EventTarget.prototype.dispatchEvent.call(o,new CustomEvent(e,{detail:t,bubbles:i,composed:!0,cancelable:!0}));else{if(this.protoListeners[e])for(let t=0;t<this.protoListeners[e].length;t++)this.protoListeners[e][t][0].call(o,a);if(this.propListeners[e]&&(this.propListeners[e].length>1&&console.warn(`EventDispatcher.dispathEvent: PropListeners[${e}] array too long!`),this.propListeners[e][0][0].call(o,a)),this.addedListeners[e])for(let t=0;t<this.addedListeners[e].length;t++)this.addedListeners[e][t][0].call(o,a)}}dispose(){for(const e in this.protoListeners){if(this.isEventTarget)for(let t=0;t<this.protoListeners[e].length;t++){const i=this.protoListeners[e][t];EventTarget.prototype.removeEventListener.call(this.node,e,i[0],i[1])}this.protoListeners[e].length=0,delete this.protoListeners[e]}for(const e in this.propListeners){if(this.isEventTarget){const t=this.propListeners[e][0];EventTarget.prototype.removeEventListener.call(this.node,e,t[0],t[1])}this.propListeners[e].length=0,delete this.propListeners[e]}for(const e in this.addedListeners){if(this.isEventTarget)for(let t=this.addedListeners[e].length;t--;){const i=this.addedListeners[e][t];EventTarget.prototype.removeEventListener.call(this.node,e,i[0],i[1])}this.addedListeners[e].length=0,delete this.addedListeners[e]}delete this.node,delete this.protoListeners,delete this.propListeners,delete this.addedListeners}}class ProtoChain{constructors=[];functions=[];properties={};listeners={};style="";observedObjectProperties=[];constructor(e){let t=e.prototype;for(;t&&e!==HTMLElement&&e!==Object&&e!==Array;){this.constructors.push(e);const i=Object.getOwnPropertyNames(t);for(let e=0;e<i.length;e++){const o=i[e];if(o.startsWith("_")||o.startsWith("on")){const e=Object.getOwnPropertyDescriptor(t,o);if(void 0===e||e.get||e.set)continue;"function"==typeof t[o]&&-1===this.functions.indexOf(o)&&this.functions.push(o)}}e.Style&&-1===this.style.indexOf(e.Style)&&(this.style=e.Style+"\n"+this.style),t=Object.getPrototypeOf(t),e=t.constructor}let i="";for(let e=this.constructors.length;e--;){let t;if(t=de.get(this.constructors[e]),t)for(const e in t){const i=new ProtoProperty(t[e]);this.properties[e]||(this.properties[e]=i),this.properties[e].assign(i)}t=this.constructors[e].Properties;const o=JSON.stringify(t);if(o!==i)for(const e in t){const a=new ProtoProperty(t[e]);this.properties[e]||(this.properties[e]=a),this.properties[e].assign(a),i=o}const a=this.constructors[e].Listeners;for(const e in a)a[e]&&(this.listeners[e]=this.listeners[e]||[],assignListenerDeclaration(this.listeners[e],hardenListenerDeclaration(a[e])))}for(const e in this.properties){this.properties[e].observe&&(-1!==[String,Number,Boolean].indexOf(this.properties[e].type)&&console.warn(`Property "${e}" in ProtoChain: "observe" is only intended for property definitions with Object data type!`),this.observedObjectProperties.push(e));{const t=this.properties[e];if(-1!==[String,Number,Boolean].indexOf(this.properties[e].type))(t.type===Boolean&&"boolean"!=typeof t.value||t.type===Number&&"number"!=typeof t.value||t.type===String&&"string"!=typeof t.value)&&console.warn(`Property "${e}" in ProtoChain: Incorrect value type for Boolean property!`);else{const i=null===this.properties[e].value,o=void 0===this.properties[e].value;"function"!=typeof t.type||t.value instanceof t.type||i||o||console.warn(`Property "${e}" in ProtoChain: Incorrect value type for Boolean property!`)}}}}autobindFunctions(e){e.constructor!==this.constructors[0]&&console.warn("`autobindFunctions` should be used on",this.constructors[0].name,"instance");for(let t=this.functions.length;t--;)Object.defineProperty(e,this.functions[t],{value:e[this.functions[t]].bind(e),writable:!0,configurable:!0})}}class ChangeQueue{hasChanged=!1;dispatching=!1;constructor(e){this.changes=[],this.node=e}queue(e,t,i){t===i&&console.warn("ChangeQueue: queuing change with same value and oldValue!");const o=this.changes.findIndex((t=>t.property===e));-1===o?this.changes.push({property:e,value:t,oldValue:i}):this.changes[o].value=t}dispatch(){if(!0!==this.dispatching){for(this.dispatching=!0,this.hasChanged=!1;this.changes.length;){const e=this.changes[0];this.changes.splice(0,1);const t=e.property;e.value!==e.oldValue&&(this.hasChanged=!0,this.node[t+"Changed"]&&this.node[t+"Changed"](e),this.node.dispatchEvent(t+"-changed",e))}this.hasChanged&&(this.node.changed(),this.node.dispatchEvent("changed"),this.node.dispatchMutationEvent(this.node)),this.dispatching=!1}}dispose(){this.changes.length=0,delete this.node,delete this.changes}}var __decorate$3=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};function IoNodeMixin(e){return class extends e{static get Properties(){return{lazy:{value:!1,reactive:!1,reflect:!0}}}constructor(e={},...t){super(...t);{const e=Object.getPrototypeOf(this).constructor;this._protochain.constructors[0]!==e&&console.error(`${e.name} not registered! Call "Register([ClassName])" of @Register decorator before using ${e.name} class!`)}this._protochain.autobindFunctions(this),Object.defineProperty(this,"_changeQueue",{enumerable:!1,configurable:!0,value:new ChangeQueue(this)}),Object.defineProperty(this,"_properties",{enumerable:!1,configurable:!0,value:new Map}),Object.defineProperty(this,"_bindings",{enumerable:!1,configurable:!0,value:new Map}),Object.defineProperty(this,"_eventDispatcher",{enumerable:!1,configurable:!0,value:new EventDispatcher(this)});for(const e in this._protochain.properties)Object.defineProperty(this,e,{get:function(){return this._properties.get(e).value},set:function(t){this.setProperty(e,t)},configurable:!0});for(const e in this._protochain.properties){const t=new PropertyInstance(this,this._protochain.properties[e]);this._properties.set(e,t);const i=t.value;null!=i&&t.reflect&&this._isIoElement&&this.setAttribute(e,i),t.binding&&t.binding.addTarget(this,e)}this.applyProperties(e),this._protochain.observedObjectProperties.length&&window.addEventListener("object-mutated",this.onObjectMutated),this.init()}setProperty(e,t,i){const o=this._properties.get(e),a=o.value;if(t!==a){const n=t instanceof Binding?t:null;if(n){const i=o.binding;if(n!==i)return i&&i.removeTarget(this,e),void n.addTarget(this,e);n.value=t=o.value,o.reactive||console.warn(`IoNode: property "${e}" is bound but has reactive flag set to false!`)}o.value=t,t instanceof Binding&&console.log(t instanceof Binding),o.type===String?"string"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${o.type.name}`,this):o.type===Number?"number"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${o.type.name}`,this):o.type===Boolean?"boolean"!=typeof t&&console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${o.type.name}`,this):o.type===Array?t instanceof Array||console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${o.type.name}`,this):o.type===Object?t instanceof Array&&console.warn(`Wrong type of property "${e}". Value: "${JSON.stringify(t)}". Expected type: ${o.type.name}`,this):"function"==typeof o.type&&(t instanceof o.type||console.warn(`Wrong type of property "${e}". Value: "${t}". Expected type: ${o.type.name}`,this)),o.reactive&&a!==t&&(this.queue(e,t,a),i||this.dispatchQueue()),o.reflect&&this._isIoElement&&this.setAttribute(e,t)}}applyProperties(e){for(const t in e)this._properties.has(t)?this.setProperty(t,e[t],!0):t.startsWith("@")||"style"===t||"config"===t||"$"===t||console.warn(`Property "${t}" is not defined`,this);this._eventDispatcher.applyPropListeners(e),this.dispatchQueue()}setProperties(e){for(const t in e)this._properties.has(t)?this.setProperty(t,e[t],!0):console.warn(`Property "${t}" is not defined`,this);this.dispatchQueue()}inputValue(e){if(this.value!==e||"object"==typeof this.value){const t=this.value;this.setProperty("value",e),this.dispatchEvent("value-input",{value:e,oldValue:t},!1)}}changed(){}init(){}queue(e,t,i){this._changeQueue.queue(e,t,i)}dispatchQueue(){this.lazy?this.throttle(this.dispatchQueueSync):this.dispatchQueueSync()}dispatchQueueSync=()=>{this._changeQueue.dispatch()};throttle(e,t=void 0,i=1){!function throttle(e,t,i,o=1){if(0===o&&-1===xe.indexOf(t)){xe.push(t);try{t(i)}catch(e){console.error(e)}return}-1===ge.indexOf(t)&&ge.push(t);if(qe.has(t)){qe.get(t).arg=i}else qe.set(t,{node:e,arg:i,timeout:Date.now()+o})}(this,e,t,i)}onObjectMutated=e=>{for(let t=0;t<this._protochain.observedObjectProperties.length;t++){const i=this._protochain.observedObjectProperties[t];if(this._properties.get(i).value===e.detail.object)return void this.throttle(this.objectMutated,i,0);if(e.detail.objects)return void console.error("Deprecation warning! `objects` property no longer supported. Use `object` property instead.")}};objectMutated=e=>{this[e+"Mutated"]&&this[e+"Mutated"](),this.changed(),this.dispatchEvent("changed"),this.dispatchMutationEvent(this)};bind(e){return this._properties.has(e)?!1===this._properties.get(e).reactive&&console.warn(`IoGUI Node: cannot bind to ${e} property. It has reactive flag set to false!`):console.warn(`IoGUI Node: cannot bind to ${e} property. Does not exist!`),this._bindings.has(e)||this._bindings.set(e,new Binding(this,e)),this._bindings.get(e)}unbind(e){const t=this._bindings.get(e);t&&(t.dispose(),this._bindings.delete(e));const i=this._properties.get(e);i?.binding?.removeTarget(this,e)}addEventListener(e,t,i){"function"==typeof t?this._eventDispatcher.addEventListener(e,t,i):console.warn(`${this.constructor.name}incorrect listener type.`,this)}removeEventListener(e,t,i){this._eventDispatcher.removeEventListener(e,t,i)}dispatchEvent(e,t={},i=!1,o){this._eventDispatcher.dispatchEvent(e,t,i,o)}dispatchMutationEvent(e){this.dispatchEvent("object-mutated",{object:e},!0,window)}dispose(){this._disposed,this._disposed||(this._bindings.forEach(((e,t)=>{e.dispose(),this._bindings.delete(t)})),delete this._bindings,this._protochain.observedObjectProperties.length&&window.removeEventListener("object-mutated",this.onObjectMutated),delete this._protochain,this._changeQueue.dispose(),delete this._changeQueue,this._properties.forEach(((e,t)=>{e.binding?.removeTarget(this,t)})),this._eventDispatcher.dispose(),delete this._eventDispatcher,delete this._properties,Object.defineProperty(this,"_disposed",{value:!0}))}Register(e){Object.defineProperty(e.prototype,"_protochain",{value:new ProtoChain(e)})}}}function Register(e){e.prototype.Register(e)}let ve=class IoNode extends(IoNodeMixin(Object)){};ve=__decorate$3([Register],ve);const xe=[],ge=[],qe=new WeakMap;requestAnimationFrame((function animate(){requestAnimationFrame(animate),xe.length=0;for(let e=ge.length;e--;){const t=ge[e],i=qe.get(t);if(!(i.timeout>Date.now())){ge.splice(ge.indexOf(t),1),qe.delete(t);try{i.node._disposed||(void 0!==i.arg?t(i.arg):t())}catch(e){console.error(e)}}}}));var __decorate$2=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};function _isNaN(e){return"number"==typeof e&&isNaN(e)}function _isSelectable(e){return"select"===e||"scroll"===e}let fe=class MenuOptions extends(IoNodeMixin(Array)){push(...e){for(let t=0;t<e.length;t++){const i=e[t];i instanceof me||console.warn("MenuOptions.push: item is not a MenuItem!"),i instanceof me&&(this.find((e=>e.label===i.label))&&console.warn(`MenuOptions.addItems: duplicate label "${i.label}"`),i.addEventListener("selected-changed",this._onItemSelectedChanged),i.addEventListener("path-changed",this._onSubOptionsPathChanged),super.push(i))}}getItem(e,t=!1){for(let i=0;i<this.length;i++){if(this[i].value===e)return this[i];if(t&&this[i].options){const o=this[i].options.getItem(e,t);if(o)return o}}return null}constructor(e=[],t={}){const i=[];for(let t=0;t<e.length;t++)e[t]instanceof me?i.push(e[t]):i.push(new me(e[t]));super(t,...i),""!==this.path&&this.pathChanged(),void 0!==this.first&&this.firstChanged();for(let e=0;e<this.length;e++){const t=this[e];t instanceof me||console.warn("MenuOptions.constructor: item is not a MenuItem!"),this.find((e=>e!==t&&e.label===t.label))&&console.warn(`MenuOptions.addItems: duplicate label "${t.label}"`),t.addEventListener("selected-changed",this._onItemSelectedChanged),t.addEventListener("path-changed",this._onSubOptionsPathChanged),t.selected&&"select"===t.mode&&this.updatePaths(t)}}addItems(e){for(let t=0;t<e.length;t++){let i;i=e[t]instanceof me?e[t]:new me(e[t]),this.find((e=>e.label===i.label))&&console.warn(`MenuOptions.addItems: duplicate label "${i.label}"`),this.push(i),i.addEventListener("selected-changed",this._onItemSelectedChanged),i.addEventListener("path-changed",this._onSubOptionsPathChanged)}}pathChanged(){const e=this.path?[...this.path.split(this.delimiter)]:[];if(this.length&&e.length){const t=e.shift(),i=this.find((e=>e.label===t));if(i)_isSelectable(i.mode)||console.warn("MenuOptions.pathChanged: Path set to non-selectable MenuItem!"),_isSelectable(i.mode)&&(i.options&&(i.options.path=e.join(this.delimiter)),i.selected=!0);else{console.warn(`MenuOptions.pathChanged: cannot find item for specified path "${this.path}"!`);for(let e=0;e<this.length;e++)_isSelectable(this[e].mode)&&(this[e].selected=!1)}}else for(let e=0;e<this.length;e++)_isSelectable(this[e].mode)&&(this[e].selected=!1)}firstChanged(){if(void 0!==this.first){const e=this.find((e=>e.value===this.first&&"select"===e.mode||_isNaN(e.value)&&_isNaN(this.first)));e&&(e.selected=!0),void 0===e&&console.warn(`MenuOptions.firstChanged: cannot find pickable item for specified first value "${this.first}"!`)}else for(let e=0;e<this.length;e++)"select"===this[e].mode&&(this[e].selected=!1)}lastChanged(){if(void 0!==this.last){const e=this.path?[...this.path.split(this.delimiter)]:[];if(e.length){let t=e.shift(),i=this.find((e=>!0===e.selected&&e.label===t&&("select"===e.mode||"scroll"===e.mode))),o=i?.options||void 0;for(;e.length&&o;)t=e.shift(),i=o.find((e=>!0===e.selected&&e.label===t&&("select"===e.mode||"scroll"===e.mode))),o=i?.options||void 0;void 0===i?console.warn(`MenuOptions.lastChanged: cannot find item for specified last value "${this.last}"!`):i.value===this.last||_isNaN(i.value)&&_isNaN(this.last)||i.value===this.scroll||_isNaN(i.value)&&_isNaN(this.scroll)||(console.warn(`MenuOptions.lastChanged: last property value "${this.last}" diverged from item specified by path!`),console.log(this.path,this.last))}else console.warn(`MenuOptions.lastChanged: last property value set "${this.last}" but path is empty!`)}}updatePaths(e){const t=[];let i="select"===e?.mode||"scroll"===e?.mode?e:void 0,o="select"===e?.mode?e:void 0,a="scroll"===e?.mode?e:void 0;const n=this.find((e=>"select"===e.mode&&e.selected)),c=this.find((e=>"scroll"===e.mode&&e.selected));if(i||!n&&!c){for(;i;)t.push(i.label),"select"===i.mode&&(o=i),"scroll"===i.mode&&(a=i),i=i.options?.find((e=>("select"===e.mode||"scroll"===e.mode)&&e.selected));this.setProperties({path:t.join(this.delimiter),first:"select"===e?.mode?e.value:void 0,last:void 0!==o?o.value:void 0,scroll:void 0!==a?a.value:void 0})}}_onItemSelectedChanged(e){const t=e.target;if(_isSelectable(t.mode))if(t.selected){for(let e=0;e<this.length;e++)this[e]!==t&&_isSelectable(this[e].mode)&&(this[e].selected=!1);this.updatePaths(t),this.dispatchEvent("item-selected",{item:t})}else this.updatePaths()}_onSubOptionsPathChanged(e){const t=e.target;t.selected?this.updatePaths(t):this.updatePaths()}selectDefault(){for(let e=0;e<this.length;e++)if(_isSelectable(this[e].mode)){if(!this[e].hasmore)return this[e].selected=!0,!0;if(this[e].options.selectDefault())return!0}return!1}bind(e){return"last"!==e&&"scroll"!==e||console.warn("MenuPath: Binding to `last` or `scroll` property is not recommended!"),super.bind(e)}dispose(){for(let e=0;e<this.length;e++)this[e].removeEventListener("selected-changed",this._onItemSelectedChanged),this[e].removeEventListener("path-changed",this._onSubOptionsPathChanged);super.dispose()}changed(){this.dispatchEvent("object-mutated",{object:this},!1,window)}};__decorate$2([Property(void 0)],fe.prototype,"first",void 0),__decorate$2([Property(void 0)],fe.prototype,"last",void 0),__decorate$2([Property(void 0)],fe.prototype,"scroll",void 0),__decorate$2([Property("")],fe.prototype,"path",void 0),__decorate$2([Property(",")],fe.prototype,"delimiter",void 0),fe=__decorate$2([Register],fe);var __decorate$1=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};let me=class MenuItem extends ve{get hasmore(){return!!this.options?.length}getSubitem(e){return this.options?.getItem(e)}constructor(e){const t={value:"",label:""};"object"!=typeof e||null===e?(t.value=e,t.label=String(e)):(t.value=e.value,void 0===e.label?"object"==typeof t.value?null===t.value?t.label="null":t.label=`${t.value.constructor.name}`+(t.value instanceof Array?`(${t.value.length})`:""):t.label=String(t.value):t.label=e.label,void 0!==e.icon&&(t.icon=e.icon),void 0!==e.hint&&(t.hint=e.hint),void 0!==e.hidden&&(t.hidden=e.hidden),void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.action&&(t.action=e.action),void 0!==e.mode&&(t.mode=e.mode),void 0!==e.selected&&(t.selected=e.selected),void 0!==e.options&&(e.options instanceof fe?t.options=e.options:t.options=new fe(e.options)),void 0!==t.selected||"select"!==e.mode&&void 0!==e.mode||!t.options||(t.selected=!!t.options.find((e=>e.selected&&"select"===e.mode)))),t.mode&&"toggle"===t.mode&&t.options&&console.warn('MenuItem: cannot have suboptions when `mode === "toggle"`'),t.mode&&"scroll"===t.mode&&t.options&&console.warn('MenuItem: cannot have suboptions when `mode === "scroll"`'),t.mode&&-1===["select","toggle","scroll","link","none"].indexOf(t.mode)&&console.warn("MenuItem: unknown `mode` property!",t.mode),t.action&&"function"!=typeof t.action&&console.warn("MenuItem: invalid type of `action` property!",typeof t.action),super(t),this.options&&(this.options.addEventListener("item-selected",this._onSubItemSelected),this.options.addEventListener("path-changed",this._onOptionsPathChanged))}toJSON(){const e={value:this.value,label:this.label,icon:this.icon,hint:this.hint,hidden:this.hidden,disabled:this.disabled};return this.options&&(e.options=this.options),e}_onSubItemSelected(){this.selected=!0}_onOptionsPathChanged(e){this.dispatchEvent("path-changed",e.detail)}optionsChanged(){void 0===this.options?.first&&void 0===this.options?.scroll||"select"!==this.mode||(this.selected=!0)}selectedChanged(){if("select"===this.mode&&!1===this.selected&&this.options){for(let e=0;e<this.options.length;e++)"select"!==this.options[e].mode&&"scroll"!==this.options[e].mode||(this.options[e].selected=!1);this.options.updatePaths()}}changed(){this.dispatchEvent("object-mutated",{object:this},!1,window)}dispose(){this.options&&(this.options.removeEventListener("item-selected",this._onSubItemSelected),this.options.removeEventListener("path-changed",this._onOptionsPathChanged)),super.dispose()}};__decorate$1([Property(void 0)],me.prototype,"value",void 0),__decorate$1([Property("")],me.prototype,"label",void 0),__decorate$1([Property("")],me.prototype,"icon",void 0),__decorate$1([Property("")],me.prototype,"hint",void 0),__decorate$1([Property(!1)],me.prototype,"hidden",void 0),__decorate$1([Property(!1)],me.prototype,"disabled",void 0),__decorate$1([Property(void 0)],me.prototype,"action",void 0),__decorate$1([Property("select")],me.prototype,"mode",void 0),__decorate$1([Property(!1)],me.prototype,"selected",void 0),__decorate$1([Property(void 0)],me.prototype,"options",void 0),me=__decorate$1([Register],me);class MenuItemTest{run(){describe("MenuItem",(()=>{it("Should initialize with correct default values",(()=>{const e=new me;chai.expect(e.value).to.be.equal(void 0),chai.expect(e.label).to.be.equal("undefined"),chai.expect(e.icon).to.be.equal(""),chai.expect(e.hint).to.be.equal(""),chai.expect(e.disabled).to.be.equal(!1),chai.expect(e.action).to.be.equal(void 0),chai.expect(e.mode).to.be.equal("select"),chai.expect(e.selected).to.be.equal(!1),chai.expect(e.options).to.be.eql(void 0)})),it("Should initialize correctly from constructor arguments",(()=>{let e=new me(1);chai.expect(e.value).to.be.equal(1),chai.expect(e.label).to.be.equal("1"),chai.expect(e.icon).to.be.equal(""),chai.expect(e.hint).to.be.equal(""),chai.expect(e.disabled).to.be.equal(!1),chai.expect(e.action).to.be.equal(void 0),chai.expect(e.mode).to.be.equal("select"),chai.expect(e.selected).to.be.equal(!1),chai.expect(e.options).to.be.eql(void 0),e=new me("foo"),chai.expect(e.value).to.be.equal("foo"),chai.expect(e.label).to.be.equal("foo"),e=new me(null),chai.expect(e.value).to.be.equal(null),chai.expect(e.label).to.be.equal("null"),e=new me({value:null}),chai.expect(e.value).to.be.equal(null),chai.expect(e.label).to.be.equal("null"),e=new me({}),chai.expect(e.value).to.be.equal(void 0),chai.expect(e.label).to.be.equal("undefined"),e=new me({value:"foo",label:"bar",icon:"icon:close",hint:"buzz",disabled:!0,action:()=>{},mode:"toggle",selected:!0}),chai.expect(e.value).to.be.equal("foo"),chai.expect(e.label).to.be.equal("bar"),chai.expect(e.icon).to.be.equal("icon:close"),chai.expect(e.hint).to.be.equal("buzz"),chai.expect(e.disabled).to.be.equal(!0),chai.expect(typeof e.action).to.be.equal("function"),chai.expect(e.mode).to.be.equal("toggle"),chai.expect(e.selected).to.be.equal(!0),chai.expect(e.options).to.be.eql(void 0)})),it("Should initialize suboptions from constructor arguments",(()=>{let e=new me({options:[]});chai.expect(e.hasmore).to.be.equal(!1),chai.expect(e.options).to.be.eql([]),chai.expect(e.options?.length).to.be.equal(0),e=new me({options:[1,"2",null]}),chai.expect(e.hasmore).to.be.equal(!0),chai.expect(e.options[0].value).to.be.equal(1),chai.expect(e.options[0].label).to.be.equal("1"),chai.expect(e.options[1].value).to.be.equal("2"),chai.expect(e.options[1].label).to.be.equal("2"),chai.expect(e.options[2].value).to.be.equal(null),chai.expect(e.options[2].label).to.be.equal("null"),e=new me({options:[1,{value:"2",label:"two"},void 0]}),chai.expect(e.options[0].value).to.be.equal(1),chai.expect(e.options[0].label).to.be.equal("1"),chai.expect(e.options[1].value).to.be.equal("2"),chai.expect(e.options[1].label).to.be.equal("two"),chai.expect(e.options[2].value).to.be.equal(void 0),chai.expect(e.options[2].label).to.be.equal("undefined"),e=new me({options:[1]}),chai.expect(e.options[0].value).to.be.equal(1),chai.expect(e.options[0].label).to.be.equal("1")})),it("Should return `options.path` from path getter",(()=>{let e=new me;chai.expect(e.options).to.be.equal(void 0),e=new me({options:[]}),chai.expect(e.options?.path).to.be.eql("")})),it("Should return subitem with specified value using `.getSubitem([value])`",(()=>{const e=new me(1),t=new me(2),i=new me({options:[e,t]});chai.expect(i.getSubitem(1)).to.be.equal(e),chai.expect(i.getSubitem(2)).to.be.equal(t)}))}))}}const ye=[{value:1,options:[{value:"foo",options:[null,void 0,NaN]},{value:"bar",options:[null,void 0,NaN]},{value:"buzz",options:[null,void 0,NaN]}]},{value:2,options:[{value:"foo",options:[null,void 0,NaN]},{value:"bar",options:[null,void 0,NaN]},{value:"buzz",options:[null,void 0,NaN]}]},{value:3,options:[{value:"foo",options:[null,void 0,NaN]},{value:"bar",options:[null,void 0,NaN]},{value:"buzz",options:[null,void 0,NaN]}]},{value:"scrolls",options:[{value:"scroll1",mode:"scroll"},{value:"scroll2",mode:"scroll"},{value:"scroll3",mode:"scroll"}]}],we=[];class MenuOptionsTest{run(){describe("MenuOptions",(()=>{it("Should initialize with correct default values",(()=>{const e=new fe;chai.expect(e.path).to.be.eql(""),chai.expect(e.first).to.be.equal(void 0),chai.expect(e.last).to.be.equal(void 0),chai.expect(e.delimiter).to.be.equal(","),chai.expect(e.length).to.be.equal(0)})),it("Should initialize correctly from constructor arguments",(()=>{let e=new fe([1,"2",null]);chai.expect(e.path).to.be.eql(""),chai.expect(e.first).to.be.equal(void 0),chai.expect(e.last).to.be.equal(void 0),chai.expect(e.delimiter).to.be.equal(","),chai.expect(e.length).to.be.equal(3),chai.expect(e[0].value).to.be.equal(1),chai.expect(e[0].label).to.be.equal("1"),chai.expect(e[1].value).to.be.equal("2"),chai.expect(e[1].label).to.be.equal("2"),chai.expect(e[2].value).to.be.equal(null),chai.expect(e[2].label).to.be.equal("null"),e=new fe([{value:"2",label:"two"}]),chai.expect(e.length).to.be.equal(1),chai.expect(e[0].value).to.be.equal("2"),chai.expect(e[0].label).to.be.equal("two"),e=new fe([1,{value:"2",label:"two"}]),chai.expect(e.length).to.be.equal(2),chai.expect(e[0].value).to.be.equal(1),chai.expect(e[0].label).to.be.equal("1"),chai.expect(e[1].value).to.be.equal("2"),chai.expect(e[1].label).to.be.equal("two")})),it("Should initialize correctly from constructor arguments including first, or path propetty",(()=>{let e=new fe([1,"2",null],{first:"2"});chai.expect(e.path).to.be.equal("2"),chai.expect(e.last).to.be.equal("2"),chai.expect(e[1].selected).to.be.eql(!0),e=new fe([1,"2",null],{path:"1"}),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),chai.expect(e[0].selected).to.be.eql(!0)})),it("Should initialize suboptions from constructor arguments",(()=>{const e=new fe([{options:[1,"2",null]}]);chai.expect(e.length).to.be.equal(1),chai.expect(e[0].hasmore).to.be.equal(!0),chai.expect(e[0].options.length).to.be.equal(3),chai.expect(e[0].options[0].value).to.be.equal(1),chai.expect(e[0].options[1].value).to.be.equal("2"),chai.expect(e[0].options[2].value).to.be.equal(null)})),it("Should return item with specified value using `.getItem([value])`",(()=>{const e=new me(1),t=new me(2),i=new fe([e,t]);chai.expect(i.getItem(1)).to.be.equal(e),chai.expect(i.getItem(2)).to.be.equal(t)})),it("Should update `path`, `first` and `last` properties when items are selected",(()=>{const e=new fe([1,2,3]);e[0].selected=!0,chai.expect(e.path).to.be.equal("1"),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[1].selected=!0,chai.expect(e.path).to.be.equal("2"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal(2),e[2].selected=!0,chai.expect(e.path).to.be.equal("3"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(3)})),it("Should update `first`, `last` and items' `selected` properties when `path` property is set",(()=>{const e=new fe([1,{value:2,label:"two"},3]);e.path="1",chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e.path="two",chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal(2),e.path="3",chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(3)})),it("Should update `last`, `path` and items' `selected` properties when `first` property is set",(()=>{const e=new fe([1,{value:2,label:"two"},3]);e.first=1,chai.expect(e.path).to.be.equal("1"),chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e.first=2,chai.expect(e.path).to.be.equal("two"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal(2),e.first=3,chai.expect(e.path).to.be.equal("3"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(3)})),it('Should update `first`, `last`, `path` properties only when items with `mode="pick"` are selected',(()=>{const e=new fe([1,{value:2,mode:"toggle"},3]);e[0].selected=!0,chai.expect(e.path).to.be.equal("1"),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[1].selected=!0,chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e.path).to.be.equal("1"),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[2].selected=!0,chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!0),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e.path).to.be.equal("3"),e[1].selected=!1,chai.expect(e.path).to.be.equal("3"),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(3),e.first=2,chai.expect(e.path).to.be.equal("3"),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal(3),e[0].selected=!0,chai.expect(e.path).to.be.equal("1"),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e.path="2",chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1)})),it("Should update deep `first`, `last`, `scroll` and `path` string when items are selected",(()=>{const e=new fe(ye);e[0].selected=!0,chai.expect(e.path).to.be.equal("1"),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[1].options[1].selected=!0,chai.expect(e.path).to.be.equal("2,bar"),chai.expect(e[1].options.path).to.be.equal("bar"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal("bar"),chai.expect(e[1].options.first).to.be.equal("bar"),chai.expect(e[1].options.last).to.be.equal("bar"),e[1].options[0].selected=!0,chai.expect(e.path).to.be.equal("2,foo"),chai.expect(e[1].options.path).to.be.equal("foo"),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal("foo"),chai.expect(e[1].options.first).to.be.equal("foo"),chai.expect(e[1].options.last).to.be.equal("foo"),e[2].options[2].options[2].selected=!0,chai.expect(e.path).to.be.equal("3,buzz,NaN"),chai.expect(e[2].options.path).to.be.equal("buzz,NaN"),chai.expect(e[2].options[2].options.path).to.be.equal("NaN"),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].selected).to.be.equal(!0),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.NaN,chai.expect(e[2].options.first).to.be.equal("buzz"),chai.expect(e[2].options.last).to.be.NaN,chai.expect(e[2].options[2].options.first).to.be.NaN,chai.expect(e[2].options[2].options.last).to.be.NaN,e[2].selected=!1,chai.expect(e[2].options[2].selected).to.be.equal(!1),chai.expect(e[2].options[2].options[2].selected).to.be.equal(!1),chai.expect(e.path).to.be.equal(""),chai.expect(e[2].options.path).to.be.equal(""),chai.expect(e[2].options[2].options.path).to.be.equal(""),chai.expect(e.first).to.be.equal(void 0),chai.expect(e.last).to.be.equal(void 0),chai.expect(e[2].options.first).to.be.equal(void 0),chai.expect(e[2].options.last).to.be.equal(void 0),chai.expect(e[2].options[2].options.first).to.be.equal(void 0),chai.expect(e[2].options[2].options.last).to.be.equal(void 0),e[0].selected=!0,chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[2].options[2].selected).to.be.equal(!1),chai.expect(e[2].options[2].options[2].selected).to.be.equal(!1),chai.expect(e.path).to.be.equal("1"),chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[2].options.path).to.be.equal(""),chai.expect(e[2].options[2].options.path).to.be.equal(""),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[3].options[1].selected=!0,chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[3].selected).to.be.equal(!0),chai.expect(e.path).to.be.equal("scrolls,scroll2"),chai.expect(e.first).to.be.equal("scrolls"),chai.expect(e.last).to.be.equal("scrolls"),chai.expect(e.scroll).to.be.equal("scroll2"),chai.expect(e[3].options.path).to.be.equal("scroll2"),chai.expect(e[3].options.first).to.be.equal(void 0),chai.expect(e[3].options.last).to.be.equal(void 0),chai.expect(e[3].options.scroll).to.be.equal("scroll2")})),it("Should update deep `first`, `last`, `scroll` and items' `selected` properties when `path` property is set",(()=>{const e=new fe(ye);e.path="1",chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e.path="2,bar",chai.expect(e[1].options.path).to.be.equal("bar"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!0),chai.expect(e[1].options[1].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal("bar"),chai.expect(e[1].options.first).to.be.equal("bar"),chai.expect(e[1].options.last).to.be.equal("bar"),e.path="1,foo",chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[0].options.path).to.be.equal("foo"),chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[0].options[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal("foo"),chai.expect(e[1].options.first).to.be.equal(void 0),chai.expect(e[1].options.last).to.be.equal(void 0),chai.expect(e[0].options.first).to.be.equal("foo"),chai.expect(e[0].options.last).to.be.equal("foo"),e.path="1,buzz",chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[0].options.path).to.be.equal("buzz"),chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e[2].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[0].options[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal("buzz"),chai.expect(e[0].options.first).to.be.equal("buzz"),chai.expect(e[0].options.last).to.be.equal("buzz"),e.path="",chai.expect(e[0].options.path).to.be.equal(""),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[0].options[0].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(void 0),chai.expect(e.last).to.be.equal(void 0),chai.expect(e[0].options.first).to.be.equal(void 0),chai.expect(e[0].options.last).to.be.equal(void 0),e.path="3,buzz,NaN",chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[2].options.path).to.be.equal("buzz,NaN"),chai.expect(e[2].options[2].options.path).to.be.equal("NaN"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].options[2].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.NaN,chai.expect(e[1].options.first).to.be.equal(void 0),chai.expect(e[1].options.last).to.be.equal(void 0),chai.expect(e[2].options.first).to.be.equal("buzz"),chai.expect(e[2].options.last).to.be.NaN,chai.expect(e[2].options[2].options.first).to.be.NaN,chai.expect(e[2].options[2].options.last).to.be.NaN,e.path="3,buzz,null",chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[2].options.path).to.be.equal("buzz,null"),chai.expect(e[2].options[2].options.path).to.be.equal("null"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].options[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(null),chai.expect(e[1].options.first).to.be.equal(void 0),chai.expect(e[1].options.last).to.be.equal(void 0),chai.expect(e[2].options.first).to.be.equal("buzz"),chai.expect(e[2].options.last).to.be.equal(null),chai.expect(e[2].options[2].options.first).to.be.equal(null),chai.expect(e[2].options[2].options.last).to.be.equal(null),e.path="scrolls,scroll1",chai.expect(e[2].options.path).to.be.equal(""),chai.expect(e[2].selected).to.be.equal(!1),chai.expect(e[3].options.path).to.be.equal("scroll1"),chai.expect(e[3].options.first).to.be.equal(void 0),chai.expect(e[3].options.last).to.be.equal(void 0),chai.expect(e[3].options.scroll).to.be.equal("scroll1"),chai.expect(e[3].options[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal("scrolls"),chai.expect(e.last).to.be.equal("scrolls"),chai.expect(e.scroll).to.be.equal("scroll1"),e.path="scrolls",chai.expect(e.first).to.be.equal("scrolls"),chai.expect(e.last).to.be.equal("scrolls"),chai.expect(e.scroll).to.be.equal(void 0)})),it("Should update deep `last`, `path` and items' `selected` properties when `first` property is set",(()=>{const e=new fe(ye);e.first=1,chai.expect(e[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(1),chai.expect(e.last).to.be.equal(1),e[1].options.first="bar",chai.expect(e[1].options.path).to.be.equal("bar"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!0),chai.expect(e[1].options[1].selected).to.be.equal(!0),chai.expect(e[2].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(2),chai.expect(e.last).to.be.equal("bar"),chai.expect(e[1].options.first).to.be.equal("bar"),chai.expect(e[1].options.last).to.be.equal("bar"),e.first=void 0,chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e.first).to.be.equal(void 0),chai.expect(e.last).to.be.equal(void 0),chai.expect(e[1].options.first).to.be.equal(void 0),chai.expect(e[1].options.last).to.be.equal(void 0),e[2].options[2].options.first=null,chai.expect(e[1].options.path).to.be.equal(""),chai.expect(e[2].options.path).to.be.equal("buzz,null"),chai.expect(e[2].options[2].options.path).to.be.equal("null"),chai.expect(e[0].selected).to.be.equal(!1),chai.expect(e[1].selected).to.be.equal(!1),chai.expect(e[1].options[1].selected).to.be.equal(!1),chai.expect(e[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].selected).to.be.equal(!0),chai.expect(e[2].options[2].options[0].selected).to.be.equal(!0),chai.expect(e.first).to.be.equal(3),chai.expect(e.last).to.be.equal(null),chai.expect(e[1].options.first).to.be.equal(void 0),chai.expect(e[1].options.last).to.be.equal(void 0),chai.expect(e[2].options.first).to.be.equal("buzz"),chai.expect(e[2].options.last).to.be.equal(null),chai.expect(e[2].options[2].options.first).to.be.equal(null),chai.expect(e[2].options[2].options.last).to.be.equal(null)})),it("Should update `path`, `first` and `last` on initialization when selected items are provided.",(()=>{const e=JSON.parse(JSON.stringify(ye));e[1].options[2].options[0]={value:null,selected:!0};const t=new fe(e);chai.expect(t[1].selected).to.be.equal(!0),chai.expect(t.path).to.be.equal("2,buzz,null"),chai.expect(t.first).to.be.equal(2),chai.expect(t.last).to.be.equal(null),chai.expect(t[1].options[2].selected).to.be.equal(!0),chai.expect(t[1].options.path).to.be.equal("buzz,null"),chai.expect(t[1].options.first).to.be.equal("buzz"),chai.expect(t[1].options.last).to.be.equal(null),chai.expect(t[1].options[2].options[0].selected).to.be.equal(!0),chai.expect(t[1].options[2].options.path).to.be.equal("null"),chai.expect(t[1].options[2].options.first).to.be.equal(null),chai.expect(t[1].options[2].options.last).to.be.equal(null)})),it("Should update `path`, `first` and `last` properties in correct order and only when necessary.",(()=>{const e=new fe(ye);e.addEventListener("changed",(()=>{we.push("change")})),e.addEventListener("path-changed",(()=>{we.push("path changed: "+e.path)})),e.addEventListener("first-changed",(()=>{we.push("firstChanged: "+e.first)})),e.addEventListener("last-changed",(()=>{we.push("lastChanged: "+e.last)})),we.length=0,e[0].selected=!0,chai.expect(we).to.be.eql(["path changed: 1","firstChanged: 1","lastChanged: 1","change"]),we.length=0,e[1].options[1].selected=!0,chai.expect(we).to.be.eql(["path changed: 2,bar","firstChanged: 2","lastChanged: bar","change"]),we.length=0,e[2].options[2].options[2].selected=!0,chai.expect(we).to.be.eql(["path changed: 3,buzz,NaN","firstChanged: 3","lastChanged: NaN","change"]),we.length=0,e[2].selected=!1,chai.expect(we).to.be.eql(["path changed: ","firstChanged: undefined","lastChanged: undefined","change"]),we.length=0,e[2].selected=!0,chai.expect(we).to.be.eql(["path changed: 3","firstChanged: 3","lastChanged: 3","change"])}))}))}}class MenuElementTest{run(){(new MenuItemTest).run(),(new MenuOptionsTest).run()}}class NumberSliderRangeElementTest{element=new O;constructor(){this.element.style.display="none",document.body.appendChild(this.element)}reset(){this.element.value=[0,1],this.element.step=.01,this.element.min=0,this.element.max=1}run(){describe("IoNumberSliderRange",(()=>{describe("default values",(()=>{it("has default values",(()=>{this.reset(),chai.expect(this.element.value[0]).to.equal(0),chai.expect(this.element.value[1]).to.equal(1),chai.expect(this.element.step).to.equal(.01),chai.expect(this.element.min).to.equal(0),chai.expect(this.element.max).to.equal(1)}))})),describe("innerText",(()=>{it("matches values",(()=>{this.reset(),this.element.value=[0,1],chai.expect(this.element.$.number0.innerText).to.equal("0"),this.element.value=[1,1],chai.expect(this.element.$.number0.innerText).to.equal("1"),chai.expect(this.element.$.number1.innerText).to.equal("1"),this.element.value=[0,.1],chai.expect(this.element.$.number1.innerText).to.equal("0.1"),this.element.value=[0,.001],chai.expect(this.element.$.number1.innerText).to.equal("0")}))})),describe("attributes",(()=>{it("has tabindex attribute",(()=>{this.reset(),chai.expect(this.element.$.number0.getAttribute("tabindex")).to.equal("0"),chai.expect(this.element.$.slider.getAttribute("tabindex")).to.equal("0")})),it("has contenteditable attribute on number field",(()=>{this.reset(),chai.expect(this.element.getAttribute("contenteditable")).to.equal(null),chai.expect(this.element.$.number0.getAttribute("contenteditable")).to.equal(""),chai.expect(this.element.$.number1.getAttribute("contenteditable")).to.equal(""),chai.expect(this.element.$.slider.getAttribute("contenteditable")).to.equal(null)})),it("has a11y attributes",(()=>{this.reset(),chai.expect(this.element.$.slider.getAttribute("role")).to.equal("slider"),this.element.min=0,chai.expect(this.element.$.slider.getAttribute("aria-valuemin")).to.equal("0"),this.element.max=1,chai.expect(this.element.$.slider.getAttribute("aria-valuemax")).to.equal("1"),this.reset()}))}))}))}}class NumberSliderElementTest{element=new z;constructor(){this.element.style.display="none",document.body.appendChild(this.element),this.element.$.slider.lazy=!1}reset(){this.element.value=0,this.element.step=.001,this.element.min=0,this.element.max=1}run(){describe("IoNumberSlider",(()=>{describe("default values",(()=>{it("has default values",(()=>{chai.expect(this.element.value).to.equal(0),chai.expect(this.element.step).to.equal(.01),chai.expect(this.element.min).to.equal(0),chai.expect(this.element.max).to.equal(1)}))})),describe("innerText",(()=>{it("matches values",(()=>{this.element.value=0,chai.expect(this.element.$.number.innerText).to.equal("0"),this.element.value=1,chai.expect(this.element.$.number.innerText).to.equal("1"),this.element.value=.1,chai.expect(this.element.$.number.innerText).to.equal("0.1"),this.element.value=.01,chai.expect(this.element.$.number.innerText).to.equal("0.01"),this.element.value=.001,chai.expect(this.element.$.number.innerText).to.equal("0")}))})),describe("attributes",(()=>{it("has tabindex attribute",(()=>{chai.expect(this.element.$.number.getAttribute("tabindex")).to.equal("0"),chai.expect(this.element.$.slider.getAttribute("tabindex")).to.equal("0")})),it("has contenteditable attribute on number field",(()=>{chai.expect(this.element.getAttribute("contenteditable")).to.equal(null),chai.expect(this.element.$.number.getAttribute("contenteditable")).to.equal(""),chai.expect(this.element.$.slider.getAttribute("contenteditable")).to.equal(null)})),it("has a11y attributes",(()=>{chai.expect(this.element.$.slider.getAttribute("role")).to.equal("slider"),this.element.value=.1,chai.expect(this.element.$.slider.getAttribute("aria-valuenow")).to.equal("0.1"),this.element.min=0,chai.expect(this.element.$.slider.getAttribute("aria-valuemin")).to.equal("0"),this.element.max=1,chai.expect(this.element.$.slider.getAttribute("aria-valuemax")).to.equal("1"),this.reset()}))}))}))}}class SliderRangeElementTest{element=new j({value:[0,0]});constructor(){this.element.style.display="none",document.body.appendChild(this.element),this.element.lazy=!1}reset(){this.element.value=[0,1],this.element.step=.01,this.element.min=0,this.element.max=1}run(){describe("IoSliderRange",(()=>{describe("default values",(()=>{it("has default values",(()=>{this.reset(),chai.expect(this.element.value[0]).to.equal(0),chai.expect(this.element.value[1]).to.equal(1),chai.expect(this.element.step).to.equal(.01),chai.expect(this.element.min).to.equal(0),chai.expect(this.element.max).to.equal(1)}))})),describe("attributes",(()=>{it("has tabindex attribute",(()=>{chai.expect(this.element.getAttribute("tabindex")).to.equal("0")})),it("has contenteditable attribute on number field",(()=>{chai.expect(this.element.getAttribute("contenteditable")).to.equal(null)})),it("has a11y attributes",(()=>{this.reset(),chai.expect(this.element.getAttribute("role")).to.equal("slider"),this.element.min=0,chai.expect(this.element.getAttribute("aria-valuemin")).to.equal("0"),this.element.max=1,chai.expect(this.element.getAttribute("aria-valuemax")).to.equal("1")}))}))}))}}const Ce=new k;Ce.lazy=!1;class SliderElementTest{run(){describe("IoSlider",(()=>{describe("Initialization",(()=>{it("Should initialize property definitions correctly",(()=>{chai.expect(Ce.value).to.equal(0),chai.expect(Ce.step).to.equal(.01),chai.expect(Ce.min).to.equal(0),chai.expect(Ce.max).to.equal(1)})),it("has correct default attributes",(()=>{chai.expect(Ce.getAttribute("tabindex")).to.equal("0"),chai.expect(Ce.getAttribute("contenteditable")).to.equal(null)})),it("has correct default innerHTML",(()=>{}))})),describe("Reactivity",(()=>{it("should render innerHTML",(()=>{})),it("should change...",(()=>{})),it("has reactive attributes",(()=>{}))})),describe("Accessibility",(()=>{it("has a11y attributes",(()=>{chai.expect(Ce.getAttribute("role")).to.equal("slider"),Ce.value=.1,chai.expect(Ce.getAttribute("aria-valuenow")).to.equal("0.1"),Ce.min=0,chai.expect(Ce.getAttribute("aria-valuemin")).to.equal("0"),Ce.max=1,chai.expect(Ce.getAttribute("aria-valuemax")).to.equal("1")}))}))}))}}class SlidersElementTest{run(){(new NumberSliderRangeElementTest).run(),(new NumberSliderElementTest).run(),(new SliderRangeElementTest).run(),(new SliderElementTest).run()}}class ElementsTests{run(){(new BasicElementTest).run(),(new ColorElementTest).run(),(new MenuElementTest).run(),(new SlidersElementTest).run()}}var __decorate=function(e,t,i,o){var a,n=arguments.length,c=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,i,o);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(c=(n<3?a(c):n>3?a(t,i,c):a(t,i))||c);return n>3&&c&&Object.defineProperty(t,i,c),c};mocha.setup("bdd");const Te=document.createElement("div");Te.setAttribute("id","mocha"),document.body.appendChild(Te),Te.style.display="none";let _e=!1;async function nextTick(){return new Promise((e=>{setTimeout((()=>{e()}))}))}async function afterHashChange(){return new Promise((e=>{self.addEventListener("hashchange",(()=>{e()}),{once:!0})}))}let Ee=class IoGuiTestPage extends p{static get Style(){return"\n      :host {\n        background: var(--iotBackgroundColor);\n        color: var(--iotColor);\n      }\n      :host #mocha {\n        font: 20px/1.5 \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n        margin: 0 var(--iotLineHeight);\n        position: relative;\n      }\n\n      :host #mocha-stats {\n        display: flex;\n        flex-direction: row;\n        font-size: var(--iotFontSize);\n        color: var(--iotColor);\n        margin: var(--iotLineHeight) 0 !important;\n      }\n      :host #mocha-stats .progress-contain {\n        display: flex;\n        margin-right: auto;\n      }\n      :host #mocha-stats .progress-ring {\n        display: none;\n      }\n      :host #mocha-stats .progress-element {\n        margin-top: 0.2em;\n        margin-right: 1em;\n      }\n      :host #mocha-stats a {\n        text-decoration: none;\n        color: inherit;\n      }\n\n      :host #mocha-stats .passes {\n        margin-right: var(--iotLineHeight);\n        color: var(--iotColorGreen);\n      }\n      :host #mocha-stats .failures {\n        margin-right: var(--iotLineHeight);\n        color: var(--iotColorRed);\n      }\n\n      :host #mocha .replay {\n        display: none !important;\n      }\n\n      :host #mocha ul,\n      :host #mocha li {\n        margin: 0;\n        padding: 0;\n        list-style: none;\n      }\n\n      :host #mocha h1,\n      :host #mocha h2 {\n        margin: 0;\n      }\n      :host #mocha h1 {\n        margin-top: 1em;\n        font-size: 1em;\n        font-weight: 200;\n      }\n      :host #mocha h1 a {\n        text-decoration: none;\n        color: inherit;\n      }\n      :host #mocha h1 a:hover {\n        text-decoration: underline;\n      }\n      :host #mocha h2 {\n        font-size: 0.75em;\n        font-weight: 300;\n        padding-left: 1em !important;\n        cursor: pointer;\n      }\n\n      :host #mocha .hidden {\n        display: none;\n      }\n\n      :host #mocha .test > pre {\n        background: var(--iotBackgroundColorDimmed);\n        font-size: var(--iotFontSize);\n        margin: var(--iotLineHeight);\n        margin-top: 0.25em;\n        padding: var(--iotLineHeight);\n        overflow: auto;\n        border: var(--iotBorder);\n        border-radius: var(--iotBorderRadius2);\n        max-width: calc(100% - 42px);\n      }\n\n      :host #mocha .test.fail h2::before {\n        content: '✖';\n        font-size: 1em;\n        margin: 0 0.5em 0 0;\n        color: var(--iotColorRed);\n      }\n      :host #mocha .test.pass h2::before {\n        content: '✓';\n        font-size: 1em;\n        margin: 0 0.5em 0 0;\n        color: var(--iotColorGreen);\n      }\n\n      :host #mocha .test.fail pre.error {\n        border: var(--iotBorderFail);\n      }\n\n      :host #mocha code .comment { color: #ddd; }\n      :host #mocha code .init { color: #2f6fad; }\n      :host #mocha code .string { color: #5890ad; }\n      :host #mocha code .keyword { color: #8a6343; }\n      :host #mocha code .number { color: #2f6fad; }\n\n      @media screen and (max-width: 550px) {\n        :host #mocha-stats .progress-contain {\n          display: none;\n        }\n\n        :host #mocha .test > pre {\n          font-size: 0.5em;\n        }\n      }\n    "}connectedCallback(){super.connectedCallback(),this.appendChild(Te),Te.style.display="block",function runTests(){_e||((new CoreTests).run(),(new ElementsTests).run(),mocha.checkLeaks(),mocha.run(),_e=!0)}()}disconnectedCallback(){super.disconnectedCallback(),document.body.appendChild(Te),Te.style.display="none"}};Ee=__decorate([i],Ee);export{Ee as IoGuiTestPage,afterHashChange,nextTick};
